{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5442991256713867, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.893166744709015, "policy_loss": -0.011194932665966916, "vf_loss": 9.960030615329742, "vf_explained_var": 1.1168420314788819e-06, "kl": 0.0068831567247343624, "entropy": 5.704555860161781, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 611935.9376234342, "episode_reward_min": 40459.82904463401, "episode_reward_mean": 259913.45996277314, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 3780, "policy_reward_min": {"policy_mom": -3736.718353068334, "policy_mean": 1492.3251524464783, "policy_mm": 12982.87957998577, "policy_rl": 28799.10641122745}, "policy_reward_max": {"policy_mom": 168136.35775001842, "policy_mean": 166171.03559092886, "policy_mm": 158705.93235889875, "policy_rl": 160908.3448730611}, "policy_reward_mean": {"policy_mom": 63878.019908762704, "policy_mean": 66592.72127338887, "policy_mm": 64175.57223821178, "policy_rl": 65267.14654240985}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 63878.0234375, "('mom_0', 'policy_mom')_total_reward_min": -3736.71826171875, "('mom_0', 'policy_mom')_total_reward_max": 168136.359375, "('mean_0', 'policy_mean')_total_reward_mean": 66592.7265625, "('mean_0', 'policy_mean')_total_reward_min": 1492.3251953125, "('mean_0', 'policy_mean')_total_reward_max": 166171.03125, "('mm_0', 'policy_mm')_total_reward_mean": 64175.56640625, "('mm_0', 'policy_mm')_total_reward_min": 12982.8798828125, "('mm_0', 'policy_mm')_total_reward_max": 158705.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 65267.14453125, "('rl_trader_0', 'policy_rl')_total_reward_min": 28799.10546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 160908.34375}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24373541471809776, "mean_inference_ms": 0.7561042111565309, "mean_action_processing_ms": 0.1151480695004166, "mean_env_wait_ms": 2.3848346637743942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007061163584391276, "StateBufferConnector_ms": 0.0007339318593343099, "ViewRequirementAgentConnector_ms": 0.018631617228190105}, "num_episodes": 15, "episode_return_max": 611935.9376234342, "episode_return_min": 40459.82904463401, "episode_return_mean": 259913.45996277314, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.09450935577775, "num_env_steps_trained_throughput_per_sec": 269.09450935577775, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14864.686, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14864.584, "sample_time_ms": 14272.648, "learn_time_ms": 574.852, "learn_throughput": 6958.313, "synch_weights_time_ms": 11.179}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "ae48a_00000", "date": "2025-10-28_12-08-29", "timestamp": 1761671309, "time_this_iter_s": 14.867477178573608, "time_total_s": 14.867477178573608, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d516a20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.867477178573608, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.586363636363636, "ram_util_percent": 84.29090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5342414975166321, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.889301398396492, "policy_loss": -0.015036886955203953, "vf_loss": 9.959212404489517, "vf_explained_var": 1.8671154975891113e-06, "kl": 0.00948032023205202, "entropy": 5.677015087008476, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 694698.0148377807, "episode_reward_min": -102720.08528414974, "episode_reward_mean": 224629.80325783096, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 7812, "policy_reward_min": {"policy_mom": -31166.657423583994, "policy_mean": -20242.281141224557, "policy_mm": -27672.216024082813, "policy_rl": -34796.67583281266}, "policy_reward_max": {"policy_mom": 209801.1209792135, "policy_mean": 184183.51785542996, "policy_mm": 198503.66176476917, "policy_rl": 160908.3448730611}, "policy_reward_mean": {"policy_mom": 55186.10857573545, "policy_mean": 55744.15984463294, "policy_mm": 56144.773548807396, "policy_rl": 57554.7612886552}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55186.11328125, "('mom_0', 'policy_mom')_total_reward_min": -31166.658203125, "('mom_0', 'policy_mom')_total_reward_max": 209801.125, "('mean_0', 'policy_mean')_total_reward_mean": 55744.16015625, "('mean_0', 'policy_mean')_total_reward_min": -20242.28125, "('mean_0', 'policy_mean')_total_reward_max": 184183.515625, "('mm_0', 'policy_mm')_total_reward_mean": 56144.765625, "('mm_0', 'policy_mm')_total_reward_min": -27672.216796875, "('mm_0', 'policy_mm')_total_reward_max": 198503.65625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57554.7578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -34796.67578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 160908.34375}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24680640512874677, "mean_inference_ms": 0.7615229162662395, "mean_action_processing_ms": 0.11638344577796567, "mean_env_wait_ms": 2.4051745285420054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007398666874054939, "StateBufferConnector_ms": 0.0007483267015026461, "ViewRequirementAgentConnector_ms": 0.018950047031525644}, "num_episodes": 16, "episode_return_max": 694698.0148377807, "episode_return_min": -102720.08528414974, "episode_return_mean": 224629.80325783096, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.58581266128573, "num_env_steps_trained_throughput_per_sec": 261.58581266128573, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15078.021, "restore_workers_time_ms": 0.028, "training_step_time_ms": 15077.935, "sample_time_ms": 14471.343, "learn_time_ms": 586.71, "learn_throughput": 6817.679, "synch_weights_time_ms": 11.925}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "ae48a_00000", "date": "2025-10-28_12-08-45", "timestamp": 1761671325, "time_this_iter_s": 15.295408248901367, "time_total_s": 30.162885427474976, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a0c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.162885427474976, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.785714285714285, "ram_util_percent": 83.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5475064516067505, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.879255044460297, "policy_loss": -0.01925349174416624, "vf_loss": 9.952748596668243, "vf_explained_var": -7.293745875358582e-06, "kl": 0.011999619829092025, "entropy": 5.664000092446804, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 694698.0148377807, "episode_reward_min": -102720.08528414974, "episode_reward_mean": 215964.48106976488, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 11844, "policy_reward_min": {"policy_mom": -31166.657423583994, "policy_mean": -20242.281141224557, "policy_mm": -40488.17783666516, "policy_rl": -34796.67583281266}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 184183.51785542996, "policy_mm": 222455.89947899498, "policy_rl": 160908.3448730611}, "policy_reward_mean": {"policy_mom": 50606.03602086267, "policy_mean": 52865.5029239606, "policy_mm": 58337.39799720191, "policy_rl": 54155.54412773971}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50606.0390625, "('mom_0', 'policy_mom')_total_reward_min": -31166.658203125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 52865.50390625, "('mean_0', 'policy_mean')_total_reward_min": -20242.28125, "('mean_0', 'policy_mean')_total_reward_max": 184183.515625, "('mm_0', 'policy_mm')_total_reward_mean": 58337.3984375, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 54155.54296875, "('rl_trader_0', 'policy_rl')_total_reward_min": -34796.67578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 160908.34375}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24859109313882954, "mean_inference_ms": 0.7660382999862658, "mean_action_processing_ms": 0.1173509605870986, "mean_env_wait_ms": 2.415580765697016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007606567220484957, "StateBufferConnector_ms": 0.000749116248272835, "ViewRequirementAgentConnector_ms": 0.019067272226861182}, "num_episodes": 16, "episode_return_max": 694698.0148377807, "episode_return_min": -102720.08528414974, "episode_return_mean": 215964.48106976488, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.4239931153457, "num_env_steps_trained_throughput_per_sec": 260.4239931153457, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15171.872, "restore_workers_time_ms": 0.027, "training_step_time_ms": 15171.799, "sample_time_ms": 14547.62, "learn_time_ms": 608.952, "learn_throughput": 6568.666, "synch_weights_time_ms": 8.418}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "ae48a_00000", "date": "2025-10-28_12-09-00", "timestamp": 1761671340, "time_this_iter_s": 15.363012075424194, "time_total_s": 45.52589750289917, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a980>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.52589750289917, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.968181818181822, "ram_util_percent": 83.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5527659058570862, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.886376625299453, "policy_loss": -0.019975942221208243, "vf_loss": 9.960470899939537, "vf_explained_var": 7.401406764984131e-06, "kl": 0.012470037084972335, "entropy": 5.661238734424114, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 694698.0148377807, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 178039.96082991897, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 15876, "policy_reward_min": {"policy_mom": -35822.45182431763, "policy_mean": -33765.77827403296, "policy_mm": -40488.17783666516, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 184183.51785542996, "policy_mm": 222455.89947899498, "policy_rl": 160908.3448730611}, "policy_reward_mean": {"policy_mom": 42111.7090800522, "policy_mean": 43044.26928314097, "policy_mm": 47523.51643824385, "policy_rl": 45360.46602848192}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 42111.703125, "('mom_0', 'policy_mom')_total_reward_min": -35822.453125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 43044.265625, "('mean_0', 'policy_mean')_total_reward_min": -33765.77734375, "('mean_0', 'policy_mean')_total_reward_max": 184183.515625, "('mm_0', 'policy_mm')_total_reward_mean": 47523.51171875, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 45360.4609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 160908.34375}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2490955154846242, "mean_inference_ms": 0.7667405801205797, "mean_action_processing_ms": 0.11768444623791843, "mean_env_wait_ms": 2.4185813455573513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007712651812841021, "StateBufferConnector_ms": 0.0007564113253638858, "ViewRequirementAgentConnector_ms": 0.019162325632004512}, "num_episodes": 16, "episode_return_max": 694698.0148377807, "episode_return_min": -138571.85737396954, "episode_return_mean": 178039.96082991897, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.79256883222985, "num_env_steps_trained_throughput_per_sec": 270.79256883222985, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15071.769, "restore_workers_time_ms": 0.023, "training_step_time_ms": 15071.702, "sample_time_ms": 14469.035, "learn_time_ms": 588.612, "learn_throughput": 6795.651, "synch_weights_time_ms": 7.314}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "ae48a_00000", "date": "2025-10-28_12-09-15", "timestamp": 1761671355, "time_this_iter_s": 14.774944067001343, "time_total_s": 60.30084156990051, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d559800>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.30084156990051, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.652380952380952, "ram_util_percent": 83.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6009844541549683, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.887882456183434, "policy_loss": -0.018716058498830533, "vf_loss": 9.96106079518795, "vf_explained_var": -1.7639249563217164e-07, "kl": 0.013935228990612841, "entropy": 5.72493535131216, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 694698.0148377807, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 195608.40838764483, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 19908, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -33765.77827403296, "policy_mm": -40488.17783666516, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 184183.51785542996, "policy_mm": 222455.89947899498, "policy_rl": 232894.76650947588}, "policy_reward_mean": {"policy_mom": 47127.7806969578, "policy_mean": 47534.095332608136, "policy_mm": 50605.385556850415, "policy_rl": 50341.146801228446}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47127.77734375, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 47534.08984375, "('mean_0', 'policy_mean')_total_reward_min": -33765.77734375, "('mean_0', 'policy_mean')_total_reward_max": 184183.515625, "('mm_0', 'policy_mm')_total_reward_mean": 50605.3828125, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 50341.140625, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 232894.765625}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24921769286911222, "mean_inference_ms": 0.7664503671846737, "mean_action_processing_ms": 0.11783169469765703, "mean_env_wait_ms": 2.4186020344139414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007818771314017381, "StateBufferConnector_ms": 0.0007641466358039952, "ViewRequirementAgentConnector_ms": 0.01928904388524309}, "num_episodes": 16, "episode_return_max": 694698.0148377807, "episode_return_min": -138571.85737396954, "episode_return_mean": 195608.40838764483, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.65406992451216, "num_env_steps_trained_throughput_per_sec": 271.65406992451216, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15002.34, "restore_workers_time_ms": 0.023, "training_step_time_ms": 15002.272, "sample_time_ms": 14410.993, "learn_time_ms": 577.537, "learn_throughput": 6925.961, "synch_weights_time_ms": 6.648}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "ae48a_00000", "date": "2025-10-28_12-09-29", "timestamp": 1761671369, "time_this_iter_s": 14.728124141693115, "time_total_s": 75.02896571159363, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55b6a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.02896571159363, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.84761904761905, "ram_util_percent": 84.26190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6224743127822876, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.884383845329285, "policy_loss": -0.021555253060068936, "vf_loss": 9.960051065683365, "vf_explained_var": 1.734122633934021e-06, "kl": 0.01585421806800016, "entropy": 5.728280821442604, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 694698.0148377807, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 200433.40545466973, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 23940, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -33765.77827403296, "policy_mm": -40488.17783666516, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 184183.51785542996, "policy_mm": 222455.89947899498, "policy_rl": 232894.76650947588}, "policy_reward_mean": {"policy_mom": 47203.97456759068, "policy_mean": 49458.88890036438, "policy_mm": 52342.00176547253, "policy_rl": 51428.54022124214}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47203.97265625, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 49458.8828125, "('mean_0', 'policy_mean')_total_reward_min": -33765.77734375, "('mean_0', 'policy_mean')_total_reward_max": 184183.515625, "('mm_0', 'policy_mm')_total_reward_mean": 52342.00390625, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51428.53515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 232894.765625}, "hist_stats": {"episode_reward": [154176.11181225485, 378397.48040392896, 248246.93695014145, 387470.86476860906, 169857.31121472825, 40459.82904463401, 119089.08663825858, 103070.81031411362, 330508.2193632295, 123615.44195996509, 329081.22239774617, 611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.98360856691, 94044.22290545708, 58677.50652661101, 104637.72887897163, 29805.25264021866, -3736.718353068334, 26256.399697711815, 24473.96155831227, 83009.92054693119, 21834.14966039074, 88262.57538370996, 168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504], "policy_policy_mean_reward": [49059.57950281323, 132025.92735116, 48235.952764249945, 99688.27244658928, 46162.177859420204, 1492.3251524464783, 33715.1073207204, 16982.98513150082, 86836.4791008781, 24290.95818578559, 59403.68067655601, 124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901], "policy_policy_mm_reward": [28257.05663343277, 72210.88331358897, 90273.77223690701, 98676.58128142486, 22424.134683237746, 12982.87957998577, 30318.4732085988, 23588.989073156063, 73912.54095264395, 43081.31769224711, 102072.61171103946, 158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722], "policy_policy_rl_reward": [31836.492067442217, 80116.44683372322, 51059.70542237324, 84468.28216162344, 71465.74603185192, 29721.34266527, 28799.10641122745, 38024.87455114453, 86749.27876277652, 34409.0164215417, 79342.35462644052, 160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24958399113864926, "mean_inference_ms": 0.7670635342996381, "mean_action_processing_ms": 0.118053471648991, "mean_env_wait_ms": 2.4204390694800884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007872832448858963, "StateBufferConnector_ms": 0.0007775582765278063, "ViewRequirementAgentConnector_ms": 0.019583137411820262}, "num_episodes": 16, "episode_return_max": 694698.0148377807, "episode_return_min": -138571.85737396954, "episode_return_mean": 200433.40545466973, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.92707565636965, "num_env_steps_trained_throughput_per_sec": 256.92707565636965, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15096.721, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15096.655, "sample_time_ms": 14503.815, "learn_time_ms": 579.211, "learn_throughput": 6905.941, "synch_weights_time_ms": 6.827}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "ae48a_00000", "date": "2025-10-28_12-09-45", "timestamp": 1761671385, "time_this_iter_s": 15.572481632232666, "time_total_s": 90.6014473438263, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a660>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.6014473438263, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.604347826086954, "ram_util_percent": 84.12608695652175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6502626538276672, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.883357229828835, "policy_loss": -0.023434230076964012, "vf_loss": 9.960822683572768, "vf_explained_var": -2.3461878299713133e-06, "kl": 0.014927083574866662, "entropy": 5.701662839949131, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 201414.1454198971, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -33765.77827403296, "policy_mm": -40488.17783666516, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 237257.73075310726, "policy_mm": 222455.89947899498, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 47895.18984030936, "policy_mean": 49754.85026538555, "policy_mm": 51671.71577018156, "policy_rl": 52092.3895440206}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47895.19140625, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 49754.85546875, "('mean_0', 'policy_mean')_total_reward_min": -33765.77734375, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 51671.71484375, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 52092.390625, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [611935.9376234342, 242364.48826259936, 263616.3050206723, 396811.8536672817, 143262.44656739075, -102720.08528414974, -31909.793079709114, 218008.01747929654, 595909.6525509243, 7885.06707469428, 359698.43363604986, 251758.70633059918, 126498.69350258714, 231145.22036519038, -22072.2830832281, -57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [168136.35775001842, 52623.99239065159, 80972.36849902522, 84149.59693793238, 46959.211589649145, -31166.657423583994, -9028.613260752927, 62289.69698092894, 119386.33476152754, -13967.933352627128, 101256.44841692456, 50317.45158086096, 27592.731135207265, 68126.9729389045, 5910.382917343586, -23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703], "policy_policy_mean_reward": [124185.30264145658, 50157.79479546901, 60483.240580858714, 166171.03559092886, 46777.62818266239, -18489.459366962197, -2776.165988037209, 34729.055666532295, 129306.6675973251, -1449.5931592233164, 82285.67929859906, 68910.9186025401, 35968.345586430005, 40472.13998280784, -20242.281141224557, -15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292], "policy_policy_mm_reward": [158705.93235889875, 55334.14272750818, 60111.49966432419, 90682.76845618304, 30706.65374137639, -18267.29266079102, -13533.175494292635, 79096.8780459096, 198503.66176476917, 9680.992711688079, 64132.73057543559, 61538.62747397317, 9517.87440287943, 77465.42558762214, 789.3757112278829, -27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308], "policy_policy_rl_reward": [160908.3448730611, 84248.55834897065, 62049.19627646441, 55808.452682236806, 18818.953053702782, -34796.67583281266, -6571.838336626373, 41892.38678592554, 148712.98842730245, 13621.6008748567, 112023.57534509049, 70991.70867322489, 53419.74237807043, 45080.68185585584, -8529.760570574905, 8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2505924881168009, "mean_inference_ms": 0.7687784488294388, "mean_action_processing_ms": 0.11855839455384247, "mean_env_wait_ms": 2.4262417869085016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007917284965515137, "StateBufferConnector_ms": 0.0007834434509277344, "ViewRequirementAgentConnector_ms": 0.019706010818481445}, "num_episodes": 16, "episode_return_max": 813953.3802918543, "episode_return_min": -138571.85737396954, "episode_return_mean": 201414.1454198971, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.9095062334803, "num_env_steps_trained_throughput_per_sec": 264.9095062334803, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 15097.119, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15097.045, "sample_time_ms": 14511.871, "learn_time_ms": 571.962, "learn_throughput": 6993.476, "synch_weights_time_ms": 6.445}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "ae48a_00000", "date": "2025-10-28_12-10-00", "timestamp": 1761671400, "time_this_iter_s": 15.106685876846313, "time_total_s": 105.70813322067261, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d559b20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.70813322067261, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.795238095238098, "ram_util_percent": 84.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6733428835868835, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.886994823813438, "policy_loss": -0.019371610971575137, "vf_loss": 9.960266664624214, "vf_explained_var": -7.918104529380799e-07, "kl": 0.014942057320843135, "entropy": 5.6888670980930325, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 194167.6838330798, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -33765.77827403296, "policy_mm": -40488.17783666516, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 214617.9669697911, "policy_mean": 237257.73075310726, "policy_mm": 222455.89947899498, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 45207.504562812515, "policy_mean": 48191.469910582724, "policy_mm": 49641.01580524929, "policy_rl": 51127.69355443519}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45207.50390625, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 214617.96875, "('mean_0', 'policy_mean')_total_reward_mean": 48191.4765625, "('mean_0', 'policy_mean')_total_reward_min": -33765.77734375, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 49641.015625, "('mm_0', 'policy_mm')_total_reward_min": -40488.1796875, "('mm_0', 'policy_mm')_total_reward_max": 222455.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51127.69921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [-57451.05398413662, 301461.96051993815, 694698.0148377807, 246126.05256609272, 102522.95155184226, 626577.8643381791, -19006.93403716021, -100316.45448761858, 240857.43011373782, -23473.539210041294, 135550.31545264734, 462065.7855052336, 646781.8286294163, 91405.39628775323, 12417.740603885255, 310507.40787523205, 35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-23132.230745325203, 44920.077260973354, 209801.1209792135, 57773.06725649819, 35561.00618061602, 156436.0869824212, -13785.830769115244, -14225.397508293969, 67844.4125144704, -6216.675534781497, 11498.296617104772, 72400.49730492661, 214617.9669697911, -3123.8881350409774, -16948.464369428457, 50461.88566019175, -1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851], "policy_policy_mean_reward": [-15123.452204399606, 91775.20000988596, 184183.51785542996, 46916.360353340104, 25933.574807081535, 108402.83745915322, -17441.436273257565, -11649.13097508785, 37652.47369025464, -3512.662656792885, 24167.938257218862, 149922.66357852813, 172931.36342115025, 42942.83729036691, 13827.935577963299, 79681.1434622593, 1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301], "policy_policy_mm_reward": [-27672.216024082813, 65589.16676828642, 151119.39031195384, 55901.24184598351, 33285.06167791396, 222455.89947899498, 12510.32613521138, -40488.17783666516, 70053.89072871003, 662.8803171368736, 59122.77970634848, 131198.8157423833, 144165.7773748463, 26894.509117096062, 18992.393337776073, 75198.0246716622, 22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295], "policy_policy_rl_reward": [8476.844989671059, 99177.5164807923, 149593.98569118325, 85535.38311027075, 7743.308886230808, 139283.0404176098, -289.99312999874337, -33953.748167571604, 65306.65318030325, -14407.081335603862, 40761.30087197506, 108543.80887939552, 115066.72086362871, 24691.938015331245, -3454.1239424256596, 105166.35408111833, 13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509962762454877, "mean_inference_ms": 0.7692564017769103, "mean_action_processing_ms": 0.11884993360754516, "mean_env_wait_ms": 2.4279233752986262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007922053337097168, "StateBufferConnector_ms": 0.000781714916229248, "ViewRequirementAgentConnector_ms": 0.01960575580596924}, "num_episodes": 15, "episode_return_max": 813953.3802918543, "episode_return_min": -138571.85737396954, "episode_return_mean": 194167.6838330798, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.0173022589389, "num_env_steps_trained_throughput_per_sec": 273.0173022589389, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 15041.366, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15041.289, "sample_time_ms": 14457.701, "learn_time_ms": 570.242, "learn_throughput": 7014.564, "synch_weights_time_ms": 6.512}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "ae48a_00000", "date": "2025-10-28_12-10-15", "timestamp": 1761671415, "time_this_iter_s": 14.658066749572754, "time_total_s": 120.36619997024536, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5462a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.36619997024536, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.033333333333335, "ram_util_percent": 83.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6867687702178955, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.879662814736367, "policy_loss": -0.027228179093799553, "vf_loss": 9.959820142388343, "vf_explained_var": 2.602115273475647e-07, "kl": 0.019580714877042778, "entropy": 5.684527388215065, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 177535.9749643723, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -34333.945412047244, "policy_mm": -32476.83290037162, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 177968.2902714537, "policy_mean": 237257.73075310726, "policy_mm": 180722.94552585788, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 41816.51525692835, "policy_mean": 43247.1681756903, "policy_mm": 45313.36711303899, "policy_rl": 47158.92441871466}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 41816.515625, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 177968.296875, "('mean_0', 'policy_mean')_total_reward_mean": 43247.171875, "('mean_0', 'policy_mean')_total_reward_min": -34333.9453125, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 45313.36328125, "('mm_0', 'policy_mm')_total_reward_min": -32476.83203125, "('mm_0', 'policy_mm')_total_reward_max": 180722.953125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 47158.9296875, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [35595.48711151347, 194638.59797075333, 362027.6375805066, 8148.796817131076, 203029.34873502172, 118716.02435423649, 169052.22498343798, -47077.78484593908, 247268.8902420316, 151852.15664216597, -57382.68031308305, -45823.82194592428, 281539.4810200024, 257886.2561554408, 48662.3814867356, 19227.072315931466, -138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-1586.5580779411098, 44817.45372384204, 67273.10489169047, 5030.429091656759, 33221.00777125335, 45510.14475367739, 38960.10773325531, -3120.431095256207, 74376.29023679793, 12736.340258256801, -15661.676511592674, -23695.786038817678, 109879.34596717023, 60748.61854855313, 5282.703476450482, -2148.664810287594, -33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337], "policy_policy_mean_reward": [1339.9305360030312, 29516.837195363103, 89205.01484649022, -4119.885147718331, 43741.8219806333, 17965.799685072598, 31453.140606428886, -4347.431771623848, 32031.197443940935, 27005.945142394372, -8504.45295523602, -4801.64781324989, 58615.97356217281, 62212.32845000571, 8058.23256864581, 37692.229508646, -33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672], "policy_policy_mm_reward": [22107.63591872363, 73084.19111820488, 111299.64938405939, 12554.775214495012, 61556.355446477035, 23329.118360522025, 43082.74926333735, -17223.797792115187, 74272.3187977558, 84103.55735604967, -14623.752134273951, -4735.244140161713, 60245.4878703127, 51692.932622110115, -1461.6448169152275, -20997.84409107977, -29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378], "policy_policy_rl_reward": [13734.478734727885, 47220.11593334372, 94249.86845826596, -5316.522341302422, 64510.16353665796, 31910.96155496455, 55556.227380416545, -22386.124186943838, 66589.08376353649, 28006.313885465213, -18592.798711980402, -12591.143953695018, 52798.6736203465, 83232.37653477189, 36783.09025855438, 4681.351708652841, -41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25088575993458967, "mean_inference_ms": 0.7683637758961283, "mean_action_processing_ms": 0.11887225019778246, "mean_env_wait_ms": 2.426889515533551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007922053337097168, "StateBufferConnector_ms": 0.0007836222648620605, "ViewRequirementAgentConnector_ms": 0.019625067710876465}, "num_episodes": 16, "episode_return_max": 813953.3802918543, "episode_return_min": -138571.85737396954, "episode_return_mean": 177535.9749643723, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.05776796693027, "num_env_steps_trained_throughput_per_sec": 266.05776796693027, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 15040.585, "restore_workers_time_ms": 0.028, "training_step_time_ms": 15040.506, "sample_time_ms": 14465.213, "learn_time_ms": 562.652, "learn_throughput": 7109.189, "synch_weights_time_ms": 6.029}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "ae48a_00000", "date": "2025-10-28_12-10-30", "timestamp": 1761671430, "time_this_iter_s": 15.037380695343018, "time_total_s": 135.40358066558838, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f53a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.40358066558838, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.29047619047619, "ram_util_percent": 83.73809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.739388644695282, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.87943625152111, "policy_loss": -0.025090714808902702, "vf_loss": 9.958106809854508, "vf_explained_var": 1.8611550331115724e-06, "kl": 0.017047561310744225, "entropy": 5.698937983810902, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -138571.85737396954, "episode_reward_mean": 190159.94280088838, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -44160.53018847734, "policy_mean": -34333.945412047244, "policy_mm": -32476.83290037162, "policy_rl": -41841.13551068387}, "policy_reward_max": {"policy_mom": 177968.2902714537, "policy_mean": 237257.73075310726, "policy_mm": 191870.9924852221, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 44531.870168925074, "policy_mean": 47218.056569159664, "policy_mm": 48269.402227202925, "policy_rl": 50140.61383560074}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44531.87109375, "('mom_0', 'policy_mom')_total_reward_min": -44160.53125, "('mom_0', 'policy_mom')_total_reward_max": 177968.296875, "('mean_0', 'policy_mean')_total_reward_mean": 47218.05859375, "('mean_0', 'policy_mean')_total_reward_min": -34333.9453125, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 48269.40625, "('mm_0', 'policy_mm')_total_reward_min": -32476.83203125, "('mm_0', 'policy_mm')_total_reward_max": 191871.0, "('rl_trader_0', 'policy_rl')_total_reward_mean": 50140.609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -41841.13671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [-138571.85737396954, 27431.73494181634, -130795.3326595931, -22965.27684420399, 187167.45384685727, 302005.5229680922, -51520.460211799014, -132613.720540483, 395393.8579776003, 44424.680251324775, 557331.3528698456, 424044.8304349238, 292033.02846041584, 349732.87956243526, 511615.62775296264, 200789.59005903793, 267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-33353.422978554554, 13947.060681107449, -35822.45182431763, -18457.68553550651, 45373.48620180675, 48134.277705707194, -20763.420048467946, -44160.53018847734, 112487.48542290869, 11665.716979713832, 125267.87211753795, 118485.03817932213, 91314.26210573988, 77971.18246361148, 146615.23175768505, 58495.674401974386, 59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184], "policy_policy_mean_reward": [-33765.77827403296, 1111.0744606288156, -33748.92832756597, -10759.423652381234, 46892.06877788658, 71831.86707773563, -9905.645848936523, -22483.997040923965, 85921.18325512424, 5126.197840955844, 162615.99245245848, 130931.85315386177, 66450.4484514823, 61095.96802965758, 141790.96358001273, 47576.80776398251, 49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214], "policy_policy_mm_reward": [-29611.520610697884, 9209.526267219719, -30644.39155976711, -3260.417025857866, 28746.751374433778, 105141.38111524054, 1194.746242626132, -32476.83290037162, 96000.83456357919, 21399.141973196347, 117818.76967444971, 104145.69239402835, 45740.79289427574, 103621.35639397928, 146704.24653163366, 28925.335148668935, 87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878], "policy_policy_rl_reward": [-41841.13551068387, 3164.0735328603237, -30579.56094794255, 9512.249369541572, 66155.14749273018, 76897.99706940906, -22046.140557020535, -33492.36041071001, 100984.35473598856, 6233.623457459031, 151628.71862539914, 70482.24670771149, 88527.52500891764, 107044.3726751867, 76505.18588363129, 65791.77274441182, 70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2507150819362671, "mean_inference_ms": 0.7674077502093241, "mean_action_processing_ms": 0.11883997499381728, "mean_env_wait_ms": 2.425439505646521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007888674736022949, "StateBufferConnector_ms": 0.0007898807525634766, "ViewRequirementAgentConnector_ms": 0.01951289176940918}, "num_episodes": 16, "episode_return_max": 813953.3802918543, "episode_return_min": -138571.85737396954, "episode_return_mean": 190159.94280088838, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.3189617773151, "num_env_steps_trained_throughput_per_sec": 273.3189617773151, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 15000.019, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14999.943, "sample_time_ms": 14430.145, "learn_time_ms": 557.48, "learn_throughput": 7175.151, "synch_weights_time_ms": 5.83}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "ae48a_00000", "date": "2025-10-28_12-10-45", "timestamp": 1761671445, "time_this_iter_s": 14.63823390007019, "time_total_s": 150.04181456565857, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6660>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.04181456565857, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.604761904761904, "ram_util_percent": 83.9857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.74969881772995, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.882247021794319, "policy_loss": -0.024330052541336043, "vf_loss": 9.960548734664917, "vf_explained_var": -7.312744855880738e-07, "kl": 0.015610698611260479, "entropy": 5.709379509091377, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -128811.9142065905, "episode_reward_mean": 195632.23965147467, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38426.794374540725, "policy_mean": -34333.945412047244, "policy_mm": -32427.132712777977, "policy_rl": -36543.25702327039}, "policy_reward_max": {"policy_mom": 177968.2902714537, "policy_mean": 237257.73075310726, "policy_mm": 191941.13421744193, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 46325.685122261086, "policy_mean": 47857.824129942426, "policy_mm": 48995.052899204005, "policy_rl": 52453.677500067155}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46325.68359375, "('mom_0', 'policy_mom')_total_reward_min": -38426.79296875, "('mom_0', 'policy_mom')_total_reward_max": 177968.296875, "('mean_0', 'policy_mean')_total_reward_mean": 47857.82421875, "('mean_0', 'policy_mean')_total_reward_min": -34333.9453125, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 48995.0546875, "('mm_0', 'policy_mm')_total_reward_min": -32427.1328125, "('mm_0', 'policy_mm')_total_reward_max": 191941.140625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 52453.67578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -36543.2578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [267542.4642463502, 9492.993065412382, 261276.41999148, 675229.6574969314, 129768.00595451538, 216768.34268974522, 214412.48015729652, 352961.96629895107, 205546.5745826538, 229073.10156649374, 105072.73858534984, 182707.3962924256, 313453.9782781362, 286940.89231476485, 322386.4328106637, 177080.076770699, 246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [59382.8723849111, 16794.230062333678, 65723.47733342176, 160053.29927879837, 42590.33305965669, 38352.54659659243, 80524.57865626065, 62961.498163994554, 37423.15096336538, 37656.932753908564, 35086.00015591226, 31881.122573086475, 79435.67031315099, 78777.14126973457, 58918.00112280628, 36283.92689025022, 62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698], "policy_policy_mean_reward": [49926.67911569937, -3832.7621425353277, 64166.61801923124, 166098.5995896903, 26093.79314066578, 60598.61631378153, 44831.05117053448, 99938.35967717558, 61170.160942036986, 53732.83819487379, 28626.414088126938, 55370.58044155788, 64248.39052721494, 66598.6559359642, 106592.69719234186, 43196.37167632714, 65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978], "policy_policy_mm_reward": [87907.41022004683, -9866.5278141637, 48356.74423696888, 116182.99211896729, 23047.84058869486, 67704.67177942612, 44838.58002592628, 139802.96423480805, 49069.18710965305, 68188.54716279542, 26440.588833255766, 54613.52799452127, 64750.06731204351, 85166.22187765173, 96264.02607470374, 22086.8327756736, 63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151], "policy_policy_rl_reward": [70325.50252569262, 6398.052959777688, 83029.58040185798, 232894.76650947588, 38036.03916549753, 50112.50799994496, 44218.270304575315, 50259.144222973155, 57884.07556759839, 69494.78345491605, 14919.735508055255, 40842.16528326029, 105019.85012572713, 56398.87323141447, 60611.70842081167, 75512.94542844802, 55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508349838513154, "mean_inference_ms": 0.7674792070511125, "mean_action_processing_ms": 0.11890913894538034, "mean_env_wait_ms": 2.42606055123752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007976889610290527, "StateBufferConnector_ms": 0.0007928013801574707, "ViewRequirementAgentConnector_ms": 0.019627749919891357}, "num_episodes": 16, "episode_return_max": 813953.3802918543, "episode_return_min": -128811.9142065905, "episode_return_mean": 195632.23965147467, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.9062586859631, "num_env_steps_trained_throughput_per_sec": 261.9062586859631, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 15040.815, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15040.742, "sample_time_ms": 14476.006, "learn_time_ms": 552.684, "learn_throughput": 7237.406, "synch_weights_time_ms": 5.176}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "ae48a_00000", "date": "2025-10-28_12-11-00", "timestamp": 1761671460, "time_this_iter_s": 15.277792930603027, "time_total_s": 165.3196074962616, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55b9c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.3196074962616, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.89545454545454, "ram_util_percent": 84.0590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7629931569099426, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.88468283712864, "policy_loss": -0.022875645619933493, "vf_loss": 9.960951840877533, "vf_explained_var": 2.6421621441841125e-06, "kl": 0.016370866952479503, "entropy": 5.6667565405368805, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 813953.3802918543, "episode_reward_min": -128811.9142065905, "episode_reward_mean": 198832.80361710876, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38426.794374540725, "policy_mean": -34333.945412047244, "policy_mm": -32427.132712777977, "policy_rl": -36543.25702327039}, "policy_reward_max": {"policy_mom": 194848.59185535114, "policy_mean": 237257.73075310726, "policy_mm": 191941.13421744193, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 47015.70971305356, "policy_mean": 48288.80591261494, "policy_mm": 49090.99695390876, "policy_rl": 54437.291037531526}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47015.71484375, "('mom_0', 'policy_mom')_total_reward_min": -38426.79296875, "('mom_0', 'policy_mom')_total_reward_max": 194848.59375, "('mean_0', 'policy_mean')_total_reward_mean": 48288.80859375, "('mean_0', 'policy_mean')_total_reward_min": -34333.9453125, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 49091.0, "('mm_0', 'policy_mm')_total_reward_min": -32427.1328125, "('mm_0', 'policy_mm')_total_reward_max": 191941.140625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 54437.296875, "('rl_trader_0', 'policy_rl')_total_reward_min": -36543.2578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [246124.26863246123, 26442.66420989686, 247808.56316842095, 239182.937797147, 222146.84141457913, 644666.1460963358, 147538.40606722803, -55822.60374417187, 20558.309201803928, 286889.47285610356, 93789.52932226329, 36529.090540515, 1718.8682459484803, 607938.1226024225, 201566.707961055, 63148.67700639954, -29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [62000.8954066083, 7287.883821687443, 51348.210290511175, 38718.5686743642, 24626.781209215504, 177968.2902714537, 22866.896817780125, -10069.832769797622, -6235.339015143046, 113670.57416479832, 21795.356789999038, 18959.3671467057, 2604.022911945868, 134869.30685862032, 36754.92183444612, 46066.52288052587, -5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567], "policy_policy_mean_reward": [65208.9560904911, -4513.301587060954, 78501.7294652343, 58568.44346766454, 60730.95066230901, 194611.81343062842, 49428.897261726546, -4843.46097786902, 9707.284334431064, 33655.735774345274, 14115.33475897019, -2414.7401380781007, -2927.2201954416028, 189656.15644200027, 52758.24432777886, -5130.305216367565, -5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806], "policy_policy_mm_reward": [63514.88921817136, 4128.968601439388, 66037.16685849182, 67300.34413120979, 54758.12473893722, 110424.80171992636, 35687.45234460713, -17350.590717451843, 5465.279254849955, 74174.42842172689, -5665.373563013104, 13092.279829993104, 6870.914287421883, 178619.24810284126, 59538.9160888942, 2812.8587085411405, -16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341], "policy_policy_rl_reward": [55399.52791719061, 19539.113373831024, 51921.45655418425, 74595.58152390862, 82030.98480411731, 161661.24067432675, 39555.1596431139, -23558.71927905341, 11621.084627665947, 65388.73449523322, 63544.21133630738, 6892.183701894213, -4828.848757977731, 104793.41119896104, 52514.625709935804, 19399.600633700007, -2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508671416641356, "mean_inference_ms": 0.7673243004632514, "mean_action_processing_ms": 0.11892375478118425, "mean_env_wait_ms": 2.425749345279126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007963776588439941, "StateBufferConnector_ms": 0.0007938146591186523, "ViewRequirementAgentConnector_ms": 0.019657611846923828}, "num_episodes": 16, "episode_return_max": 813953.3802918543, "episode_return_min": -128811.9142065905, "episode_return_mean": 198832.80361710876, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.19907678967473, "num_env_steps_trained_throughput_per_sec": 265.19907678967473, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 15019.981, "restore_workers_time_ms": 0.027, "training_step_time_ms": 15019.906, "sample_time_ms": 14463.383, "learn_time_ms": 544.922, "learn_throughput": 7340.505, "synch_weights_time_ms": 4.61}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "ae48a_00000", "date": "2025-10-28_12-11-15", "timestamp": 1761671475, "time_this_iter_s": 15.086724758148193, "time_total_s": 180.4063322544098, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55af20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 180.4063322544098, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.638095238095236, "ram_util_percent": 83.6142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7958404421806335, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.884168589115143, "policy_loss": -0.02004048346861964, "vf_loss": 9.955885019898414, "vf_explained_var": 1.989118754863739e-06, "kl": 0.016507953168866198, "entropy": 5.497752951085568, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -128811.9142065905, "episode_reward_mean": 207484.3026132902, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38426.794374540725, "policy_mean": -34333.945412047244, "policy_mm": -32427.132712777977, "policy_rl": -36543.25702327039}, "policy_reward_max": {"policy_mom": 203803.1166316179, "policy_mean": 237257.73075310726, "policy_mm": 192907.57735002012, "policy_rl": 244056.90765823002}, "policy_reward_mean": {"policy_mom": 48987.454501183674, "policy_mean": 49395.244606321285, "policy_mm": 51750.490201864755, "policy_rl": 57351.11330392049}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48987.44921875, "('mom_0', 'policy_mom')_total_reward_min": -38426.79296875, "('mom_0', 'policy_mom')_total_reward_max": 203803.109375, "('mean_0', 'policy_mean')_total_reward_mean": 49395.25, "('mean_0', 'policy_mean')_total_reward_min": -34333.9453125, "('mean_0', 'policy_mean')_total_reward_max": 237257.734375, "('mm_0', 'policy_mm')_total_reward_mean": 51750.484375, "('mm_0', 'policy_mm')_total_reward_min": -32427.1328125, "('mm_0', 'policy_mm')_total_reward_max": 192907.578125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57351.109375, "('rl_trader_0', 'policy_rl')_total_reward_min": -36543.2578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 244056.90625}, "hist_stats": {"episode_reward": [-29907.674259246927, 443886.1105220563, 239121.15317166448, 813953.3802918543, -31359.35721853762, 232068.77239462727, 398738.36846412404, 105762.90482156971, 68304.72625753457, -114891.09087122443, 299003.7629449724, 206123.6453285364, 566853.301679671, 124047.31698265517, 247084.95669434455, -34511.52609612361, 275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-5100.79996990602, 119283.6583107888, 69264.89813745308, 151915.79635465788, -17184.257560693703, 56496.16927736639, 70704.03778903016, 11031.4398583007, 7672.019406062385, -38426.794374540725, 71781.75346764039, 43183.31322014574, 125062.9813155283, 32374.25508892525, 59231.62310319273, -5837.072125847289, 58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608], "policy_policy_mean_reward": [-5327.01442950543, 103623.25528006133, 28189.405685553345, 237257.73075310726, -17577.09059528292, 52128.07871459545, 90864.21378339584, 37324.64595489521, 10992.748625823626, -22505.783551082393, 53129.59182220686, 27042.615008287623, 120748.2954854799, 36314.68253251361, 78359.9742262572, -26134.143316761758, 81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103], "policy_policy_mm_reward": [-16595.94421973126, 105366.76087030205, 55350.92655594918, 180722.94552585788, 3965.746453812308, 51808.981915483906, 65299.6110744871, 20330.928635533124, 38373.48040384974, -30680.235116851254, 116510.56107196448, 64610.77486139775, 173245.86752912882, 27075.838965914325, 57571.21121727219, -3090.1111767806938, 41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558], "policy_policy_rl_reward": [-2883.9156401042605, 115612.43606090447, 86315.92279270863, 244056.90765823002, -563.7555163732999, 71635.54248718121, 171870.50581721184, 37075.890372840775, 11266.477821798768, -23278.27782874989, 57581.856583160414, 71286.94223870465, 147796.15734953384, 28282.540395301865, 51922.148147622596, 549.8005232660206, 94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506833368504011, "mean_inference_ms": 0.766667075835955, "mean_action_processing_ms": 0.11886513783368724, "mean_env_wait_ms": 2.424347769140803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007784366607666016, "StateBufferConnector_ms": 0.0007720589637756348, "ViewRequirementAgentConnector_ms": 0.01925724744796753}, "num_episodes": 16, "episode_return_max": 859294.4390075249, "episode_return_min": -128811.9142065905, "episode_return_mean": 207484.3026132902, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.02213899445957, "num_env_steps_trained_throughput_per_sec": 271.02213899445957, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14959.919, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14959.842, "sample_time_ms": 14415.535, "learn_time_ms": 531.803, "learn_throughput": 7521.576, "synch_weights_time_ms": 5.422}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "ae48a_00000", "date": "2025-10-28_12-11-30", "timestamp": 1761671490, "time_this_iter_s": 14.762211799621582, "time_total_s": 195.16854405403137, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a160>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.16854405403137, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.447619047619046, "ram_util_percent": 83.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7805358171463013, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.88186417222023, "policy_loss": -0.024028794842888602, "vf_loss": 9.95782329440117, "vf_explained_var": -4.6640634536743165e-07, "kl": 0.01913048242666951, "entropy": 5.575641384720802, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -128811.9142065905, "episode_reward_mean": 208331.72250305035, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35809.60889214184, "policy_mean": -36390.81449029251, "policy_mm": -32427.132712777977, "policy_rl": -36543.25702327039}, "policy_reward_max": {"policy_mom": 203803.1166316179, "policy_mean": 225507.8507625443, "policy_mm": 218701.05672780724, "policy_rl": 237075.89426334266}, "policy_reward_mean": {"policy_mom": 49350.491389134266, "policy_mean": 50157.87173696185, "policy_mm": 52458.04484058207, "policy_rl": 56365.31453637216}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49350.49609375, "('mom_0', 'policy_mom')_total_reward_min": -35809.609375, "('mom_0', 'policy_mom')_total_reward_max": 203803.109375, "('mean_0', 'policy_mean')_total_reward_mean": 50157.859375, "('mean_0', 'policy_mean')_total_reward_min": -36390.81640625, "('mean_0', 'policy_mean')_total_reward_max": 225507.84375, "('mm_0', 'policy_mm')_total_reward_mean": 52458.05078125, "('mm_0', 'policy_mm')_total_reward_min": -32427.1328125, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 56365.31640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -36543.2578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 237075.890625}, "hist_stats": {"episode_reward": [275719.1332770165, -86782.5118191511, 57298.59301526683, 222726.1488780778, -67653.11365718604, 253955.6608142614, 182677.28432537869, -16821.120046212316, 283446.2992258829, 127976.27308453976, 234327.26744793318, 40870.59874283121, -128811.9142065905, -51400.326900129105, 50508.518285458136, 178693.46601766683, 695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [58248.07627459659, -25254.58206582901, -5766.556695097093, 84289.150572851, -13624.973704017484, 83650.40186392948, 41029.45353703688, 8901.306872182582, 70848.57059149616, 43757.73809227818, 73519.85346062586, 5926.037898253837, -25857.060857696288, 3470.919630079535, 10301.083109038553, 39072.24703343572, 113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315], "policy_policy_mean_reward": [81200.58649738094, -21518.23696618026, 47851.33700427719, 74353.66756879301, -9207.669670270745, 58629.18959608606, 34809.858531112106, -16584.278215185113, 73775.93902161052, 21302.779216761264, 46386.79589499899, 10112.896184942416, -33984.4636128456, -34333.945412047244, -5734.5521734133, 36374.58585767783, 194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251], "policy_policy_mm_reward": [41677.03114818237, -7464.851741496497, 4784.029355791103, 41342.980429608295, -21909.568445193167, 75322.24154871875, 42117.869660998454, -15078.200356162106, 89101.51177585834, 33273.290517705624, 66349.42844587607, -1012.2483658164673, -32427.132712777977, -21385.26443352877, 13028.14518788527, 70152.99610679215, 180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107], "policy_policy_rl_reward": [94593.43935685667, -32544.84104564534, 10429.783350295682, 22740.350306825505, -22910.901837704714, 36353.82780552709, 64720.10259623122, 5940.051652952334, 49720.277836918336, 29642.465257794807, 48071.189646432016, 25843.913025451457, -36543.25702327039, 847.963315367476, 32913.84216194747, 33093.637019761125, 207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2505870174486684, "mean_inference_ms": 0.7663742005053529, "mean_action_processing_ms": 0.1188507335966247, "mean_env_wait_ms": 2.423674881476319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007760524749755859, "StateBufferConnector_ms": 0.0007728934288024902, "ViewRequirementAgentConnector_ms": 0.01927727460861206}, "num_episodes": 16, "episode_return_max": 859294.4390075249, "episode_return_min": -128811.9142065905, "episode_return_mean": 208331.72250305035, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.60771478732096, "num_env_steps_trained_throughput_per_sec": 263.60771478732096, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15000.18, "restore_workers_time_ms": 0.03, "training_step_time_ms": 15000.098, "sample_time_ms": 14445.902, "learn_time_ms": 540.37, "learn_throughput": 7402.335, "synch_weights_time_ms": 6.665}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "ae48a_00000", "date": "2025-10-28_12-11-45", "timestamp": 1761671505, "time_this_iter_s": 15.18493103981018, "time_total_s": 210.35347509384155, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f5440>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.35347509384155, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.831818181818186, "ram_util_percent": 83.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8485774993896484, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.88255354464054, "policy_loss": -0.02536300714418758, "vf_loss": 9.96063529253006, "vf_explained_var": -8.60895961523056e-06, "kl": 0.01860346849525745, "entropy": 5.643939140439033, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -127524.4552097218, "episode_reward_mean": 232388.4445908631, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35809.60889214184, "policy_mean": -36390.81449029251, "policy_mm": -39300.038919409955, "policy_rl": -31268.595523738837}, "policy_reward_max": {"policy_mom": 214468.7401870328, "policy_mean": 225507.8507625443, "policy_mm": 218701.05672780724, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 54376.098610111774, "policy_mean": 55398.52848496683, "policy_mm": 58031.015510993675, "policy_rl": 64582.80198479081}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54376.1015625, "('mom_0', 'policy_mom')_total_reward_min": -35809.609375, "('mom_0', 'policy_mom')_total_reward_max": 214468.734375, "('mean_0', 'policy_mean')_total_reward_mean": 55398.5234375, "('mean_0', 'policy_mean')_total_reward_min": -36390.81640625, "('mean_0', 'policy_mean')_total_reward_max": 225507.84375, "('mm_0', 'policy_mm')_total_reward_mean": 58031.015625, "('mm_0', 'policy_mm')_total_reward_min": -39300.0390625, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64582.80859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31268.595703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [695607.881560933, -55913.330257128415, -63652.12492829475, 343742.56018269726, 303047.0101463889, -23842.15101733077, 605186.6435362706, 625700.6347870739, 165890.7108210076, 34916.76833619032, 564714.8780870752, 118347.17202385406, -48213.10845712064, 141660.49772488922, 327926.72751882544, -24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [113763.89876689906, -20899.498844511443, -18080.710665818697, 89003.73329259337, 57252.70834715197, 4827.549529009383, 169875.24036392063, 168231.99085534242, 44717.36118519103, 5886.011194031032, 109682.1013859232, 26348.52826526842, -18358.78903695451, 29919.93016049814, 79688.13954135978, -5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584], "policy_policy_mean_reward": [194474.55513975394, -6264.749291334789, -15883.677726252792, 82307.72682225672, 56304.44204471894, -15277.825007947646, 163611.1978772491, 139113.36570885516, 48937.14003152589, 11308.527594766823, 169608.12493879348, 29896.036034181463, -11878.483887154433, 20540.659032993153, 81773.29091952914, -14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145], "policy_policy_mm_reward": [180279.75148953084, -10636.836575928886, -15958.814177964512, 115007.72446653378, 125001.40133736897, -11193.67834530031, 191870.9924852221, 146685.020944829, 27781.722258149595, 3835.150675115905, 153305.63671937905, 38909.082068475764, -9876.157811850118, 21743.241369481104, 79408.54085343075, -23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493], "policy_policy_rl_reward": [207089.6761647499, -18112.2455453533, -13728.922358258635, 57423.37560131324, 64488.45841714899, -2198.1971930920704, 79829.21280987904, 171670.25727804692, 44454.487346141104, 13887.078872276588, 132119.01504298009, 23193.52565592817, -8099.677721161438, 69456.66716191685, 87056.7562045061, 18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508654116413404, "mean_inference_ms": 0.767345225364339, "mean_action_processing_ms": 0.11898687865767243, "mean_env_wait_ms": 2.4249468725067724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007865428924560547, "StateBufferConnector_ms": 0.0007771849632263184, "ViewRequirementAgentConnector_ms": 0.019416630268096924}, "num_episodes": 16, "episode_return_max": 859294.4390075249, "episode_return_min": -127524.4552097218, "episode_return_mean": 232388.4445908631, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.8757748337101, "num_env_steps_trained_throughput_per_sec": 246.8757748337101, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 15147.967, "restore_workers_time_ms": 0.03, "training_step_time_ms": 15147.884, "sample_time_ms": 14592.37, "learn_time_ms": 541.385, "learn_throughput": 7388.455, "synch_weights_time_ms": 7.017}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "ae48a_00000", "date": "2025-10-28_12-12-01", "timestamp": 1761671521, "time_this_iter_s": 16.207101345062256, "time_total_s": 226.5605764389038, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6c00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 226.5605764389038, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.08695652173913, "ram_util_percent": 84.3391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8573219180107117, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.885954037308693, "policy_loss": -0.024753406582749448, "vf_loss": 9.96398322880268, "vf_explained_var": -4.207529127597809e-06, "kl": 0.01657407404528618, "entropy": 5.659058637917042, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -127524.4552097218, "episode_reward_mean": 234213.28983720773, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35809.60889214184, "policy_mean": -36390.81449029251, "policy_mm": -39300.038919409955, "policy_rl": -31268.595523738837}, "policy_reward_max": {"policy_mom": 214468.7401870328, "policy_mean": 225507.8507625443, "policy_mm": 218701.05672780724, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 54380.98463278234, "policy_mean": 55851.45726709031, "policy_mm": 56677.08912213037, "policy_rl": 67303.75881520468}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54380.984375, "('mom_0', 'policy_mom')_total_reward_min": -35809.609375, "('mom_0', 'policy_mom')_total_reward_max": 214468.734375, "('mean_0', 'policy_mean')_total_reward_mean": 55851.4453125, "('mean_0', 'policy_mean')_total_reward_min": -36390.81640625, "('mean_0', 'policy_mean')_total_reward_max": 225507.84375, "('mm_0', 'policy_mm')_total_reward_mean": 56677.08984375, "('mm_0', 'policy_mm')_total_reward_min": -39300.0390625, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67303.7578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31268.595703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [-24950.13491984482, 273463.5700669732, -23628.755423883118, 279268.1799027313, -109731.79117153307, 336918.11292745237, 93463.90083988945, 156305.9484803605, 335552.51861087856, 556790.719765933, -30875.48236312535, 23553.91164317485, 710122.6144700296, 358206.18539065967, 44910.34614508316, 69938.60442643643, 172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-5130.548848619636, 30262.88669347999, -1127.480171909786, 56891.900546830075, -35809.60889214184, 91997.45328376479, 8177.658388919835, 32083.024495189293, 87621.24832972403, 166566.7574137675, -4378.02052579042, 842.71927958933, 162095.93203448635, 86878.44718321587, 7595.175476729685, 26785.621678111584, 30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545], "policy_policy_mean_reward": [-14212.00140937506, 82504.90829095109, 5281.583108543052, 74222.77573124669, -27579.867823972214, 75960.08042604358, 40765.32269975433, 24876.4179119324, 84289.30723988327, 115616.80086080598, -18699.978454287455, 25272.049359214652, 179160.2508283882, 79759.80482092594, -20455.02985655406, 20695.967352665164, 69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623], "policy_policy_mm_reward": [-23685.84942131198, 79298.14555919026, -17450.088060294587, 74733.96495144679, -26477.12578943878, 66666.25300068673, 14939.868197737926, 54203.98458196178, 86381.14747646281, 120140.54791487429, -4338.879118686823, -5217.712825603984, 191941.13421744193, 98725.89509015864, 39588.277558978116, 1883.553793542233, 15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866], "policy_policy_rl_reward": [18078.26475946186, 81397.62952335147, -10332.770300221742, 73419.5386732078, -19865.188665980255, 102294.32621695736, 29581.051553477257, 45142.52149127674, 77260.81556480825, 154466.61357648543, -3458.6042643605533, 2656.8558299749475, 176925.29738971448, 92842.03829635968, 18181.922965929396, 20573.461602117564, 57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512079125301536, "mean_inference_ms": 0.768494236449021, "mean_action_processing_ms": 0.11914006692451691, "mean_env_wait_ms": 2.4266615771013686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007906556129455566, "StateBufferConnector_ms": 0.0007838606834411621, "ViewRequirementAgentConnector_ms": 0.019633829593658447}, "num_episodes": 15, "episode_return_max": 859294.4390075249, "episode_return_min": -127524.4552097218, "episode_return_mean": 234213.28983720773, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.5273957137052, "num_env_steps_trained_throughput_per_sec": 265.5273957137052, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15097.541, "restore_workers_time_ms": 0.034, "training_step_time_ms": 15097.452, "sample_time_ms": 14547.643, "learn_time_ms": 535.633, "learn_throughput": 7467.799, "synch_weights_time_ms": 6.682}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "ae48a_00000", "date": "2025-10-28_12-12-16", "timestamp": 1761671536, "time_this_iter_s": 15.074319839477539, "time_total_s": 241.63489627838135, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a8e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.63489627838135, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.15909090909091, "ram_util_percent": 83.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8877949714660645, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.878114813566208, "policy_loss": -0.027158347313525157, "vf_loss": 9.957983219623566, "vf_explained_var": -2.767518162727356e-06, "kl": 0.019479289417927308, "entropy": 5.660591056942939, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -127524.4552097218, "episode_reward_mean": 234064.89950815815, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -30341.861363428176, "policy_mean": -36390.81449029251, "policy_mm": -39300.038919409955, "policy_rl": -31268.595523738837}, "policy_reward_max": {"policy_mom": 214468.7401870328, "policy_mean": 225507.8507625443, "policy_mm": 218701.05672780724, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 54979.7834188555, "policy_mean": 55574.97802688018, "policy_mm": 56273.05219303715, "policy_rl": 67237.08586938535}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54979.78515625, "('mom_0', 'policy_mom')_total_reward_min": -30341.861328125, "('mom_0', 'policy_mom')_total_reward_max": 214468.734375, "('mean_0', 'policy_mean')_total_reward_mean": 55574.98046875, "('mean_0', 'policy_mean')_total_reward_min": -36390.81640625, "('mean_0', 'policy_mean')_total_reward_max": 225507.84375, "('mm_0', 'policy_mm')_total_reward_mean": 56273.0546875, "('mm_0', 'policy_mm')_total_reward_min": -39300.0390625, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67237.078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31268.595703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [172386.83901255994, 150470.76725614458, -18497.244515933267, 22123.58500263285, 381362.2694617149, 225001.6363645973, 214048.69998129946, 293800.35565834766, 761466.1861497246, 279562.3578399106, 202704.81100489397, 608532.274410039, 125267.71397292099, 264488.9301363297, 110550.96220359858, 150483.1360245891, 280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [30424.233453730816, 47793.077165006165, -9472.115251629237, 18415.188602880633, 123154.87176769698, 62495.94926099747, 33647.78476880404, 90805.53578657775, 194848.59185535114, 52190.04280183008, 50927.46459001613, 130698.26558622289, 14793.837868722028, 80635.31970773582, 28752.880164931485, 37413.25673775194, 45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727], "policy_policy_mean_reward": [69657.07441955607, 18363.009620455305, -1980.4589796518314, -6191.497347768345, 87568.28687685978, 47407.65757073589, 53337.421456436685, 79158.45958350724, 176786.69435808086, 70915.69705837597, 40033.03776731851, 102878.0045429569, 33940.16061995914, 57808.04313962258, 26284.211963311667, 28301.304748655395, 74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846], "policy_policy_mm_reward": [15165.777019735988, 43087.68036488881, -4159.064840147769, 939.2124422732242, 65272.80480244151, 53193.229324722095, 41842.64219596497, 66934.45036943935, 154297.19300328652, 64499.64622418022, 32593.982391759127, 178706.29348642268, 39728.396415011666, 65215.67594031903, 24677.694701994606, 40872.41385300611, 94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174], "policy_policy_rl_reward": [57139.75411953723, 41227.00010579416, -2885.6054445044815, 8960.681305247339, 105366.30601471668, 61904.80020814196, 85220.85156009348, 56901.90991882336, 235533.7069330051, 91956.97175552402, 79150.3262557998, 196249.7107944368, 36805.319069228, 60829.89134865211, 30836.1753733609, 43896.16068517595, 66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25146674612650555, "mean_inference_ms": 0.7693939922727219, "mean_action_processing_ms": 0.11926254309302678, "mean_env_wait_ms": 2.427794215551354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007832050323486328, "StateBufferConnector_ms": 0.000776827335357666, "ViewRequirementAgentConnector_ms": 0.01947629451751709}, "num_episodes": 16, "episode_return_max": 859294.4390075249, "episode_return_min": -127524.4552097218, "episode_return_mean": 234064.89950815815, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.4064226101034, "num_env_steps_trained_throughput_per_sec": 269.4064226101034, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 15072.337, "restore_workers_time_ms": 0.035, "training_step_time_ms": 15072.255, "sample_time_ms": 14522.901, "learn_time_ms": 535.442, "learn_throughput": 7470.463, "synch_weights_time_ms": 6.514}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "ae48a_00000", "date": "2025-10-28_12-12-31", "timestamp": 1761671551, "time_this_iter_s": 14.851158857345581, "time_total_s": 256.48605513572693, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a660>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 256.48605513572693, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.571428571428573, "ram_util_percent": 83.6952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9415475726127625, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.876727735996246, "policy_loss": -0.022442304866854102, "vf_loss": 9.95278221666813, "vf_explained_var": -2.6796013116836546e-06, "kl": 0.017332146972626174, "entropy": 5.707860201597214, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 859294.4390075249, "episode_reward_min": -141793.68300062293, "episode_reward_mean": 225344.21350720237, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -30991.339272977093, "policy_mean": -38449.125345661705, "policy_mm": -39300.038919409955, "policy_rl": -41035.48163164594}, "policy_reward_max": {"policy_mom": 214468.7401870328, "policy_mean": 225507.8507625443, "policy_mm": 218701.05672780724, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 50901.2493512427, "policy_mean": 54685.39626252489, "policy_mm": 54525.01348710674, "policy_rl": 65232.55440632809}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50901.25, "('mom_0', 'policy_mom')_total_reward_min": -30991.33984375, "('mom_0', 'policy_mom')_total_reward_max": 214468.734375, "('mean_0', 'policy_mean')_total_reward_mean": 54685.3984375, "('mean_0', 'policy_mean')_total_reward_min": -38449.125, "('mean_0', 'policy_mean')_total_reward_max": 225507.84375, "('mm_0', 'policy_mm')_total_reward_mean": 54525.015625, "('mm_0', 'policy_mm')_total_reward_min": -39300.0390625, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 65232.5546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -41035.48046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [280562.80124731315, 285691.5789683642, -12299.014598777916, 342590.61006984883, 137316.87823228174, 149048.82966692594, 342051.34227657004, 381457.10510726494, 155373.6308547615, 859294.4390075249, 130421.6662120658, 125183.67617237078, 295685.75824438396, 370131.0667934874, -94086.18084072323, 101941.59698866174, 221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45702.18707245989, 92920.90827217927, -7244.410531437289, 77590.26710905468, 4669.359606233567, 28223.65469735245, 76326.60856761309, 114347.26571016853, 39081.49033727702, 203803.1166316179, 36803.41061281754, 27533.384462367365, 88626.40358348849, 55799.72588531237, -26375.240293819417, 35230.21651317968, 41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668], "policy_policy_mean_reward": [74153.60943782961, 92848.31255114434, -5874.805190425203, 106992.60896855965, 45484.823573869806, 44911.890229283636, 75760.6841445166, 65874.16328234582, 20350.898501344378, 225507.8507625443, 34248.099088902454, 36448.81719887048, 25665.06931018397, 96154.27780801132, -16784.957609180645, 20208.335205963747, 67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049], "policy_policy_mm_reward": [94433.83038621864, 58336.27700278602, -5532.336436015604, 42807.38446031875, 41541.30668203341, 33137.554843799706, 92669.23458538923, 75013.4558852166, 51524.194086343865, 192907.57735002012, 20172.48768318879, 34824.57947970612, 70170.40957760265, 121531.63273752054, -24588.492603278948, 35199.30814701808, 62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378], "policy_policy_rl_reward": [66273.17435080487, 41586.08114225512, 6352.537559100201, 115200.34953191587, 45621.38837014515, 42775.72989649026, 97294.81497905111, 126222.22022953388, 44417.04792979612, 237075.89426334266, 39197.668827156864, 26376.895031426855, 111223.87577310909, 96645.4303626436, -26337.490334444206, 11303.737122500197, 50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516309522374409, "mean_inference_ms": 0.7700113367442267, "mean_action_processing_ms": 0.11934927265593977, "mean_env_wait_ms": 2.428776153839225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007826089859008789, "StateBufferConnector_ms": 0.0007735490798950195, "ViewRequirementAgentConnector_ms": 0.01951014995574951}, "num_episodes": 16, "episode_return_max": 859294.4390075249, "episode_return_min": -141793.68300062293, "episode_return_mean": 225344.21350720237, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.7942793704347, "num_env_steps_trained_throughput_per_sec": 267.7942793704347, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15100.912, "restore_workers_time_ms": 0.037, "training_step_time_ms": 15100.831, "sample_time_ms": 14555.858, "learn_time_ms": 530.236, "learn_throughput": 7543.804, "synch_weights_time_ms": 7.107}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "ae48a_00000", "date": "2025-10-28_12-12-46", "timestamp": 1761671566, "time_this_iter_s": 14.940357208251953, "time_total_s": 271.4264123439789, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6d40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.4264123439789, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.204761904761902, "ram_util_percent": 83.72380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9253556132316589, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.880356234312057, "policy_loss": -0.023734400304965673, "vf_loss": 9.957933303713798, "vf_explained_var": -3.7886202335357667e-07, "kl": 0.018617890509494903, "entropy": 5.756622338294983, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 768861.5253312688, "episode_reward_min": -141793.68300062293, "episode_reward_mean": 220576.39444975674, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -34200.2750887776, "policy_mean": -38449.125345661705, "policy_mm": -41535.84804527388, "policy_rl": -41035.48163164594}, "policy_reward_max": {"policy_mom": 243153.8620182348, "policy_mean": 220926.3427416178, "policy_mm": 218701.05672780724, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 50962.35907528283, "policy_mean": 52855.2468977259, "policy_mm": 52929.98947029357, "policy_rl": 63828.79900645445}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50962.36328125, "('mom_0', 'policy_mom')_total_reward_min": -34200.2734375, "('mom_0', 'policy_mom')_total_reward_max": 243153.859375, "('mean_0', 'policy_mean')_total_reward_mean": 52855.25, "('mean_0', 'policy_mean')_total_reward_min": -38449.125, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 52929.98828125, "('mm_0', 'policy_mm')_total_reward_min": -41535.84765625, "('mm_0', 'policy_mm')_total_reward_max": 218701.0625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63828.8046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -41035.48046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [221423.64135404397, 312879.2249857283, 226435.19428385928, 60677.095284955605, 257457.81460466876, 502259.0804940255, 246856.8197582656, 253856.74802364566, 244953.18621262707, 365438.8650551452, 102647.62749171161, -3952.269914095385, 213928.6772351718, 336975.7703398485, 369822.80590815295, 84829.49203044959, 338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [41011.830137941266, 81555.21691720029, 65895.35962555281, 12703.96942649804, 59840.49329216608, 61026.375732140004, 63512.75374473906, 53224.75675188819, 74962.94475136916, 66752.43243542545, 11751.449770582467, -3518.890226341738, 74062.17348497211, 73074.80183197431, 102755.81265850304, 25641.39908456884, 61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348], "policy_policy_mean_reward": [67013.61891817611, 71140.26191685807, 46826.50243051454, 2384.8538027101126, 82048.02228035103, 111693.30775048993, 54545.77156036915, 71921.88694359134, 53200.0167053158, 110014.95746416101, 37646.242749116405, -6525.044966963921, 48097.205894769795, 52968.226586273704, 101490.81460873304, 10581.596143764282, 83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859], "policy_policy_mm_reward": [62780.151646793856, 75603.71999948434, 70102.4732403754, 10886.17067893016, 63424.57548407558, 218701.05672780724, 46326.53538908717, 69495.54191125982, 63313.907552343466, 102467.23302225895, 35448.24795436303, 6618.05657936673, 40290.160814154784, 73366.1050405586, 89008.28038808267, 19845.49787030138, 69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115], "policy_policy_rl_reward": [50618.04065113274, 84580.02615218512, 43610.858987416745, 34702.10137681719, 52144.72354807599, 110838.34028358766, 82471.75906407028, 59214.56241690639, 53476.31720359903, 86204.24213329969, 17801.687017649827, -526.3913001564628, 51479.137041274815, 137566.636881042, 76567.89825283404, 28760.99893181561, 123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25193316752487105, "mean_inference_ms": 0.7710529107211874, "mean_action_processing_ms": 0.11949088749159965, "mean_env_wait_ms": 2.4305811720108927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007925629615783691, "StateBufferConnector_ms": 0.0007815957069396973, "ViewRequirementAgentConnector_ms": 0.019583284854888916}, "num_episodes": 16, "episode_return_max": 768861.5253312688, "episode_return_min": -141793.68300062293, "episode_return_mean": 220576.39444975674, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.89060203391483, "num_env_steps_trained_throughput_per_sec": 254.89060203391483, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15166.78, "restore_workers_time_ms": 0.034, "training_step_time_ms": 15166.701, "sample_time_ms": 14603.054, "learn_time_ms": 548.259, "learn_throughput": 7295.826, "synch_weights_time_ms": 7.524}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "ae48a_00000", "date": "2025-10-28_12-13-02", "timestamp": 1761671582, "time_this_iter_s": 15.697205066680908, "time_total_s": 287.1236174106598, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f4c20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 287.1236174106598, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.177272727272726, "ram_util_percent": 84.19545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9334808588027954, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.877395978569984, "policy_loss": -0.027596426362288186, "vf_loss": 9.957022392749787, "vf_explained_var": 3.342144191265106e-06, "kl": 0.021731959717317367, "entropy": 5.637639251351357, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 768861.5253312688, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 210362.94209643398, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 243153.8620182348, "policy_mean": 220926.3427416178, "policy_mm": 206881.48801737974, "policy_rl": 284826.27705782995}, "policy_reward_mean": {"policy_mom": 48847.84187830011, "policy_mean": 50041.77140765714, "policy_mm": 49329.76711356378, "policy_rl": 62143.56169691295}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48847.84375, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 243153.859375, "('mean_0', 'policy_mean')_total_reward_mean": 50041.7734375, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 49329.76953125, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 206881.484375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62143.56640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 284826.28125}, "hist_stats": {"episode_reward": [338075.15547022835, 267541.4734129034, 320902.0791934461, 75967.18941213985, -101081.96003917397, -127524.4552097218, 158777.82495716552, -86270.19485953361, 761576.643057517, 197596.60642824843, 277837.1418829565, -40290.304602166165, 260310.9577865642, 185346.72738894046, 336755.7734788851, 110757.94728048476, 742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [61474.50568768069, 73991.27505585998, 49385.76330306247, 17431.0546017182, -17771.898574981315, -29373.83605143773, 66285.07772819966, -15516.725363312216, 123244.7927366948, 56867.6763393369, 90204.1708613343, -30341.861363428176, 50296.39763778279, 42126.967848771565, 80949.31190373686, 25274.879312679685, 214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217], "policy_policy_mean_reward": [83913.21480994114, 82873.67328531577, 82299.16066452117, 22363.703334495738, -36390.81449029251, -28532.651850228533, 27124.792877375887, -25655.066918925324, 146624.08524561164, 33763.70942852879, 58926.004509144645, -4303.184916383441, 66059.39195867439, 44222.400950428426, 56066.85232441958, 24523.387723731157, 169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009], "policy_policy_mm_reward": [69181.31452646403, 57779.98734865064, 90523.54143245165, 13907.993332333244, -15650.651450161107, -39300.038919409955, 28876.766173028936, -22313.354789955378, 206881.48801737974, 58265.722168966706, 40431.08848678708, -4214.994056722413, 63609.12026667972, 52786.09503241174, 86473.90616476048, 26022.06618661745, 165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739], "policy_policy_rl_reward": [123506.12044614276, 52896.53772307653, 98693.61379341078, 22264.438143592793, -31268.595523738837, -30317.928388645465, 36491.188178560966, -22785.047787340223, 284826.27705782995, 48699.49849141626, 88275.87802569024, -1430.2642656323087, 80346.04792342738, 46211.26355732841, 113265.70308596805, 34937.61405745651, 193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523077992044056, "mean_inference_ms": 0.7723176175897586, "mean_action_processing_ms": 0.11965910871712004, "mean_env_wait_ms": 2.432464558295466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000814974308013916, "StateBufferConnector_ms": 0.0008080601692199707, "ViewRequirementAgentConnector_ms": 0.019932091236114502}, "num_episodes": 16, "episode_return_max": 768861.5253312688, "episode_return_min": -190099.6263918819, "episode_return_mean": 210362.94209643398, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.74600293319617, "num_env_steps_trained_throughput_per_sec": 261.74600293319617, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15231.488, "restore_workers_time_ms": 0.059, "training_step_time_ms": 15231.383, "sample_time_ms": 14664.408, "learn_time_ms": 551.032, "learn_throughput": 7259.102, "synch_weights_time_ms": 7.96}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "ae48a_00000", "date": "2025-10-28_12-13-17", "timestamp": 1761671597, "time_this_iter_s": 15.285547971725464, "time_total_s": 302.40916538238525, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f5e40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.40916538238525, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.422727272727272, "ram_util_percent": 83.79545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9820863604545593, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.879413801431657, "policy_loss": -0.02521674307936337, "vf_loss": 9.954721316695213, "vf_explained_var": 3.2158568501472473e-06, "kl": 0.018628833048569566, "entropy": 5.567943942546845, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 883601.9529225574, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 230170.4584322585, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 243153.8620182348, "policy_mean": 220926.3427416178, "policy_mm": 216375.73823587643, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 54066.720220755, "policy_mean": 54833.66925021468, "policy_mm": 53025.80076768004, "policy_rl": 68244.26819360876}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54066.71484375, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 243153.859375, "('mean_0', 'policy_mean')_total_reward_mean": 54833.671875, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 53025.80078125, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 216375.734375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68244.2734375, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [742958.9025746314, 260147.13169160442, 238045.4277614711, 22141.84086009944, 664234.4947891729, 16742.40133087427, -7927.853456948415, 594422.4600768088, 157621.15808661474, 442773.98374023195, 355885.58499291935, 288950.0692640228, 567346.008795364, 188508.13699268212, 319540.60562328814, 4476.872181146116, 349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [214468.7401870328, 41283.55281707845, 88050.72389041047, 2495.766907430561, 148756.75231860584, -5804.742503641509, 11214.825629939194, 158785.71949840817, 44534.77671924777, 154541.43362134555, 62541.37851487655, 72306.47174187178, 85802.28930298501, 30094.607316654303, 43598.62638900056, -755.0162882310144, 67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594], "policy_policy_mean_reward": [169319.90312098077, 64991.1265844215, 72712.04944874, 7618.374345394323, 174038.98929228145, -2653.5574327549093, -9082.650871953085, 179173.08716454727, 43848.86829445114, 91046.85670101749, 87535.6464948457, 55157.23596177521, 166868.05697265232, 42604.64853690651, 94264.61222258807, -3658.912592053087, 85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418], "policy_policy_mm_reward": [165217.33607942003, 67719.16823448887, 27394.051154156252, -15781.556047432363, 193102.46101242493, 4764.224656174601, -21110.01326804082, 111182.88168302001, 24436.181132409405, 100644.92500913718, 108353.60581873842, 85367.06733483574, 124263.25993735046, 45260.20251535176, 75493.46227318424, -1354.7848237253854, 86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356], "policy_policy_rl_reward": [193952.9231871978, 86153.28405561546, 49888.60326816435, 27809.255654706914, 148336.29216586085, 20436.47661109619, 11049.985053106371, 145280.77173083264, 44801.331940506374, 96540.76840873169, 97454.95416445915, 76119.29422554023, 190412.4025823753, 70548.67862376965, 106183.90473851534, 10245.58588515556, 110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524275190162089, "mean_inference_ms": 0.7726835274082517, "mean_action_processing_ms": 0.11971438892198805, "mean_env_wait_ms": 2.4329395806943035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008162856101989746, "StateBufferConnector_ms": 0.0008119940757751465, "ViewRequirementAgentConnector_ms": 0.01992744207382202}, "num_episodes": 16, "episode_return_max": 883601.9529225574, "episode_return_min": -190099.6263918819, "episode_return_mean": 230170.4584322585, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.31194857201336, "num_env_steps_trained_throughput_per_sec": 270.31194857201336, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15183.998, "restore_workers_time_ms": 0.063, "training_step_time_ms": 15183.886, "sample_time_ms": 14616.05, "learn_time_ms": 551.797, "learn_throughput": 7249.038, "synch_weights_time_ms": 8.007}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "ae48a_00000", "date": "2025-10-28_12-13-32", "timestamp": 1761671612, "time_this_iter_s": 14.802252054214478, "time_total_s": 317.21141743659973, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7a60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 317.21141743659973, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.885714285714286, "ram_util_percent": 83.09047619047618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9942137002944946, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.888170874118805, "policy_loss": -0.021479681810887996, "vf_loss": 9.96108321249485, "vf_explained_var": -2.767890691757202e-07, "kl": 0.017623853303939622, "entropy": 5.671974498033523, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 883601.9529225574, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 192943.62327924388, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 243153.8620182348, "policy_mean": 220926.3427416178, "policy_mm": 216375.73823587643, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 45139.33547670641, "policy_mean": 44956.55555443137, "policy_mm": 45567.97004231603, "policy_rl": 57279.76220579005}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45139.33984375, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 243153.859375, "('mean_0', 'policy_mean')_total_reward_mean": 44956.5546875, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 45567.96875, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 216375.734375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57279.765625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [349063.43389846326, 435438.8036686372, 84150.22463882423, 120613.4048668667, 306878.4411686449, 235379.6496265749, 641094.4530074182, 264349.6364457125, 10995.302080102827, 179781.56487859247, -78108.86001746953, 223371.2982855722, 193824.7090546682, 153535.14503472336, -2088.099314201101, -30332.23567114038, 319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [67206.06482853036, 61733.57356966016, 29742.77344004997, 26804.014826263545, 61598.28878700959, 45642.22646785781, 173106.05848467385, 83376.72022716455, 174.220913917057, 24727.6290635093, -8509.293035290115, 69333.91531695388, 32924.129392772025, 42233.14097431026, 7074.9923322068535, -7828.387863703863, 105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393], "policy_policy_mean_reward": [85514.17310589775, 123554.69010443838, 12113.73452259784, 27576.71925932623, 106694.32061872842, 98548.03704917585, 128788.66112372442, 15613.422440234768, 3119.298939601652, 49895.00567894319, -27817.101700607876, 50254.24587314004, 45828.82456278379, 18899.347223041656, 3224.072885934683, -22869.62586658966, 70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474], "policy_policy_mm_reward": [86322.96555213344, 118098.8615372037, 21205.683069990293, 17841.61644237866, 76019.95477432627, 44703.677994555095, 138611.0218156472, 83793.55789662269, 4885.31401122635, 37118.08555798569, -16881.147627450395, 44018.18069408961, 48731.84841107248, 33896.99600140995, -14164.904194867511, -2187.2499930552713, 74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364], "policy_policy_rl_reward": [110020.23041190117, 132051.67845733475, 21088.033606186185, 48391.0543388985, 62565.87698858051, 46485.70811498624, 200588.71158337302, 81565.93588169034, 2816.4682153578774, 68040.8445781542, -24901.317654121154, 59764.95640138857, 66339.90668804006, 58505.660835961506, 1777.739662524827, 2553.028052208419, 69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25245631293798604, "mean_inference_ms": 0.7726711745720504, "mean_action_processing_ms": 0.11972215218446337, "mean_env_wait_ms": 2.432720753615553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000810086727142334, "StateBufferConnector_ms": 0.0008031129837036133, "ViewRequirementAgentConnector_ms": 0.019777774810791016}, "num_episodes": 16, "episode_return_max": 883601.9529225574, "episode_return_min": -190099.6263918819, "episode_return_mean": 192943.62327924388, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.83121182359923, "num_env_steps_trained_throughput_per_sec": 265.83121182359923, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15180.411, "restore_workers_time_ms": 0.063, "training_step_time_ms": 15180.302, "sample_time_ms": 14613.21, "learn_time_ms": 552.248, "learn_throughput": 7243.125, "synch_weights_time_ms": 7.437}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "ae48a_00000", "date": "2025-10-28_12-13-47", "timestamp": 1761671627, "time_this_iter_s": 15.050124883651733, "time_total_s": 332.26154232025146, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55b880>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 332.26154232025146, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.70909090909091, "ram_util_percent": 83.92727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9981412887573242, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.87679348886013, "policy_loss": -0.025721247064939234, "vf_loss": 9.95342322587967, "vf_explained_var": 5.945749580860138e-06, "kl": 0.018349629918998356, "entropy": 5.641338688135147, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 883601.9529225574, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 187516.45564418644, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 243153.8620182348, "policy_mean": 220926.3427416178, "policy_mm": 216375.73823587643, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 44655.066483940675, "policy_mean": 43268.1716325329, "policy_mm": 44244.61168182364, "policy_rl": 55348.6058458892}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44655.05859375, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 243153.859375, "('mean_0', 'policy_mean')_total_reward_mean": 43268.171875, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 44244.61328125, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 216375.734375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55348.60546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [319763.0231862548, 274110.95334234624, 253286.76923891486, 88627.66553954837, 49085.04829020205, 272425.40389373095, 246016.26814887783, -81726.8354126482, 84786.9301336637, -141793.68300062293, 215131.50639580164, 354898.0795698817, 69293.24587672517, 673385.1557946941, 258352.59970356285, 106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [105960.3727507143, 65823.6867404907, 40366.37675763917, 35228.96766243727, 18562.932358347945, 43076.57210962035, 64729.514976835504, -24046.05124307168, 14163.97392909041, -30991.339272977093, 48014.35800787379, 50249.855180562234, 18019.16176862415, 134928.191409763, 27747.117767064476, 22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017], "policy_policy_mean_reward": [70072.83267754242, 69096.93926550618, 66275.95712165309, 24186.22917233846, 7108.302374893129, 66313.99653545038, 64894.79519371836, -28999.64311106803, 23459.632408824567, -38449.125345661705, 30274.609422512225, 100554.91317383968, 1780.4772614587637, 209878.26382540853, 91464.57945021318, 31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942], "policy_policy_mm_reward": [74656.77297908292, 77693.16818578335, 67209.39627799997, 12824.751433396174, 936.6514177985193, 80755.26313347233, 46154.948261748104, -26896.1665086517, 12549.236163354239, -31317.73675033812, 89750.42918561945, 97953.62938878263, 33494.97887034149, 122459.73681695695, 48027.41853619482, 18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415], "policy_policy_rl_reward": [69073.04477891591, 61497.159150565705, 79435.03908162277, 16387.717271376336, 22477.16213916259, 82279.57211518775, 70237.00971657592, -1784.9745498568911, 34614.08763239432, -41035.48163164594, 47092.10977979645, 106139.68182669667, 15998.627976300771, 206118.96374256548, 91113.48395009061, 33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25250044734206645, "mean_inference_ms": 0.7726776377972581, "mean_action_processing_ms": 0.11973160730336688, "mean_env_wait_ms": 2.43278555728137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000825345516204834, "StateBufferConnector_ms": 0.000811159610748291, "ViewRequirementAgentConnector_ms": 0.019910573959350586}, "num_episodes": 16, "episode_return_max": 883601.9529225574, "episode_return_min": -190099.6263918819, "episode_return_mean": 187516.45564418644, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.64292034883647, "num_env_steps_trained_throughput_per_sec": 267.64292034883647, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15199.045, "restore_workers_time_ms": 0.062, "training_step_time_ms": 15198.937, "sample_time_ms": 14630.325, "learn_time_ms": 553.663, "learn_throughput": 7224.607, "synch_weights_time_ms": 7.406}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "ae48a_00000", "date": "2025-10-28_12-14-02", "timestamp": 1761671642, "time_this_iter_s": 14.949503898620605, "time_total_s": 347.21104621887207, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a3e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 347.21104621887207, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.2, "ram_util_percent": 83.42380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0962499380111694, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.888591933250428, "policy_loss": -0.021574496550601906, "vf_loss": 9.960740321874619, "vf_explained_var": 1.8395483493804932e-06, "kl": 0.018198164860996326, "entropy": 5.603335176408291, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 883601.9529225574, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 205786.9940040877, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 220926.3427416178, "policy_mm": 228006.12525802891, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 50106.44865733359, "policy_mean": 47935.74669545186, "policy_mm": 47274.14328262354, "policy_rl": 60470.655368678694}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50106.44921875, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 47935.74609375, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 220926.34375, "('mm_0', 'policy_mm')_total_reward_mean": 47274.140625, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 228006.125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60470.64453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [106412.35058275834, -30671.447283494475, 355925.7792225961, 690822.6636886096, -50658.38573654558, 194709.62983843085, 13884.166318819623, 98078.40126920493, -35348.52362316157, 222504.6473469227, 300659.09588434116, 552160.2255480415, 330956.44680348336, 570358.4656364539, -27103.04065659277, -98538.46746919728, -135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [22412.06518179691, -14004.222322938977, 95979.71512895575, 122402.8739544144, -11573.940828613668, 67771.50985135429, -2405.5585365441184, 11336.360890007372, -15594.947862515606, 61688.7177440142, 57797.570351780654, 117063.39436811852, 88163.34322832659, 188431.3993161621, -12245.069835760645, -24077.125570735283, -34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194], "policy_policy_mean_reward": [31909.293776321436, -12241.01217965439, 41139.40865001649, 220926.3427416178, -14705.903215007049, 53972.82977634285, -404.422212600549, 27493.768243479786, -3585.9263689722625, 34165.22875285276, 72472.69509029013, 133636.59655459455, 92296.5906394867, 116535.90810169601, -1224.2923289539806, -33864.10931663113, -23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249], "policy_policy_mm_reward": [18395.844575527663, -15022.436645563164, 96328.12299829132, 159110.5613709538, -24616.323712233378, 29918.613572833612, -6740.510151567964, 44285.07069110338, -13613.15701750984, 74249.41352280739, 79572.9319424926, 119120.08356676942, 69490.51019652798, 128844.50167513138, 8785.428912935016, -28487.2462992933, -41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998], "policy_policy_rl_reward": [33695.14704911218, 10596.223864662055, 122478.53244533243, 188382.88562162413, 237.78201930843514, 43046.676637900055, 23434.6572195324, 14963.20144461444, -2554.4923741640246, 52401.28732724849, 90815.89849977772, 182340.1510585588, 81006.00273914197, 136546.6565434643, -22419.10740481307, -12109.986282537928, -36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524990809869248, "mean_inference_ms": 0.7725850456159127, "mean_action_processing_ms": 0.11972975749469789, "mean_env_wait_ms": 2.4325865362867387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008150935173034668, "StateBufferConnector_ms": 0.0008129477500915527, "ViewRequirementAgentConnector_ms": 0.019852876663208008}, "num_episodes": 15, "episode_return_max": 883601.9529225574, "episode_return_min": -190099.6263918819, "episode_return_mean": 205786.9940040877, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.0225902650404, "num_env_steps_trained_throughput_per_sec": 275.0225902650404, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15136.07, "restore_workers_time_ms": 0.065, "training_step_time_ms": 15135.955, "sample_time_ms": 14580.456, "learn_time_ms": 541.937, "learn_throughput": 7380.926, "synch_weights_time_ms": 6.17}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "ae48a_00000", "date": "2025-10-28_12-14-17", "timestamp": 1761671657, "time_this_iter_s": 14.547543048858643, "time_total_s": 361.7585892677307, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f76a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 361.7585892677307, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 22.571428571428573, "ram_util_percent": 83.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0472513437271118, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.88630270063877, "policy_loss": -0.023828330676769836, "vf_loss": 9.961439689993858, "vf_explained_var": 3.9959326386451725e-06, "kl": 0.017885713218765975, "entropy": 5.667434632778168, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -190099.6263918819, "episode_reward_mean": 216825.83014513928, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -55285.63741462418, "policy_mean": -43504.17257371751, "policy_mm": -47641.848455593325, "policy_rl": -43667.9679479465}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 243632.46579163687, "policy_mm": 228006.12525802891, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 52653.607999936976, "policy_mean": 51478.69240386505, "policy_mm": 49734.25967040131, "policy_rl": 62959.27007093602}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52653.60546875, "('mom_0', 'policy_mom')_total_reward_min": -55285.63671875, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 51478.69140625, "('mean_0', 'policy_mean')_total_reward_min": -43504.171875, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 49734.26171875, "('mm_0', 'policy_mm')_total_reward_min": -47641.84765625, "('mm_0', 'policy_mm')_total_reward_max": 228006.125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62959.265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43667.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [-135851.39973831028, 344343.62052875146, 286597.4264690887, -12688.340829786866, 768861.5253312688, 228326.44124373372, 706116.2936668136, -11413.979701615086, 134569.72693932697, -190099.6263918819, 227077.67056865286, 230885.43494049695, 240171.23872823067, 101812.10769966453, -38983.21592785418, 175629.08047873375, 289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-34200.2750887776, 87036.78183511931, 55450.364479115866, 9778.993451975399, 243153.8620182348, 69270.34374880695, 176320.14573464807, -677.9483691502467, 61477.84905017457, -55285.63741462418, 52682.17717676205, 48608.43516897275, 74712.71122351878, 22223.392384241335, -10861.90607493149, 49356.359353067746, 45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627], "policy_policy_mean_reward": [-23751.919027730244, 89174.8773327421, 57678.4915652456, -27325.056248561963, 171663.4802305859, 52384.102591207746, 175671.86350399637, 8974.268822526865, 38426.85919925581, -43504.17257371751, 63631.626117243904, 36771.274339543765, 35621.142589044284, 18503.09247398452, -5695.275734180986, 38927.92159028614, 97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637], "policy_policy_mm_reward": [-41535.84804527388, 69232.63906001403, 70392.99858417285, 6097.4072950581785, 165033.16468035115, 72261.34392551435, 159511.8244714723, -15857.72510654179, 15509.80892539421, -47641.848455593325, 68750.87110498344, 65297.946334285676, 49231.75458676327, 33410.90330133274, -19197.376682966737, 38733.397980938076, 36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287], "policy_policy_rl_reward": [-36363.35757652866, 98899.32230087585, 103075.5718405544, -1239.6853282583877, 189011.01840209754, 34410.65097820471, 194612.45995669693, -3852.5750484497967, 19155.209764502382, -43667.9679479465, 42012.99616966332, 80207.77909769473, 80605.63032890427, 27674.71954010587, -3228.6574357751056, 48611.401554442, 110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523755805737522, "mean_inference_ms": 0.7721085767562904, "mean_action_processing_ms": 0.11968038215344366, "mean_env_wait_ms": 2.4317189341844307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008054971694946289, "StateBufferConnector_ms": 0.0008087754249572754, "ViewRequirementAgentConnector_ms": 0.01967555284500122}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -190099.6263918819, "episode_return_mean": 216825.83014513928, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.70730097081616, "num_env_steps_trained_throughput_per_sec": 270.70730097081616, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14993.435, "restore_workers_time_ms": 0.106, "training_step_time_ms": 14993.279, "sample_time_ms": 14439.39, "learn_time_ms": 541.213, "learn_throughput": 7390.799, "synch_weights_time_ms": 5.556}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "ae48a_00000", "date": "2025-10-28_12-14-32", "timestamp": 1761671672, "time_this_iter_s": 14.780580043792725, "time_total_s": 376.53916931152344, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6340>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.53916931152344, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.566666666666663, "ram_util_percent": 83.4952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0878725051879883, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.880976352095605, "policy_loss": -0.024928815275779927, "vf_loss": 9.956765124201775, "vf_explained_var": -2.6660040020942687e-06, "kl": 0.020299497959104084, "entropy": 5.6949761167168615, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -140091.65542177475, "episode_reward_mean": 220669.14861353664, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43486.456590186055, "policy_mean": -39749.91375934535, "policy_mm": -37763.7000337157, "policy_rl": -32500.635153315896}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 292101.3654411044}, "policy_reward_mean": {"policy_mom": 51556.04866309843, "policy_mean": 52618.72213525378, "policy_mm": 52141.15470141274, "policy_rl": 64353.22311377175}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51556.05078125, "('mom_0', 'policy_mom')_total_reward_min": -43486.45703125, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 52618.71875, "('mean_0', 'policy_mean')_total_reward_min": -39749.9140625, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 52141.15625, "('mm_0', 'policy_mm')_total_reward_min": -37763.69921875, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64353.2265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -32500.634765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 292101.375}, "hist_stats": {"episode_reward": [289900.27383754944, 68124.77602607827, 162624.21836044348, 296655.307343546, 153748.79000400862, 269985.8537531906, 216587.12932878276, -13501.232646808867, 313854.995405272, 883601.9529225574, 468429.6791679169, 776123.3684843691, -6436.123462888694, 141800.43868812584, 356592.37320048467, 118008.70353823545, 200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45509.984017519106, -1845.6944499235155, 35015.513324024294, 54872.895294565664, 31422.539553237217, 72329.48235040695, 64391.23208095971, -11553.998388849524, 68489.72431878289, 241514.86362411766, 136290.98585022008, 150676.60299036393, -15447.658043209223, 39342.2479446075, 61574.70589621245, 30139.583218247142, 41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024], "policy_policy_mean_reward": [97332.05083161421, 2448.7757674507534, 34350.86001155012, 65065.057219779315, 14791.245031769009, 49751.60308442961, 54920.823326034304, -14195.9338194814, 100824.38238481608, 220772.18424557731, 160536.88585581494, 116969.6618170241, -6025.6551949447, 30527.75794305314, 98916.00632832674, 34970.52239781792, 39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612], "policy_policy_mm_reward": [36908.322835093364, 40330.00778161416, 24035.463214982956, 110687.29569475312, 55683.48871423739, 84007.47558855324, 36542.286030401556, 3203.9684465756122, 74682.65264424025, 156855.42644850348, 80322.61479345162, 216375.73823587643, -6517.496686418431, 20841.250725311555, 70222.08475806104, 29195.10170052624, 42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328], "policy_policy_rl_reward": [110149.91615332261, 27191.686926936807, 69222.38180988604, 66030.05913444803, 51851.51670476505, 63897.29272980044, 60732.787891387175, 9044.731114946422, 69858.23605743272, 264459.4786043587, 91279.19266843052, 292101.3654411044, 21554.68646168354, 51089.18207515374, 125879.5762178843, 23703.4962216441, 76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25214852631748724, "mean_inference_ms": 0.7713144167086182, "mean_action_processing_ms": 0.11959233968870386, "mean_env_wait_ms": 2.4306066978002026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007727146148681641, "StateBufferConnector_ms": 0.0007765889167785645, "ViewRequirementAgentConnector_ms": 0.01926034688949585}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -140091.65542177475, "episode_return_mean": 220669.14861353664, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.3370715431252, "num_env_steps_trained_throughput_per_sec": 269.3370715431252, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14972.127, "restore_workers_time_ms": 0.1, "training_step_time_ms": 14971.977, "sample_time_ms": 14419.419, "learn_time_ms": 538.583, "learn_throughput": 7426.895, "synch_weights_time_ms": 7.086}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "ae48a_00000", "date": "2025-10-28_12-14-46", "timestamp": 1761671686, "time_this_iter_s": 14.854598760604858, "time_total_s": 391.3937680721283, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7ce0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.3937680721283, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.14285714285714, "ram_util_percent": 84.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0900304317474365, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.882584887742997, "policy_loss": -0.0246902265578683, "vf_loss": 9.958202105760574, "vf_explained_var": 1.3809651136398315e-06, "kl": 0.015373834311640291, "entropy": 5.784519873559475, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -140091.65542177475, "episode_reward_mean": 203986.67602867712, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43486.456590186055, "policy_mean": -39749.91375934535, "policy_mm": -37763.7000337157, "policy_rl": -32500.635153315896}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 274295.96754043153}, "policy_reward_mean": {"policy_mom": 47588.34961310339, "policy_mean": 48557.95620651444, "policy_mm": 47940.0413136164, "policy_rl": 59900.32889544291}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47588.3515625, "('mom_0', 'policy_mom')_total_reward_min": -43486.45703125, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 48557.953125, "('mean_0', 'policy_mean')_total_reward_min": -39749.9140625, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 47940.0390625, "('mm_0', 'policy_mm')_total_reward_min": -37763.69921875, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59900.32421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -32500.634765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 274295.96875}, "hist_stats": {"episode_reward": [200096.53180294737, 554293.7644648303, 256855.37447034087, 270011.3218195329, 110726.10768444526, 58349.619370758315, 152224.9573530029, 522944.2662353342, -139135.66460852773, -92488.59859184899, 168844.71072424302, 44268.94930678033, -15241.642588568682, 171987.41033577197, 293221.65389278927, 171329.6010890142, 139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [41005.86486680898, 120466.01829318856, 84097.0331651265, 54376.20194075129, 28722.495801450594, 13857.361872758038, 27036.238350371925, 152207.06852077652, -43486.456590186055, -22514.15459760355, 26629.88564236615, 10357.860326108332, 6699.049715071157, 30975.736861834997, 66104.63232581933, 49736.64879250247, 29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234], "policy_policy_mean_reward": [39920.22318783184, 99675.3126826211, 42611.71552468648, 64094.08543682606, 18798.867991680418, 14252.198114844165, 31894.512238830106, 117504.21041336028, -29215.122562226145, -29935.222494642163, 69848.7592014137, 683.6842816476913, -19112.402001995528, 32986.13827741684, 51820.08638474946, 34182.30330109224, 35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936], "policy_policy_mm_reward": [42970.204464915434, 116612.02639989763, 69941.03634796447, 69494.66186255634, 18114.383571493356, 5893.594087399239, 66707.18625214015, 111709.22872555512, -34401.81771863789, -27118.477536635743, 50773.6846570053, 2166.9736198991573, -8799.78461005372, 59018.20986707738, 101603.05760465603, 77093.01899568885, 32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648], "policy_policy_rl_reward": [76200.2392833913, 217540.40708912315, 60205.58943256344, 82046.37257939928, 45090.360319820946, 24346.465295756923, 26587.02051166096, 141523.75857564248, -32032.267737477614, -12920.743962967528, 21592.381223458196, 31060.431079125072, 5971.494308409312, 49007.32532944276, 73693.87757756458, 10317.629999730878, 41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518785059047065, "mean_inference_ms": 0.770387618704874, "mean_action_processing_ms": 0.11948866103439826, "mean_env_wait_ms": 2.4292640111250314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007721185684204102, "StateBufferConnector_ms": 0.0007755756378173828, "ViewRequirementAgentConnector_ms": 0.019243180751800537}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -140091.65542177475, "episode_return_mean": 203986.67602867712, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.0258397793375, "num_env_steps_trained_throughput_per_sec": 276.0258397793375, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14936.52, "restore_workers_time_ms": 0.102, "training_step_time_ms": 14936.37, "sample_time_ms": 14386.958, "learn_time_ms": 535.55, "learn_throughput": 7468.959, "synch_weights_time_ms": 7.047}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "ae48a_00000", "date": "2025-10-28_12-15-01", "timestamp": 1761671701, "time_this_iter_s": 14.494553089141846, "time_total_s": 405.88832116127014, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c540>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 405.88832116127014, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.885714285714286, "ram_util_percent": 83.44761904761906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0766290426254272, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.877765581011772, "policy_loss": -0.028030199292697944, "vf_loss": 9.955186039209366, "vf_explained_var": 1.592189073562622e-06, "kl": 0.015993741104841773, "entropy": 5.658742989599705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -140091.65542177475, "episode_reward_mean": 213934.5042932724, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37918.669958722945, "policy_mean": -39749.91375934535, "policy_mm": -37763.7000337157, "policy_rl": -32500.635153315896}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 274295.96754043153}, "policy_reward_mean": {"policy_mom": 50147.2602411799, "policy_mean": 52975.190624863615, "policy_mm": 48767.804503595835, "policy_rl": 62044.24892363305}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50147.25390625, "('mom_0', 'policy_mom')_total_reward_min": -37918.671875, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 52975.19140625, "('mean_0', 'policy_mean')_total_reward_min": -39749.9140625, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 48767.80078125, "('mm_0', 'policy_mm')_total_reward_min": -37763.69921875, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62044.25, "('rl_trader_0', 'policy_rl')_total_reward_min": -32500.634765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 274295.96875}, "hist_stats": {"episode_reward": [139637.37252869233, -140091.65542177475, -9891.600363224967, -69275.74558020163, -123499.9236797205, 269315.53434036113, 39265.78947680908, 325739.17928428005, -89605.40301432392, -19213.39454234255, 271392.1759226876, 384102.4774525647, 130421.91935533045, 230478.68853827292, 101549.19993587543, 130938.33668985999, 5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [29491.736817746412, -37918.669958722945, 7338.785416090159, -25309.476302539813, -32028.815534236393, 58305.342844086364, 19847.67990498018, 81600.3276821275, -21458.13832460995, 806.219586125119, 56135.8610611106, 103233.85287548626, 24082.100238526906, 78231.2230809815, 32615.925199868896, 27554.997817332194, 256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443], "policy_policy_mean_reward": [35966.50402205776, -39749.91375934535, 11759.510152887056, -6005.155115517093, -30807.125789064474, 70998.5458888475, -13338.743702878844, 69446.79685576116, -13254.84831975573, -15430.708872628647, 70916.14413728083, 57588.903616630654, 28160.397894359154, 39932.87009720624, 12282.36318858331, 41973.6403621672, 20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863], "policy_policy_mm_reward": [32341.14405392342, -37763.7000337157, -14174.169788048135, -7715.400808057389, -28163.34720310364, 60586.89210162636, 8553.104162010968, 100661.46629757223, -36755.91362193365, -17165.064438408983, 106252.11734284788, 70675.46446447568, 51236.34875224302, 48421.475534177465, 19394.85226052397, 22299.060438300145, -17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122], "policy_policy_rl_reward": [41837.98763496475, -24659.371669990785, -14815.72614415403, -30245.713354087253, -32500.635153315896, 79424.75350580066, 24203.749112696794, 74030.58844881914, -18136.502748024493, 12576.159182570134, 38088.0533814477, 152604.25649597184, 26943.07247020146, 63893.11982590843, 37256.05928689933, 39110.638072060516, 1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25154621639675406, "mean_inference_ms": 0.7693174323043067, "mean_action_processing_ms": 0.11936765887137397, "mean_env_wait_ms": 2.427817312067474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007537007331848145, "StateBufferConnector_ms": 0.0007652640342712402, "ViewRequirementAgentConnector_ms": 0.018980085849761963}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -140091.65542177475, "episode_return_mean": 213934.5042932724, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.6194099395191, "num_env_steps_trained_throughput_per_sec": 273.6194099395191, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14904.721, "restore_workers_time_ms": 0.099, "training_step_time_ms": 14904.576, "sample_time_ms": 14355.948, "learn_time_ms": 536.095, "learn_throughput": 7461.361, "synch_weights_time_ms": 5.967}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "ae48a_00000", "date": "2025-10-28_12-15-16", "timestamp": 1761671716, "time_this_iter_s": 14.622513055801392, "time_total_s": 420.51083421707153, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f54e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 420.51083421707153, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.209523809523812, "ram_util_percent": 83.53809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1065139770507812, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.883997356891632, "policy_loss": -0.022340634730062446, "vf_loss": 9.956917798519134, "vf_explained_var": 8.746981620788575e-07, "kl": 0.013487970025744386, "entropy": 5.6649401664733885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -76911.03510982319, "episode_reward_mean": 229678.71728141233, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -23397.92558309576, "policy_mean": -22270.64278125172, "policy_mm": -20391.8701818659, "policy_rl": -18919.229829417498}, "policy_reward_max": {"policy_mom": 293400.52352372766, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 274295.96754043153}, "policy_reward_mean": {"policy_mom": 53674.419072397264, "policy_mean": 56860.74932599112, "policy_mm": 52039.79297183175, "policy_rl": 67103.75591119225}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53674.421875, "('mom_0', 'policy_mom')_total_reward_min": -23397.92578125, "('mom_0', 'policy_mom')_total_reward_max": 293400.53125, "('mean_0', 'policy_mean')_total_reward_mean": 56860.74609375, "('mean_0', 'policy_mean')_total_reward_min": -22270.642578125, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 52039.7890625, "('mm_0', 'policy_mm')_total_reward_min": -20391.87109375, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67103.7578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -18919.23046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 274295.96875}, "hist_stats": {"episode_reward": [5221.845658182131, 482181.9726390699, 130569.02070838875, 30938.861832949795, 121933.90386827893, 865670.0291092034, 1709.8389385715575, 196229.6100010217, 544664.9515920787, 734374.0111421779, 65188.49722180844, 124502.24811538546, 828894.2171572322, 332087.06093110883, 281129.13763810473, 127355.94008654948, -43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [256.46102566618436, 157697.1540505093, 10519.738556159118, 4122.489791451791, 27361.93305951017, 293400.52352372766, -7093.062768181954, 55072.5697939966, 130772.66824235066, 170755.78953472094, 440.465454837656, 31024.878203673175, 201504.3742278066, 65106.8118436727, 53672.73178262126, 30695.841068007696, -6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045], "policy_policy_mean_reward": [20614.60814294322, 91270.79146716133, 44457.65579218512, 5643.090877692545, 38837.92620496942, 150186.1673698472, 1104.2589265121296, 44460.12413017742, 146231.72445919644, 206620.52988210093, 3586.2698774846776, 53481.66557669122, 157640.8164912298, 114781.8485115936, 90208.61467946092, 64854.004787695965, -16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809], "policy_policy_mm_reward": [-17383.623122355842, 116308.43307732153, 24564.110078147038, 3082.394044039569, 28947.508523441415, 200371.73877690724, -9644.40638300669, 61098.17355342438, 49464.15935431486, 142841.1080620742, 17509.476248220246, 18957.599938112493, 228006.12525802891, 62486.77508219382, 66047.72214774531, 15999.299323103933, -14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905], "policy_policy_rl_reward": [1734.399611928585, 116905.5940440781, 51027.516281897275, 18090.8871197659, 26786.536080357906, 221711.59943872108, 17343.049163248266, 35598.74252342327, 218196.39953621704, 214156.5836632813, 43652.28564126586, 21038.104396908533, 241742.90118016713, 89711.62549364868, 71200.06902827717, 15806.794907741974, -4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2511554970545952, "mean_inference_ms": 0.7681145913197966, "mean_action_processing_ms": 0.11923018511219513, "mean_env_wait_ms": 2.426031408957793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007368326187133789, "StateBufferConnector_ms": 0.0007538795471191406, "ViewRequirementAgentConnector_ms": 0.01871347427368164}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -76911.03510982319, "episode_return_mean": 229678.71728141233, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.8850919441309, "num_env_steps_trained_throughput_per_sec": 277.8850919441309, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14774.864, "restore_workers_time_ms": 0.106, "training_step_time_ms": 14774.711, "sample_time_ms": 14243.522, "learn_time_ms": 519.404, "learn_throughput": 7701.133, "synch_weights_time_ms": 5.468}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "ae48a_00000", "date": "2025-10-28_12-15-30", "timestamp": 1761671730, "time_this_iter_s": 14.397406816482544, "time_total_s": 434.9082410335541, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f4540>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 434.9082410335541, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.790000000000003, "ram_util_percent": 83.99000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.14349365234375, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.883099821209907, "policy_loss": -0.024841946427477522, "vf_loss": 9.957914730906486, "vf_explained_var": -6.326846778392791e-06, "kl": 0.016145491262011646, "entropy": 5.7238453269004825, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 955253.5884766153, "episode_reward_min": -133078.85260587448, "episode_reward_mean": 204686.84771800778, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33828.14984684919, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -26266.32758269457}, "policy_reward_max": {"policy_mom": 284385.2684779558, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 274295.96754043153}, "policy_reward_mean": {"policy_mom": 46901.65098401073, "policy_mean": 50592.56925577609, "policy_mm": 47605.17785995762, "policy_rl": 59587.449618263425}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46901.6484375, "('mom_0', 'policy_mom')_total_reward_min": -33828.1484375, "('mom_0', 'policy_mom')_total_reward_max": 284385.28125, "('mean_0', 'policy_mean')_total_reward_mean": 50592.5703125, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 47605.17578125, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59587.44921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -26266.328125, "('rl_trader_0', 'policy_rl')_total_reward_max": 274295.96875}, "hist_stats": {"episode_reward": [-43298.72977243524, 143911.30943629003, 353893.65127401816, 206384.1938199427, -43661.8994918133, 955253.5884766153, 405130.24503406254, 222834.8097293993, -39811.62435890176, 193962.45747704155, 359779.6632500524, -2237.1996356429977, 499548.3190864434, 81885.00162477455, 264976.9467711364, 129559.0014896622, 807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-6921.118230420527, 32691.004382022566, 66642.72087244077, 39205.710311029194, -19150.706303372437, 284385.2684779558, 95787.08436736905, 61944.53866657945, -23397.92558309576, 46664.50454600066, 58970.77789518745, 7637.765628148452, 111572.77993071084, 18219.30896050262, 75741.30857194966, 37766.73333539517, 139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922], "policy_policy_mean_reward": [-16984.918241928677, 37108.528368850755, 112327.31730063725, 59063.31359897249, -12420.244395614296, 195105.5524718543, 91858.94410682953, 74949.87206088034, -9409.163833712217, 49595.184047186085, 90640.94004763757, -3862.035686033667, 148327.47993101872, 12458.598669664947, 62587.55181304442, 37360.63425437609, 243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764], "policy_policy_mm_reward": [-14779.442235224851, 32627.15551489137, 78652.61667249755, 59567.53615824998, -4813.431205927073, 217252.4120500578, 117872.55989865823, 37794.02640240288, -8825.12829000651, 42093.05871274158, 105375.92032187287, -13073.789752817278, 90401.91640511151, 25590.129309267002, 42414.634992336534, 24412.98233796515, 224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192], "policy_policy_rl_reward": [-4613.251064861164, 41484.62117052514, 96270.99642844261, 48547.63375169105, -7277.517586899348, 258510.35547674831, 99611.6566612065, 48146.37259953653, 1820.5933479126722, 55609.710171112914, 104792.02498535455, 7060.860175059541, 149246.14281960332, 25616.96468533978, 84233.45139380591, 30018.651561925883, 199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250807736120028, "mean_inference_ms": 0.7670785473793356, "mean_action_processing_ms": 0.11911173493476128, "mean_env_wait_ms": 2.4245691808104564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007390379905700684, "StateBufferConnector_ms": 0.0007621645927429199, "ViewRequirementAgentConnector_ms": 0.018725812435150146}, "num_episodes": 16, "episode_return_max": 955253.5884766153, "episode_return_min": -133078.85260587448, "episode_return_mean": 204686.84771800778, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.2057345698721, "num_env_steps_trained_throughput_per_sec": 268.2057345698721, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14738.057, "restore_workers_time_ms": 0.081, "training_step_time_ms": 14737.928, "sample_time_ms": 14210.064, "learn_time_ms": 515.611, "learn_throughput": 7757.793, "synch_weights_time_ms": 5.99}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "ae48a_00000", "date": "2025-10-28_12-15-45", "timestamp": 1761671745, "time_this_iter_s": 14.917325019836426, "time_total_s": 449.8255660533905, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a160>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 449.8255660533905, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.52857142857143, "ram_util_percent": 84.26190476190477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2210273742675781, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.881662094593048, "policy_loss": -0.024676587419526184, "vf_loss": 9.954606023430824, "vf_explained_var": -2.275221049785614e-06, "kl": 0.017198818731685734, "entropy": 5.600677400827408, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 894540.0959821036, "episode_reward_min": -133078.85260587448, "episode_reward_mean": 211929.43333388984, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33828.14984684919, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -26266.32758269457}, "policy_reward_max": {"policy_mom": 228900.56276632973, "policy_mean": 243632.46579163687, "policy_mm": 253631.40088382174, "policy_rl": 315241.81490110804}, "policy_reward_mean": {"policy_mom": 49096.7575574283, "policy_mean": 51101.27802131259, "policy_mm": 48880.18356900116, "policy_rl": 62851.21418614778}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49096.76171875, "('mom_0', 'policy_mom')_total_reward_min": -33828.1484375, "('mom_0', 'policy_mom')_total_reward_max": 228900.5625, "('mean_0', 'policy_mean')_total_reward_mean": 51101.2734375, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 243632.46875, "('mm_0', 'policy_mm')_total_reward_mean": 48880.18359375, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 253631.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62851.21484375, "('rl_trader_0', 'policy_rl')_total_reward_min": -26266.328125, "('rl_trader_0', 'policy_rl')_total_reward_max": 315241.8125}, "hist_stats": {"episode_reward": [807228.6088545511, 185850.4034729145, 9868.526486736855, 267868.77320880146, 174521.07268419972, 733635.0061267896, 101365.24987696945, -56915.16131625433, 25913.27010637052, 159964.32417293199, 272735.4922650546, 193666.45399197348, 112206.72129709154, 372691.88962704124, 13076.863935548927, 554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [139757.8381767338, 29755.85485649109, 5314.720616609529, 76892.16717499627, 37228.17005571592, 130377.66608367547, 20134.489500229058, -6439.927557707161, 7079.851568321572, 34594.66982107018, 45139.86532360484, 26771.12583080208, 33734.427050626065, 68323.72252447536, 17364.923291820734, 105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732], "policy_policy_mean_reward": [243632.46579163687, 75572.58105715341, -19283.341058786908, 75702.5482690637, 23479.918451639984, 145299.8432031163, 45975.9948273656, -20918.504273509872, 13981.22051800716, 45448.10969532234, 63515.708623731865, 62978.51133955737, 20588.710197055432, 111357.20342949212, -8844.98530055983, 121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892], "policy_policy_mm_reward": [224363.03535127253, 35625.38457611518, -2429.57287759688, 51578.9097455287, 35788.471752253114, 253631.40088382174, 17077.129876842053, -20391.8701818659, -1712.023480485308, 43359.105428356495, 115198.67919451576, 46348.928895904886, 15637.683225792984, 93671.71393693976, 3743.730229915701, 158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074], "policy_policy_rl_reward": [199475.26953490908, 44896.582983155335, 26266.71980651114, 63695.148019212895, 78024.51242459042, 204326.09595617565, 18177.63567253268, -9164.859303171444, 6564.221500527068, 36562.43922818304, 48881.2391232024, 57567.88792570929, 42245.90082361701, 99339.24973613418, 813.1957143723924, 168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25049386934799694, "mean_inference_ms": 0.7661514435484645, "mean_action_processing_ms": 0.11900719437207495, "mean_env_wait_ms": 2.42335553375159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007496476173400879, "StateBufferConnector_ms": 0.0007649064064025879, "ViewRequirementAgentConnector_ms": 0.0188063383102417}, "num_episodes": 16, "episode_return_max": 894540.0959821036, "episode_return_min": -133078.85260587448, "episode_return_mean": 211929.43333388984, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.9901369658086, "num_env_steps_trained_throughput_per_sec": 269.9901369658086, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 14739.818, "restore_workers_time_ms": 0.08, "training_step_time_ms": 14739.695, "sample_time_ms": 14214.193, "learn_time_ms": 513.629, "learn_throughput": 7787.716, "synch_weights_time_ms": 5.911}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "ae48a_00000", "date": "2025-10-28_12-16-00", "timestamp": 1761671760, "time_this_iter_s": 14.819622993469238, "time_total_s": 464.64518904685974, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55ba60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 464.64518904685974, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 23.29047619047619, "ram_util_percent": 83.05238095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2362287044525146, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.886069855093956, "policy_loss": -0.02386770567536587, "vf_loss": 9.959591960906982, "vf_explained_var": -6.525777280330658e-06, "kl": 0.015740094712237012, "entropy": 5.6737427279353145, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -133078.85260587448, "episode_reward_mean": 232529.40105039798, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33828.14984684919, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -26266.32758269457}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 198187.90148114864, "policy_mm": 220253.18092416128, "policy_rl": 315241.81490110804}, "policy_reward_mean": {"policy_mom": 54855.99434452936, "policy_mean": 55388.82312546854, "policy_mm": 52054.28135391844, "policy_rl": 70230.30222648161}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54855.99609375, "('mom_0', 'policy_mom')_total_reward_min": -33828.1484375, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 55388.82421875, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 198187.90625, "('mm_0', 'policy_mm')_total_reward_mean": 52054.28125, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 220253.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70230.3125, "('rl_trader_0', 'policy_rl')_total_reward_min": -26266.328125, "('rl_trader_0', 'policy_rl')_total_reward_max": 315241.8125}, "hist_stats": {"episode_reward": [554191.7318327843, 159255.93148451205, 193547.30627493266, 251809.7609124218, 178019.93757268434, 21105.70441250772, 199396.39507844453, 11920.860367905443, 613889.9369485733, -5174.384889579196, 650389.1004552299, -76911.03510982319, 211737.34164104864, 371540.63050027203, -14428.515289927205, 73496.63884934215, 359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [105706.124330531, 33218.975618610864, 60345.18118988197, 78137.81967978149, 47572.630681859024, -782.9779562338862, 36750.31227288561, 6274.57905147956, 139782.6979152819, 11876.473231719681, 107415.87188745412, -21005.71657264258, 49434.25630347762, 99525.54660057431, -11994.525902112846, 7561.078858427111, 82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573], "policy_policy_mean_reward": [121399.16184240599, 39395.16093372012, 58979.330037603424, 40600.657857494036, 37919.50852790612, 19721.41964631605, 58340.04895224068, 3510.4592070543263, 119325.634811147, 12135.601156150167, 130456.62707866127, -22270.64278125172, 76142.7072884882, 100023.1522715487, -11336.807644213792, -354.40052248634237, 86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427], "policy_policy_mm_reward": [158093.42949296217, 31796.06330700798, 14561.016881520958, 59370.901069451895, 63746.40454811328, -10275.982906460957, 51158.38601878914, 12474.405728257962, 133886.5562356562, -16012.53052371893, 138220.63394868287, -14715.445926511395, 47941.752337433056, 76163.68969809018, -19873.381523393316, 13287.795288223986, 77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951], "policy_policy_rl_reward": [168993.0161668843, 54845.73162517289, 59661.778165926225, 73700.38230569441, 28781.393814805873, 12443.245628886478, 53147.64783452916, -10338.58361888634, 220895.04798648763, -13173.928753730095, 274295.96754043153, -18919.229829417498, 38218.62571164993, 95828.24193005885, 28776.199779792765, 53002.16522517743, 112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2502336188887457, "mean_inference_ms": 0.7654034596503962, "mean_action_processing_ms": 0.11892385917249836, "mean_env_wait_ms": 2.422243264533937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000752866268157959, "StateBufferConnector_ms": 0.0007748603820800781, "ViewRequirementAgentConnector_ms": 0.018877029418945312}, "num_episodes": 15, "episode_return_max": 1008228.7254599353, "episode_return_min": -133078.85260587448, "episode_return_mean": 232529.40105039798, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.24217004268723, "num_env_steps_trained_throughput_per_sec": 266.24217004268723, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14737.506, "restore_workers_time_ms": 0.109, "training_step_time_ms": 14737.34, "sample_time_ms": 14196.594, "learn_time_ms": 527.63, "learn_throughput": 7581.063, "synch_weights_time_ms": 6.337}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "ae48a_00000", "date": "2025-10-28_12-16-15", "timestamp": 1761671775, "time_this_iter_s": 15.02817988395691, "time_total_s": 479.67336893081665, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c180>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 479.67336893081665, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.099999999999998, "ram_util_percent": 83.33181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1643604040145874, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.88032769560814, "policy_loss": -0.023551165327080525, "vf_loss": 9.953594478964806, "vf_explained_var": -3.846734762191772e-06, "kl": 0.015932112468635858, "entropy": 5.688506625592709, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -133078.85260587448, "episode_reward_mean": 231152.86565520073, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33828.14984684919, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -26266.32758269457}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 198187.90148114864, "policy_mm": 220253.18092416128, "policy_rl": 315241.81490110804}, "policy_reward_mean": {"policy_mom": 53850.36835746659, "policy_mean": 55138.085324789776, "policy_mm": 52207.529782328944, "policy_rl": 69956.88219061545}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53850.37109375, "('mom_0', 'policy_mom')_total_reward_min": -33828.1484375, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 55138.08984375, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 198187.90625, "('mm_0', 'policy_mm')_total_reward_mean": 52207.53125, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 220253.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69956.8828125, "('rl_trader_0', 'policy_rl')_total_reward_min": -26266.328125, "('rl_trader_0', 'policy_rl')_total_reward_max": 315241.8125}, "hist_stats": {"episode_reward": [359605.8417899061, 13756.239799313782, 294001.7735923972, 71584.94109324286, 31941.776226053906, 142607.9829365499, 304515.38097030605, 725870.8519997925, 260694.76811375841, 64497.53758902445, 234277.8709492277, 74749.84566128836, 295639.66677304916, -173.62472406505572, 307507.2688691772, 124194.74842024372, 330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [82297.13585678801, 549.286042231659, 62869.45107974931, 16640.894836881496, 18758.741075818234, 39211.56071425265, 87659.6763690022, 143398.1657749076, 40828.45176980822, 24553.52264629511, 76424.73003056292, 24969.006937350943, 89201.25039811771, -950.1232314991015, 66869.74351050456, 27096.08707243625, 71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511], "policy_policy_mean_reward": [86661.30338709713, 7532.063232351272, 65400.90592918438, 14278.419243880464, -3686.8568994720936, 30409.188433504944, 85541.63519661764, 154859.04236081894, 87306.0744214368, 19908.206677767073, 42308.403075542294, 4616.89083536628, 90882.62058370395, 7912.619055143999, 100290.95766221668, 42635.01045367562, 81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294], "policy_policy_mm_reward": [77750.67907622691, -4123.168099907761, 101359.02429783085, 10054.890231526966, 15967.038265403648, 21672.31049540347, 54502.78750527495, 220253.18092416128, 48181.643685014235, -13875.26240285111, 54883.58414933766, 33322.64686545291, 50191.379746353174, -8025.126697749082, 72908.75780394605, 25469.614985263135, 72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505], "policy_policy_rl_reward": [112896.72346979367, 9798.058624638405, 64372.39228563218, 30610.736780953823, 902.8537843041489, 51314.923293388776, 76811.28189941111, 207360.46293990497, 84378.59823749891, 33911.07066781333, 60661.153693784516, 11841.301023118269, 65364.41604487431, 889.0061500391181, 67437.80989250989, 28994.035908868806, 104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2500073243973802, "mean_inference_ms": 0.7647551453852227, "mean_action_processing_ms": 0.11885188448822717, "mean_env_wait_ms": 2.4213496500680534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007564425468444824, "StateBufferConnector_ms": 0.0007777810096740723, "ViewRequirementAgentConnector_ms": 0.0189363956451416}, "num_episodes": 16, "episode_return_max": 1008228.7254599353, "episode_return_min": -133078.85260587448, "episode_return_mean": 231152.86565520073, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.19697370448216, "num_env_steps_trained_throughput_per_sec": 266.19697370448216, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 14745.624, "restore_workers_time_ms": 0.112, "training_step_time_ms": 14745.457, "sample_time_ms": 14207.242, "learn_time_ms": 526.082, "learn_throughput": 7603.372, "synch_weights_time_ms": 5.552}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "ae48a_00000", "date": "2025-10-28_12-16-30", "timestamp": 1761671790, "time_this_iter_s": 15.029529094696045, "time_total_s": 494.7028980255127, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68ce00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 494.7028980255127, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 27.171428571428567, "ram_util_percent": 82.62380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2286360263824463, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.88719483613968, "policy_loss": -0.022920962925127242, "vf_loss": 9.960605174303055, "vf_explained_var": 2.4339184165000916e-06, "kl": 0.014273035032101805, "entropy": 5.691231040656566, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 233739.1688905929, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 198187.90148114864, "policy_mm": 189378.32092743512, "policy_rl": 315241.81490110804}, "policy_reward_mean": {"policy_mom": 53252.76519633211, "policy_mean": 55340.60980128611, "policy_mm": 52151.78228022956, "policy_rl": 72994.01161274515}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53252.765625, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 55340.609375, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 198187.90625, "('mm_0', 'policy_mm')_total_reward_mean": 52151.7890625, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 189378.328125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72994.015625, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 315241.8125}, "hist_stats": {"episode_reward": [330477.4163933942, 204146.40034383396, 82672.98090935613, 31587.448055790665, 539804.6459596463, 151557.48189026042, 184481.74952918754, 246498.95128719328, 11578.652272337249, 321355.00546525506, 541880.3365789445, 118378.11923139064, 13615.702156595173, 77399.11347936682, 132795.33802730747, 42450.833943826496, 287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [71809.45487893489, 76439.20685270823, 7471.643623753892, 2405.44674580617, 124774.72400185443, 31837.76619648702, 50664.404033791856, 39237.751693518185, 5758.956915642077, 80590.70336183032, 140944.6705757287, 26487.981623373533, -15060.084516256376, 1561.6018047716564, 42509.60896305565, 28674.996445439967, 81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087], "policy_policy_mean_reward": [81432.2120615367, 52546.037017481445, 23627.50265534259, 13082.83066165101, 144373.56066124863, 28364.582685443318, 65816.53073731333, 46644.27549434694, -17144.720167185867, 78561.69513648115, 117569.35615415947, 22362.006853875635, 37448.62440523008, 31978.861944175875, 37873.162274960625, -7529.7503813404, 80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557], "policy_policy_mm_reward": [72709.56945606924, 27249.241610209127, 8094.888886759123, 10574.574996488444, 126439.71357973122, 51082.79302140702, 44379.49234537953, 65267.30633550788, -1101.9398616493602, 88018.86059379205, 77964.16273707042, 19717.270573573755, -8020.355366865739, 4971.869557729382, 25804.668851436832, 11676.200875098779, 63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416], "policy_policy_rl_reward": [104526.17999685364, 47911.91486343506, 43478.945743500626, 5524.595651844978, 144216.6477168118, 40272.339986922954, 23621.322412702648, 95349.6177638204, 24066.35538553043, 74183.74637315221, 205402.14711198563, 49810.86018056758, -752.4823655127761, 38886.78017268996, 26607.897937854694, 9629.38700462818, 61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24984459834046885, "mean_inference_ms": 0.7642912820911195, "mean_action_processing_ms": 0.11880266002823532, "mean_env_wait_ms": 2.4206666842056257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007681846618652344, "StateBufferConnector_ms": 0.0007829070091247559, "ViewRequirementAgentConnector_ms": 0.019154846668243408}, "num_episodes": 16, "episode_return_max": 1008228.7254599353, "episode_return_min": -138135.72055330293, "episode_return_mean": 233739.1688905929, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.28055104753673, "num_env_steps_trained_throughput_per_sec": 270.28055104753673, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 14771.136, "restore_workers_time_ms": 0.106, "training_step_time_ms": 14770.981, "sample_time_ms": 14230.792, "learn_time_ms": 527.417, "learn_throughput": 7584.13, "synch_weights_time_ms": 5.946}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "ae48a_00000", "date": "2025-10-28_12-16-45", "timestamp": 1761671805, "time_this_iter_s": 14.802688121795654, "time_total_s": 509.50558614730835, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55ade0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 509.50558614730835, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 27.428571428571427, "ram_util_percent": 83.35238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.315190076828003, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.887898021936417, "policy_loss": -0.022089771408354865, "vf_loss": 9.959609153866769, "vf_explained_var": 3.0472874641418457e-06, "kl": 0.01612796283607183, "entropy": 5.687897519767285, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 257593.38769045315, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -39619.0742928583, "policy_mm": -33365.300883472424, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 255389.69422391706, "policy_mm": 189759.69366199392, "policy_rl": 332213.9869754488}, "policy_reward_mean": {"policy_mom": 57426.75934948343, "policy_mean": 61795.29551149365, "policy_mm": 57420.43309161568, "policy_rl": 80950.89973786048}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57426.76171875, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 61795.296875, "('mean_0', 'policy_mean')_total_reward_min": -39619.07421875, "('mean_0', 'policy_mean')_total_reward_max": 255389.6875, "('mm_0', 'policy_mm')_total_reward_mean": 57420.42578125, "('mm_0', 'policy_mm')_total_reward_min": -33365.30078125, "('mm_0', 'policy_mm')_total_reward_max": 189759.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 80950.8984375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 332214.0}, "hist_stats": {"episode_reward": [287090.61737662926, 48442.84142571456, 185352.11395835597, 636530.6260462971, 146276.76706847758, -47076.139561040625, -133078.85260587448, -82946.71100634398, 10581.048607838688, 218164.463443417, 18535.45410712036, 450669.03420621034, 121500.77763741568, 598468.5788033842, 166536.9604626185, 298392.7943087922, 180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [81488.62037483855, 1229.789409581596, 41693.03949758119, 139781.37544856803, 57843.653698137045, -12426.958862209638, -33828.14984684919, -13945.570370390162, -10171.80201390242, 56900.46969655792, -2958.2905072119906, 120470.77949690307, 41519.2502033516, 124648.85233304197, 59451.55646204857, 75168.4743697736, 47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277], "policy_policy_mean_reward": [80667.42690653949, 8695.32262588072, 32425.16299130686, 112201.05404877252, 33061.4590593809, -19568.25564166446, -39619.0742928583, -35185.51841565811, 8837.78890666672, 64062.47426678287, 7324.6169094847355, 111485.13683678136, 47178.37236663463, 137245.3871421779, 44443.214339585786, 90016.90047272995, 38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605], "policy_policy_mm_reward": [63420.08766885992, 4126.669962577458, 33655.10921419198, 183868.09867036014, 41052.881159554905, -6563.009049532436, -33365.300883472424, -15520.178492369847, -13.17872004996743, 61057.96981109295, 6439.382637238593, 110522.58412481051, 19003.46159849671, 122979.1057176647, 28125.952847808556, 53930.63960309496, 31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523], "policy_policy_rl_reward": [61514.48242639186, 34391.05942767495, 77578.80225527586, 200680.09787859733, 14318.773151405048, -8517.91600763403, -26266.32758269457, -18295.443727925875, 11928.24043512439, 36143.5496689835, 7729.745067608983, 108190.53374771522, 13799.693468932888, 213595.23361049988, 34516.23681317556, 79276.77986319404, 63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.249779295237244, "mean_inference_ms": 0.7641051173682064, "mean_action_processing_ms": 0.1187856368654336, "mean_env_wait_ms": 2.4204828002853422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007928013801574707, "StateBufferConnector_ms": 0.0008028149604797363, "ViewRequirementAgentConnector_ms": 0.01959174871444702}, "num_episodes": 16, "episode_return_max": 1008228.7254599353, "episode_return_min": -138135.72055330293, "episode_return_mean": 257593.38769045315, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.5344656992917, "num_env_steps_trained_throughput_per_sec": 264.5344656992917, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 14805.616, "restore_workers_time_ms": 0.071, "training_step_time_ms": 14805.495, "sample_time_ms": 14265.733, "learn_time_ms": 525.633, "learn_throughput": 7609.871, "synch_weights_time_ms": 7.207}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "ae48a_00000", "date": "2025-10-28_12-17-00", "timestamp": 1761671820, "time_this_iter_s": 15.124549150466919, "time_total_s": 524.6301352977753, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7060>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 524.6301352977753, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.568181818181817, "ram_util_percent": 84.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3107123374938965, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.880900537967682, "policy_loss": -0.025026033059111795, "vf_loss": 9.95555438697338, "vf_explained_var": -2.4398788809776308e-06, "kl": 0.016681873402990453, "entropy": 5.7134674996137615, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 283175.0898954023, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -33690.49518125557, "policy_mm": -33026.668997312416, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 256760.47313760014, "policy_mm": 189759.69366199392, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 61798.48048799914, "policy_mean": 67638.82374302532, "policy_mm": 61160.6593785467, "policy_rl": 92577.12628583118}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 61798.48046875, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 67638.828125, "('mean_0', 'policy_mean')_total_reward_min": -33690.49609375, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 61160.66015625, "('mm_0', 'policy_mm')_total_reward_min": -33026.66796875, "('mm_0', 'policy_mm')_total_reward_max": 189759.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 92577.1328125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [180571.12026166244, 89658.35461292001, 191492.08594916423, 189833.84761135196, 102161.37346102214, 361738.9089399077, 142214.3003408974, 241490.05415902712, 216985.3894069605, 45774.09745532889, 894540.0959821036, -32043.359264245006, 360543.27606888436, -98447.61121822878, 268355.5467277883, 387549.3026913409, 405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [47875.15219433613, -3777.081497160687, 21839.03792048787, 49850.57687737026, 27418.262095728922, 92077.47435712317, 21949.44276782442, 55500.896104299296, 41138.37765405653, -4136.597472007411, 228900.56276632973, -5714.991930851222, 119121.0386398634, -29384.330372200515, 63714.58784354262, 99920.88442456866, 114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766], "policy_policy_mean_reward": [38002.62763396657, 29806.78224096977, 58599.87791747834, 39221.1655716139, 25310.593900745764, 95954.84914614123, 48005.453787648905, 76534.86745108393, 47678.951719104094, 18240.542641511962, 161019.39738723112, 9943.558170484794, 91487.71789183504, -32540.947857613523, 64444.0258838399, 71373.50121290571, 74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233], "policy_policy_mm_reward": [31626.151159361056, 47321.70013985319, 51720.49973959775, 54865.82923261363, 33063.47330809192, 84323.93413214272, 7098.423543258003, 55215.05029029152, 52488.98552929799, 17889.67834977682, 189378.32092743512, -19361.442670132798, 32044.920316050397, -27028.5994104747, 57952.62706150532, 95100.96716390178, 99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734], "policy_policy_rl_reward": [63067.18927399855, 16306.953729257997, 59332.67037160036, 45896.27592975399, 16369.044156455762, 89382.6513045003, 65160.980242166086, 54239.240313352486, 75679.07450450167, 13780.473936047509, 315241.81490110804, -16910.482833745802, 117889.59922113588, -9493.733577939962, 82244.30593890058, 121153.94988996469, 117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24973670211596877, "mean_inference_ms": 0.7639692139836829, "mean_action_processing_ms": 0.11877326748865835, "mean_env_wait_ms": 2.4203405222375407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007959604263305664, "StateBufferConnector_ms": 0.0008087158203125, "ViewRequirementAgentConnector_ms": 0.019763171672821045}, "num_episodes": 16, "episode_return_max": 1008228.7254599353, "episode_return_min": -138135.72055330293, "episode_return_mean": 283175.0898954023, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.34195468831314, "num_env_steps_trained_throughput_per_sec": 267.34195468831314, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 14816.699, "restore_workers_time_ms": 0.073, "training_step_time_ms": 14816.577, "sample_time_ms": 14272.979, "learn_time_ms": 530.939, "learn_throughput": 7533.816, "synch_weights_time_ms": 5.5}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "ae48a_00000", "date": "2025-10-28_12-17-15", "timestamp": 1761671835, "time_this_iter_s": 14.968539953231812, "time_total_s": 539.5986752510071, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7420>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 539.5986752510071, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 23.89047619047619, "ram_util_percent": 84.18095238095236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.333481788635254, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.887906733155251, "policy_loss": -0.024373615640797652, "vf_loss": 9.961576807498933, "vf_explained_var": -3.2180920243263245e-06, "kl": 0.01537054721911788, "entropy": 5.621321420371532, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 1008228.7254599353, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 314024.6857524577, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -33690.49518125557, "policy_mm": -33026.668997312416, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 334197.9572398397, "policy_mean": 256760.47313760014, "policy_mm": 207556.61491432047, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 68619.49955554194, "policy_mean": 73430.84576711371, "policy_mm": 68569.25180920068, "policy_rl": 103405.08862060144}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 68619.5, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 334197.96875, "('mean_0', 'policy_mean')_total_reward_mean": 73430.84375, "('mean_0', 'policy_mean')_total_reward_min": -33690.49609375, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 68569.25, "('mm_0', 'policy_mm')_total_reward_min": -33026.66796875, "('mm_0', 'policy_mm')_total_reward_max": 207556.609375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 103405.078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [405590.4917942369, -52443.37824955622, 151418.13032116205, 415592.03420781554, 703511.0164354228, 367147.1637533334, 506345.2425479665, 168240.6710233403, 1008228.7254599353, 392207.8391047166, 12539.592427553382, 301989.98916644615, 196314.55976832935, 525294.9215651348, -29300.284383928178, 185712.46984410408, 339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [114873.8715343411, -21367.177214591145, 31587.870287157515, 109866.20967837615, 189222.29410232732, 52381.35458542625, 103265.56782840891, 55735.558358009366, 334197.9572398397, 87374.60409256205, -18731.53292696244, 52588.80031875283, 33733.98141565068, 133637.40657386632, -24759.780587260717, 35437.93348542663, 70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925], "policy_policy_mean_reward": [74128.60104398959, -17152.36655759887, 27436.870087001003, 85160.20687140159, 157863.20218834892, 145479.90721313655, 158851.13305280497, 28049.135797102543, 180164.00186506647, 83030.69719483428, 10169.757720678628, 71730.89380767911, 28449.109327446844, 198187.90148114864, 6700.97078225224, 44959.40209341932, 61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114], "policy_policy_mm_reward": [99477.33985949497, -6773.89969739717, 45244.91412852636, 99883.83952604368, 177128.66914671074, 56368.84181786041, 83203.84376802352, 54840.13551685521, 185124.21588854602, 107312.13458837979, 200.46843571051633, 69270.985914026, 64687.462539304506, 98067.33538330019, -2034.1526620535487, 51380.374450650044, 86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557], "policy_policy_rl_reward": [117110.679356411, -7149.934779969024, 47148.47581847747, 120681.77813199394, 179296.8509980351, 112917.06013691021, 161024.6978987291, 29615.841351373176, 308742.5504664823, 114490.40322894041, 20900.899198126706, 108399.30912598796, 69444.00648592714, 95402.27812681964, -9207.321916866178, 53934.759814608, 121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.249726625717414, "mean_inference_ms": 0.7639129598956123, "mean_action_processing_ms": 0.11876836211718786, "mean_env_wait_ms": 2.420267224557748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007957816123962402, "StateBufferConnector_ms": 0.0008037090301513672, "ViewRequirementAgentConnector_ms": 0.019730806350708008}, "num_episodes": 16, "episode_return_max": 1008228.7254599353, "episode_return_min": -138135.72055330293, "episode_return_mean": 314024.6857524577, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.8727813612481, "num_env_steps_trained_throughput_per_sec": 266.8727813612481, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 14866.402, "restore_workers_time_ms": 0.073, "training_step_time_ms": 14866.277, "sample_time_ms": 14316.905, "learn_time_ms": 536.134, "learn_throughput": 7460.828, "synch_weights_time_ms": 5.906}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "ae48a_00000", "date": "2025-10-28_12-17-30", "timestamp": 1761671850, "time_this_iter_s": 14.992207050323486, "time_total_s": 554.5908823013306, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68cfe0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 554.5908823013306, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.423809523809524, "ram_util_percent": 82.91904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.182929277420044, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.878895235061645, "policy_loss": -0.02768506788270315, "vf_loss": 9.958017390966415, "vf_explained_var": -6.687641143798828e-06, "kl": 0.015223832399499464, "entropy": 5.828781071305275, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 294118.93654455687, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -33690.49518125557, "policy_mm": -33026.668997312416, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 256760.47313760014, "policy_mm": 207556.61491432047, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 63820.43293679975, "policy_mean": 68136.3537722745, "policy_mm": 63987.550515414274, "policy_rl": 98174.5993200684}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 63820.43359375, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 68136.3515625, "('mean_0', 'policy_mean')_total_reward_min": -33690.49609375, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 63987.55078125, "('mm_0', 'policy_mm')_total_reward_min": -33026.66796875, "('mm_0', 'policy_mm')_total_reward_max": 207556.609375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 98174.609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [339639.39543287014, 621572.7259309827, 662639.394051377, 175101.8607493734, 11116.748387127574, -41920.42594573595, 8102.7079964210925, 93968.38102872114, 581181.1471591227, 111278.80814655188, 370314.9072958695, 280951.35060544655, 143315.76609599483, 232448.68589941438, 346918.22713852907, 41045.90741387146, 394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [70692.61985237202, 181167.25630857417, 98921.77789162044, 46309.73859128573, -5748.546909931653, -12212.705510068874, -13739.288141876335, 19961.919697549958, 93958.17388746567, 21969.12222479143, 94782.65993036416, 68765.30613948184, 27455.359347231748, 26946.700797148, 107538.58107800594, 30678.500345671953, 49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363], "policy_policy_mean_reward": [61583.394773550935, 85928.73368913507, 178087.61425766317, 25867.842129961427, 14478.994025395774, -18906.145961903036, 7441.5291360901265, 6556.69041075414, 118907.31557528704, 11979.455456067508, 89814.75688175266, 76588.93517520464, 44647.609686975746, 34737.58989219126, 78394.02091569899, 3848.4864795076746, 110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934], "policy_policy_mm_reward": [86107.52239269316, 141165.98256251073, 188639.93906230366, 44565.39539092951, -10920.560714295458, -24167.438944898073, -12174.031422330077, 31024.941800149343, 179554.4037473201, 24715.239381698433, 73278.86357622176, 50069.34399000374, 39569.98688206357, 74132.7209269711, 83220.08748599185, -209.27305464290973, 80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445], "policy_policy_rl_reward": [121255.85841425443, 213310.75337076234, 196990.0628397898, 58358.88463719675, 13306.86198595896, 13365.864471134155, 26574.49842453745, 36424.82912026757, 188761.25394904995, 52614.9910839945, 112438.62690753069, 85527.76530075677, 31642.810179723954, 96631.6742831039, 77765.53765883304, 6728.193643334944, 153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24987707320279762, "mean_inference_ms": 0.764318504373382, "mean_action_processing_ms": 0.11881592953479636, "mean_env_wait_ms": 2.4209826732049344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008276104927062988, "StateBufferConnector_ms": 0.0008220672607421875, "ViewRequirementAgentConnector_ms": 0.02035534381866455}, "num_episodes": 16, "episode_return_max": 972206.0269597644, "episode_return_min": -138135.72055330293, "episode_return_mean": 294118.93654455687, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.69919721662401, "num_env_steps_trained_throughput_per_sec": 221.69919721662401, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15208.772, "restore_workers_time_ms": 0.076, "training_step_time_ms": 15208.635, "sample_time_ms": 14479.661, "learn_time_ms": 715.256, "learn_throughput": 5592.404, "synch_weights_time_ms": 5.868}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "ae48a_00000", "date": "2025-10-28_12-17-48", "timestamp": 1761671868, "time_this_iter_s": 18.047827005386353, "time_total_s": 572.6387093067169, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d1c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 572.6387093067169, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 42.25416666666667, "ram_util_percent": 84.34583333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2832105159759521, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.874733027815818, "policy_loss": -0.0218493216088973, "vf_loss": 9.947481906414032, "vf_explained_var": 3.5688281059265136e-07, "kl": 0.014835899035552002, "entropy": 5.757574911415577, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 303461.5157548795, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -33690.49518125557, "policy_mm": -36251.93996991306, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 256760.47313760014, "policy_mm": 221937.9336165237, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 66753.52027067254, "policy_mean": 70387.98295100105, "policy_mm": 66178.1285741991, "policy_rl": 100141.88395900681}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 66753.5234375, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 70387.984375, "('mean_0', 'policy_mean')_total_reward_min": -33690.49609375, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 66178.1328125, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 100141.8828125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [394171.4788407502, 263863.2989810121, 354824.5245212278, 64552.28795728394, 251469.52815137003, 158441.17884763484, 250141.0015300368, 198110.25820903922, 10597.237426769485, 367460.48212170246, 283735.0891438292, 683985.7367517212, 150485.95092042966, 628367.2841381838, 303225.69997339306, -99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [49159.48009071409, 51224.82255828505, 82648.96410532783, 5866.678844537511, 89068.78048297463, 23991.17036475472, 26410.896566427113, 66619.34417732364, -5105.633837472375, 85616.03779400507, 72298.43854239302, 176509.72804085087, 39188.04224495215, 98198.99635628193, 59638.20470537411, -28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941], "policy_policy_mean_reward": [110312.74840873954, 68214.92165263336, 84849.30261892872, 27047.628241584294, 47995.61543544444, 58712.684485418285, 62008.50736445229, 42864.70065134533, -1180.7313927461255, 80716.3447020481, 61966.395552903836, 149166.76330139712, 28747.215452883003, 174408.29623848462, 45025.004777893766, -10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974], "policy_policy_mm_reward": [80958.07272812612, 71229.63305488873, 83415.68451977448, 11450.862558111505, 47907.20744498166, 20325.72561810496, 78130.35445042946, 43815.70693660209, 21156.113493476914, 73907.19725098577, 62342.240987291305, 130298.11840525254, 26824.139328423593, 107637.73926051377, 108901.7280149979, -31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566], "policy_policy_rl_reward": [153741.17761317006, 73193.92171520504, 103910.57327719702, 20187.118313050607, 66497.9247879698, 55411.59837935695, 83591.24314872791, 44810.50644376793, -4272.510836489012, 127220.90237466345, 87128.01406124109, 228011.1270042221, 55726.55389417071, 248122.25228290402, 89660.76247512682, -29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2501147764730957, "mean_inference_ms": 0.7649746561058535, "mean_action_processing_ms": 0.11889921738840517, "mean_env_wait_ms": 2.4221449302534315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008257627487182617, "StateBufferConnector_ms": 0.0008245110511779785, "ViewRequirementAgentConnector_ms": 0.020431160926818848}, "num_episodes": 16, "episode_return_max": 972206.0269597644, "episode_return_min": -138135.72055330293, "episode_return_mean": 303461.5157548795, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.10059320904114, "num_env_steps_trained_throughput_per_sec": 253.10059320904114, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15349.728, "restore_workers_time_ms": 0.066, "training_step_time_ms": 15349.6, "sample_time_ms": 14615.759, "learn_time_ms": 718.804, "learn_throughput": 5564.799, "synch_weights_time_ms": 6.54}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "ae48a_00000", "date": "2025-10-28_12-18-04", "timestamp": 1761671884, "time_this_iter_s": 15.808096885681152, "time_total_s": 588.4468061923981, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68de40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 588.4468061923981, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 36.082608695652176, "ram_util_percent": 84.2608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2051289081573486, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.885310560464859, "policy_loss": -0.021790136030176654, "vf_loss": 9.958938425779342, "vf_explained_var": 1.1201947927474975e-06, "kl": 0.0164060746764791, "entropy": 5.922045573592186, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -138135.72055330293, "episode_reward_mean": 281549.03653896047, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39761.78597337087, "policy_mean": -33690.49518125557, "policy_mm": -36251.93996991306, "policy_rl": -31656.7704013639}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 256760.47313760014, "policy_mm": 221937.9336165237, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 61847.20303639685, "policy_mean": 65440.20151812263, "policy_mm": 62349.58533931405, "policy_rl": 91912.04664512699}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 61847.203125, "('mom_0', 'policy_mom')_total_reward_min": -39761.78515625, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 65440.1953125, "('mean_0', 'policy_mean')_total_reward_min": -33690.49609375, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 62349.58984375, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 91912.046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -31656.76953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [-99466.56528646653, 8561.777809285224, 153476.8764157351, 353447.37799912045, -138135.72055330293, 616450.8322052346, 840811.796787018, -57430.09558188829, 257441.6411519859, 418251.8574250256, 18420.143903065353, 133268.35642409144, 107950.2946128392, 376424.4783802373, 217942.53687644267, 895723.2675646846, -70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-28206.653939009124, -17544.26956623818, 29784.005678853126, 63911.963131658835, -39761.78597337087, 102167.10315770129, 165822.29121480844, 279.68934463489074, 63368.56148076566, 113787.26459115282, 20840.56824724562, 36853.38134478452, 3259.6912309845256, 79465.46802374162, 60035.93437217565, 143364.7857990866, -23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743], "policy_policy_mean_reward": [-10175.578156599848, 3329.9922003192537, 36833.2911520398, 110380.92471444108, -33690.49518125557, 130614.97905873907, 255389.69422391706, -22397.47635610397, 49209.35310263079, 122386.58642331515, -12168.24427906202, 39989.88021792104, 40406.29005421382, 110263.96990485414, 51976.9763430745, 234554.8095992932, -7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258], "policy_policy_mm_reward": [-31952.24195211984, -13452.227314992631, 33746.28574181741, 78357.81195229628, -33026.668997312416, 171714.731836749, 189759.69366199392, -26800.049183289982, 70873.18397752006, 91584.66562364183, -12316.848998928772, 15865.393399445009, 41779.49973926995, 57951.33784836835, 37628.844584114, 185589.68519085608, -31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326], "policy_policy_rl_reward": [-29132.091238737612, 36228.282490196674, 53113.29384302475, 100796.67820072395, -31656.7704013639, 211954.01815204477, 229840.11768629967, -8512.259387129187, 73990.54259106964, 90493.3407869153, 22064.668933810583, 40559.701461940516, 22504.813588370915, 128743.70260327333, 68300.7815770786, 332213.9869754488, -7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25040993665416844, "mean_inference_ms": 0.765800153124054, "mean_action_processing_ms": 0.11900231892093656, "mean_env_wait_ms": 2.423768847511941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008432269096374512, "StateBufferConnector_ms": 0.0008393526077270508, "ViewRequirementAgentConnector_ms": 0.02065807580947876}, "num_episodes": 15, "episode_return_max": 972206.0269597644, "episode_return_min": -138135.72055330293, "episode_return_mean": 281549.03653896047, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.80354116288433, "num_env_steps_trained_throughput_per_sec": 252.80354116288433, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15440.592, "restore_workers_time_ms": 0.072, "training_step_time_ms": 15440.46, "sample_time_ms": 14706.923, "learn_time_ms": 718.854, "learn_throughput": 5564.415, "synch_weights_time_ms": 5.576}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "ae48a_00000", "date": "2025-10-28_12-18-20", "timestamp": 1761671900, "time_this_iter_s": 15.825934886932373, "time_total_s": 604.2727410793304, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7ce0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 604.2727410793304, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.84090909090908, "ram_util_percent": 84.32272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2309061288833618, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.881051242351532, "policy_loss": -0.025023130857152864, "vf_loss": 9.958189523220062, "vf_explained_var": 2.094730734825134e-06, "kl": 0.015656612281532194, "entropy": 5.916066117584705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -118568.67133537735, "episode_reward_mean": 268792.10776333476, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -33516.68888443948, "policy_mm": -36251.93996991306, "policy_rl": -22844.340362537452}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 256760.47313760014, "policy_mm": 221937.9336165237, "policy_rl": 405415.0485657768}, "policy_reward_mean": {"policy_mom": 59117.1118890044, "policy_mean": 61199.388867718575, "policy_mm": 61063.57512339892, "policy_rl": 87412.03188321291}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 59117.11328125, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 61199.38671875, "('mean_0', 'policy_mean')_total_reward_min": -33516.6875, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 61063.57421875, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 87412.0390625, "('rl_trader_0', 'policy_rl')_total_reward_min": -22844.33984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 405415.0625}, "hist_stats": {"episode_reward": [-70451.35881233413, 11793.342894324662, 728929.0447792774, 680011.2699287959, 240564.64697091712, 284439.5258247199, 967695.8659081818, 254910.53117552193, 118249.29388748296, 823263.2519135976, 789390.1629943487, 195966.64981711906, -71243.9970042417, -44415.31476129893, 308076.1597824202, 208344.80636863064, 171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-23560.843808680096, -16851.496569906405, 185074.12653843194, 132242.82247432097, 67358.90107432277, 84822.0885293343, 185381.57875209692, 62756.63008890577, 34053.50550262878, 171236.65623332807, 148751.96726711953, 25789.290941693776, -23070.823152929148, -17891.05735875542, 82228.76776983179, 80368.42842533853, 27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555], "policy_policy_mean_reward": [-7870.515280563741, 14469.440184069112, 163140.28570666234, 181409.23444851744, 51100.07586399605, 32251.44663635221, 197308.6707381187, 95474.60515616472, 29170.343545578366, 216194.0521586322, 166371.87902436435, 42447.06049776606, -9592.573891547716, -2130.3121240764644, 77774.47415512076, 27588.68066429362, 42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816], "policy_policy_mm_reward": [-31317.9021508989, -6546.791344012676, 159479.73572747875, 149007.6878782489, 57440.53153979523, 56789.432963238694, 179590.56785219017, 41906.72811727316, 27365.694186236728, 151975.23110915118, 127891.01038999096, 56576.44263277005, -19972.455154793493, -4938.863981409845, 81278.01705124817, 45126.93585505252, 36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537], "policy_policy_rl_reward": [-7702.097572191449, 20722.190624174476, 221234.89680670423, 217351.5251277083, 64665.1384928031, 110576.55769579431, 405415.0485657768, 54772.56781317822, 27659.75065303901, 283857.31241248717, 346375.3063128738, 71153.85574488911, -18608.144804971158, -19455.081297057368, 66794.9008062198, 55260.761423945856, 65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506966208872351, "mean_inference_ms": 0.7666186706166789, "mean_action_processing_ms": 0.11910746760917436, "mean_env_wait_ms": 2.4253699992441606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008281469345092773, "StateBufferConnector_ms": 0.0008214712142944336, "ViewRequirementAgentConnector_ms": 0.020372748374938965}, "num_episodes": 16, "episode_return_max": 972206.0269597644, "episode_return_min": -118568.67133537735, "episode_return_mean": 268792.10776333476, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.1271739528485, "num_env_steps_trained_throughput_per_sec": 267.1271739528485, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 15456.471, "restore_workers_time_ms": 0.085, "training_step_time_ms": 15456.326, "sample_time_ms": 14725.394, "learn_time_ms": 716.833, "learn_throughput": 5580.101, "synch_weights_time_ms": 5.272}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "ae48a_00000", "date": "2025-10-28_12-18-35", "timestamp": 1761671915, "time_this_iter_s": 14.977532863616943, "time_total_s": 619.2502739429474, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a520>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 619.2502739429474, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.318181818181817, "ram_util_percent": 84.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3121799230575562, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.882205671072006, "policy_loss": -0.02267131764674559, "vf_loss": 9.957160586118698, "vf_explained_var": 1.8203631043434142e-06, "kl": 0.015838081129004422, "entropy": 5.941077198088169, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -118568.67133537735, "episode_reward_mean": 249965.3971677663, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -33516.68888443948, "policy_mm": -36251.93996991306, "policy_rl": -22844.340362537452}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 256760.47313760014, "policy_mm": 221937.9336165237, "policy_rl": 384122.3359590411}, "policy_reward_mean": {"policy_mom": 55031.870908579454, "policy_mean": 55601.899659952986, "policy_mm": 58695.31179105482, "policy_rl": 80636.31480817904}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55031.86328125, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 55601.8984375, "('mean_0', 'policy_mean')_total_reward_min": -33516.6875, "('mean_0', 'policy_mean')_total_reward_max": 256760.46875, "('mm_0', 'policy_mm')_total_reward_mean": 58695.30859375, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 80636.3125, "('rl_trader_0', 'policy_rl')_total_reward_min": -22844.33984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 384122.34375}, "hist_stats": {"episode_reward": [171219.71725818558, 179759.1600758273, -22920.352809489596, 931556.2138532287, 387318.9204896878, 883179.9329704025, 664096.9897123291, 247724.0207018019, 32648.805704959297, 174238.12714960563, 55236.607836384785, 334223.68483438983, 132504.65508075847, 179810.86853098872, 521443.39164941444, 727425.0189789378, 972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [27231.707860732342, 38793.90696427967, -12699.415380719112, 172816.31509527803, 103467.65570322766, 140771.79752516173, 150506.04292742035, 60980.369985857746, -986.090483679779, 42061.365971406514, 11085.71508133439, 60936.1795409992, 20208.362851900314, 34261.998151678396, 133873.72319633845, 188082.5401773912, 277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586], "policy_policy_mean_reward": [42170.05487164981, 32446.833586866742, -3.3540374053495388, 256760.47313760014, 63391.95755623233, 237241.27963248178, 127444.73340560819, 50602.732823554776, 507.83441475470363, 41399.8433193873, 20404.58002038665, 76010.10141373739, 27747.409637701545, 44829.01320006472, 119552.2486700035, 124083.03483556713, 158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935], "policy_policy_mm_reward": [36650.61653033248, 68540.81357233845, -2819.847329638032, 117857.08966130961, 82925.49110813734, 179885.1778094053, 114847.80655231982, 67134.45074466048, 25274.954987940782, 34624.048070177465, 8493.615355869735, 76899.61077774336, 62753.859628477134, 46495.79823022499, 103831.04638711154, 207556.61491432047, 189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104], "policy_policy_rl_reward": [65167.337995470625, 39977.605952342594, -7397.736061726993, 384122.3359590411, 137533.81612209004, 325281.6780033541, 271298.4068269806, 69006.46714772904, 7852.106785943605, 56152.86978863407, 15252.697378794026, 120377.79310190954, 21795.02296267944, 54224.058949020706, 164186.37339596133, 207702.82905165912, 346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509781967010335, "mean_inference_ms": 0.7674271371564007, "mean_action_processing_ms": 0.11921537351990591, "mean_env_wait_ms": 2.4271111850752627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008345246315002441, "StateBufferConnector_ms": 0.0008252263069152832, "ViewRequirementAgentConnector_ms": 0.020405173301696777}, "num_episodes": 16, "episode_return_max": 972206.0269597644, "episode_return_min": -118568.67133537735, "episode_return_mean": 249965.3971677663, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.12595577549064, "num_env_steps_trained_throughput_per_sec": 264.12595577549064, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15468.498, "restore_workers_time_ms": 0.053, "training_step_time_ms": 15468.398, "sample_time_ms": 14751.658, "learn_time_ms": 703.402, "learn_throughput": 5686.651, "synch_weights_time_ms": 5.244}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "ae48a_00000", "date": "2025-10-28_12-18-50", "timestamp": 1761671930, "time_this_iter_s": 15.147601842880249, "time_total_s": 634.3978757858276, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a980>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 634.3978757858276, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.02380952380953, "ram_util_percent": 84.13809523809523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3573077917099, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.890924987196922, "policy_loss": -0.02043476529943291, "vf_loss": 9.960751444101334, "vf_explained_var": -4.219077527523041e-06, "kl": 0.015429596418562336, "entropy": 5.633502547442913, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 972206.0269597644, "episode_reward_min": -118568.67133537735, "episode_reward_mean": 240877.36393621363, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -33516.68888443948, "policy_mm": -36251.93996991306, "policy_rl": -22844.340362537452}, "policy_reward_max": {"policy_mom": 277903.4427559278, "policy_mean": 226202.28564054586, "policy_mm": 221937.9336165237, "policy_rl": 357572.0954585387}, "policy_reward_mean": {"policy_mom": 54679.99031804648, "policy_mean": 52989.35348432341, "policy_mm": 54701.68462315861, "policy_rl": 78506.3355106851}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54679.98828125, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 277903.4375, "('mean_0', 'policy_mean')_total_reward_mean": 52989.3515625, "('mean_0', 'policy_mean')_total_reward_min": -33516.6875, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 54701.6796875, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 78506.3359375, "('rl_trader_0', 'policy_rl')_total_reward_min": -22844.33984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 357572.09375}, "hist_stats": {"episode_reward": [972206.0269597644, 362955.1418260044, 668880.5112057701, 529459.8544831997, 141342.73126672246, 317068.251015396, 259060.13623498866, -55698.6974756267, 290576.892602462, 10974.03482286822, 625100.1078543157, 126979.77584346806, 254816.55502312043, -20632.51175766446, 307273.3009915449, 197227.92416965993, -26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [277903.4427559278, 57864.82391562672, 160608.30191589904, 137082.53699159046, 33154.08862273925, 48605.916319752454, 67927.1294269287, -7854.41294042455, 94369.96925524816, 12077.842551147534, 123042.99118295226, 52965.723534454846, 74921.1034011257, -3961.66310253164, 74194.3856734686, 32454.099437018373, -10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222], "policy_policy_mean_reward": [158788.41362498378, 85618.04063683316, 128084.98987072644, 120574.20612899709, 59396.705472999114, 83454.04841839308, 52643.10254806848, -9267.652793975363, 79513.30328919864, -6909.966944099861, 182681.4938080235, 28677.141894553457, 56973.46004344334, -8522.065042580052, 67437.1855815664, 41412.18494504515, -6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805], "policy_policy_mm_reward": [189329.2717757555, 127840.15856643567, 152443.1348414924, 87091.70236529947, 20058.510870733557, 83631.159094743, 66132.77692867038, -32081.114962464442, 32096.06840463925, -4302.757486013509, 156292.53821990764, 28714.68396715965, 51788.21791711036, -2948.458710634171, 78657.46427475566, 41276.35420931173, -13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424], "policy_policy_rl_reward": [346184.8988030972, 91632.11870710888, 227744.084577652, 184711.40899731257, 28733.42630025065, 101377.12718250771, 72357.12733132127, -6495.516778762411, 84597.55165337549, 10108.91670183411, 163083.08464343142, 16622.22644730007, 71133.77366144123, -5200.324901918659, 86984.265461754, 82085.28557828453, 3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512619660731046, "mean_inference_ms": 0.7682552261926725, "mean_action_processing_ms": 0.1193266257635442, "mean_env_wait_ms": 2.4288605669582033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008409023284912109, "StateBufferConnector_ms": 0.0008213520050048828, "ViewRequirementAgentConnector_ms": 0.020445823669433594}, "num_episodes": 16, "episode_return_max": 972206.0269597644, "episode_return_min": -118568.67133537735, "episode_return_mean": 240877.36393621363, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.09802961997576, "num_env_steps_trained_throughput_per_sec": 266.09802961997576, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15469.057, "restore_workers_time_ms": 0.059, "training_step_time_ms": 15468.918, "sample_time_ms": 14750.575, "learn_time_ms": 704.192, "learn_throughput": 5680.267, "synch_weights_time_ms": 5.582}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "ae48a_00000", "date": "2025-10-28_12-19-05", "timestamp": 1761671945, "time_this_iter_s": 15.039355754852295, "time_total_s": 649.4372315406799, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68dbc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 649.4372315406799, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.99545454545455, "ram_util_percent": 84.13181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.204108476638794, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.877445322275161, "policy_loss": -0.028090572383371183, "vf_loss": 9.955611681938171, "vf_explained_var": -5.13419508934021e-06, "kl": 0.015599959129667846, "entropy": 5.709579716622829, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 916285.9609462376, "episode_reward_min": -118568.67133537735, "episode_reward_mean": 225029.87267389565, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -33516.68888443948, "policy_mm": -36251.93996991306, "policy_rl": -22844.340362537452}, "policy_reward_max": {"policy_mom": 238180.03586141102, "policy_mean": 226202.28564054586, "policy_mm": 221937.9336165237, "policy_rl": 357572.0954585387}, "policy_reward_mean": {"policy_mom": 50768.99888198839, "policy_mean": 49746.27264298223, "policy_mm": 51124.797574027165, "policy_rl": 73389.8035748979}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50768.99609375, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 238180.03125, "('mean_0', 'policy_mean')_total_reward_mean": 49746.26953125, "('mean_0', 'policy_mean')_total_reward_min": -33516.6875, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 51124.796875, "('mm_0', 'policy_mm')_total_reward_min": -36251.94140625, "('mm_0', 'policy_mm')_total_reward_max": 221937.9375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73389.8046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -22844.33984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 357572.09375}, "hist_stats": {"episode_reward": [-26915.694042530326, 271044.07097203727, 582373.010349023, 155782.23161045872, -27215.12421759853, 656464.0416134271, 207419.01830855792, 117118.88139333358, 244007.66389342298, 135501.42518280348, 729099.8231716527, 850232.7018029845, 573696.2496516574, 119174.79151194147, -67138.65907859406, 351590.8740274459, 133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-10083.243442972942, 40011.82026367563, 177863.24837297088, 28607.35391534212, -16004.006951044363, 188122.53538212014, 40626.47912065657, 27964.846869820798, 53293.84424347531, 23409.429468315317, 178235.3231243965, 152208.28772968551, 128296.07482533951, 23260.8209404318, -10716.258220844327, 102447.10035903435, 52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898], "policy_policy_mean_reward": [-6612.929175281586, 49757.080143171734, 114577.73988599925, 26416.30556783842, 1529.792315424934, 111033.60504014515, 67199.44001312873, 42982.57406565191, 61989.21154751103, 38870.7008589419, 126613.33597945291, 173607.8165381961, 86558.32875037382, 40575.20751507239, -16190.145079115835, 82174.83790225294, 23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773], "policy_policy_mm_reward": [-13353.411984480532, 62873.35738589824, 130098.17457007017, 49973.788512477244, -3636.4611158105445, 148296.92828258395, 48865.04317967043, 19845.472886989028, 70028.8006508266, 40092.10374467142, 184025.28252474737, 221937.9336165237, 170467.1837021542, 29755.620745340795, -36251.93996991306, 72179.52871907537, 27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095], "policy_policy_rl_reward": [3133.8905602047125, 118401.81317929176, 159833.84751998336, 50784.78361480111, -9104.448466168678, 209010.97290857727, 50728.055995102055, 26325.987570871748, 58695.80745161004, 33129.19111087487, 240225.88154305532, 302478.6639185796, 188374.66237378944, 25583.142311096468, -3980.3158087208235, 94789.40704708338, 30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25143839921148375, "mean_inference_ms": 0.7687406175689577, "mean_action_processing_ms": 0.11939866618401895, "mean_env_wait_ms": 2.430053349768945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008026361465454102, "StateBufferConnector_ms": 0.0007947683334350586, "ViewRequirementAgentConnector_ms": 0.01980292797088623}, "num_episodes": 16, "episode_return_max": 916285.9609462376, "episode_return_min": -118568.67133537735, "episode_return_mean": 225029.87267389565, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.00287238046093, "num_env_steps_trained_throughput_per_sec": 267.00287238046093, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15487.225, "restore_workers_time_ms": 0.065, "training_step_time_ms": 15487.081, "sample_time_ms": 14767.848, "learn_time_ms": 705.981, "learn_throughput": 5665.876, "synch_weights_time_ms": 4.914}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "ae48a_00000", "date": "2025-10-28_12-19-20", "timestamp": 1761671960, "time_this_iter_s": 14.984379768371582, "time_total_s": 664.4216113090515, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68cf40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 664.4216113090515, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.442857142857143, "ram_util_percent": 84.43809523809526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4786300659179688, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.877965077757835, "policy_loss": -0.026718238434114028, "vf_loss": 9.954550224542619, "vf_explained_var": -6.659701466560364e-06, "kl": 0.0185912790615478, "entropy": 5.823299510776996, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 916285.9609462376, "episode_reward_min": -118568.67133537735, "episode_reward_mean": 231580.8986733373, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -33516.68888443948, "policy_mm": -35309.05016361928, "policy_rl": -22844.340362537452}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 226202.28564054586, "policy_mm": 220027.67201738965, "policy_rl": 357572.0954585387}, "policy_reward_mean": {"policy_mom": 52790.459018031346, "policy_mean": 52932.90045028381, "policy_mm": 51307.848576771336, "policy_rl": 74549.69062825087}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52790.4609375, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 52932.90625, "('mean_0', 'policy_mean')_total_reward_min": -33516.6875, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 51307.85546875, "('mm_0', 'policy_mm')_total_reward_min": -35309.05078125, "('mm_0', 'policy_mm')_total_reward_max": 220027.671875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 74549.703125, "('rl_trader_0', 'policy_rl')_total_reward_min": -22844.33984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 357572.09375}, "hist_stats": {"episode_reward": [133369.53227895408, 272229.41151568736, 145041.0790263282, 225270.8020768856, 218855.87204171074, 340108.9124056883, 323637.99213196087, -5015.613520742381, 334120.3495453925, 479348.3352159821, 92080.3674827898, 3412.263712458482, -118568.67133537735, 194706.43507378106, 291291.5597719305, 16133.74640376379, 101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [52330.146943843574, 47655.31991964007, 48493.137363096255, 31199.013638523473, 63929.80720942941, 68007.97099970123, 60193.815234655514, -889.1234221937584, 89886.54741823132, 125868.94591236838, 17694.246815265436, -12201.737323437137, -28685.32902374514, 28288.072807352055, 58159.81369554308, -7487.562286423656, 11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633], "policy_policy_mean_reward": [23278.979705003876, 82444.82850023804, 29360.5241102636, 61442.895951930484, 33177.598996939974, 80745.17232930382, 78230.80378686986, -7380.856950685705, 93949.54672345736, 129455.31814673138, 17827.546456532258, 4665.956702756077, -31729.951785475365, 55520.944133689525, 69872.51607826144, 213.57739161450166, 25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815], "policy_policy_mm_reward": [27705.013917404896, 43969.304362519346, 13470.109822009908, 68096.21471710759, 65148.328039463566, 101451.11205445779, 79790.28425990854, -527.5822499334419, 81441.24079541933, 114011.80444417542, 13398.909436852871, 5844.147082249621, -35309.05016361928, 76064.8780590832, 63365.576246054865, 22005.907830656193, 21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793], "policy_policy_rl_reward": [30055.391712701847, 98159.95873328953, 53717.30773095849, 64532.677769324066, 56600.137795878174, 89904.65702222542, 105423.08885052757, 3781.949102070609, 68843.01460828481, 110012.26671270731, 43159.66477413928, 5103.897250889901, -22844.340362537452, 34832.54007365598, 99893.6537520714, 1401.8234679167026, 42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515825189185717, "mean_inference_ms": 0.7691188213432847, "mean_action_processing_ms": 0.11945537827834157, "mean_env_wait_ms": 2.4311484778040904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000813603401184082, "StateBufferConnector_ms": 0.0007963180541992188, "ViewRequirementAgentConnector_ms": 0.019887030124664307}, "num_episodes": 16, "episode_return_max": 916285.9609462376, "episode_return_min": -118568.67133537735, "episode_return_mean": 231580.8986733373, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.39982096196476, "num_env_steps_trained_throughput_per_sec": 252.39982096196476, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15559.92, "restore_workers_time_ms": 0.058, "training_step_time_ms": 15559.786, "sample_time_ms": 14838.362, "learn_time_ms": 707.864, "learn_throughput": 5650.799, "synch_weights_time_ms": 4.948}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "ae48a_00000", "date": "2025-10-28_12-19-36", "timestamp": 1761671976, "time_this_iter_s": 15.852215051651001, "time_total_s": 680.2738263607025, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e840>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 680.2738263607025, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 36.631818181818176, "ram_util_percent": 84.34090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3122928142547607, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.882069614529609, "policy_loss": -0.02629442360776011, "vf_loss": 9.959483107924461, "vf_explained_var": 5.759298801422119e-07, "kl": 0.017621709600234896, "entropy": 5.904885445535183, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 1067347.2446712912, "episode_reward_min": -107214.69309989556, "episode_reward_mean": 235438.86549528918, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39817.228670533485, "policy_mean": -37460.70233672052, "policy_mm": -34734.88723789095, "policy_rl": -22769.257555631943}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 226202.28564054586, "policy_mm": 220027.67201738965, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 53018.62384481372, "policy_mean": 51863.93264849899, "policy_mm": 51375.29210022557, "policy_rl": 79181.01690175093}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53018.62890625, "('mom_0', 'policy_mom')_total_reward_min": -39817.23046875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 51863.9296875, "('mean_0', 'policy_mean')_total_reward_min": -37460.703125, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 51375.296875, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 220027.671875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 79181.015625, "('rl_trader_0', 'policy_rl')_total_reward_min": -22769.2578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [101152.68577233687, -43406.623323076106, 160271.98332512155, 2909.3932604757497, 386748.4514744249, -101343.99182912469, 31330.828228420916, 221135.03160810485, 339154.22721691354, 139535.06870356368, 197354.27050893125, -69056.03073436912, 641322.5411323013, -1798.4611755380363, 300234.24464974186, 8888.463769303946, 131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [11944.180685825482, -18029.031604806205, 40731.09500850626, -2779.6773076824743, 65771.98444475455, -39817.228670533485, 21883.372557291063, 51800.67252543511, 74191.36204269413, 20471.44021040868, 54333.59335184515, -36490.81334546731, 86194.40742259436, -2092.2399098164033, 81932.88639927821, -3206.161654705844, 21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384], "policy_policy_mean_reward": [25839.4741090496, -5673.0089329673765, 35600.545780111635, -1060.329765679258, 98843.31516998136, -27606.64892820333, 15634.262484644489, 52526.09852533867, 83493.29412160914, 29661.488975807846, 36414.140026572124, -33516.68888443948, 201073.19937145524, -9564.901061431588, 43102.55655471261, 15939.349264751967, 26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213], "policy_policy_mm_reward": [21347.643809072073, 3064.674770329468, 36860.779177947756, 2635.8750108009326, 81817.63826647395, -15536.729560956508, -7442.135561681302, 46158.725057692594, 104194.32124463863, 32524.504602039928, 43176.8740744024, -1549.3646525353226, 172367.8330285761, 7962.17413997011, 103434.84210509644, -11364.406737530873, 41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171], "policy_policy_rl_reward": [42021.38716838968, -22769.257555631943, 47079.563358556334, 4113.5253230365315, 140315.51359321503, -18383.384669431463, 1255.3287481666716, 70649.53549963827, 77275.249807972, 56877.634915307026, 63429.66305611147, 2500.8361480730946, 181687.10130967564, 1896.5056557399266, 71763.95959065454, 7519.682896788719, 42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516404841868453, "mean_inference_ms": 0.7692171599377516, "mean_action_processing_ms": 0.11947872171564299, "mean_env_wait_ms": 2.43165903415632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000800788402557373, "StateBufferConnector_ms": 0.0007898211479187012, "ViewRequirementAgentConnector_ms": 0.019708335399627686}, "num_episodes": 16, "episode_return_max": 1067347.2446712912, "episode_return_min": -107214.69309989556, "episode_return_mean": 235438.86549528918, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.3400334248974, "num_env_steps_trained_throughput_per_sec": 269.3400334248974, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 15548.831, "restore_workers_time_ms": 0.092, "training_step_time_ms": 15548.641, "sample_time_ms": 14827.435, "learn_time_ms": 707.593, "learn_throughput": 5652.968, "synch_weights_time_ms": 5.107}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "ae48a_00000", "date": "2025-10-28_12-19-51", "timestamp": 1761671991, "time_this_iter_s": 14.856551885604858, "time_total_s": 695.1303782463074, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d559a80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.1303782463074, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.59090909090909, "ram_util_percent": 84.27727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3104554414749146, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.886512917280196, "policy_loss": -0.02022593846922973, "vf_loss": 9.9582650244236, "vf_explained_var": -1.1989846825599671e-06, "kl": 0.015605721734425732, "entropy": 5.854875375330448, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 1067347.2446712912, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 236038.04742004492, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37844.04804984726, "policy_mean": -46839.270010604036, "policy_mm": -34734.88723789095, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 226202.28564054586, "policy_mm": 220027.67201738965, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 54809.10317248002, "policy_mean": 51527.65291526864, "policy_mm": 50829.052441506254, "policy_rl": 78872.23889079002}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54809.1015625, "('mom_0', 'policy_mom')_total_reward_min": -37844.046875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 51527.65625, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 50829.0546875, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 220027.671875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 78872.234375, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [131887.39280992612, 161754.30327611175, 90542.8769002644, 349756.76203155774, 53199.798884142496, 41803.84462429649, -52727.12334098884, 751463.4564271494, 270643.23531304765, 11992.486962978763, 571824.8250851209, 24774.46203182532, 38692.46999087529, 17011.98030407781, 188930.43709578307, 258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [21441.81396865514, 34877.20500121763, 18172.564728555284, 74954.02432752555, 5987.975632681678, 21767.617577641624, -20302.588943401344, 116272.37805193526, 79242.53807086963, -17576.585367495736, 128240.64597591436, 8582.837186377175, 4004.999224813349, 22003.57911709953, 35092.89784642386, 85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884], "policy_policy_mean_reward": [26467.25111274377, 32174.65369165344, 16736.576613426914, 101445.74094270816, 20242.511480850226, 1784.9571918320737, -16794.084529747273, 195069.5599790499, 38489.137291736675, 16364.104939427783, 105665.83626070827, 3375.2234605888043, 26866.8259321737, -18268.381815710443, 30788.785907214562, 36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381], "policy_policy_mm_reward": [41519.57499340139, 52754.767266815725, 26950.010208616426, 51733.44704289537, 6095.157716219308, 7463.59356260347, -7431.485329192269, 136090.87915479598, 70822.93086271912, 25925.229306035868, 122506.78069449237, -3570.759836166412, 6330.545352985493, 3066.5645598318056, 39655.793584174826, 45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165], "policy_policy_rl_reward": [42458.75273512574, 41947.67731642496, 28683.72534966586, 121623.54971842885, 20874.154054391307, 10787.676292219534, -8198.96453864787, 304030.6392413681, 82088.62908772248, -12720.261914989096, 215411.56215400476, 16387.161221025726, 1490.0994809027602, 10210.218442856964, 83392.95975797002, 91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516643122022542, "mean_inference_ms": 0.7691847678512909, "mean_action_processing_ms": 0.11948551253398909, "mean_env_wait_ms": 2.4320097401512673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007910728454589844, "StateBufferConnector_ms": 0.0007834434509277344, "ViewRequirementAgentConnector_ms": 0.01955515146255493}, "num_episodes": 16, "episode_return_max": 1067347.2446712912, "episode_return_min": -128423.44289330824, "episode_return_mean": 236038.04742004492, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.58812148825393, "num_env_steps_trained_throughput_per_sec": 268.58812148825393, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 15539.261, "restore_workers_time_ms": 0.101, "training_step_time_ms": 15539.06, "sample_time_ms": 14822.877, "learn_time_ms": 702.886, "learn_throughput": 5690.823, "synch_weights_time_ms": 4.934}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "ae48a_00000", "date": "2025-10-28_12-20-06", "timestamp": 1761672006, "time_this_iter_s": 14.896896839141846, "time_total_s": 710.0272750854492, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6e80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 710.0272750854492, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 23.947619047619042, "ram_util_percent": 84.20476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4232494831085205, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.891052395105362, "policy_loss": -0.02239421714330092, "vf_loss": 9.963101491332054, "vf_explained_var": -5.484744906425476e-06, "kl": 0.01728382635431011, "entropy": 5.743261413276196, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 1067347.2446712912, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 254547.32191114457, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37844.04804984726, "policy_mean": -46839.270010604036, "policy_mm": -34734.88723789095, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 226202.28564054586, "policy_mm": 220027.67201738965, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 58401.453913003796, "policy_mean": 57208.58588169063, "policy_mm": 56283.372162464315, "policy_rl": 82653.90995398581}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58401.453125, "('mom_0', 'policy_mom')_total_reward_min": -37844.046875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 57208.5859375, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 56283.37109375, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 220027.671875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 82653.90625, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [258139.65637967933, -42641.721131646394, 367929.53274407383, 762061.2835708262, 279754.19716937584, -57095.21336810006, 229178.87945710166, 284200.91657594783, 327394.9243449991, 269809.0703543268, 650249.3215352225, -29285.104250137403, 198924.98530823315, 784581.0455369215, 701363.4029149776, 9295.783826676503, 916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [85364.67890746247, -7316.925542157736, 88148.61473782554, 166587.06390753508, 54066.718281063586, -11457.006480371037, 85542.66663900505, 60796.889026630866, 75890.61799515839, 82741.90673288028, 130422.25631367417, -12214.877811964365, 51903.778913553644, 229350.42809015283, 142600.0385612169, 3832.6559121774435, 194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176], "policy_policy_mean_reward": [36011.28514194532, -26036.597597982338, 90775.41423310233, 148249.1650465625, 62774.183785138935, -23708.00326842749, 25665.390802537946, 75318.04105987916, 47812.932641681036, 68283.06619377018, 127589.10994750468, -4999.089047445538, 33512.617001648214, 179265.61008916437, 158674.91724106667, 5803.017756736317, 226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176], "policy_policy_mm_reward": [45370.963861772994, -4687.750076128025, 99239.98268450297, 220027.67201738965, 67919.57132111104, -26204.571690351564, 31917.55562739257, 62073.977535460894, 81538.45363735448, 49148.69875122939, 130685.31463799057, -3991.9438920856956, 46655.85073361967, 111784.15044493377, 128329.21930969965, -5445.533164497917, 138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253], "policy_policy_rl_reward": [91392.7284684988, -4600.447915378203, 89765.52108864297, 227197.3825993388, 94993.72378206214, 4274.368071050167, 86053.26638816591, 86012.00895397681, 122152.92007080496, 69635.39867644706, 261552.64063605518, -8079.193498641824, 66852.73865941179, 264180.8569126708, 271759.2278029946, 5105.64332226073, 357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516597952646045, "mean_inference_ms": 0.7690435588360272, "mean_action_processing_ms": 0.11947842251352797, "mean_env_wait_ms": 2.4320377729160487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007864236831665039, "StateBufferConnector_ms": 0.0007800459861755371, "ViewRequirementAgentConnector_ms": 0.019499540328979492}, "num_episodes": 15, "episode_return_max": 1067347.2446712912, "episode_return_min": -128423.44289330824, "episode_return_mean": 254547.32191114457, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.5915182771561, "num_env_steps_trained_throughput_per_sec": 275.5915182771561, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 15186.431, "restore_workers_time_ms": 0.101, "training_step_time_ms": 15186.236, "sample_time_ms": 14649.083, "learn_time_ms": 524.298, "learn_throughput": 7629.254, "synch_weights_time_ms": 5.2}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "ae48a_00000", "date": "2025-10-28_12-20-20", "timestamp": 1761672020, "time_this_iter_s": 14.518631935119629, "time_total_s": 724.5459070205688, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d4e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 724.5459070205688, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 22.604761904761904, "ram_util_percent": 84.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4011019468307495, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.882744428515434, "policy_loss": -0.020981461278279313, "vf_loss": 9.957441335916519, "vf_explained_var": 5.707144737243652e-07, "kl": 0.016414683786570315, "entropy": 6.110202419757843, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 1067347.2446712912, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 235098.77221625074, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -46839.270010604036, "policy_mm": -34734.88723789095, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 226202.28564054586, "policy_mm": 256972.8170959475, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 52596.86394047673, "policy_mean": 54177.12453080664, "policy_mm": 53896.92722008066, "policy_rl": 74427.85652488674}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52596.86328125, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 54177.12890625, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 226202.28125, "('mm_0', 'policy_mm')_total_reward_mean": 53896.921875, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 256972.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 74427.8515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [916285.9609462376, 16642.28535956774, -37977.010755601295, 200202.9480297482, 226890.24304601815, 200294.6035397508, -23757.401224428362, 195478.024618102, 22277.509760372115, 898281.5428732394, 202039.5690755647, 251112.09799658757, 234978.95136286027, 82944.71346493241, 191194.3435713421, 154194.7330004646, 128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [194249.9220255414, 7666.284825805822, -30267.760120032035, 41892.25773141832, 83254.05776046222, 53053.64400961222, 323.43498712925646, 44087.60746563387, 10159.544352019102, 238180.03586141102, 46968.656018216345, 67871.19807059341, 54430.96117243208, 12054.591777808051, 49982.80822739195, 40013.329383977405, 12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163], "policy_policy_mean_reward": [226202.28564054586, -1790.6137770094028, -9245.326239763624, 52964.58552731592, 41985.61735602805, 59630.00694399553, -24801.97528914781, 43963.84575156567, 28044.617996134584, 219059.5198877066, 49997.87346613388, 54636.297754296764, 48578.48280304101, 6937.7107395727935, 51360.532317015924, 53355.19652786677, 40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768], "policy_policy_mm_reward": [138261.65782161127, 11172.090950789332, -8925.038581399192, 28449.09678725023, 56139.45130211424, 41213.580942657725, -13264.202130322294, 59387.02943659791, -15440.8107828231, 139498.22115127073, 39235.552544893624, 55594.44419638811, 61467.39630623826, 32373.061829284463, 33908.001201544976, 33739.15635321753, 32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899], "policy_policy_rl_reward": [357572.0954585387, -405.4766400180307, 10461.11418559365, 76897.00798376383, 45511.11662741342, 46397.37164348543, 13985.341207912526, 48039.54196430456, -485.84180495857544, 301543.7659728504, 65837.48704632091, 73010.15797530937, 70502.11108114912, 31579.3491182671, 55943.00182538903, 27087.050735403136, 43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516155262427669, "mean_inference_ms": 0.7687437290077399, "mean_action_processing_ms": 0.11945295471384104, "mean_env_wait_ms": 2.431876522587093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000775456428527832, "StateBufferConnector_ms": 0.0007800459861755371, "ViewRequirementAgentConnector_ms": 0.019361793994903564}, "num_episodes": 16, "episode_return_max": 1067347.2446712912, "episode_return_min": -128423.44289330824, "episode_return_mean": 235098.77221625074, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.5307471949001, "num_env_steps_trained_throughput_per_sec": 272.5307471949001, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 15073.757, "restore_workers_time_ms": 0.151, "training_step_time_ms": 15073.513, "sample_time_ms": 14540.647, "learn_time_ms": 521.379, "learn_throughput": 7671.957, "synch_weights_time_ms": 4.524}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "ae48a_00000", "date": "2025-10-28_12-20-35", "timestamp": 1761672035, "time_this_iter_s": 14.680614233016968, "time_total_s": 739.2265212535858, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c860>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 739.2265212535858, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.744999999999997, "ram_util_percent": 83.50999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3684461116790771, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.878905934095382, "policy_loss": -0.0267732645443175, "vf_loss": 9.957342839241027, "vf_explained_var": -1.697428524494171e-06, "kl": 0.01745812365929871, "entropy": 5.951981736719608, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 237162.88653923015, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -46839.270010604036, "policy_mm": -34734.88723789095, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 218797.67711218155, "policy_mm": 256972.8170959475, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 52664.391202105544, "policy_mean": 52279.10152097416, "policy_mm": 56095.692361343, "policy_rl": 76123.70145480752}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52664.39453125, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 52279.10546875, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 218797.671875, "('mm_0', 'policy_mm')_total_reward_mean": 56095.6953125, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 256972.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76123.703125, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [128788.71751768443, 182925.63314110466, 309599.81244324404, 244948.92250443343, 127539.13518894635, 378187.33443861466, 252414.77193235155, 250373.5857753032, 12809.859967840246, 257854.02914412785, 665259.4173908228, 699796.1005172973, 101695.37303894416, 4536.470062719376, 563589.7959754006, 150844.16648737068, -40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [12636.14633940724, 32999.632283225976, 70186.62164474632, 68799.87556897043, 42509.04817253898, 110143.80743094035, 55313.73358586501, 71879.77258483018, -1443.387384988619, 45315.44171811745, 190206.90943287555, 185444.00267809554, 21618.903043733662, -8823.340806477105, 125671.5957632771, 28048.521106545195, -26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004], "policy_policy_mean_reward": [40707.49519805998, 37981.46909691597, 55158.532821761575, 52119.58324637263, 19517.31808676773, 120499.85078156576, 54811.913042696404, 79804.89323617192, -5384.4817413701485, 82771.7220801274, 175644.5275855906, 157648.0785920627, 32543.354808844106, 2360.3055900463773, 124069.61586721522, 44504.88649908098, -704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135], "policy_policy_mm_reward": [32225.77741853555, 58543.94851615428, 73047.81687119328, 66170.92105996428, 20631.110448961095, 76493.93399350657, 80748.98613675953, 38679.98833299113, -2630.9487308068133, 83133.59026915791, 112947.99311942258, 150581.49806409836, 21950.338964896677, -9545.74020430527, 153056.949190258, 26301.781473056442, -13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716], "policy_policy_rl_reward": [43219.298561681455, 53400.5832448087, 111206.84110554244, 57858.54262912624, 44881.65848067879, 71049.74223260241, 61540.13916703032, 60008.93162130988, 22268.677825005758, 46633.275076724756, 186459.98725293437, 206122.52118304066, 25582.77622146976, 20545.245483455426, 160791.63515465078, 51988.97740868819, 1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515392613719096, "mean_inference_ms": 0.7683539167556013, "mean_action_processing_ms": 0.11941738675193168, "mean_env_wait_ms": 2.431601850774075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007725954055786133, "StateBufferConnector_ms": 0.0007812380790710449, "ViewRequirementAgentConnector_ms": 0.019342422485351562}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -128423.44289330824, "episode_return_mean": 237162.88653923015, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.13634722897666, "num_env_steps_trained_throughput_per_sec": 274.13634722897666, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 14950.628, "restore_workers_time_ms": 0.147, "training_step_time_ms": 14950.389, "sample_time_ms": 14415.034, "learn_time_ms": 523.48, "learn_throughput": 7641.167, "synch_weights_time_ms": 5.341}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "ae48a_00000", "date": "2025-10-28_12-20-50", "timestamp": 1761672050, "time_this_iter_s": 14.595282077789307, "time_total_s": 753.8218033313751, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d080>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 753.8218033313751, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 21.071428571428573, "ram_util_percent": 83.47619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5091105699539185, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.88126636147499, "policy_loss": -0.02505057300440967, "vf_loss": 9.958210200071335, "vf_explained_var": -3.890693187713623e-06, "kl": 0.015950218485795812, "entropy": 5.907087330520153, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 230312.19359691325, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -46839.270010604036, "policy_mm": -34734.88723789095, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 263232.61888434633, "policy_mean": 218797.67711218155, "policy_mm": 256972.8170959475, "policy_rl": 508902.3467738916}, "policy_reward_mean": {"policy_mom": 51196.34148567696, "policy_mean": 48240.940648491865, "policy_mm": 53930.31459236834, "policy_rl": 76944.59687037613}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51196.33984375, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 263232.625, "('mean_0', 'policy_mean')_total_reward_mean": 48240.94140625, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 218797.671875, "('mm_0', 'policy_mm')_total_reward_mean": 53930.3203125, "('mm_0', 'policy_mm')_total_reward_min": -34734.88671875, "('mm_0', 'policy_mm')_total_reward_max": 256972.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76944.59375, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 508902.34375}, "hist_stats": {"episode_reward": [-40078.43817748802, 483668.5430355835, 794699.7433860718, 105677.56389700902, 846009.5892222198, 394033.2835741839, 1673.6089016384653, -107214.69309989556, 196377.70062269652, -51666.237449814675, 255941.80468266184, 95017.98552998237, 1067347.2446712912, 672163.6958695139, 26731.47249541867, 202303.63639640802, 115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-26955.19213620971, 71024.75852594306, 174765.65753022133, 24245.867647581894, 263232.61888434633, 79705.13260226611, 2544.893673783647, -21241.748415131253, 51396.64250860604, -9116.23750855523, 52920.27688182731, 29458.953588518038, 146777.4811335435, 123832.5384814304, 1636.6122015584926, 44483.20610851104, 26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022], "policy_policy_mean_reward": [-704.3314630171104, 105515.46519292613, 172794.3537773392, 23697.08759210423, 149168.44115753815, 65150.3191461005, 6735.847669583872, -37460.70233672052, 41616.62659604054, -19582.475244113048, 49966.65883366028, 16258.938414559276, 218797.67711218155, 129792.33849595892, -988.7773009010775, 46912.723118108384, 23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343], "policy_policy_mm_reward": [-13903.692449150578, 114541.4724885471, 167250.2871054724, 32025.307941890052, 181870.76002944793, 112966.06858466077, -18750.542365551377, -34734.88723789095, 58735.60160546508, -3716.1078634162704, 79326.80062757687, 24189.786218293004, 192869.73965167603, 149060.11330204183, 1442.15975440354, 51254.5622844997, 42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538], "policy_policy_rl_reward": [1484.777870889396, 192586.8468281683, 279889.44497303874, 25709.300715432804, 251737.76915088767, 136211.7632411566, 11143.409923822212, -13777.355110152746, 44628.82991258475, -19251.416833730076, 73728.06833959748, 25110.3073086121, 508902.3467738916, 269478.70559008175, 24641.477840357635, 59653.14488528882, 22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25139271040143396, "mean_inference_ms": 0.7677670978237547, "mean_action_processing_ms": 0.11935734075621345, "mean_env_wait_ms": 2.4309072103134755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007505416870117188, "StateBufferConnector_ms": 0.0007684230804443359, "ViewRequirementAgentConnector_ms": 0.019019365310668945}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -128423.44289330824, "episode_return_mean": 230312.19359691325, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.9154464072777, "num_env_steps_trained_throughput_per_sec": 268.9154464072777, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 14940.67, "restore_workers_time_ms": 0.135, "training_step_time_ms": 14940.441, "sample_time_ms": 14378.864, "learn_time_ms": 549.166, "learn_throughput": 7283.776, "synch_weights_time_ms": 5.707}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "ae48a_00000", "date": "2025-10-28_12-21-05", "timestamp": 1761672065, "time_this_iter_s": 14.879125118255615, "time_total_s": 768.7009284496307, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d580>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 768.7009284496307, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.576190476190476, "ram_util_percent": 83.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4386003017425537, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.877445954084397, "policy_loss": -0.026554492217837834, "vf_loss": 9.957130199670791, "vf_explained_var": -3.504939377307892e-06, "kl": 0.01805876293906317, "entropy": 6.125616562366486, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -128423.44289330824, "episode_reward_mean": 220423.83541931663, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -46839.270010604036, "policy_mm": -30969.18766138306, "policy_rl": -32413.969100580754}, "policy_reward_max": {"policy_mom": 247484.75480832794, "policy_mean": 207219.20066314389, "policy_mm": 264694.7877119011, "policy_rl": 457120.30298052606}, "policy_reward_mean": {"policy_mom": 48118.316299406244, "policy_mean": 47343.13681488508, "policy_mm": 53134.14213041003, "policy_rl": 71828.24017461525}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48118.3203125, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 247484.75, "('mean_0', 'policy_mean')_total_reward_mean": 47343.13671875, "('mean_0', 'policy_mean')_total_reward_min": -46839.26953125, "('mean_0', 'policy_mean')_total_reward_max": 207219.203125, "('mm_0', 'policy_mm')_total_reward_mean": 53134.140625, "('mm_0', 'policy_mm')_total_reward_min": -30969.1875, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71828.2421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -32413.96875, "('rl_trader_0', 'policy_rl')_total_reward_max": 457120.3125}, "hist_stats": {"episode_reward": [115165.73044099647, 214852.63629431548, 172079.09556365898, -2451.0157939505257, 79463.10732327423, 66261.98258887758, 238476.92823557183, 245351.41882790913, -60915.78442014554, 223428.17674577248, 318295.75173518126, -104351.99673487768, -128423.44289330824, 80535.52074813606, 298831.47980753856, 275463.807531162, 228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [26669.798809328688, 86743.45609657886, 26487.27411249272, -9132.040635112755, 32093.32894044384, 25131.25500508503, 27262.358876791834, 66044.04952343187, -9202.24691242022, 59995.53349035469, 83436.43644524449, -37844.04804984726, -28669.54386075354, 19348.970685067638, 56334.48999249038, 90990.20777483421, 55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393], "policy_policy_mean_reward": [23209.35352530667, 35488.67730097134, 41860.19234290817, -1746.5464615760407, -1832.2311131213, -13675.026579981792, 76662.1863501639, 42435.55000987737, -14910.949632955133, 55633.85126853376, 70739.91760699122, -15635.86727492926, -46839.270010604036, 36949.233199520175, 95300.09105021029, 62018.17875406032, 61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855], "policy_policy_mm_reward": [42592.961376566105, 45863.615954854096, 47882.353355543746, -6961.0210608481275, 4649.346811358171, 10774.674352806302, 50613.04961292596, 71128.97481835257, -26004.234252046972, 36544.11681899282, 92346.4263318053, -30531.18648274343, -20500.659921370097, 17662.117371042023, 46616.997554966765, 40027.917989484115, 61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977], "policy_policy_rl_reward": [22693.61672979515, 46756.886941910954, 55849.27575271425, 15388.592363586346, 44552.66268459368, 44031.07981096816, 83939.33339569018, 65742.84447624769, -10798.353622723238, 71254.6751678911, 71772.97135114005, -20340.894927357942, -32413.969100580754, 6575.199492506368, 100579.90120987107, 82427.50301278323, 49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512292354235258, "mean_inference_ms": 0.7671519753226054, "mean_action_processing_ms": 0.11929308024942514, "mean_env_wait_ms": 2.4301642116713023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007638335227966309, "StateBufferConnector_ms": 0.000774085521697998, "ViewRequirementAgentConnector_ms": 0.019182980060577393}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -128423.44289330824, "episode_return_mean": 220423.83541931663, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.5300903479168, "num_env_steps_trained_throughput_per_sec": 264.5300903479168, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14938.357, "restore_workers_time_ms": 0.139, "training_step_time_ms": 14938.125, "sample_time_ms": 14374.746, "learn_time_ms": 551.429, "learn_throughput": 7253.883, "synch_weights_time_ms": 5.318}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "ae48a_00000", "date": "2025-10-28_12-21-20", "timestamp": 1761672080, "time_this_iter_s": 15.125341176986694, "time_total_s": 783.8262696266174, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f5440>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 783.8262696266174, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 26.563636363636363, "ram_util_percent": 83.81363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5071146488189697, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.886849662661552, "policy_loss": -0.020249039074406026, "vf_loss": 9.959439566731453, "vf_explained_var": -1.8207356333732605e-06, "kl": 0.016441197532640433, "entropy": 5.973938155174255, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 237992.94478126333, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -50313.582888347584, "policy_mm": -38940.962122818506, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 247484.75480832794, "policy_mean": 210523.23066991425, "policy_mm": 264694.7877119011, "policy_rl": 457120.30298052606}, "policy_reward_mean": {"policy_mom": 52368.182666726636, "policy_mean": 51964.78609179886, "policy_mm": 56368.53794513922, "policy_rl": 77291.43807759859}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52368.1796875, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 247484.75, "('mean_0', 'policy_mean')_total_reward_mean": 51964.7890625, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 210523.234375, "('mm_0', 'policy_mm')_total_reward_mean": 56368.5390625, "('mm_0', 'policy_mm')_total_reward_min": -38940.9609375, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77291.4453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 457120.3125}, "hist_stats": {"episode_reward": [228074.2787269246, 224224.41884851732, 166510.2525677813, -8630.03699171976, 311217.51973978477, 289967.2140625429, 349121.9912316303, 521899.33619513665, 329010.9230836056, -11153.468285237606, 270921.1446125954, 116538.72816743416, 553152.7626264672, 301105.34495896817, 379115.521153612, 732426.9136532154, 307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [55580.45129752423, 74769.1046173092, 61423.67066836553, -14762.035287772003, 56049.120656543884, 62371.65094812759, 71200.8152179025, 100955.63426791527, 65397.808039929274, -36234.570863802655, 56601.693408236155, 33496.45017246977, 112696.60117971084, 81677.14086182165, 83385.99956206932, 111231.07652286853, 72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105], "policy_policy_mean_reward": [61696.085076962256, 48460.28972472394, 18193.829681183015, 1359.1338338500602, 48690.94043067381, 57535.16569108483, 101296.37852922536, 124294.6651201167, 72501.13008594878, 1306.5040975476134, 66916.98425432271, 4756.546763397646, 140827.08577873444, 79621.43012215507, 101489.28014975933, 207219.20066314389, 71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425], "policy_policy_mm_reward": [61766.130711049824, 48784.09256294909, 35534.96357227745, -1441.9386728872869, 131707.84053480165, 87105.18871428115, 75596.15658701868, 106715.7566176733, 74803.95493995496, 32946.106878753795, 74511.77559977713, 34133.2471287926, 153309.94527702563, 71585.57031842723, 100775.46454364767, 139756.86138139685, 87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779], "policy_policy_rl_reward": [49031.61164138817, 52210.93194353524, 51357.78864595531, 6214.80313508951, 74769.61811776552, 82955.20870904962, 101028.64089748358, 189933.28018943156, 116308.03001777208, -9171.50839773627, 72890.69135025896, 44152.48410277411, 146319.13039099626, 68221.20365656482, 93464.7768981354, 274219.77508580685, 75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25106490884159943, "mean_inference_ms": 0.7665429278496316, "mean_action_processing_ms": 0.11922897486153673, "mean_env_wait_ms": 2.4293437794733186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007521510124206543, "StateBufferConnector_ms": 0.0007675290107727051, "ViewRequirementAgentConnector_ms": 0.01908886432647705}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -148904.55572262206, "episode_return_mean": 237992.94478126333, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.3489182212002, "num_env_steps_trained_throughput_per_sec": 272.3489182212002, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 14903.855, "restore_workers_time_ms": 0.132, "training_step_time_ms": 14903.663, "sample_time_ms": 14337.721, "learn_time_ms": 554.047, "learn_throughput": 7219.604, "synch_weights_time_ms": 5.634}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "ae48a_00000", "date": "2025-10-28_12-21-35", "timestamp": 1761672095, "time_this_iter_s": 14.69171404838562, "time_total_s": 798.517983675003, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5596c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 798.517983675003, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.985714285714288, "ram_util_percent": 82.96190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.442201852798462, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.876507484912873, "policy_loss": -0.02728694836841896, "vf_loss": 9.956529629230499, "vf_explained_var": -1.9652768969535826e-06, "kl": 0.019031980386398823, "entropy": 6.129961785674095, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 222762.0150332875, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43275.60666462556, "policy_mean": -50313.582888347584, "policy_mm": -38940.962122818506, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 247484.75480832794, "policy_mean": 216755.26478305022, "policy_mm": 264694.7877119011, "policy_rl": 457120.30298052606}, "policy_reward_mean": {"policy_mom": 49015.950808289934, "policy_mean": 48792.20298775841, "policy_mm": 52523.049341543, "policy_rl": 72430.81189569613}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49015.9453125, "('mom_0', 'policy_mom')_total_reward_min": -43275.60546875, "('mom_0', 'policy_mom')_total_reward_max": 247484.75, "('mean_0', 'policy_mean')_total_reward_mean": 48792.19921875, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 216755.265625, "('mm_0', 'policy_mm')_total_reward_mean": 52523.046875, "('mm_0', 'policy_mm')_total_reward_min": -38940.9609375, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72430.8125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 457120.3125}, "hist_stats": {"episode_reward": [307433.6331829227, 255710.78660569317, 222888.65110634625, -115660.82484880261, 924026.191206037, 102237.95234311995, 73775.98706944559, -72078.08523102668, 711844.6599429138, 15186.914422892343, 124011.93282764316, -6745.91322602654, -106319.3500578669, 264267.7685003329, -69233.4018010931, 257005.10689610866, 280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [72726.65482281834, 55232.945395727365, 54294.64538220892, -33037.568466812176, 231261.73893297117, 12448.486954630473, 15042.341545508083, -33288.027884650546, 115670.51187022138, 27680.210756724384, 15573.086287545912, 3315.2196297803544, -43275.60666462556, 76568.15559851553, -19499.247938054425, 73733.28322403543, 56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859], "policy_policy_mean_reward": [71680.217350833, 93895.88031057516, 62115.846784212816, -36954.320600202176, 199288.12082551586, 30607.658199090067, 28956.582420625316, -18443.898088112837, 137037.71836204868, -4583.572863690923, 24258.288606608723, 31.737655231156765, -30085.07854141562, 73626.21885204728, -4560.834725824618, 59207.077019715114, 62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701], "policy_policy_mm_reward": [87575.29510421712, 60937.887764097846, 43241.6437466749, -17649.853365703253, 256972.8170959475, 31827.53615854894, 8488.316380517912, -20450.627787648933, 215080.57845402043, -4298.635625544747, 37356.375224556454, -24554.093655587196, -30969.18766138306, 44040.16035315415, -22247.242611331752, 70791.76012606382, 68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684], "policy_policy_rl_reward": [75451.46590505406, 45644.07313529264, 63236.51519324964, -28019.08241608498, 236503.51435160215, 27354.271030850476, 21288.7467227944, 104.468529385627, 244055.85125662424, -3611.087844596324, 46824.182708932036, 14461.223144549125, -1989.4771904425777, 70033.2336966158, -22926.07652588235, 53272.98652629394, 92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509054942320937, "mean_inference_ms": 0.7659488726885558, "mean_action_processing_ms": 0.11916507937663562, "mean_env_wait_ms": 2.428516974533913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007489919662475586, "StateBufferConnector_ms": 0.0007686614990234375, "ViewRequirementAgentConnector_ms": 0.018945276737213135}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -148904.55572262206, "episode_return_mean": 222762.0150332875, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.87061641243014, "num_env_steps_trained_throughput_per_sec": 272.87061641243014, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14871.64, "restore_workers_time_ms": 0.127, "training_step_time_ms": 14871.452, "sample_time_ms": 14301.304, "learn_time_ms": 557.951, "learn_throughput": 7169.087, "synch_weights_time_ms": 6.067}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "ae48a_00000", "date": "2025-10-28_12-21-49", "timestamp": 1761672109, "time_this_iter_s": 14.666304111480713, "time_total_s": 813.1842877864838, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68ed40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 813.1842877864838, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.728571428571428, "ram_util_percent": 83.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5036481618881226, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.884459954500198, "policy_loss": -0.02692864380951505, "vf_loss": 9.960829770565033, "vf_explained_var": -5.573965609073639e-06, "kl": 0.021527681642055853, "entropy": 5.912863175570965, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 218877.95192750308, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -29957.521664935794, "policy_mean": -50313.582888347584, "policy_mm": -38940.962122818506, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 247484.75480832794, "policy_mean": 216755.26478305022, "policy_mm": 264694.7877119011, "policy_rl": 457120.30298052606}, "policy_reward_mean": {"policy_mom": 48122.529166511136, "policy_mean": 46156.66524623351, "policy_mm": 50884.49640718049, "policy_rl": 73714.26110757793}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48122.5234375, "('mom_0', 'policy_mom')_total_reward_min": -29957.521484375, "('mom_0', 'policy_mom')_total_reward_max": 247484.75, "('mean_0', 'policy_mean')_total_reward_mean": 46156.66015625, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 216755.265625, "('mm_0', 'policy_mm')_total_reward_mean": 50884.49609375, "('mm_0', 'policy_mm')_total_reward_min": -38940.9609375, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73714.2578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 457120.3125}, "hist_stats": {"episode_reward": [280191.39306189853, 155186.22759646992, 77810.87890081166, 317837.72902744083, 916615.9674629611, 332129.2168478368, 199150.82131755544, 180083.88741072186, -85522.20095816617, -34935.27418699876, 150472.46784326306, 151764.95466375438, 122283.40228084341, 180546.02702823826, 319790.63469430077, 9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [56173.70704957062, 20310.27651381897, 27294.29201340225, 66792.07904174163, 211511.78006426003, 64415.2209611426, 43594.56969733407, 55876.31343795952, -11964.214069278656, -9799.114443102962, 29571.55847549749, 48540.20702046977, 16645.120320034115, 44057.545638271426, 83456.22004832917, 3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732], "policy_policy_mean_reward": [62770.38626336883, 34317.41609365287, 2822.9629388955836, 106594.14292072768, 177395.88083713304, 79557.99192757235, 52185.5995953932, 34158.74513501056, -31530.37056644425, -32452.51824330281, 42540.268385976015, 19470.578411908402, 29481.752964376712, 20340.184123967854, 46356.64941626695, -4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804], "policy_policy_mm_reward": [68832.0490993815, 57070.22042185393, 22467.517658631343, 85309.57386984899, 219379.00263533555, 87799.52368904538, 32158.699556510113, 31341.133998662302, -26055.725084894933, -13764.872019936456, 21221.84823217356, 47377.167642608445, 47650.85707404042, 46551.75399124171, 94509.19899734776, 4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674], "policy_policy_rl_reward": [92415.25064957763, 43488.31456714412, 25226.106289882613, 59141.93319512257, 308329.3039262323, 100356.48027007664, 71211.9524683182, 58707.69483908955, -15971.891237548485, 21081.23051934338, 57138.79274961616, 36377.00158876776, 28505.671922392135, 69596.54327475723, 95468.56623235715, 6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25079387029002315, "mean_inference_ms": 0.7655194662565563, "mean_action_processing_ms": 0.1191220463631959, "mean_env_wait_ms": 2.427942833390531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007559061050415039, "StateBufferConnector_ms": 0.0007720589637756348, "ViewRequirementAgentConnector_ms": 0.019070565700531006}, "num_episodes": 16, "episode_return_max": 1082301.7852990802, "episode_return_min": -148904.55572262206, "episode_return_mean": 218877.95192750308, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.92312749842904, "num_env_steps_trained_throughput_per_sec": 262.92312749842904, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14808.21, "restore_workers_time_ms": 0.13, "training_step_time_ms": 14808.02, "sample_time_ms": 14240.349, "learn_time_ms": 557.148, "learn_throughput": 7179.425, "synch_weights_time_ms": 4.86}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "ae48a_00000", "date": "2025-10-28_12-22-04", "timestamp": 1761672124, "time_this_iter_s": 15.217574119567871, "time_total_s": 828.4018619060516, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68df80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 828.4018619060516, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 27.590476190476195, "ram_util_percent": 84.22857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.500976800918579, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.88221071958542, "policy_loss": -0.02836987284317729, "vf_loss": 9.962363055348396, "vf_explained_var": -4.736892879009247e-06, "kl": 0.014411851338082001, "entropy": 6.15104271620512, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 1082301.7852990802, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 210235.3295800414, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -50313.582888347584, "policy_mm": -38940.962122818506, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 247484.75480832794, "policy_mean": 218477.64010528763, "policy_mm": 264694.7877119011, "policy_rl": 457120.30298052606}, "policy_reward_mean": {"policy_mom": 44809.862806852005, "policy_mean": 46957.26234766957, "policy_mm": 47028.93078482344, "policy_rl": 71439.27364069638}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44809.859375, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 247484.75, "('mean_0', 'policy_mean')_total_reward_mean": 46957.265625, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 218477.640625, "('mm_0', 'policy_mm')_total_reward_mean": 47028.9296875, "('mm_0', 'policy_mm')_total_reward_min": -38940.9609375, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71439.2734375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 457120.3125}, "hist_stats": {"episode_reward": [9567.058495475932, 169257.74093864296, 1082301.7852990802, 143831.72574892224, 100156.33207627096, 48822.62196337473, -32820.13997237726, 142168.09059318158, 359874.97541492025, 621820.7647654191, 102850.78236238747, -85564.10678539885, 895306.5074583197, 91409.94149088924, 333644.0361385813, 437804.7097225609, -40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [3474.4089829569657, 45930.44673585702, 247484.75480832794, 37603.362996374424, 10275.119037869004, 29775.611942485015, 765.065307253964, 22982.896600389035, 89914.92638914281, 150448.7298299805, 9135.719095670862, -29957.521664935794, 204264.3855075934, 37317.496750670405, 56840.72297021256, 128084.04076457159, -431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913], "policy_policy_mean_reward": [-4299.753918616436, 60067.99748815748, 136470.3408086669, 36388.14100136702, 44944.869054617135, 1905.6491522068325, -20374.548710152445, 27726.70834383254, 92187.36971310206, 114437.32405596963, 33857.22061666868, -36113.89925436597, 182504.4272497546, 2012.7112413242446, 67066.71323879763, 81303.79161681868, -6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013], "policy_policy_mm_reward": [4338.105426595355, 32590.659042856892, 241226.38670155848, 23117.04206938166, 23244.421503019716, -14152.535476143361, -8127.40331350978, 28218.110628609516, 95064.40978108699, 147674.07160806263, 33581.85129226809, -19019.35074765192, 140603.46758502568, 21889.98745583588, 87470.69611271666, 77671.63509073954, -12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357], "policy_policy_rl_reward": [6054.298004540161, 30668.637671771674, 457120.30298052606, 46723.17968179913, 21691.922480765214, 31293.896344826186, -5083.253255969096, 63240.375020350264, 82708.26953158795, 209260.6392714059, 26275.991357779876, -473.33511844529534, 367934.2271159468, 30189.746043058734, 122265.90381685489, 150745.2422504307, -21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25073485297010045, "mean_inference_ms": 0.7652596810835399, "mean_action_processing_ms": 0.11909788054200647, "mean_env_wait_ms": 2.4276201641813504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000765383243560791, "StateBufferConnector_ms": 0.0007767677307128906, "ViewRequirementAgentConnector_ms": 0.019183337688446045}, "num_episodes": 15, "episode_return_max": 1082301.7852990802, "episode_return_min": -148904.55572262206, "episode_return_mean": 210235.3295800414, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.97200310002717, "num_env_steps_trained_throughput_per_sec": 261.97200310002717, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14849.969, "restore_workers_time_ms": 0.094, "training_step_time_ms": 14849.834, "sample_time_ms": 14277.034, "learn_time_ms": 561.867, "learn_throughput": 7119.119, "synch_weights_time_ms": 4.896}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "ae48a_00000", "date": "2025-10-28_12-22-20", "timestamp": 1761672140, "time_this_iter_s": 15.273146867752075, "time_total_s": 843.6750087738037, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e520>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 843.6750087738037, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 28.13636363636364, "ram_util_percent": 84.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5511747598648071, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.881597283482552, "policy_loss": -0.020316809459473006, "vf_loss": 9.955447694659233, "vf_explained_var": -1.5215948224067688e-06, "kl": 0.013951607076251416, "entropy": 6.295093300938606, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 863243.5082611251, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 205465.09591120444, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -50313.582888347584, "policy_mm": -42827.83016647408, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 230855.79284481105, "policy_mean": 218477.64010528763, "policy_mm": 264694.7877119011, "policy_rl": 339108.1331241657}, "policy_reward_mean": {"policy_mom": 43521.046096634615, "policy_mean": 47406.74783478617, "policy_mm": 47009.48856927469, "policy_rl": 67527.81341050901}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 43521.046875, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 230855.796875, "('mean_0', 'policy_mean')_total_reward_mean": 47406.75, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 218477.640625, "('mm_0', 'policy_mm')_total_reward_mean": 47009.484375, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67527.8125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 339108.125}, "hist_stats": {"episode_reward": [-40187.58137135292, 243424.6496344923, -15589.080957389815, 294664.72826733935, 248462.9325695658, 346133.3148324548, 37887.21237659388, 11184.914544433357, 39590.18488587994, 795187.9456207044, 266876.28728301433, 173993.69422531317, 228533.6576026199, 9452.071899137743, 42150.617312902825, 86597.51359545908, 253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-431.8685766936798, 53949.85144604292, 1780.1925324785211, 91640.86986416295, 57191.19275982022, 69801.60264256982, -3879.6371784004054, -13299.858916635785, -7651.483074751756, 141894.57007507814, 70959.47531234713, 37889.2855961569, 46572.04991117318, -5576.606317522313, 3892.455995439375, 8562.356251749421, 53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986], "policy_policy_mean_reward": [-6176.933324931927, 30064.51519857118, -6755.127538980829, 37171.92929850105, 70125.12664656343, 107765.2454906789, 15597.821084040745, -4835.012006544781, 16867.477481586295, 166408.79759638608, 43997.85426470412, 53781.97541626547, 66053.89018982387, -4549.490283167554, 9989.242402981537, 26418.887550617983, 61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416], "policy_policy_mm_reward": [-12228.157679950793, 62631.80155707418, -17986.691929475706, 85286.38001979409, 57221.89604189538, 112213.64238856973, -815.2613782740774, 8655.079748211061, 12216.670135708506, 176805.19188660965, 80280.95520465248, 41684.268935942, 35581.00316654579, 20194.944349127152, -2785.7009049647595, 26238.559893009762, 64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548], "policy_policy_rl_reward": [-21350.621789776535, 96778.48143280414, 7372.545978588218, 80565.54908488128, 63924.71712128666, 56352.82431063646, 26984.289849227538, 20664.705719403042, 18157.520343336742, 310079.3860626308, 71638.00250131049, 40638.164276948635, 80326.71433507695, -616.7758492996174, 31054.61981944664, 25377.70990008201, 74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25067872128626634, "mean_inference_ms": 0.7650010605168418, "mean_action_processing_ms": 0.11907419691218327, "mean_env_wait_ms": 2.4273563354241916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007798075675964355, "StateBufferConnector_ms": 0.0007761120796203613, "ViewRequirementAgentConnector_ms": 0.019239842891693115}, "num_episodes": 16, "episode_return_max": 863243.5082611251, "episode_return_min": -148904.55572262206, "episode_return_mean": 205465.09591120444, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.7669349492192, "num_env_steps_trained_throughput_per_sec": 269.7669349492192, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14843.466, "restore_workers_time_ms": 0.088, "training_step_time_ms": 14843.333, "sample_time_ms": 14260.853, "learn_time_ms": 571.122, "learn_throughput": 7003.761, "synch_weights_time_ms": 5.306}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "ae48a_00000", "date": "2025-10-28_12-22-35", "timestamp": 1761672155, "time_this_iter_s": 14.831668138504028, "time_total_s": 858.5066769123077, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68fb00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 858.5066769123077, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 23.2, "ram_util_percent": 84.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5717747211456299, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.878751856088638, "policy_loss": -0.023901646936428732, "vf_loss": 9.955203166604042, "vf_explained_var": -3.129243850708008e-07, "kl": 0.014542131311009534, "entropy": 6.236560647189617, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 952337.666270986, "episode_reward_min": -148904.55572262206, "episode_reward_mean": 214299.69467175184, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -50313.582888347584, "policy_mm": -42827.83016647408, "policy_rl": -40041.17434481075}, "policy_reward_max": {"policy_mom": 230855.79284481105, "policy_mean": 218477.64010528763, "policy_mm": 264694.7877119011, "policy_rl": 347054.16337296437}, "policy_reward_mean": {"policy_mom": 46133.29061589811, "policy_mean": 47713.20795816873, "policy_mm": 49292.749563143996, "policy_rl": 71160.44653454103}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46133.28515625, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 230855.796875, "('mean_0', 'policy_mean')_total_reward_mean": 47713.203125, "('mean_0', 'policy_mean')_total_reward_min": -50313.58203125, "('mean_0', 'policy_mean')_total_reward_max": 218477.640625, "('mm_0', 'policy_mm')_total_reward_mean": 49292.75, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 264694.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71160.453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40041.17578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 347054.15625}, "hist_stats": {"episode_reward": [253929.1562066458, 797615.6308682248, -59349.195431291235, 863243.5082611251, 60824.17171459591, -148904.55572262206, 354465.8926807108, 2719.1613647981676, 659638.7055343951, -56073.48570347669, 158520.2550006358, 247344.13964216335, 328971.1347685377, 169109.1826928837, 233770.02991409603, 388789.71466786985, 572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [53601.460130262894, 161576.6530128032, -18012.73597930843, 138494.3932455342, 16084.962374675393, -25627.711400423836, 73213.68328815381, -14196.016599976763, 143853.6612090067, -18251.120772544633, 25304.44237136281, 66777.14186359399, 99555.65075673745, 48877.23219658344, 44574.41247774004, 75759.22153534155, 154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543], "policy_policy_mean_reward": [61357.26705675731, 146682.15723746346, -25562.86553494095, 204658.27022426933, -6741.7107702505855, -50313.582888347584, 80510.59921031466, 12650.956691534244, 161947.5300696584, -19851.491461689704, 21445.12899953887, 59698.24133593304, 69312.66359995263, 61179.81253120444, 68417.07223274924, 120405.5748105042, 109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208], "policy_policy_mm_reward": [64535.89985209787, 264694.7877119011, -16793.938755003812, 180982.7116671569, 11121.369580843977, -32922.087089039844, 72351.91868484324, -6420.1417387017345, 168076.13832219565, -30015.08445371285, 38247.58436232538, 50331.20325735224, 67812.37569106724, 35856.173120802654, 51380.78043179871, 73424.95464647566, 123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109], "policy_policy_rl_reward": [74434.52916752783, 224662.03290605693, 1020.3448379620329, 339108.1331241657, 40359.550529327214, -40041.17434481075, 128389.6914973988, 10684.363011942445, 185761.37593353385, 12044.210984470441, 73523.09926740873, 70537.55318528414, 92290.44472078058, 23195.964844293114, 69397.76477180766, 119199.96367554841, 185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506385373024181, "mean_inference_ms": 0.764802476019463, "mean_action_processing_ms": 0.11905646820357091, "mean_env_wait_ms": 2.4271376130010798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000805974006652832, "StateBufferConnector_ms": 0.0007783174514770508, "ViewRequirementAgentConnector_ms": 0.019256949424743652}, "num_episodes": 16, "episode_return_max": 952337.666270986, "episode_return_min": -148904.55572262206, "episode_return_mean": 214299.69467175184, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.02046189245226, "num_env_steps_trained_throughput_per_sec": 261.02046189245226, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 14924.492, "restore_workers_time_ms": 0.12, "training_step_time_ms": 14924.324, "sample_time_ms": 14322.095, "learn_time_ms": 589.607, "learn_throughput": 6784.185, "synch_weights_time_ms": 6.113}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "ae48a_00000", "date": "2025-10-28_12-22-50", "timestamp": 1761672170, "time_this_iter_s": 15.32928991317749, "time_total_s": 873.8359668254852, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6c00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 873.8359668254852, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.650000000000002, "ram_util_percent": 83.86818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6492156982421875, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.879465398192405, "policy_loss": -0.023750154016306625, "vf_loss": 9.954721981287003, "vf_explained_var": 1.027435064315796e-06, "kl": 0.015728701082025787, "entropy": 6.21233332157135, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 952337.666270986, "episode_reward_min": -142150.43242813225, "episode_reward_mean": 216898.25810651082, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -38640.173269601924, "policy_mm": -42827.83016647408, "policy_rl": -22982.152591164824}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 218477.64010528763, "policy_mm": 235750.97638727308, "policy_rl": 348697.1251670014}, "policy_reward_mean": {"policy_mom": 47881.049295177785, "policy_mean": 46095.99044665688, "policy_mm": 49329.83572184573, "policy_rl": 73591.38264283046}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47881.05078125, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 46095.99609375, "('mean_0', 'policy_mean')_total_reward_min": -38640.171875, "('mean_0', 'policy_mean')_total_reward_max": 218477.640625, "('mm_0', 'policy_mm')_total_reward_mean": 49329.83984375, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 235750.96875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73591.3828125, "('rl_trader_0', 'policy_rl')_total_reward_min": -22982.15234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 348697.125}, "hist_stats": {"episode_reward": [572903.0390748945, 7217.198021602185, 196480.4174645531, -125496.58661535656, 799520.0894090973, 184337.40066801468, 169085.82608179032, 202257.23759751575, 7307.440824631972, 118336.67094781931, -89483.57615256197, 258370.70556982912, 283943.6331929078, 797966.5763378738, 90726.53439631066, 41091.47587778919, 20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [154004.88784842283, -19804.252485404802, 80712.19052441527, -24933.2986317712, 230855.79284481105, 21659.225927172574, 49004.30704408224, 31879.450721191944, 16313.21721582949, 34462.630879444725, -16793.553838456213, 58704.97728237859, 78210.34444546037, 154781.77200075894, 18620.644466281625, -6743.082528806193, -6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182], "policy_policy_mean_reward": [109538.0225719419, 10169.300206654963, 30829.382716492546, -38640.173269601924, 210523.23066991425, 38757.97978389821, 40888.02809548416, 48828.398865046074, 8047.323026900922, 9468.816689547333, -37309.72961445718, 78658.29385329854, 79175.16307244242, 216755.26478305022, 28000.588421134536, 26008.451265169726, -1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274], "policy_policy_mm_reward": [123811.43048214838, 1422.2521031604258, 52151.45084482583, -38940.962122818506, 119577.04556188779, 90074.91286461645, 37115.756495837995, 71299.29633600402, -13915.499257494868, 34769.27083375002, -14137.171612398231, 53695.55458874289, 68966.31466658087, 194793.6367216467, 4894.750361690314, 1786.30725081991, 9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834], "policy_policy_rl_reward": [185548.69817238153, 15429.898197191622, 32787.39337881949, -22982.152591164824, 238564.02033248337, 33845.2820923274, 42077.734446385824, 50250.09167527321, -3137.6001606034197, 39635.95254507725, -21243.12108725043, 67311.87984540914, 57591.81100842426, 231635.9028324181, 39210.55114720425, 20039.799890605675, 18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25072561492731005, "mean_inference_ms": 0.7650203510664088, "mean_action_processing_ms": 0.11908918234419112, "mean_env_wait_ms": 2.427668019169073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008559226989746094, "StateBufferConnector_ms": 0.000830233097076416, "ViewRequirementAgentConnector_ms": 0.020267248153686523}, "num_episodes": 16, "episode_return_max": 952337.666270986, "episode_return_min": -142150.43242813225, "episode_return_mean": 216898.25810651082, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.9097913475868, "num_env_steps_trained_throughput_per_sec": 238.9097913475868, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 15131.039, "restore_workers_time_ms": 0.076, "training_step_time_ms": 15130.914, "sample_time_ms": 14529.967, "learn_time_ms": 586.891, "learn_throughput": 6815.575, "synch_weights_time_ms": 7.258}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "ae48a_00000", "date": "2025-10-28_12-23-07", "timestamp": 1761672187, "time_this_iter_s": 16.74760413169861, "time_total_s": 890.5835709571838, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68df80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 890.5835709571838, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.4125, "ram_util_percent": 84.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6008718013763428, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.88241879940033, "policy_loss": -0.018340882761549437, "vf_loss": 9.956405141949654, "vf_explained_var": 1.2114644050598144e-06, "kl": 0.013370140042343642, "entropy": 6.467028647661209, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 952337.666270986, "episode_reward_min": -142150.43242813225, "episode_reward_mean": 207805.2617950272, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -38238.41861351461, "policy_mm": -42827.83016647408, "policy_rl": -19766.123798760153}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 242650.8339573294, "policy_mm": 235750.97638727308, "policy_rl": 348697.1251670014}, "policy_reward_mean": {"policy_mom": 44615.37388051996, "policy_mean": 43719.308732917874, "policy_mm": 47262.57996571551, "policy_rl": 72207.9992158739}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44615.375, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 43719.3046875, "('mean_0', 'policy_mean')_total_reward_min": -38238.41796875, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 47262.578125, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 235750.96875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72207.9921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -19766.123046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 348697.125}, "hist_stats": {"episode_reward": [20645.737797109312, 412852.2516084747, 500008.44780150865, 201093.61179259015, 31869.89521207212, 170770.2641662044, 273785.57466118835, 280233.64938462595, 372171.2217975382, 84692.08912178961, 222053.7445380636, 333132.4595915593, 131207.23582674304, -1616.5718318165202, 69551.53757202836, 325315.73175494064, 99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-6146.351810812207, 87939.90247720784, 66960.19105131135, 54196.034004062996, -2432.283911558859, 57654.83001692055, 39579.53836866818, 46272.41335443344, 104114.03016690516, 6220.975052738892, 26675.892798343422, 112860.41116961106, 44750.69135501473, -16696.227369871103, 4940.827964640653, 70204.8671580627, 25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064], "policy_policy_mean_reward": [-1305.1472239924713, 91438.25535303171, 123834.42116123642, 62667.53471435456, 4992.697352638701, 17147.5358271047, 62971.782367290994, 72950.6808192864, 40918.994138822854, 14212.650456861293, 56012.06641579658, 38988.92874836485, 25051.66563948692, 7079.437638487842, 2771.407225017895, 52079.40414774742, 22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993], "policy_policy_mm_reward": [9697.437945434745, 121841.81104848612, 120544.64753005106, 38931.10986509527, 22684.120696454684, 21151.158039973976, 76924.49234271918, 75521.50148333292, 92582.3337338182, 24238.417752713296, 60185.63973748681, 72140.58097564876, 33803.72893305751, -8981.588716455875, 10916.522994852157, 54245.941535283506, 8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742], "policy_policy_rl_reward": [18399.798886479202, 111632.28272974909, 188669.18805891048, 45298.93320907734, 6625.361074537684, 74816.74028220528, 94309.76158250993, 85489.05372757353, 134555.86375799184, 40020.045859476464, 79180.14558643696, 109142.5386979348, 27601.14989918403, 16981.806616022557, 50922.77938751772, 148785.51891384716, 43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509153077920033, "mean_inference_ms": 0.765568120428602, "mean_action_processing_ms": 0.11916209638755557, "mean_env_wait_ms": 2.4287503626422557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008873939514160156, "StateBufferConnector_ms": 0.000853121280670166, "ViewRequirementAgentConnector_ms": 0.020832180976867676}, "num_episodes": 16, "episode_return_max": 952337.666270986, "episode_return_min": -142150.43242813225, "episode_return_mean": 207805.2617950272, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.06170218394243, "num_env_steps_trained_throughput_per_sec": 245.06170218394243, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 15304.154, "restore_workers_time_ms": 0.082, "training_step_time_ms": 15304.022, "sample_time_ms": 14700.696, "learn_time_ms": 590.515, "learn_throughput": 6773.748, "synch_weights_time_ms": 6.203}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "ae48a_00000", "date": "2025-10-28_12-23-23", "timestamp": 1761672203, "time_this_iter_s": 16.32859492301941, "time_total_s": 906.9121658802032, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e5c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 906.9121658802032, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.2391304347826, "ram_util_percent": 83.74347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7297731637954712, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.88620333969593, "policy_loss": -0.021847018999687863, "vf_loss": 9.960700878500939, "vf_explained_var": -3.2223761081695557e-06, "kl": 0.015357331534369512, "entropy": 6.301672810316086, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -142150.43242813225, "episode_reward_mean": 214510.1903013558, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43502.61724977209, "policy_mean": -38238.41861351461, "policy_mm": -42827.83016647408, "policy_rl": -19766.123798760153}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 242650.8339573294, "policy_mm": 237254.37913185495, "policy_rl": 372153.31917040003}, "policy_reward_mean": {"policy_mom": 46472.34044067659, "policy_mean": 46305.22346257046, "policy_mm": 47699.721274130476, "policy_rl": 74032.9051239783}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46472.33984375, "('mom_0', 'policy_mom')_total_reward_min": -43502.6171875, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 46305.2265625, "('mean_0', 'policy_mean')_total_reward_min": -38238.41796875, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 47699.71484375, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 74032.90625, "('rl_trader_0', 'policy_rl')_total_reward_min": -19766.123046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 372153.3125}, "hist_stats": {"episode_reward": [99526.80879235083, 119910.6164583438, -5356.185119616979, 49001.32999996384, -24433.80835370777, 38826.98957052935, 273427.5081724948, -7564.43503722655, 621542.5523375467, 136215.6071161218, 100742.56147404971, 1855.4282859112573, 364671.1559382002, -86574.95412951826, 115390.85681221032, 232975.41443770763, 307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [25350.793252099083, 29084.444118249652, -4903.786431353398, -7914.0461623502615, -3090.989543447732, -4546.481245282952, 43266.08367869837, 9174.452704989331, 94711.56341392153, 36039.59254387172, 23041.62257277604, -5673.393954286348, 69747.18573431342, -43502.61724977209, 21179.70635195313, 66989.13143007751, 64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066], "policy_policy_mean_reward": [22333.330675536858, 39436.23701309689, -15265.832360702472, 9924.312767045725, -24088.734104476804, 18174.250809077716, 79040.18066163767, -11669.51733721626, 218477.64010528763, 22907.926503712853, 15106.895829755666, 2588.2735419218902, 118002.35774725402, -19064.2389849374, 19598.631450799607, 57840.554564323415, 112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874], "policy_policy_mm_reward": [8692.807948384656, 24440.532510665984, 6286.470384106051, 20768.154863735755, -629.2582549739674, 13402.064101354103, 58316.69608939993, 472.5148000787539, 96919.45117773021, 26736.203307411903, 9030.77132793669, -5367.94545358909, 60459.18434757117, -10778.650410939968, 28434.68469593395, 39380.32209689299, 50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652], "policy_policy_rl_reward": [43149.87691633025, 26949.402816331094, 8526.963288332629, 26222.908531532685, 3375.1735491908353, 11797.155905380427, 92804.54774275905, -5541.885205078434, 211433.8976406076, 50531.884761125395, 53563.27174358094, 10308.49415186463, 116462.42810906202, -13229.447483868687, 46177.83431352387, 68765.40634641377, 80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25108235936616774, "mean_inference_ms": 0.7660484171540378, "mean_action_processing_ms": 0.11922605236022786, "mean_env_wait_ms": 2.42974243653636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008779764175415039, "StateBufferConnector_ms": 0.00084686279296875, "ViewRequirementAgentConnector_ms": 0.020738959312438965}, "num_episodes": 16, "episode_return_max": 1034945.8216006276, "episode_return_min": -142150.43242813225, "episode_return_mean": 214510.1903013558, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.4538627644973, "num_env_steps_trained_throughput_per_sec": 272.4538627644973, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 15284.836, "restore_workers_time_ms": 0.076, "training_step_time_ms": 15284.711, "sample_time_ms": 14702.738, "learn_time_ms": 568.378, "learn_throughput": 7037.574, "synch_weights_time_ms": 7.048}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "ae48a_00000", "date": "2025-10-28_12-23-38", "timestamp": 1761672218, "time_this_iter_s": 14.685533046722412, "time_total_s": 921.5976989269257, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d8a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 921.5976989269257, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.27619047619048, "ram_util_percent": 81.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6937789916992188, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.884847757220268, "policy_loss": -0.021065577330591622, "vf_loss": 9.958768931031226, "vf_explained_var": -4.621408879756927e-06, "kl": 0.017401285527467118, "entropy": 6.4601488128304485, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -142150.43242813225, "episode_reward_mean": 230680.52619413476, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42209.46794794258, "policy_mean": -38238.41861351461, "policy_mm": -42827.83016647408, "policy_rl": -19766.123798760153}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 242650.8339573294, "policy_mm": 237254.37913185495, "policy_rl": 372153.31917040003}, "policy_reward_mean": {"policy_mom": 51668.293114450054, "policy_mean": 48436.72778260917, "policy_mm": 52608.51295072082, "policy_rl": 77966.99234635473}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51668.296875, "('mom_0', 'policy_mom')_total_reward_min": -42209.46875, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 48436.73046875, "('mean_0', 'policy_mean')_total_reward_min": -38238.41796875, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 52608.515625, "('mm_0', 'policy_mm')_total_reward_min": -42827.83203125, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77966.9921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -19766.123046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 372153.3125}, "hist_stats": {"episode_reward": [307608.8493904616, 231476.7247744464, 145584.04558340408, -77034.4064815752, 820035.1219017729, 745706.265798729, -142150.43242813225, 254346.7128133447, 329693.8139897265, -40931.262594800515, -51860.219767168644, 356221.83017771324, 253403.99035326845, 3523.8382229805907, 126163.0586005552, 249615.64586843274, 203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [64273.16563218045, 51761.357736222395, 14175.959264916808, -25428.402811041913, 169879.1525511915, 176261.19323727087, -41318.05984938349, 72410.68115411844, 79665.32937015893, -30550.600665770664, -32314.70587419998, 65514.95021036329, 73847.14301098404, -2652.0788314043466, 25034.535107622094, 64462.531665059585, 37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422], "policy_policy_mean_reward": [112536.45128363762, 51612.45456263215, 51313.0124344327, -12395.492824211013, 137331.51878435074, 119957.47371328853, -38238.41861351461, 73490.78626398166, 87108.50997090618, -3713.7104187887676, -2018.6772386897503, 86893.64876966078, 50791.99528286025, -492.2925379556393, 41516.62766288025, 54179.96208697606, 73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079], "policy_policy_mm_reward": [50207.08875531417, 54604.56723903374, 36118.32572489868, -21643.89027288357, 235750.97638727308, 201191.4380853301, -42827.83016647408, 44327.656565971396, 81180.77557442425, -2589.5114980349103, -7071.697795303101, 45236.55695540591, 72901.66529097853, -4495.57668767287, 24905.079860420454, 55519.60611629605, 35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435], "policy_policy_rl_reward": [80592.14371932908, 73498.34523655815, 43976.7481591552, -17566.62057343868, 277073.4741789586, 248296.1607628399, -19766.123798760153, 64117.58882927321, 81739.19907423713, -4077.4400122060015, -10455.138858975795, 158576.6742422832, 55863.18676844577, 11163.786280013373, 34706.81596963249, 75453.54600010075, 56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25126748924110553, "mean_inference_ms": 0.7665884464915541, "mean_action_processing_ms": 0.11929863995898592, "mean_env_wait_ms": 2.430892911812636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0009017586708068848, "StateBufferConnector_ms": 0.0008590817451477051, "ViewRequirementAgentConnector_ms": 0.021130084991455078}, "num_episodes": 16, "episode_return_max": 1034945.8216006276, "episode_return_min": -142150.43242813225, "episode_return_mean": 230680.52619413476, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.4572481002365, "num_env_steps_trained_throughput_per_sec": 254.4572481002365, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 15344.693, "restore_workers_time_ms": 0.084, "training_step_time_ms": 15344.558, "sample_time_ms": 14752.774, "learn_time_ms": 576.897, "learn_throughput": 6933.644, "synch_weights_time_ms": 7.342}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "ae48a_00000", "date": "2025-10-28_12-23-54", "timestamp": 1761672234, "time_this_iter_s": 15.72506308555603, "time_total_s": 937.3227620124817, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e8180>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 937.3227620124817, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.37826086956522, "ram_util_percent": 83.65217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.763423204421997, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.888113760948182, "policy_loss": -0.017934077559038995, "vf_loss": 9.961738854646683, "vf_explained_var": -2.5155022740364075e-06, "kl": 0.0134937598891159, "entropy": 6.479928486049175, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -112279.87566308033, "episode_reward_mean": 245155.57227345943, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42209.46794794258, "policy_mean": -28817.54434261559, "policy_mm": -40809.49472374667, "policy_rl": -30945.000433621826}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 242650.8339573294, "policy_mm": 237254.37913185495, "policy_rl": 376086.9512284732}, "policy_reward_mean": {"policy_mom": 54971.10581497852, "policy_mean": 51433.33945569806, "policy_mm": 53993.95889349792, "policy_rl": 84757.16810928489}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54971.10546875, "('mom_0', 'policy_mom')_total_reward_min": -42209.46875, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 51433.3359375, "('mean_0', 'policy_mean')_total_reward_min": -28817.544921875, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 53993.9609375, "('mm_0', 'policy_mm')_total_reward_min": -40809.49609375, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 84757.171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -30945.0, "('rl_trader_0', 'policy_rl')_total_reward_max": 376086.9375}, "hist_stats": {"episode_reward": [203176.95611524052, 152748.52290755318, 602981.6693199103, 80733.94754743022, -35969.1015027495, 10199.009827594566, 952337.666270986, 288644.33948100876, 282212.53519306803, 44096.03890255535, 705475.5637866373, 203426.39540466215, 52549.39526873538, -23191.25077630983, 265562.22004165075, 350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [37777.99629218414, 43314.578279403424, 177400.29846694152, 36725.55090813986, -4156.813878989132, 6073.574132784667, 206638.94808129218, 49037.29371990549, 67418.25706962851, -3492.772382859247, 168158.84728174022, 60072.93926418756, 18151.27129619721, -4720.648741126046, 38967.96153247855, 93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766], "policy_policy_mean_reward": [73467.41680532321, 35887.341123591985, 127223.61592177123, 21647.812833166416, -10771.01374343503, -21438.772113453975, 190258.66896638394, 53193.111952106236, 32896.76675375311, -11361.337288661593, 81265.71067219412, 61686.92387687074, -4490.754664157144, -14617.521370577137, 102641.6787070491, 87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484], "policy_policy_mm_reward": [35208.86863114843, 50661.05967572133, 110618.01988110074, 12930.246328993548, -8487.80277734825, -5.025474420993409, 208385.88585034478, 106297.17693350856, 92036.6296256613, 6206.865553142814, 171192.14951206176, 44417.286434881884, 15274.757770071323, -3093.9369585906024, 80789.52120694648, 64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265], "policy_policy_rl_reward": [56722.67438658487, 22885.543828836428, 187739.73505009673, 9430.337477130384, -12553.471102977237, 25569.233282684952, 347054.16337296437, 80116.75687548831, 89860.88174402513, 52743.283020933384, 284858.85632064036, 37249.24582872198, 23614.12086662392, -759.143706016007, 43163.058595176604, 104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514843947829635, "mean_inference_ms": 0.7672526328068686, "mean_action_processing_ms": 0.11938732509155468, "mean_env_wait_ms": 2.4321919054809165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0009019970893859863, "StateBufferConnector_ms": 0.000873863697052002, "ViewRequirementAgentConnector_ms": 0.021365702152252197}, "num_episodes": 16, "episode_return_max": 1034945.8216006276, "episode_return_min": -112279.87566308033, "episode_return_mean": 245155.57227345943, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.7098721271967, "num_env_steps_trained_throughput_per_sec": 257.7098721271967, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 15428.121, "restore_workers_time_ms": 0.085, "training_step_time_ms": 15427.986, "sample_time_ms": 14839.727, "learn_time_ms": 573.591, "learn_throughput": 6973.612, "synch_weights_time_ms": 7.094}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "ae48a_00000", "date": "2025-10-28_12-24-09", "timestamp": 1761672249, "time_this_iter_s": 15.52721881866455, "time_total_s": 952.8499808311462, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e8cc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.8499808311462, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.41818181818182, "ram_util_percent": 84.11818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5912480354309082, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880382430553436, "policy_loss": -0.022810744479647836, "vf_loss": 9.957464453577995, "vf_explained_var": -4.2082741856575016e-06, "kl": 0.014149160890974894, "entropy": 6.382197606563568, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 242759.67568303648, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -40809.49472374667, "policy_rl": -30945.000433621826}, "policy_reward_max": {"policy_mom": 263660.3350274165, "policy_mean": 242650.8339573294, "policy_mm": 237254.37913185495, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 54188.77426434771, "policy_mean": 50214.77646352523, "policy_mm": 52512.54818493425, "policy_rl": 85843.57677022928}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54188.76953125, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 263660.34375, "('mean_0', 'policy_mean')_total_reward_mean": 50214.76953125, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 52512.55078125, "('mm_0', 'policy_mm')_total_reward_min": -40809.49609375, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 85843.578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -30945.0, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [350807.40523122007, 41968.335593948366, -18994.065105962294, 299357.91847230785, 233340.5322865569, 280312.86173788516, 129587.58517216645, 178403.5968840731, 306709.03330532234, 207313.92121064206, 169871.51427538274, 66226.99624667125, 918821.4530764496, 143557.4108062176, 70649.87219719429, 174680.33489916488, 538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [93568.35000284221, 29803.8535035928, -23779.413625188787, 80794.00497429915, 31983.248018580543, 95496.97333627974, 15482.579434934283, 25463.990822911157, 73726.33142930274, 47987.0961435641, 6577.439165818032, 20449.40813129571, 263660.3350274165, 42545.15589503558, 16610.44842205732, 50501.14842649688, 82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375], "policy_policy_mean_reward": [87852.1039930812, 75.95454140338613, -17274.685677239955, 67857.13413726288, 54798.24306277208, 37562.75374508928, 34536.67275200755, 37560.6172473547, 66172.78402553874, 46112.026776871426, 18193.564064875114, 12293.442169692496, 87529.0980886711, 28600.920949675205, 24996.55867722902, 19562.855107315958, 117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114], "policy_policy_mm_reward": [64714.51409888731, -6533.891527967341, 10371.915333076233, 69864.43421000663, 62090.20103114109, 53382.016585746875, 36739.03790978154, 41572.0610667967, 64975.18593250712, 58719.05876954669, 47970.84890540211, -3765.270009113553, 218934.89479336108, 24299.57172864508, 6418.086426069362, 40208.62175925701, 107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826], "policy_policy_rl_reward": [104672.43713641017, 18622.41907691944, 11688.118863390164, 80842.34515073907, 84468.84017406352, 93871.11807076882, 42829.2950754431, 73806.92774701046, 101834.73191797383, 54495.739520660005, 97129.66213928717, 37249.41595479648, 348697.1251670014, 48111.76223286165, 22624.77867183863, 64407.70960609482, 231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516833740505685, "mean_inference_ms": 0.767851572417852, "mean_action_processing_ms": 0.11946826112550304, "mean_env_wait_ms": 2.433425615531624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0009096264839172363, "StateBufferConnector_ms": 0.0008727908134460449, "ViewRequirementAgentConnector_ms": 0.021439790725708008}, "num_episodes": 15, "episode_return_max": 1034945.8216006276, "episode_return_min": -163217.66354633836, "episode_return_mean": 242759.67568303648, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.8678573733738, "num_env_steps_trained_throughput_per_sec": 265.8678573733738, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 15466.732, "restore_workers_time_ms": 0.098, "training_step_time_ms": 15466.583, "sample_time_ms": 14878.434, "learn_time_ms": 573.601, "learn_throughput": 6973.494, "synch_weights_time_ms": 6.919}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "ae48a_00000", "date": "2025-10-28_12-24-24", "timestamp": 1761672264, "time_this_iter_s": 15.048832893371582, "time_total_s": 967.8988137245178, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c7c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 967.8988137245178, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.371428571428574, "ram_util_percent": 83.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4995204210281372, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.873884212970733, "policy_loss": -0.02096687785233371, "vf_loss": 9.952573442459107, "vf_explained_var": -1.5473738312721252e-05, "kl": 0.012520973614505571, "entropy": 6.617405481636524, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 215563.90917505388, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -40809.49472374667, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 227334.80815788018, "policy_mean": 242650.8339573294, "policy_mm": 237254.37913185495, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 47564.10943602232, "policy_mean": 45394.86177907365, "policy_mm": 45927.81746893643, "policy_rl": 76677.12049102149}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47564.11328125, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 227334.8125, "('mean_0', 'policy_mean')_total_reward_mean": 45394.86328125, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 242650.828125, "('mm_0', 'policy_mm')_total_reward_mean": 45927.81640625, "('mm_0', 'policy_mm')_total_reward_min": -40809.49609375, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76677.125, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [538429.2084628524, 791984.9531633686, 21886.345970609767, 166975.38302032964, 349059.3195068607, 214052.94709232295, 317829.76620173076, 398657.3927800457, 797837.2246097779, -54655.234699855275, 257110.27717820735, 149009.85966432578, -112279.87566308033, -3125.8018578185915, 11426.693765083503, 94182.98080513091, 116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [82738.10948043026, 172851.68969128118, 2124.091033116474, 25065.125765227094, 105081.27543234182, 29728.66553553078, 89070.54181912405, 51032.813545320896, 172571.61101095288, -11749.436624853333, 83515.28170534752, 34493.63057683842, -42209.46794794258, -17543.59176225551, 5254.745184263996, 15770.199741024555, 24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723], "policy_policy_mean_reward": [117112.23770967568, 175124.12834995714, 6889.878883860033, 31779.041402969593, 60047.29224268274, 43777.81341369446, 65575.98865932273, 114083.41753704465, 242650.8339573294, -26487.15142999164, 36240.46251982009, 49026.47537958914, -27175.290868298653, -10681.616430289972, -1364.9607121256133, 6779.667877963911, 34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901], "policy_policy_mm_reward": [107452.03944649453, 185925.7653816019, 586.4870319813782, 49133.04426437177, 63821.81117012834, 80557.84271764071, 57109.90140680255, 97196.58842086198, 144770.38143536513, 264.575146872209, 55142.293783325185, 11089.55555275638, -31870.01927598331, -2905.987048187699, 10457.193300417588, 36876.79541501051, 32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013], "policy_policy_rl_reward": [231126.82182625204, 258083.369740529, 12285.889021651847, 60998.171587761106, 120108.94066170824, 59988.62542545737, 106073.33431648133, 136344.5732768185, 237844.39820613022, -16683.221791882497, 82212.23916971481, 54400.19815514188, -11025.097570855865, 28005.39338291458, -2920.284007472467, 34756.317771131886, 25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.251817177942887, "mean_inference_ms": 0.7682408541845672, "mean_action_processing_ms": 0.11952405647195985, "mean_env_wait_ms": 2.4342862031399313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008400678634643555, "StateBufferConnector_ms": 0.0008361339569091797, "ViewRequirementAgentConnector_ms": 0.02048361301422119}, "num_episodes": 16, "episode_return_max": 1034945.8216006276, "episode_return_min": -163217.66354633836, "episode_return_mean": 215563.90917505388, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.05043589559006, "num_env_steps_trained_throughput_per_sec": 264.05043589559006, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 15460.238, "restore_workers_time_ms": 0.105, "training_step_time_ms": 15460.081, "sample_time_ms": 14860.184, "learn_time_ms": 585.456, "learn_throughput": 6832.285, "synch_weights_time_ms": 6.825}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "ae48a_00000", "date": "2025-10-28_12-24-39", "timestamp": 1761672279, "time_this_iter_s": 15.15224003791809, "time_total_s": 983.0510537624359, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68f420>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 983.0510537624359, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.24545454545455, "ram_util_percent": 83.37727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6404165029525757, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.872614830732346, "policy_loss": -0.027723346540005876, "vf_loss": 9.954192346334457, "vf_explained_var": -4.846975207328796e-06, "kl": 0.01590569448419501, "entropy": 6.459045206010342, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 1034945.8216006276, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 208958.80210959396, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -40809.49472374667, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 227334.80815788018, "policy_mean": 257837.59159980176, "policy_mm": 237254.37913185495, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 47989.216408852, "policy_mean": 44590.86734464535, "policy_mm": 43717.9695544877, "policy_rl": 72660.74880160898}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47989.21484375, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 227334.8125, "('mean_0', 'policy_mean')_total_reward_mean": 44590.86328125, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 257837.59375, "('mm_0', 'policy_mm')_total_reward_mean": 43717.96875, "('mm_0', 'policy_mm')_total_reward_min": -40809.49609375, "('mm_0', 'policy_mm')_total_reward_max": 237254.375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72660.7421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [116833.50495026764, -99870.22441840246, 282734.4065945489, 47945.94569568438, 187574.5888503808, 106605.10360215984, 59893.86872308552, 1034945.8216006276, 70472.86282026679, 20496.097517745777, 327064.2214739444, 308854.13269470516, -13718.716361330378, -107860.0784490361, 654092.1398989755, 136163.16723121094, 391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [24497.111939448103, -32681.94391458101, 93348.20216184834, 4317.565639840852, 34951.78364012064, 24013.71624360073, 780.4189470900841, 204526.927418696, 33947.214756112386, -21875.223669878716, 76273.19182099384, 58242.583426956146, -8648.456033398581, -32881.87957462795, 137930.71568201765, 40289.75509963251, 133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301], "policy_policy_mean_reward": [34303.122995404745, -28817.54434261559, 51711.09730867489, 7330.633776193353, 65077.22012129993, 11141.174624004625, 21185.949099282378, 221011.19587967574, 14456.320185248213, 18648.021996411764, 91633.4777205228, 68164.45810319975, -2577.65313325896, -17265.69013124255, 126692.0391359137, 33281.44787709296, 85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176], "policy_policy_mm_reward": [32972.61221375522, -21063.937675802474, 51435.61036193085, 12428.816635235635, 46176.54811597742, 47659.94478255394, -6141.9018934003525, 237254.37913185495, 3493.520237277746, 11774.373323001015, 47390.65019178374, 45459.38554735577, -13561.75475362682, -40809.49472374667, 193557.05102395144, 23885.495108164094, 81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283], "policy_policy_rl_reward": [25060.657801659523, -17306.798485403306, 86239.49676209361, 23868.92964441469, 41369.036972982794, 23790.26795200056, 44069.4025701134, 372153.31917040003, 18575.807641628402, 11948.925868211787, 111766.90174064429, 136987.70561719342, 11069.147558953824, -16903.014019419246, 195912.33405709322, 38706.469146321324, 90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519407203365113, "mean_inference_ms": 0.7686269034193998, "mean_action_processing_ms": 0.11958054965984022, "mean_env_wait_ms": 2.435230553971714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000830531120300293, "StateBufferConnector_ms": 0.0008186697959899902, "ViewRequirementAgentConnector_ms": 0.020156025886535645}, "num_episodes": 16, "episode_return_max": 1034945.8216006276, "episode_return_min": -163217.66354633836, "episode_return_mean": 208958.80210959396, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.49901571070322, "num_env_steps_trained_throughput_per_sec": 233.49901571070322, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15646.425, "restore_workers_time_ms": 0.104, "training_step_time_ms": 15646.248, "sample_time_ms": 15005.004, "learn_time_ms": 624.387, "learn_throughput": 6406.279, "synch_weights_time_ms": 8.387}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "ae48a_00000", "date": "2025-10-28_12-24-57", "timestamp": 1761672297, "time_this_iter_s": 17.142875909805298, "time_total_s": 1000.1939296722412, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6840>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1000.1939296722412, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 83.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7185159921646118, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.874744641780854, "policy_loss": -0.026685318849195026, "vf_loss": 9.954838520288467, "vf_explained_var": -3.6699697375297546e-06, "kl": 0.015010446364295021, "entropy": 6.354060837626458, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 1001044.950914719, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 213298.9866720225, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -38426.94103835319, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 227334.80815788018, "policy_mean": 257837.59159980176, "policy_mm": 207896.80792322528, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 50370.21791921643, "policy_mean": 45473.5288030314, "policy_mm": 44744.312346446924, "policy_rl": 72710.9276033278}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50370.21875, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 227334.8125, "('mean_0', 'policy_mean')_total_reward_mean": 45473.5234375, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 257837.59375, "('mm_0', 'policy_mm')_total_reward_mean": 44744.3203125, "('mm_0', 'policy_mm')_total_reward_min": -38426.94140625, "('mm_0', 'policy_mm')_total_reward_max": 207896.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72710.9296875, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [391578.45146940136, 15839.798889875212, 252961.7113057392, 344064.2391728457, 496806.90983726183, 177327.33054933182, -20196.517995984825, 63089.77372877987, 592678.3823661063, 252832.2188669809, 26841.730311791613, 728205.427505037, 66339.60083387949, 317950.79229697253, 707021.0406816571, -13462.80135891534, -64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [133570.55956276876, 5886.3376647350715, 55671.27310371285, 80592.52776874021, 94472.73564419066, 21294.85445469487, -19601.939356323743, 22802.12597426116, 172910.30314164763, 75491.23245158278, 12905.378747227991, 192448.02879077138, 14611.961325520284, 79210.03276544796, 99235.3014620346, -9560.166266276765, -18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521], "policy_policy_mean_reward": [85997.23062010994, -18849.364695894557, 69394.76649427788, 89707.3513214132, 117783.06265003874, 41292.676814565464, -19822.201961731433, -6180.070541419643, 106416.07874511367, 57892.2272720347, 4237.63198203494, 157221.5641863921, 17442.97120691798, 73801.48574189206, 170644.51164952398, 4542.92840948675, -16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865], "policy_policy_mm_reward": [81087.5823106294, 718.696052837073, 35812.87803107285, 98224.5252326748, 104336.6571370652, 51885.95862954491, -2884.7777345345667, 6587.46857314037, 154628.0732890965, 59714.484793352836, -6061.999009837762, 137237.12370125152, 22161.79805194278, 87171.38204217031, 207896.80792322528, -6392.407625942548, -20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685], "policy_policy_rl_reward": [90923.07897589318, 28084.129868197626, 92082.79367667578, 75539.8348500175, 180214.4544059675, 62853.84065052657, 22112.401056605016, 39880.249722798006, 158723.92719024885, 59734.274350010484, 15760.718592366502, 241298.71082662194, 12122.870249498666, 77767.89174746239, 229244.41964687296, -2053.1558761828096, -9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2520644978700434, "mean_inference_ms": 0.7690285177204956, "mean_action_processing_ms": 0.11963798734025233, "mean_env_wait_ms": 2.436216956932893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008298158645629883, "StateBufferConnector_ms": 0.0008167624473571777, "ViewRequirementAgentConnector_ms": 0.020158469676971436}, "num_episodes": 16, "episode_return_max": 1001044.950914719, "episode_return_min": -163217.66354633836, "episode_return_mean": 213298.9866720225, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.63161900214857, "num_env_steps_trained_throughput_per_sec": 261.63161900214857, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 15692.526, "restore_workers_time_ms": 0.102, "training_step_time_ms": 15692.353, "sample_time_ms": 15055.877, "learn_time_ms": 619.606, "learn_throughput": 6455.716, "synch_weights_time_ms": 8.325}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "ae48a_00000", "date": "2025-10-28_12-25-12", "timestamp": 1761672312, "time_this_iter_s": 15.29369592666626, "time_total_s": 1015.4876255989075, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c7c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1015.4876255989075, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 24.91818181818182, "ram_util_percent": 82.99545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7270212173461914, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.886701914668084, "policy_loss": -0.019122211102512665, "vf_loss": 9.961781400442124, "vf_explained_var": -3.0994415283203126e-07, "kl": 0.013583041816855542, "entropy": 6.512583780288696, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 1001044.950914719, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 211774.47708853357, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -38426.94103835319, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 227334.80815788018, "policy_mean": 257837.59159980176, "policy_mm": 183181.05421078563, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 49929.123450375155, "policy_mean": 45260.87009177968, "policy_mm": 44716.741367143804, "policy_rl": 71867.74217923493}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49929.12890625, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 227334.8125, "('mean_0', 'policy_mean')_total_reward_mean": 45260.87109375, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 257837.59375, "('mm_0', 'policy_mm')_total_reward_mean": 44716.75, "('mm_0', 'policy_mm')_total_reward_min": -38426.94140625, "('mm_0', 'policy_mm')_total_reward_max": 183181.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71867.7421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [-64205.20585695271, 177564.71771959067, 220775.8151087802, 165267.76483238104, 249160.96644381934, 1001044.950914719, 578730.5744685498, 306586.2984482791, 49244.89873300775, 498306.44080407737, 803845.3638040074, 710174.8604879814, -3653.653024039714, -94385.62684085069, 190087.4688934833, 425293.2462218991, 110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-18048.32587109515, 55996.511443043295, 38165.77589712229, 56837.055048410795, 73850.39858373422, 217565.67490548623, 136319.0799996968, 77246.81432563558, -1373.4028394498591, 145184.6175385298, 161162.06565959618, 134125.10111527357, -923.0397737995626, -14355.943927364475, 38121.45081362746, 107927.73540195632, 22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983], "policy_policy_mean_reward": [-16411.936553326963, 39734.32141127413, 55642.58181559365, 27772.44002356531, 52265.49068407079, 224211.27056997595, 127935.58815328164, 70471.04355799659, 6294.971183140423, 105142.93278992867, 176819.78794363316, 159892.9088782301, -90.49058712979374, -19569.35739994571, 61567.51322722222, 67955.93579340217, 29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279], "policy_policy_mm_reward": [-20057.55674112029, 35705.829324853505, 58262.8932188627, 36041.484099704074, 45546.608655022435, 183181.05421078563, 121234.79279687919, 94351.06301938921, -10192.939811926484, 112418.53184754262, 97275.31534983552, 142742.63544331182, -5944.347282558553, -29515.325079918643, 36571.60857163811, 102843.83115133733, 16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682], "policy_policy_rl_reward": [-9687.38669141024, 46128.0555404196, 68704.56417720155, 44616.78566070081, 77498.4685209921, 376086.9512284732, 193241.1135186915, 64517.377545257485, 54516.27020124366, 135560.35862807618, 368588.1948509423, 273414.2150511652, 3304.224619448178, -30945.000433621826, 53826.89628099562, 146565.74387520316, 41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2521986130902178, "mean_inference_ms": 0.769471644125907, "mean_action_processing_ms": 0.11969997085215155, "mean_env_wait_ms": 2.4372026152690136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008105635643005371, "StateBufferConnector_ms": 0.0008093714714050293, "ViewRequirementAgentConnector_ms": 0.019949257373809814}, "num_episodes": 16, "episode_return_max": 1001044.950914719, "episode_return_min": -163217.66354633836, "episode_return_mean": 211774.47708853357, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.33561171938254, "num_env_steps_trained_throughput_per_sec": 257.33561171938254, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 15714.467, "restore_workers_time_ms": 0.073, "training_step_time_ms": 15714.327, "sample_time_ms": 15097.374, "learn_time_ms": 601.777, "learn_throughput": 6646.977, "synch_weights_time_ms": 7.211}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "ae48a_00000", "date": "2025-10-28_12-25-28", "timestamp": 1761672328, "time_this_iter_s": 15.54795217514038, "time_total_s": 1031.0355777740479, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e8680>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1031.0355777740479, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.286363636363635, "ram_util_percent": 82.67727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6954647302627563, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.881279182434081, "policy_loss": -0.023100390810577666, "vf_loss": 9.96050500869751, "vf_explained_var": -1.9224360585212706e-06, "kl": 0.014778397228838318, "entropy": 6.610089313983917, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 956244.1357463619, "episode_reward_min": -163217.66354633836, "episode_reward_mean": 198915.77274662253, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -46743.401292025286, "policy_mean": -50232.57904381257, "policy_mm": -41384.80232091054, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 227334.80815788018, "policy_mean": 257837.59159980176, "policy_mm": 221669.40412667245, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 46991.88336062317, "policy_mean": 42787.551508679215, "policy_mm": 44464.80377867888, "policy_rl": 64671.53409864131}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46991.87890625, "('mom_0', 'policy_mom')_total_reward_min": -46743.40234375, "('mom_0', 'policy_mom')_total_reward_max": 227334.8125, "('mean_0', 'policy_mean')_total_reward_mean": 42787.55078125, "('mean_0', 'policy_mean')_total_reward_min": -50232.578125, "('mean_0', 'policy_mean')_total_reward_max": 257837.59375, "('mm_0', 'policy_mm')_total_reward_mean": 44464.8046875, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 221669.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64671.53125, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [110083.04689295543, -46652.28190667921, 141988.9853005404, 29623.413286654988, 258590.1976510351, -44149.08157410754, 166239.3008452605, 339486.9120946126, 123350.68706831922, 157705.46199286485, 147611.51669458652, -163217.66354633836, 87145.71191648197, -33847.99802456704, 426697.4878257718, 288538.3988953891, 956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [22046.723395581408, -25368.97854961593, -2204.5960022341183, 14497.52579986881, 45332.593098345766, 3714.0042411077784, 39060.31127592085, 53240.68646563406, 33548.73724957267, 29454.64564593578, 49098.57325205838, -46743.401292025286, 27769.63100627693, -17200.133439445857, 96253.88004799258, 67429.09874378149, 227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594], "policy_policy_mean_reward": [29898.212741126103, -10414.338422134098, 41256.232098247805, 5953.505775913846, 62209.3001884484, -19484.953978533267, 23882.33633822673, 64485.65362347419, 17165.8854180581, 16698.530720880593, 18423.930972349895, -50232.57904381257, 6950.723071385641, -13487.361818929663, 92698.70547996684, 61691.27038433775, 173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776], "policy_policy_mm_reward": [16764.71145482041, -13509.144223867212, 29869.31142879371, 12321.157556772903, 71447.56797985265, -28445.661023467903, 56211.72355787942, 87408.13392311323, 25370.919282193834, 84072.75974255534, 32954.4219933861, -38426.94103835319, 16953.175997200335, -25409.91949630428, 112416.12138980943, 78126.89759537522, 130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245], "policy_policy_rl_reward": [41373.39930142743, 2640.1792889378676, 73068.03777573312, -3148.7758459006423, 79600.73638438835, 67.5291867858719, 47084.92967323333, 134352.4380823913, 47265.14511849465, 27479.52588349346, 47134.59047679233, -27814.742172147213, 35472.18184161906, 22249.416730112735, 125328.78090800387, 81291.13217189466, 424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25232271547938395, "mean_inference_ms": 0.7698807269145067, "mean_action_processing_ms": 0.11975923595315435, "mean_env_wait_ms": 2.4381373471081127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007924437522888184, "StateBufferConnector_ms": 0.0007911324501037598, "ViewRequirementAgentConnector_ms": 0.019634664058685303}, "num_episodes": 16, "episode_return_max": 956244.1357463619, "episode_return_min": -163217.66354633836, "episode_return_mean": 198915.77274662253, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.4961462791342, "num_env_steps_trained_throughput_per_sec": 257.4961462791342, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15593.616, "restore_workers_time_ms": 0.068, "training_step_time_ms": 15593.481, "sample_time_ms": 14960.085, "learn_time_ms": 618.887, "learn_throughput": 6463.212, "synch_weights_time_ms": 6.59}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "ae48a_00000", "date": "2025-10-28_12-25-43", "timestamp": 1761672343, "time_this_iter_s": 15.539427042007446, "time_total_s": 1046.5750048160553, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e9260>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1046.5750048160553, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.981818181818177, "ram_util_percent": 83.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7817027568817139, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.882394525408746, "policy_loss": -0.022428680266602895, "vf_loss": 9.958496037125588, "vf_explained_var": 1.524202525615692e-06, "kl": 0.01576087984867659, "entropy": 6.431146292388439, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1140496.2961861512, "episode_reward_min": -156280.15577620038, "episode_reward_mean": 226285.46445493863, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39428.917973872325, "policy_mean": -42791.16357849054, "policy_mm": -41384.80232091054, "policy_rl": -39839.40986321983}, "policy_reward_max": {"policy_mom": 281699.40192028537, "policy_mean": 289170.0442563668, "policy_mm": 221669.40412667245, "policy_rl": 424918.2856854207}, "policy_reward_mean": {"policy_mom": 54877.972905182425, "policy_mean": 49725.53192156031, "policy_mm": 48643.49641248308, "policy_rl": 73038.4632157128}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54877.98046875, "('mom_0', 'policy_mom')_total_reward_min": -39428.91796875, "('mom_0', 'policy_mom')_total_reward_max": 281699.40625, "('mean_0', 'policy_mean')_total_reward_mean": 49725.53125, "('mean_0', 'policy_mean')_total_reward_min": -42791.1640625, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 48643.5, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 221669.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73038.4609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -39839.41015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 424918.28125}, "hist_stats": {"episode_reward": [956244.1357463619, 525070.6417787508, 236962.8150176103, 331555.92201468453, 52199.339554841106, -12255.027040915347, 180418.6420666151, 100702.0799618493, -119400.35804132174, 127852.95413612152, 250041.53041125374, 271978.1667225631, 38268.358030216856, -77139.70972300415, -152491.74513666958, 143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [227334.80815788018, 140658.62810964035, 63207.49603927028, 52307.160755228375, -1521.4782814178907, 4170.164402500638, 35302.736136553714, 38332.654020865186, -23509.753755114096, 39923.21222563691, 59439.424475546606, 47752.53485279815, 4892.644965419382, -16636.672521233097, -39428.917973872325, 53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703], "policy_policy_mean_reward": [173570.14872067573, 108176.98021530402, 25213.902939745978, 69880.1761715114, 9708.26650182367, -20668.300329360518, 42901.24396551526, 20199.995001974836, -37516.11881445879, 32011.40944371868, 48571.9335962552, 88764.50334294184, -2198.96725694379, -18941.536844953003, -38927.703119286016, 19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502], "policy_policy_mm_reward": [130420.89318238477, 95138.84324254, 54937.626326286016, 92561.63666225826, -239.4941413145878, -11022.253278727236, 49158.57575716534, 22780.817256431692, -35632.516378251064, 32431.345363036122, 72273.97899736864, 30371.09618776204, 12793.291136504482, -26864.791445429197, -34295.714180291325, 19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474], "policy_policy_rl_reward": [424918.2856854207, 181096.19021126578, 93603.7897123078, 116806.94842568644, 44252.04547574999, 15265.362164671802, 53056.086207380984, 19388.613682577772, -22741.969093497788, 23486.987103729927, 69756.19334208361, 105090.03233906103, 22781.389185236803, -14696.708911388903, -39839.40986321983, 50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252453191009121, "mean_inference_ms": 0.7702910428588468, "mean_action_processing_ms": 0.11981797538980415, "mean_env_wait_ms": 2.4390100986320915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000783085823059082, "StateBufferConnector_ms": 0.0007892251014709473, "ViewRequirementAgentConnector_ms": 0.01954519748687744}, "num_episodes": 16, "episode_return_max": 1140496.2961861512, "episode_return_min": -156280.15577620038, "episode_return_mean": 226285.46445493863, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.7450790351013, "num_env_steps_trained_throughput_per_sec": 264.7450790351013, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15472.276, "restore_workers_time_ms": 0.073, "training_step_time_ms": 15472.116, "sample_time_ms": 14841.363, "learn_time_ms": 615.891, "learn_throughput": 6494.657, "synch_weights_time_ms": 6.919}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "ae48a_00000", "date": "2025-10-28_12-25-58", "timestamp": 1761672358, "time_this_iter_s": 15.11430287361145, "time_total_s": 1061.6893076896667, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f7e20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1061.6893076896667, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.79090909090909, "ram_util_percent": 83.96818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.845071792602539, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.883137744665145, "policy_loss": -0.01933880519500235, "vf_loss": 9.956767332553863, "vf_explained_var": -1.6245990991592408e-06, "kl": 0.017657811749723213, "entropy": 6.620979468524456, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 1140496.2961861512, "episode_reward_min": -156280.15577620038, "episode_reward_mean": 233212.0625194062, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39072.18535522144, "policy_mean": -42791.16357849054, "policy_mm": -41384.80232091054, "policy_rl": -33032.00452157783}, "policy_reward_max": {"policy_mom": 281699.40192028537, "policy_mean": 289170.0442563668, "policy_mm": 221669.40412667245, "policy_rl": 407269.3111039059}, "policy_reward_mean": {"policy_mom": 57115.98463365523, "policy_mean": 51285.49841184323, "policy_mm": 50979.60640320621, "policy_rl": 73830.97307070148}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57115.984375, "('mom_0', 'policy_mom')_total_reward_min": -39072.18359375, "('mom_0', 'policy_mom')_total_reward_max": 281699.40625, "('mean_0', 'policy_mean')_total_reward_mean": 51285.5, "('mean_0', 'policy_mean')_total_reward_min": -42791.1640625, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 50979.6015625, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 221669.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73830.96875, "('rl_trader_0', 'policy_rl')_total_reward_min": -33032.00390625, "('rl_trader_0', 'policy_rl')_total_reward_max": 407269.3125}, "hist_stats": {"episode_reward": [143388.83355198696, -72599.07568033643, 101274.27545449464, 21414.08817895776, -20614.296955669677, -110940.62117513963, 364567.51763289893, 563332.3360724023, 71718.21812885301, -60328.156828262094, 342815.0426850073, 80807.30142082422, -1720.9707930780237, -18578.618952191748, -10603.686728117951, 257030.17695115355, 557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [53633.19870594718, -15101.235363328893, 26822.37648306801, 13865.526758494909, -19531.948855164723, -27116.405980973137, 92386.52885535118, 172746.42044244125, -4091.2728710183105, -13547.560808259626, 80476.77040707062, 25703.405131540178, -13778.767210834812, -8673.033754880546, 261.5821364360299, 66304.35785661504, 168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831], "policy_policy_mean_reward": [19647.178280989083, -25822.187995345837, 24120.420565753222, -10243.080173562668, -7168.480948618901, -26335.315447311415, 99666.91919420767, 171748.23589325586, 28295.46345980101, -17708.14429278383, 75790.67193518532, 12795.659810312429, 1127.4135150925872, -10863.439152899451, -6126.747650360206, 52962.76832737284, 88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287], "policy_policy_mm_reward": [19137.6562509583, -14098.85886545822, 22023.68602030347, 8753.14097933664, -16081.744246032013, -25316.3191911689, 97772.41939623654, 92688.71944666625, 17272.76750215739, -22866.48215524304, 82752.0029024193, 17334.944018565886, 10680.68938511407, 848.6562067792106, -17601.14726390376, 50744.79847785347, 125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436], "policy_policy_rl_reward": [50970.80031409216, -17576.793456203355, 28307.792385369667, 9038.500614688883, 22167.87709414598, -32172.58055568621, 74741.65018710392, 126148.96029003817, 30241.260037912805, -6205.969571975466, 103795.59744033233, 24973.29246040566, 249.69351755020855, 109.19774880912293, 12862.626049709943, 87018.25228931243, 175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2526014287427903, "mean_inference_ms": 0.7707503649336934, "mean_action_processing_ms": 0.11988232092034401, "mean_env_wait_ms": 2.4399657463210787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008040666580200195, "StateBufferConnector_ms": 0.000809013843536377, "ViewRequirementAgentConnector_ms": 0.019906342029571533}, "num_episodes": 15, "episode_return_max": 1140496.2961861512, "episode_return_min": -156280.15577620038, "episode_return_mean": 233212.0625194062, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.88453014995866, "num_env_steps_trained_throughput_per_sec": 254.88453014995866, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 15573.476, "restore_workers_time_ms": 0.081, "training_step_time_ms": 15573.309, "sample_time_ms": 14943.661, "learn_time_ms": 615.992, "learn_throughput": 6493.591, "synch_weights_time_ms": 5.792}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "ae48a_00000", "date": "2025-10-28_12-26-14", "timestamp": 1761672374, "time_this_iter_s": 15.697644233703613, "time_total_s": 1077.3869519233704, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68eb60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1077.3869519233704, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 31.69545454545454, "ram_util_percent": 84.14090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6241896152496338, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880907121300698, "policy_loss": -0.021458891400834547, "vf_loss": 9.95965325832367, "vf_explained_var": -6.125867366790772e-06, "kl": 0.014657277671858888, "entropy": 6.71809263676405, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 1140496.2961861512, "episode_reward_min": -156280.15577620038, "episode_reward_mean": 240151.5453837828, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39072.18535522144, "policy_mean": -42791.16357849054, "policy_mm": -41384.80232091054, "policy_rl": -33032.00452157783}, "policy_reward_max": {"policy_mom": 281699.40192028537, "policy_mean": 289170.0442563668, "policy_mm": 221669.40412667245, "policy_rl": 407269.3111039059}, "policy_reward_mean": {"policy_mom": 58409.580278948444, "policy_mean": 52509.26945435751, "policy_mm": 52428.61583445422, "policy_rl": 76804.07981602264}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58409.578125, "('mom_0', 'policy_mom')_total_reward_min": -39072.18359375, "('mom_0', 'policy_mom')_total_reward_max": 281699.40625, "('mean_0', 'policy_mean')_total_reward_mean": 52509.26953125, "('mean_0', 'policy_mean')_total_reward_min": -42791.1640625, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 52428.609375, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 221669.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76804.078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -33032.00390625, "('rl_trader_0', 'policy_rl')_total_reward_max": 407269.3125}, "hist_stats": {"episode_reward": [557266.217494516, 264765.88280425314, 2812.322387250277, 40999.71673324879, 933928.0556202844, 52083.974687793176, 603877.4917204133, 256896.0391164731, 113944.87459842832, 93468.76611771963, 54923.409734934095, 141259.22675024773, 789425.2525796415, 132073.49166475373, 50330.68498675291, 211513.69293589302, 197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [168121.77447307488, 61882.7399946125, 3363.6731833746135, 18341.251822935617, 217924.5177912301, 17305.400728641576, 188319.34022266313, 50277.40599264495, 37249.04727310631, 22916.794097859067, 2507.8408969829575, 27542.93859834322, 157973.79146642968, 34949.39576833188, 16802.71053210284, 66784.10143540669, 41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143], "policy_policy_mean_reward": [88124.31219134138, 91411.0626190744, -8073.2124932064735, -7674.464458510787, 257837.59159980176, 10762.44103799325, 158802.3641594762, 56305.19154866626, 28470.141723379744, 12493.07690244879, 15705.6049191866, 28406.671359958073, 175695.81715425354, 49594.40103159441, -2129.5253972184223, 52735.105145692025, 44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217], "policy_policy_mm_reward": [125861.16138288526, 45381.86883841514, -20366.7315321991, 8479.338848793988, 180956.79044121283, 7962.570865593496, 102616.16530999311, 61905.08326889423, 28370.72663510033, 20510.238637514693, 1665.777763473892, 42160.25302464522, 159430.8490890774, 28772.31237404174, 40080.63679280065, 41854.4321638864, 51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048], "policy_policy_rl_reward": [175158.96944721503, 66090.21135215118, 27888.593229281294, 21853.59052003005, 277209.15578803985, 16053.562055564904, 154139.62202828124, 88408.3583062675, 19854.958966842063, 37548.65647989687, 35044.18615529067, 43149.363767300754, 296324.7948698815, 18757.382490785643, -4423.1369409321405, 50140.054190907606, 59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25271164144912006, "mean_inference_ms": 0.7710586171551287, "mean_action_processing_ms": 0.11992707679678784, "mean_env_wait_ms": 2.4405821507622045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007861852645874023, "StateBufferConnector_ms": 0.0007939338684082031, "ViewRequirementAgentConnector_ms": 0.01968437433242798}, "num_episodes": 16, "episode_return_max": 1140496.2961861512, "episode_return_min": -156280.15577620038, "episode_return_mean": 240151.5453837828, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.4627265417157, "num_env_steps_trained_throughput_per_sec": 264.4627265417157, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 15514.003, "restore_workers_time_ms": 0.069, "training_step_time_ms": 15513.847, "sample_time_ms": 14889.813, "learn_time_ms": 610.427, "learn_throughput": 6552.79, "synch_weights_time_ms": 5.861}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "ae48a_00000", "date": "2025-10-28_12-26-29", "timestamp": 1761672389, "time_this_iter_s": 15.130100011825562, "time_total_s": 1092.517051935196, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68d8a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1092.517051935196, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 29.40454545454546, "ram_util_percent": 83.20454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.738864541053772, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.879756152629852, "policy_loss": -0.025959589306148702, "vf_loss": 9.959195867180824, "vf_explained_var": -4.3567270040512086e-07, "kl": 0.015255959877220332, "entropy": 6.377786473929882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 1140496.2961861512, "episode_reward_min": -156280.15577620038, "episode_reward_mean": 239861.5965878298, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39072.18535522144, "policy_mean": -42791.16357849054, "policy_mm": -41384.80232091054, "policy_rl": -33032.00452157783}, "policy_reward_max": {"policy_mom": 281699.40192028537, "policy_mean": 289170.0442563668, "policy_mm": 221669.40412667245, "policy_rl": 407269.3111039059}, "policy_reward_mean": {"policy_mom": 56026.90172978486, "policy_mean": 52840.09580226769, "policy_mm": 53294.48261908537, "policy_rl": 77700.11643669188}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56026.8984375, "('mom_0', 'policy_mom')_total_reward_min": -39072.18359375, "('mom_0', 'policy_mom')_total_reward_max": 281699.40625, "('mean_0', 'policy_mean')_total_reward_mean": 52840.08984375, "('mean_0', 'policy_mean')_total_reward_min": -42791.1640625, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 53294.4765625, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 221669.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77700.1171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -33032.00390625, "('rl_trader_0', 'policy_rl')_total_reward_max": 407269.3125}, "hist_stats": {"episode_reward": [197588.2142156204, -4628.959269644278, 341709.11307208764, 206782.89671121628, 324997.1290453575, 187818.08623802476, 210570.33117688153, 363720.0686635969, 173754.8002171579, 385962.7870247187, 300776.24867671105, 262744.21717070084, 387435.77725705697, 278485.135843582, 284704.66370100476, 68979.18226880798, 664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [41784.217167859526, -8505.68400548111, 49717.08355165913, 78977.61859105974, 90529.83230270521, 54182.172647298445, 44972.583082649355, 81684.77464594191, 55819.55463204066, 79939.31522014644, 102181.92186936215, 36309.464133221365, 110991.32784298067, 70112.36483767319, 45084.05848485961, 7087.42780502317, 129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196], "policy_policy_mean_reward": [44859.460440727584, -1141.9538839840204, 84155.0733032975, 48059.51056170036, 41468.037047241865, 13627.941057780135, 41873.88907217887, 141257.98386460848, 38232.49544020746, 87118.27765565674, 84712.74542789943, 66716.04998642208, 84502.25343506131, 50857.26373721732, 58721.99779171426, 29089.39687117138, 114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199], "policy_policy_mm_reward": [51598.72408273729, -315.6779217522688, 92053.78606527913, 19034.335118276053, 76845.36355262685, 67524.84666492866, 71579.08925727026, 63422.53478876278, 39094.617969612285, 84340.56880809582, 56382.9717497188, 70180.32448434758, 93736.96899954673, 80454.14326688788, 76440.76704965955, 8987.70197224144, 162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622], "policy_policy_rl_reward": [59345.812524296045, 5334.356541573123, 115783.17015185239, 60711.43244018006, 116153.89614278362, 52483.12586801756, 52144.769764783145, 77354.77536428379, 40608.132175297564, 134564.62534081916, 57498.60962973069, 89538.37856670993, 98205.22697946805, 77061.36400180326, 104457.84037477124, 23814.655620372076, 257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25280815868933554, "mean_inference_ms": 0.7712977400748301, "mean_action_processing_ms": 0.1199622031623507, "mean_env_wait_ms": 2.441028312638405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007894039154052734, "StateBufferConnector_ms": 0.0008006095886230469, "ViewRequirementAgentConnector_ms": 0.019813358783721924}, "num_episodes": 16, "episode_return_max": 1140496.2961861512, "episode_return_min": -156280.15577620038, "episode_return_mean": 239861.5965878298, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.6970377524758, "num_env_steps_trained_throughput_per_sec": 260.6970377524758, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 15496.219, "restore_workers_time_ms": 0.075, "training_step_time_ms": 15496.055, "sample_time_ms": 14866.778, "learn_time_ms": 615.836, "learn_throughput": 6495.233, "synch_weights_time_ms": 5.737}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "ae48a_00000", "date": "2025-10-28_12-26-45", "timestamp": 1761672405, "time_this_iter_s": 15.349087953567505, "time_total_s": 1107.8661398887634, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e9620>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1107.8661398887634, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.781818181818185, "ram_util_percent": 83.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7218650579452515, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.882671210169793, "policy_loss": -0.015466164184908848, "vf_loss": 9.956892132759094, "vf_explained_var": 1.7318874597549438e-06, "kl": 0.014103106126276955, "entropy": 6.827436564862728, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 1140496.2961861512, "episode_reward_min": -156280.15577620038, "episode_reward_mean": 236216.1140024729, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39072.18535522144, "policy_mean": -42791.16357849054, "policy_mm": -41384.80232091054, "policy_rl": -33032.00452157783}, "policy_reward_max": {"policy_mom": 281699.40192028537, "policy_mean": 289170.0442563668, "policy_mm": 270387.32517085527, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 54287.372036911445, "policy_mean": 51181.57301450311, "policy_mm": 52448.573528187306, "policy_rl": 78298.59542287099}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54287.37109375, "('mom_0', 'policy_mom')_total_reward_min": -39072.18359375, "('mom_0', 'policy_mom')_total_reward_max": 281699.40625, "('mean_0', 'policy_mean')_total_reward_mean": 51181.57421875, "('mean_0', 'policy_mean')_total_reward_min": -42791.1640625, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 52448.57421875, "('mm_0', 'policy_mm')_total_reward_min": -41384.80078125, "('mm_0', 'policy_mm')_total_reward_max": 270387.3125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 78298.6015625, "('rl_trader_0', 'policy_rl')_total_reward_min": -33032.00390625, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [664051.5612301838, 200928.84730005937, 461147.28012416937, 28117.08106997099, -11768.937850764049, 380970.34662506205, 202235.6358837401, 209048.0214571536, 299826.76224258525, 224472.24620912634, 163466.22853988022, 226116.9061944147, 92073.83245146164, 142901.76052291234, 43790.08416225031, -156280.15577620038, 123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [129091.65030775084, 42511.89540506068, 88714.85576165818, 21414.9249767995, 17732.808698140983, 77455.2304365579, 73566.09970920093, 47964.3863489266, 54095.63646239453, 53260.92386816015, 46087.5047698929, 57045.02121665162, 22256.417342032968, 30807.071898009734, 3531.78580945073, -39072.18535522144, 33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925], "policy_policy_mean_reward": [114362.31438565115, 45981.884070363914, 98340.05902593289, -14562.877836081207, -10574.695216201279, 81672.85118691744, 47102.16949062488, 60627.66205848997, 46015.455562828276, 37818.15566747606, 29148.584570301293, 54306.75369652497, 12628.658145620557, 39002.29916773517, -2996.7341361308104, -42791.16357849054, 73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944], "policy_policy_mm_reward": [162945.9991385249, 47346.8127586598, 116626.9251622794, -15022.603341703556, 5325.484738545682, 94648.66518915872, 57813.57716087018, 45597.274866467524, 98611.37570028697, 33773.02184474137, 29814.712629101905, 39770.51792885603, 35923.866564294396, 20217.659275431557, 18365.589078429675, -41384.80232091054, 6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071], "policy_policy_rl_reward": [257651.59739825735, 65088.25506597485, 157465.4401742995, 36287.63727095623, -24252.53607124944, 127193.59981242857, 23753.789523044114, 54858.698183269444, 101104.2945170756, 99620.14482874863, 58415.426570584146, 74994.61335238184, 21264.89039951345, 52874.73018173565, 24889.443410500877, -33032.00452157783, 10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2528781226020033, "mean_inference_ms": 0.7714509073513668, "mean_action_processing_ms": 0.11998613594215934, "mean_env_wait_ms": 2.441356737322061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007843971252441406, "StateBufferConnector_ms": 0.0007987022399902344, "ViewRequirementAgentConnector_ms": 0.019708752632141113}, "num_episodes": 16, "episode_return_max": 1140496.2961861512, "episode_return_min": -156280.15577620038, "episode_return_mean": 236216.1140024729, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.9065439992107, "num_env_steps_trained_throughput_per_sec": 262.9065439992107, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 15513.174, "restore_workers_time_ms": 0.077, "training_step_time_ms": 15512.997, "sample_time_ms": 14877.223, "learn_time_ms": 622.002, "learn_throughput": 6430.844, "synch_weights_time_ms": 5.854}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "ae48a_00000", "date": "2025-10-28_12-27-00", "timestamp": 1761672420, "time_this_iter_s": 15.21922779083252, "time_total_s": 1123.085367679596, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e87c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1123.085367679596, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 21.628571428571426, "ram_util_percent": 83.88095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9185197353363037, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.882981491088866, "policy_loss": -0.022664677553984804, "vf_loss": 9.958725184202194, "vf_explained_var": 3.21660190820694e-06, "kl": 0.01700732281901809, "entropy": 6.455897426605224, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -134341.63677489106, "episode_reward_mean": 246789.5433008609, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37344.41663907143, "policy_mean": -41824.63313567081, "policy_mm": -38726.363618228424, "policy_rl": -28454.1515234824}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 289170.0442563668, "policy_mm": 308777.89639416285, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 56271.15423122281, "policy_mean": 53268.78058245072, "policy_mm": 55910.53263340721, "policy_rl": 81339.07585378012}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56271.1640625, "('mom_0', 'policy_mom')_total_reward_min": -37344.41796875, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 53268.78515625, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 289170.03125, "('mm_0', 'policy_mm')_total_reward_mean": 55910.51953125, "('mm_0', 'policy_mm')_total_reward_min": -38726.36328125, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 81339.0703125, "('rl_trader_0', 'policy_rl')_total_reward_min": -28454.15234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [123938.5682801799, 545413.9815852379, 319569.33817222866, 231687.2224180554, 878737.6679995406, 1140496.2961861512, 176032.5798147134, 129363.06102366759, 35140.832323243834, 347410.0763795165, 130180.21215878183, 732789.4814016622, 277487.31230955344, 97195.18203268308, 312589.54591056664, -111867.43448998888, 45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [33551.768357401976, 118671.10070075702, 92701.54686753031, 68047.15839919982, 174108.0925142594, 281699.40192028537, 48985.7683727513, 45872.83764712151, 7480.528681198257, 82968.25470474054, 20883.31766016832, 124165.31860060971, 83896.34821305946, 41488.23028045447, 63283.243576303685, -13704.6205979812, 1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935], "policy_policy_mean_reward": [73222.65962944778, 149637.26885139465, 80760.65429874894, 42456.238088779355, 183691.63048059776, 289170.0442563668, 16157.11634468599, 35570.96034597071, -7119.6703977004745, 74748.64474220734, 17378.302837462135, 191381.22807454653, 61101.68425533686, 18579.34223384882, 82660.00018650031, -35268.09332784261, 17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493], "policy_policy_mm_reward": [6416.872981847273, 137581.19818974848, 103603.66953890063, 72849.11717324804, 221669.40412667245, 162357.53890559217, 54498.7167971928, 15967.319600197463, 16545.31057498587, 62415.96665035438, 42611.93079987951, 138418.9087347937, 65227.20837679902, 16895.87006751589, 47577.8907170902, -34440.56904068267, 7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816], "policy_policy_rl_reward": [10747.267311482903, 139524.4138433379, 42503.46746704854, 48334.70875682844, 299268.54087801126, 407269.3111039059, 56390.97830008323, 31951.943430377763, 18234.663464760284, 127277.21028221448, 49306.66086127217, 278824.0259917111, 67262.07146435775, 20231.73945086393, 119068.41143067258, -28454.1515234824, 19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25292813157359556, "mean_inference_ms": 0.7715282911213589, "mean_action_processing_ms": 0.11999847401556617, "mean_env_wait_ms": 2.441502654894219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000775456428527832, "StateBufferConnector_ms": 0.0007917284965515137, "ViewRequirementAgentConnector_ms": 0.01952338218688965}, "num_episodes": 16, "episode_return_max": 1246983.8390059813, "episode_return_min": -134341.63677489106, "episode_return_mean": 246789.5433008609, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.7462268344012, "num_env_steps_trained_throughput_per_sec": 266.7462268344012, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 15497.865, "restore_workers_time_ms": 0.079, "training_step_time_ms": 15497.683, "sample_time_ms": 14865.333, "learn_time_ms": 617.779, "learn_throughput": 6474.812, "synch_weights_time_ms": 6.127}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "ae48a_00000", "date": "2025-10-28_12-27-15", "timestamp": 1761672435, "time_this_iter_s": 14.999814987182617, "time_total_s": 1138.0851826667786, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e9c60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1138.0851826667786, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.722727272727276, "ram_util_percent": 83.76363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7475208044052124, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.875277408957482, "policy_loss": -0.020261066561215558, "vf_loss": 9.95328831076622, "vf_explained_var": -6.187707185745239e-07, "kl": 0.013417533735401232, "entropy": 6.680665341019631, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -134341.63677489106, "episode_reward_mean": 232611.60637368847, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37344.41663907143, "policy_mean": -41824.63313567081, "policy_mm": -38726.363618228424, "policy_rl": -27771.07530635447}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 232885.20772081075, "policy_mm": 308777.89639416285, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 52680.978717927486, "policy_mean": 50185.67546606104, "policy_mm": 52371.56197183151, "policy_rl": 77373.39021786842}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52680.98046875, "('mom_0', 'policy_mom')_total_reward_min": -37344.41796875, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 50185.6796875, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 232885.203125, "('mm_0', 'policy_mm')_total_reward_mean": 52371.56640625, "('mm_0', 'policy_mm')_total_reward_min": -38726.36328125, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77373.390625, "('rl_trader_0', 'policy_rl')_total_reward_min": -27771.076171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [45397.80665503554, 246053.8753828844, 384054.2972093429, -33435.80458348609, 817275.9465300628, 159421.21913465744, 872476.0264354852, 114214.9286643384, -11718.000775612725, 761491.9088997554, 84271.24651400807, 127649.31428736946, 339792.7263780267, 330571.2359561803, 168131.49241809145, -1837.57125541321, -90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [1172.508473020959, 71993.04478446596, 119653.31229966758, 1927.3391009451245, 196773.4216778703, 57417.71309742854, 216934.77256035025, 36540.561942338914, 34.995494941486456, 139155.4133747197, 29269.224707351113, 39772.067116155304, 84096.51535889675, 102468.44664678923, 35986.589217581335, -9882.845206297774, -20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722], "policy_policy_mean_reward": [17288.417168570017, 40243.04868818819, 46452.73992331714, -7967.006728291612, 201116.3362339502, 22986.33843128339, 183905.89766907057, 24324.62662255407, -430.78004961894544, 158757.33117907288, 9139.938938338828, 20414.78641721574, 77234.90153674502, 66232.58377568623, 41726.176082119615, -7354.110425488414, -27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535], "policy_policy_mm_reward": [7896.144334189514, 72263.25407285492, 117517.11363654878, -13037.127212116378, 163279.02248498474, 25133.955606747386, 148438.5900415909, 21920.801431878797, -4281.017699090255, 158828.86273057052, 5216.571998913708, 29001.004043666544, 79075.28806490754, 93193.66523120557, 45069.95370473608, 15924.142696224328, -24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186], "policy_policy_rl_reward": [19040.736679255173, 61554.52783737544, 100431.13134980906, -14359.009744023353, 256107.1661332578, 53883.21199919819, 323196.7661644734, 31428.938667566552, -7041.198521845091, 304750.3016153924, 40645.51086940449, 38461.456710331884, 99386.02141747744, 68676.54030249991, 45348.77341365434, -524.7583198514345, -18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529585495982336, "mean_inference_ms": 0.7715416137631501, "mean_action_processing_ms": 0.12000188773760546, "mean_env_wait_ms": 2.4415581864648086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007838606834411621, "StateBufferConnector_ms": 0.0007894039154052734, "ViewRequirementAgentConnector_ms": 0.01956319808959961}, "num_episodes": 16, "episode_return_max": 1246983.8390059813, "episode_return_min": -134341.63677489106, "episode_return_mean": 232611.60637368847, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.73509021792455, "num_env_steps_trained_throughput_per_sec": 266.73509021792455, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 15284.411, "restore_workers_time_ms": 0.081, "training_step_time_ms": 15284.253, "sample_time_ms": 14696.303, "learn_time_ms": 576.787, "learn_throughput": 6934.971, "synch_weights_time_ms": 4.28}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "ae48a_00000", "date": "2025-10-28_12-27-30", "timestamp": 1761672450, "time_this_iter_s": 15.00052285194397, "time_total_s": 1153.0857055187225, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e340>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1153.0857055187225, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 22.33809523809524, "ram_util_percent": 82.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9642337560653687, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.88173559308052, "policy_loss": -0.018727590929483996, "vf_loss": 9.956644827127457, "vf_explained_var": -6.936490535736084e-07, "kl": 0.014053956946373042, "entropy": 6.5668020501732824, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -134341.63677489106, "episode_reward_mean": 230213.35959373295, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37344.41663907143, "policy_mean": -41824.63313567081, "policy_mm": -38726.363618228424, "policy_rl": -27771.07530635447}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 232885.20772081075, "policy_mm": 308777.89639416285, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 50842.61501361406, "policy_mean": 50288.9225184533, "policy_mm": 51855.95865200335, "policy_rl": 77225.86340966224}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50842.61328125, "('mom_0', 'policy_mom')_total_reward_min": -37344.41796875, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 50288.92578125, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 232885.203125, "('mm_0', 'policy_mm')_total_reward_mean": 51855.96484375, "('mm_0', 'policy_mm')_total_reward_min": -38726.36328125, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77225.859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -27771.076171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [-90710.01850524651, 352299.782666533, 141463.84732841115, 55149.41379912762, 138083.59061837633, 271285.117307043, 205434.2540636923, 501893.05023441394, -47820.25446172737, 171744.9145401295, -10000.916538585925, 368555.3970079462, 71639.10501743406, -131065.48830431142, -103988.70395085019, 218147.96217693947, 318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-20164.34249322729, 90973.37795999766, 35354.290376579396, 18069.03430337831, 42349.263495617015, 74262.40517622269, 67281.70838630141, 106480.64051510894, -5526.176535489329, 21089.21685569056, -10705.43314048523, 93673.26544076212, 12492.543844865355, -33768.563238913586, -18735.079860587386, 43290.92587786315, 86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956], "policy_policy_mean_reward": [-27476.026609210872, 56477.42540379313, 22589.38987725619, 8214.103713941287, 22750.115538900387, 47419.85766477191, 39504.07181988004, 123186.75004059257, -20293.61196398575, 53358.975392730645, 2847.076671550312, 97942.74162906045, 10651.975202664073, -37136.04867366351, -37665.69979874999, 64177.7744913345, 87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145], "policy_policy_mm_reward": [-24485.788384086183, 86305.05758029287, 23886.19666209666, 15197.050050383436, 33364.43484218936, 51639.734351379826, 37738.881706750435, 118469.98107801894, -4396.833693176006, 27590.990633885674, -17854.125685658397, 84942.65597898045, 13235.517894425206, -32389.801085379793, -34721.06165231154, 52083.68554917565, 51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788], "policy_policy_rl_reward": [-18583.861018722226, 118543.92172244891, 59633.97041247916, 13669.225731424727, 39619.776741669746, 97963.12011466852, 60909.592150760334, 153755.67860069367, -17603.632269076545, 69705.73165782278, 15711.565616007449, 91996.73395914311, 35259.06807547947, -27771.07530635447, -12866.86263920132, 58595.57625856622, 93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25294359161003466, "mean_inference_ms": 0.7714283670260781, "mean_action_processing_ms": 0.11998968331676771, "mean_env_wait_ms": 2.4413791280205244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007720589637756348, "StateBufferConnector_ms": 0.0007732510566711426, "ViewRequirementAgentConnector_ms": 0.01920241117477417}, "num_episodes": 16, "episode_return_max": 1246983.8390059813, "episode_return_min": -134341.63677489106, "episode_return_mean": 230213.35959373295, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.2497660521216, "num_env_steps_trained_throughput_per_sec": 274.2497660521216, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 15214.067, "restore_workers_time_ms": 0.077, "training_step_time_ms": 15213.917, "sample_time_ms": 14628.223, "learn_time_ms": 575.186, "learn_throughput": 6954.27, "synch_weights_time_ms": 3.798}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "ae48a_00000", "date": "2025-10-28_12-27-44", "timestamp": 1761672464, "time_this_iter_s": 14.589162111282349, "time_total_s": 1167.6748676300049, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d5f6e80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1167.6748676300049, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.642857142857142, "ram_util_percent": 81.84761904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8663089275360107, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.883121743798256, "policy_loss": -0.023557301696564538, "vf_loss": 9.961697706580162, "vf_explained_var": 9.974464774131775e-07, "kl": 0.016199987325035626, "entropy": 6.595367151498794, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -134341.63677489106, "episode_reward_mean": 252932.93271948834, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37344.41663907143, "policy_mean": -41824.63313567081, "policy_mm": -38726.363618228424, "policy_rl": -26584.88233293708}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 232885.20772081075, "policy_mm": 308777.89639416285, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 57371.35884527286, "policy_mean": 55795.12030190604, "policy_mm": 56997.33384654307, "policy_rl": 82769.11972576639}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57371.359375, "('mom_0', 'policy_mom')_total_reward_min": -37344.41796875, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 55795.11328125, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 232885.203125, "('mm_0', 'policy_mm')_total_reward_mean": 56997.328125, "('mm_0', 'policy_mm')_total_reward_min": -38726.36328125, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 82769.1171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -26584.8828125, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [318738.32799430133, -17098.729624516436, 381204.14245754684, 8158.880863612649, 54123.64068283144, 327688.6038888065, 307904.87821131287, 307010.96692666516, 91411.66018072137, 91422.22134999168, 280732.65039224544, 414870.12834172364, 111228.69649078645, 795052.0919743858, -134341.63677489106, 343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [86717.80519639332, -19447.506580358808, 91779.92592255825, 8484.565106276143, -953.1532040132964, 67913.49908216008, 48477.67345080051, 48162.37678157553, 19345.7955836959, 28184.841806777007, 58619.529609345744, 86080.17030329659, 24276.824644520926, 175987.98234998263, -37344.41663907143, 83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419], "policy_policy_mean_reward": [87740.85871901536, -4367.234196925757, 56296.14331809321, -2149.3062827562217, 14448.443289935543, 74206.17462313347, 90591.66049136377, 85855.33142158952, 32505.63774512217, 2840.969261503744, 51125.845552524406, 100303.05199240816, 31786.421637865642, 158324.98084817245, -31685.974184654166, 85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866], "policy_policy_mm_reward": [51051.028975329784, -3629.764507480516, 105407.8230302567, -13587.275427000048, 14001.905503290904, 91003.7038470422, 58639.13792178643, 48941.90633446049, 6565.557617759069, 20548.916366581958, 65218.335969670945, 103584.49546027643, 13273.642854938344, 165458.33269804952, -38726.363618228424, 80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105], "policy_policy_rl_reward": [93228.63510356282, 10345.775660248597, 127720.25018663867, 15410.897467092836, 26626.445093618386, 94565.22633647115, 110196.40634736196, 124051.35238903933, 32994.66923414437, 39847.49391512892, 105768.93926070447, 124902.41058574198, 41891.80735346165, 295280.7960781801, -26584.88233293708, 94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25289100531268693, "mean_inference_ms": 0.7712152073539735, "mean_action_processing_ms": 0.11996536978586053, "mean_env_wait_ms": 2.4410792307264355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007547140121459961, "StateBufferConnector_ms": 0.0007535815238952637, "ViewRequirementAgentConnector_ms": 0.01897716522216797}, "num_episodes": 16, "episode_return_max": 1246983.8390059813, "episode_return_min": -134341.63677489106, "episode_return_mean": 252932.93271948834, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.2150035792442, "num_env_steps_trained_throughput_per_sec": 269.2150035792442, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 15145.476, "restore_workers_time_ms": 0.071, "training_step_time_ms": 15145.333, "sample_time_ms": 14538.717, "learn_time_ms": 594.633, "learn_throughput": 6726.834, "synch_weights_time_ms": 4.83}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "ae48a_00000", "date": "2025-10-28_12-27-59", "timestamp": 1761672479, "time_this_iter_s": 14.864016771316528, "time_total_s": 1182.5388844013214, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d559a80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1182.5388844013214, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 21.623809523809523, "ram_util_percent": 81.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9659335613250732, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.88530254662037, "policy_loss": -0.019584142026724295, "vf_loss": 9.96237183213234, "vf_explained_var": 3.394670784473419e-06, "kl": 0.015322577009647342, "entropy": 6.782790479063988, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -125723.5150988185, "episode_reward_mean": 251758.79053090792, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -36618.46100259596, "policy_mean": -41824.63313567081, "policy_mm": -35556.84425639425, "policy_rl": -26111.0237509179}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 317996.70035112643, "policy_mm": 308777.89639416285, "policy_rl": 469726.61212325946}, "policy_reward_mean": {"policy_mom": 56851.613222403816, "policy_mean": 57398.73322869255, "policy_mm": 55866.515059026024, "policy_rl": 81641.92902078558}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56851.61328125, "('mom_0', 'policy_mom')_total_reward_min": -36618.4609375, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 57398.734375, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 55866.515625, "('mm_0', 'policy_mm')_total_reward_min": -35556.84375, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 81641.9296875, "('rl_trader_0', 'policy_rl')_total_reward_min": -26111.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 469726.625}, "hist_stats": {"episode_reward": [343506.418370027, 258103.2230886478, 335020.73935709643, 247782.22364645975, 439057.7142104957, 271944.76685916836, 1026380.3401318712, 143748.46904990845, 119957.99742986241, 17225.88093051442, 298450.2167510853, 140761.1619157081, 119858.27396358822, -3346.0754671932664, 58338.538268150325, -37793.26866321316, 102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [83207.52216490454, 56824.11068034031, 66883.05344722231, 41982.56436895255, 86346.49493089196, 53325.771837824315, 163509.34526973203, 35019.03013988402, 28216.609982386934, 697.8937875982263, 51364.96213480606, 27491.733036954913, 46776.91318659389, -6927.918391304641, 4769.108604586128, -15679.94253119581, 16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623], "policy_policy_mean_reward": [85180.58983523872, 55509.50480923781, 123006.048157027, 68449.94150623954, 99100.58684824199, 108056.64602323399, 122757.05756802484, 47349.30504582976, 37071.48472345539, -7937.024726520577, 83247.22040150985, 29826.548616283737, 8993.057604497282, -4485.1249299119145, 139.50786036199622, 11823.309057673701, 4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032], "policy_policy_mm_reward": [80870.38122138074, 91341.71488826953, 69266.24532135138, 52373.626915039815, 119866.61306557622, 58734.366268261816, 270387.32517085527, 6056.040440177073, 7815.886279634498, 282.8926831340884, 96700.26365087955, 50011.65817118688, 27114.0194075167, 18131.134422084153, 12701.160038254793, -12978.61327496069, 47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992], "policy_policy_rl_reward": [94247.9251485034, 54427.892710800006, 75865.39243149596, 84976.09085622759, 133744.01936578564, 51827.982729848365, 469726.61212325946, 55324.09342401761, 46854.01644438564, 24182.119186302614, 67137.77056388976, 33431.22209128267, 36974.28376498014, -10064.166568060857, 40728.76176494742, -20958.021914730387, 34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25282407101923376, "mean_inference_ms": 0.770969820870254, "mean_action_processing_ms": 0.11993866809152844, "mean_env_wait_ms": 2.440716760771316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007637143135070801, "StateBufferConnector_ms": 0.0007526874542236328, "ViewRequirementAgentConnector_ms": 0.01896125078201294}, "num_episodes": 15, "episode_return_max": 1246983.8390059813, "episode_return_min": -125723.5150988185, "episode_return_mean": 251758.79053090792, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.2117319016911, "num_env_steps_trained_throughput_per_sec": 266.2117319016911, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 15094.618, "restore_workers_time_ms": 0.072, "training_step_time_ms": 15094.477, "sample_time_ms": 14502.751, "learn_time_ms": 580.487, "learn_throughput": 6890.772, "synch_weights_time_ms": 4.305}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "ae48a_00000", "date": "2025-10-28_12-28-14", "timestamp": 1761672494, "time_this_iter_s": 15.029051065444946, "time_total_s": 1197.5679354667664, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e8f40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1197.5679354667664, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 25.31428571428572, "ram_util_percent": 83.22857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6755340099334717, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.87110457122326, "policy_loss": -0.022892344601859804, "vf_loss": 9.953571420907974, "vf_explained_var": 1.2919306755065918e-06, "kl": 0.01276924757237378, "entropy": 6.819373071193695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1246983.8390059813, "episode_reward_min": -125723.5150988185, "episode_reward_mean": 240780.54619594273, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -36618.46100259596, "policy_mean": -41824.63313567081, "policy_mm": -35556.84425639425, "policy_rl": -26111.0237509179}, "policy_reward_max": {"policy_mom": 313514.5404557216, "policy_mean": 317996.70035112643, "policy_mm": 308777.89639416285, "policy_rl": 391806.1944352858}, "policy_reward_mean": {"policy_mom": 55942.69247295535, "policy_mean": 54784.69583511566, "policy_mm": 52600.49487932437, "policy_rl": 77452.66300854734}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55942.69140625, "('mom_0', 'policy_mom')_total_reward_min": -36618.4609375, "('mom_0', 'policy_mom')_total_reward_max": 313514.53125, "('mean_0', 'policy_mean')_total_reward_mean": 54784.6953125, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 52600.49609375, "('mm_0', 'policy_mm')_total_reward_min": -35556.84375, "('mm_0', 'policy_mm')_total_reward_max": 308777.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77452.6640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -26111.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 391806.1875}, "hist_stats": {"episode_reward": [102093.55471619012, 269708.3867757051, 204844.74774158603, 144916.24908205715, 729762.1939921963, 320524.28916806134, 300276.4807043913, 261467.3823191504, 1246983.8390059813, -3789.626459979688, 191987.31888936885, -41008.84976459162, 704734.5426118855, 66631.51787444075, 21788.370714646353, 315565.16674394504, 224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [16296.56919656734, 65928.67297873794, 55285.50645034716, 54919.98452130967, 185920.82331682925, 48169.07542249422, 70039.99822514295, 35371.699238978974, 313514.5404557216, 4169.35589510838, 32649.615957483813, -16928.055095781725, 166035.53179982695, 18751.301249138458, -2664.9237331224135, 84661.32526759566, 64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796], "policy_policy_mean_reward": [4211.6238556499175, 72482.55128624887, 39040.047638283955, 36763.039828092806, 158918.89317972944, 52278.22564708469, 78177.68116471589, 36067.19924481417, 232885.20772081075, -10804.678179112318, 57107.75279319817, -7520.435295018052, 140980.66001490213, 7226.871452551142, -6888.476958850002, 45486.240292307244, 32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126], "policy_policy_mm_reward": [47120.65994418716, 73388.90588506115, 53780.49551051288, 15410.866469774617, 142113.09575187071, 68550.56604106798, 89511.04149552634, 58660.71096684534, 308777.89639416285, 612.3268779452859, 47499.275094145545, -12412.621393884956, 192710.16367728123, 26737.205314504707, 1495.7115095573124, 99495.64797636843, 55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138], "policy_policy_rl_reward": [34464.70171978565, 57908.25662565742, 56738.69814244199, 37822.35826288009, 242809.38174376692, 151526.42205741402, 62547.75981900586, 131367.77286851182, 391806.1944352858, 2233.3689460790197, 54730.675044541036, -4147.737979906957, 205008.1871198745, 13916.139858246503, 29846.059897061426, 85921.95320767412, 72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527501312992814, "mean_inference_ms": 0.7707002226220002, "mean_action_processing_ms": 0.11990975869364479, "mean_env_wait_ms": 2.4402977772104055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007693767547607422, "StateBufferConnector_ms": 0.0007535219192504883, "ViewRequirementAgentConnector_ms": 0.019137561321258545}, "num_episodes": 16, "episode_return_max": 1246983.8390059813, "episode_return_min": -125723.5150988185, "episode_return_mean": 240780.54619594273, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.2933031945531, "num_env_steps_trained_throughput_per_sec": 266.2933031945531, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 15085.819, "restore_workers_time_ms": 0.06, "training_step_time_ms": 15085.708, "sample_time_ms": 14490.507, "learn_time_ms": 583.626, "learn_throughput": 6853.702, "synch_weights_time_ms": 4.566}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "ae48a_00000", "date": "2025-10-28_12-28-29", "timestamp": 1761672509, "time_this_iter_s": 15.025182008743286, "time_total_s": 1212.5931174755096, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e9580>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1212.5931174755096, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.45909090909091, "ram_util_percent": 83.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8539619445800781, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.87454948425293, "policy_loss": -0.022658720261824784, "vf_loss": 9.955648663640023, "vf_explained_var": -2.2217631340026855e-06, "kl": 0.014806652824200206, "entropy": 6.843496835231781, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 952995.844593285, "episode_reward_min": -125723.5150988185, "episode_reward_mean": 226317.23328348174, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -41824.63313567081, "policy_mm": -38189.942454365744, "policy_rl": -26111.0237509179}, "policy_reward_max": {"policy_mom": 241610.55743695586, "policy_mean": 317996.70035112643, "policy_mm": 203950.13213768948, "policy_rl": 391793.39437671023}, "policy_reward_mean": {"policy_mom": 52994.360331538424, "policy_mean": 53234.31338367348, "policy_mm": 48516.4060346269, "policy_rl": 71572.15353364295}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52994.36328125, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 241610.5625, "('mean_0', 'policy_mean')_total_reward_mean": 53234.31640625, "('mean_0', 'policy_mean')_total_reward_min": -41824.6328125, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 48516.40625, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 203950.125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71572.15625, "('rl_trader_0', 'policy_rl')_total_reward_min": -26111.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 391793.40625}, "hist_stats": {"episode_reward": [224752.2735567071, 266469.58009541733, -125723.5150988185, 197394.67637927603, 280386.98348492885, 142484.27493873236, 412168.5038335914, -43096.666262370956, 126921.88628774934, -29314.966919888142, 308705.05118122447, 103391.34752844556, 952995.844593285, 273152.2730979463, 616561.9776276671, 90488.24548755147, 121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [64016.99494346622, 58994.79097738811, -31557.166121498994, 38638.84779325123, 40979.314811410935, 65339.53524463003, 119833.07442363363, -16637.414090871505, 16028.461305104189, -11462.937824902892, 85908.92351194368, 12852.718485125517, 162860.76466088265, 74455.62600770546, 103120.55859782232, 17731.147169722375, 45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039], "policy_policy_mean_reward": [32388.708537404913, 83105.10712731839, -41824.63313567081, 42706.79329138366, 63429.90933848493, 23116.922320423866, 129181.04124248469, 13649.270230783659, 32706.88515356067, -1744.5980079230685, 77969.09666025161, 23721.89097346851, 194391.55341800317, 58831.772366658704, 137439.73962754113, 31189.336122208133, 14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161], "policy_policy_mm_reward": [55401.671474636394, 42771.170249974224, -31238.76611840327, 62775.74316443915, 85222.24417085816, 20819.425854094137, 65205.11862445744, -13997.498651365413, 47321.16153261561, -3321.739776260548, 63299.06611015547, 23442.706577436245, 203950.13213768948, 54732.31207719498, 126966.39914510983, 20641.139386835453, 22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468], "policy_policy_rl_reward": [72944.89860119998, 81598.51174073698, -21102.949723245416, 53273.2921302019, 90755.51516417469, 33208.39151958454, 97949.26954301515, -26111.0237509179, 30865.378296468723, -12785.691310801622, 81527.96489887343, 43374.03149241514, 391793.39437671023, 85132.56264638716, 249035.28025719398, 20926.622808785465, 40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25267256824421286, "mean_inference_ms": 0.7704321859700481, "mean_action_processing_ms": 0.119880968043117, "mean_env_wait_ms": 2.43992517302547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007841587066650391, "StateBufferConnector_ms": 0.0007682442665100098, "ViewRequirementAgentConnector_ms": 0.01933354139328003}, "num_episodes": 16, "episode_return_max": 952995.844593285, "episode_return_min": -125723.5150988185, "episode_return_mean": 226317.23328348174, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.76595356573574, "num_env_steps_trained_throughput_per_sec": 266.76595356573574, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 15015.922, "restore_workers_time_ms": 0.062, "training_step_time_ms": 15015.809, "sample_time_ms": 14419.831, "learn_time_ms": 583.794, "learn_throughput": 6851.736, "synch_weights_time_ms": 5.191}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "ae48a_00000", "date": "2025-10-28_12-28-45", "timestamp": 1761672525, "time_this_iter_s": 14.99815583229065, "time_total_s": 1227.5912733078003, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e8c20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1227.5912733078003, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.114285714285714, "ram_util_percent": 83.88095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9157549142837524, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.882801857590675, "policy_loss": -0.020481387991458176, "vf_loss": 9.961793744564057, "vf_explained_var": -2.9323622584342956e-06, "kl": 0.015439232822337196, "entropy": 6.893196333944798, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 920768.2050209037, "episode_reward_min": -123191.0063803818, "episode_reward_mean": 226748.26560959485, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -36216.551707837956, "policy_mm": -38189.942454365744, "policy_rl": -22279.173387764233}, "policy_reward_max": {"policy_mom": 241610.55743695586, "policy_mean": 317996.70035112643, "policy_mm": 211364.75858071502, "policy_rl": 293595.1282220811}, "policy_reward_mean": {"policy_mom": 52647.44756804155, "policy_mean": 52494.687336684445, "policy_mm": 48472.359762834945, "policy_rl": 73133.77094203395}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52647.44921875, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 241610.5625, "('mean_0', 'policy_mean')_total_reward_mean": 52494.6796875, "('mean_0', 'policy_mean')_total_reward_min": -36216.55078125, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 48472.359375, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 211364.765625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73133.7734375, "('rl_trader_0', 'policy_rl')_total_reward_min": -22279.173828125, "('rl_trader_0', 'policy_rl')_total_reward_max": 293595.125}, "hist_stats": {"episode_reward": [121539.8864807579, 178072.735469399, 292379.8782057203, 113157.26039781877, 288762.69884091866, -4526.808113836211, 153012.6277728675, 750340.5338314016, 349098.1695114812, 384777.70303530106, 383417.1995438729, 710908.7194478323, 686490.6994585907, 279379.15779965505, -98518.1590155145, 9868.598947052267, 94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [45022.19777010441, 80179.65908958619, 51562.182986845095, 28347.478785859843, 79938.76844513722, -3904.587521614298, 40639.813353493875, 163919.83244454136, 102372.4938666153, 93632.06067702295, 88477.40878238305, 102167.41192713313, 175175.05613282663, 90573.41712060694, -36618.46100259596, 11644.384024090725, 35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286], "policy_policy_mean_reward": [14430.242009759724, 52784.36104797261, 91694.72090894263, 7730.990362489679, 78724.27482475535, 697.2810100599978, 48197.197646490495, 142139.18710400123, 76340.3478592601, 102530.4010626766, 101387.5145119143, 167316.4189229034, 168152.18726214147, 50737.78586750587, -22680.383199907752, -28381.274549699585, 26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415], "policy_policy_mm_reward": [22018.25208382709, 13520.187585823927, 66630.09900574118, 24144.74410776766, 40927.78223544186, -11012.711399452102, 41605.18005376436, 161268.9407683897, 75434.56099913851, 75589.3526032327, 86173.60621343018, 178303.43338255456, 135091.24232045174, 59434.30056138852, -17564.431640221577, 12808.726013926904, 15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804], "policy_policy_rl_reward": [40069.194617066685, 31588.527746016163, 82492.87530419105, 52934.04714170163, 89171.87333558433, 9693.209797170088, 22570.436719118672, 283012.57351447054, 94950.76678646763, 113025.88869236904, 107378.67003614592, 263121.4552152406, 208072.21374317072, 78633.65425015349, -21654.883172789232, 13796.763458734287, 16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525961489134179, "mean_inference_ms": 0.7701765028151063, "mean_action_processing_ms": 0.11985438851782698, "mean_env_wait_ms": 2.439579479036303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000790715217590332, "StateBufferConnector_ms": 0.0007759928703308105, "ViewRequirementAgentConnector_ms": 0.01949453353881836}, "num_episodes": 16, "episode_return_max": 920768.2050209037, "episode_return_min": -123191.0063803818, "episode_return_mean": 226748.26560959485, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.38545159437587, "num_env_steps_trained_throughput_per_sec": 266.38545159437587, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 15005.012, "restore_workers_time_ms": 0.08, "training_step_time_ms": 15004.876, "sample_time_ms": 14413.824, "learn_time_ms": 579.76, "learn_throughput": 6899.401, "synch_weights_time_ms": 5.143}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "ae48a_00000", "date": "2025-10-28_12-29-00", "timestamp": 1761672540, "time_this_iter_s": 15.01990294456482, "time_total_s": 1242.611176252365, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68f9c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1242.611176252365, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 23.266666666666666, "ram_util_percent": 83.61904761904759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.782920479774475, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.876600655913354, "policy_loss": -0.019657751033082604, "vf_loss": 9.95547209084034, "vf_explained_var": -2.2903084754943846e-06, "kl": 0.013573610402454913, "entropy": 6.837588043510914, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 920768.2050209037, "episode_reward_min": -123191.0063803818, "episode_reward_mean": 215373.6659340627, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -36216.551707837956, "policy_mm": -38189.942454365744, "policy_rl": -22279.173387764233}, "policy_reward_max": {"policy_mom": 241610.55743695586, "policy_mean": 317996.70035112643, "policy_mm": 211364.75858071502, "policy_rl": 293595.1282220811}, "policy_reward_mean": {"policy_mom": 49361.281797028954, "policy_mean": 50058.41453859917, "policy_mm": 46291.65457013017, "policy_rl": 69662.31502830442}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49361.2734375, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 241610.5625, "('mean_0', 'policy_mean')_total_reward_mean": 50058.41015625, "('mean_0', 'policy_mean')_total_reward_min": -36216.55078125, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 46291.66015625, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 211364.765625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69662.3125, "('rl_trader_0', 'policy_rl')_total_reward_min": -22279.173828125, "('rl_trader_0', 'policy_rl')_total_reward_max": 293595.125}, "hist_stats": {"episode_reward": [94102.78276139816, 846.9271702728059, 235243.65593708516, -107290.52708153162, 336834.6888492457, 375659.5854707728, 355498.9047935537, 284372.330080602, 811211.9178406169, 108199.06224262468, 165144.3566209426, -25323.15186811974, 295515.3880203925, 157413.35680197913, 811417.7280068748, -99068.20839753297, -28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [35880.55727917122, -10177.085227996353, 48187.36526264042, -31475.95776447822, 68983.00086103956, 96835.19443402337, 112919.34505381859, 52190.459386866765, 241610.55743695586, 54140.112939815386, 44849.27875771528, -14.501950301486788, 71897.4963955007, 44273.174962052704, 204186.80405028287, -21283.61967216917, -32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181], "policy_policy_mean_reward": [26678.991132236064, -3716.341276702963, 17496.83178217613, -36216.551707837956, 93716.33727472145, 84460.2492720566, 46251.917929837306, 69446.68827126609, 130382.24162397321, 28622.957010967744, 32703.40126031426, -16060.152073513133, 81651.52181490982, 40349.72724432949, 232747.75562106038, -19948.57108120533, 6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191], "policy_policy_mm_reward": [15410.547141865538, -7072.750695449006, 58111.88973368613, -27321.247074437764, 77619.25420272788, 91990.1519476556, 84133.88036420391, 70121.05548744387, 158345.7463403513, 9130.423296382014, 41961.96727384552, -15233.762544340632, 69068.23059735326, 35503.38857064868, 160754.00411141635, -35556.84425639425, -5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287], "policy_policy_rl_reward": [16132.687208125108, 21813.10437042119, 111447.5691585827, -12276.770534777637, 96516.09651075704, 102373.98981703685, 112193.76144569382, 92614.12693502528, 280873.3724393374, 16305.568995459596, 45629.70932906772, 5985.2647000355055, 72898.13921262856, 37287.06602494872, 213729.16422411567, -22279.173387764233, 2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525502205703622, "mean_inference_ms": 0.7700115536223435, "mean_action_processing_ms": 0.11983893428788647, "mean_env_wait_ms": 2.439415019024444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008113980293273926, "StateBufferConnector_ms": 0.0007901191711425781, "ViewRequirementAgentConnector_ms": 0.019878685474395752}, "num_episodes": 16, "episode_return_max": 920768.2050209037, "episode_return_min": -123191.0063803818, "episode_return_mean": 215373.6659340627, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.3457398552481, "num_env_steps_trained_throughput_per_sec": 261.3457398552481, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 15001.204, "restore_workers_time_ms": 0.075, "training_step_time_ms": 15001.072, "sample_time_ms": 14414.187, "learn_time_ms": 574.71, "learn_throughput": 6960.03, "synch_weights_time_ms": 5.181}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "ae48a_00000", "date": "2025-10-28_12-29-15", "timestamp": 1761672555, "time_this_iter_s": 15.309424877166748, "time_total_s": 1257.9206011295319, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e840>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1257.9206011295319, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 29.4, "ram_util_percent": 83.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9731239080429077, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880005764961243, "policy_loss": -0.018247495536343195, "vf_loss": 9.957285177707671, "vf_explained_var": -4.375912249088288e-06, "kl": 0.015263385073604196, "entropy": 6.933471757173538, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 949374.1581071967, "episode_reward_min": -123191.0063803818, "episode_reward_mean": 223649.94979780007, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -30660.94992316594, "policy_mm": -38189.942454365744, "policy_rl": -12712.125520714875}, "policy_reward_max": {"policy_mom": 229360.4421998945, "policy_mean": 317996.70035112643, "policy_mm": 228544.80562369217, "policy_rl": 293595.1282220811}, "policy_reward_mean": {"policy_mom": 50733.076068178896, "policy_mean": 51694.01703325239, "policy_mm": 48946.45022420093, "policy_rl": 72276.40647216787}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50733.078125, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 229360.4375, "('mean_0', 'policy_mean')_total_reward_mean": 51694.01171875, "('mean_0', 'policy_mean')_total_reward_min": -30660.94921875, "('mean_0', 'policy_mean')_total_reward_max": 317996.6875, "('mm_0', 'policy_mm')_total_reward_mean": 48946.453125, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 228544.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72276.40625, "('rl_trader_0', 'policy_rl')_total_reward_min": -12712.1259765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 293595.125}, "hist_stats": {"episode_reward": [-28732.30135493206, 190363.91588731247, 97393.31375772679, 592658.470193855, 292343.6974781987, 41147.46697342472, 4554.4980993281415, 14347.437153370809, 133898.8583714957, 920768.2050209037, 164319.6557644257, 764786.7256794177, 358093.2575990376, 60038.2970634544, 190423.68395878284, 71362.04070033378, 227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-32537.33486842222, 45522.301606535846, 25319.207802801047, 117544.88799274556, 111838.09580134419, 18516.736428537224, -6936.614528319123, -8974.294957294416, 20631.2037331524, 204889.36725808078, 30849.427516204007, 102220.16899955396, 79279.79627872196, 14502.592797352127, 61259.55965989271, 12171.068672994039, 44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574], "policy_policy_mean_reward": [6705.863090023701, 36289.481592945915, 39885.721496852464, 131630.2037275027, 52049.64194481866, 15144.45581713336, 24735.859567228745, -5523.290792599248, 39441.790729626795, 317996.70035112643, 42943.13758730088, 184304.65642945596, 70347.7845311085, -1714.888927248613, 56030.06351055273, 31674.731230216643, 49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009], "policy_policy_mm_reward": [-5501.678933037815, 42298.22372215642, 16383.500003549632, 155680.07535464453, 65665.73394506105, -11551.622338256784, -5760.969035660266, -2043.8107146981242, 30017.691647747215, 113800.02952534995, 37820.717649666505, 184666.77202832725, 110598.7874248478, -2847.751450732878, 31101.63148910441, 428.17029302936095, 48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411], "policy_policy_rl_reward": [2600.8493565042995, 66253.90896567436, 15804.884454523743, 187803.30311896233, 62790.225786974945, 19037.897066011123, -7483.777903921209, 30888.833617962675, 43808.17226096928, 284082.1078863448, 52706.37301125436, 293595.1282220811, 97866.88936436009, 50098.34464408376, 42032.429299233656, 27088.070504093703, 84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525387353386492, "mean_inference_ms": 0.7699621178300953, "mean_action_processing_ms": 0.11983788630999864, "mean_env_wait_ms": 2.4394359588044763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008298754692077637, "StateBufferConnector_ms": 0.0008154511451721191, "ViewRequirementAgentConnector_ms": 0.020162463188171387}, "num_episodes": 16, "episode_return_max": 949374.1581071967, "episode_return_min": -123191.0063803818, "episode_return_mean": 223649.94979780007, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.6258139111839, "num_env_steps_trained_throughput_per_sec": 260.6258139111839, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 15014.51, "restore_workers_time_ms": 0.074, "training_step_time_ms": 15014.388, "sample_time_ms": 14438.386, "learn_time_ms": 564.075, "learn_throughput": 7091.257, "synch_weights_time_ms": 5.077}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "ae48a_00000", "date": "2025-10-28_12-29-30", "timestamp": 1761672570, "time_this_iter_s": 15.351535081863403, "time_total_s": 1273.2721362113953, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7eaa20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1273.2721362113953, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 28.113636363636363, "ram_util_percent": 84.09545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8380844593048096, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880677238106728, "policy_loss": -0.0212077232557931, "vf_loss": 9.961530181765557, "vf_explained_var": -1.9514933228492738e-06, "kl": 0.015380800582398001, "entropy": 7.002727429568767, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 949374.1581071967, "episode_reward_min": -123191.0063803818, "episode_reward_mean": 218958.85100022928, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -30660.94992316594, "policy_mm": -38189.942454365744, "policy_rl": -14533.359592698487}, "policy_reward_max": {"policy_mom": 229360.4421998945, "policy_mean": 235179.0754076041, "policy_mm": 228544.80562369217, "policy_rl": 277702.8084729843}, "policy_reward_mean": {"policy_mom": 50803.93380766832, "policy_mean": 48388.55122275704, "policy_mm": 49092.21005947489, "policy_rl": 70674.15591032898}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50803.9296875, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 229360.4375, "('mean_0', 'policy_mean')_total_reward_mean": 48388.55859375, "('mean_0', 'policy_mean')_total_reward_min": -30660.94921875, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 49092.19921875, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 228544.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70674.1484375, "('rl_trader_0', 'policy_rl')_total_reward_min": -14533.359375, "('rl_trader_0', 'policy_rl')_total_reward_max": 277702.8125}, "hist_stats": {"episode_reward": [227711.49873187454, 1348.2584795885136, -3196.4181060866576, 271088.8390081286, 577970.9401405257, 52833.66814124019, 1140.6460985049605, 9987.920949653704, -57515.053667447486, 116203.13927402778, 598.4641556228812, 248541.43125893603, 121857.07633258229, 245990.47237637592, 367536.36886787077, 251041.55642584106, 175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [44969.81781183728, 4274.346363091714, -1151.398047077687, 57809.57314030623, 167719.82667659796, 11201.810686298702, -9819.450764901329, -2522.167014393277, -26958.20860914575, 37781.64062733238, -2201.7401875902797, 61565.877885241636, 20530.06865855032, 45668.5759583331, 100443.76202321085, 69672.36097241862, 31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688], "policy_policy_mean_reward": [49255.83035321999, -2584.39565187645, -10161.026277294839, 96292.88845709032, 111935.43807218953, 14598.572076811604, 787.5522636256031, 15171.82238970625, -2310.984169185152, 28145.968475507994, -19380.637799766042, 57729.4801285244, 29508.947295153557, 75863.9685726596, 81361.89721725967, 46921.71634358713, 37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756], "policy_policy_mm_reward": [48701.44033380954, -12616.50693622762, -2522.129717117591, 54877.05407583992, 149539.15272000205, -12442.048075964227, -2565.43718763143, -12715.576183134257, -22210.715454980098, 27360.878017350584, 5395.525695491016, 43417.921328184726, 40852.07112561462, 70099.58836747373, 89800.13494920149, 71037.59956161639, 20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275], "policy_policy_rl_reward": [84784.41023300769, 12274.814704600882, 10638.135935403432, 62109.32333489236, 148776.52267173553, 39475.33345409401, 12737.981787411762, 10053.841757474751, -6035.145434136564, 22914.652153836778, 16785.316447488178, 85828.15191698523, 30965.989253263928, 54358.339477908834, 95930.57467819896, 63409.87954821892, 85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25253071705835084, "mean_inference_ms": 0.7699232920630875, "mean_action_processing_ms": 0.11983699447985753, "mean_env_wait_ms": 2.4395206593424006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008363723754882812, "StateBufferConnector_ms": 0.0008269548416137695, "ViewRequirementAgentConnector_ms": 0.02027028799057007}, "num_episodes": 16, "episode_return_max": 949374.1581071967, "episode_return_min": -123191.0063803818, "episode_return_mean": 218958.85100022928, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.72203691935744, "num_env_steps_trained_throughput_per_sec": 264.72203691935744, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 15025.976, "restore_workers_time_ms": 0.065, "training_step_time_ms": 15025.863, "sample_time_ms": 14453.449, "learn_time_ms": 560.097, "learn_throughput": 7141.617, "synch_weights_time_ms": 5.914}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "ae48a_00000", "date": "2025-10-28_12-29-45", "timestamp": 1761672585, "time_this_iter_s": 15.114067792892456, "time_total_s": 1288.3862040042877, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7ea660>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1288.3862040042877, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 22.92727272727273, "ram_util_percent": 83.62272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9885879755020142, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.881691089272499, "policy_loss": -0.015781944633636157, "vf_loss": 9.955683436989784, "vf_explained_var": -1.393444836139679e-06, "kl": 0.01543971465689597, "entropy": 6.8632188305258754, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 949374.1581071967, "episode_reward_min": -123191.0063803818, "episode_reward_mean": 246225.5620940123, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42786.87946792294, "policy_mean": -38201.02754846958, "policy_mm": -38189.942454365744, "policy_rl": -19818.878562034573}, "policy_reward_max": {"policy_mom": 255807.95931469108, "policy_mean": 235179.0754076041, "policy_mm": 256649.39521840474, "policy_rl": 283050.1736602137}, "policy_reward_mean": {"policy_mom": 58039.1104976029, "policy_mean": 52499.91851757772, "policy_mm": 55582.69026639123, "policy_rl": 80103.84281244045}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58039.109375, "('mom_0', 'policy_mom')_total_reward_min": -42786.87890625, "('mom_0', 'policy_mom')_total_reward_max": 255807.953125, "('mean_0', 'policy_mean')_total_reward_mean": 52499.921875, "('mean_0', 'policy_mean')_total_reward_min": -38201.02734375, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 55582.68359375, "('mm_0', 'policy_mm')_total_reward_min": -38189.94140625, "('mm_0', 'policy_mm')_total_reward_max": 256649.390625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 80103.84375, "('rl_trader_0', 'policy_rl')_total_reward_min": -19818.87890625, "('rl_trader_0', 'policy_rl')_total_reward_max": 283050.1875}, "hist_stats": {"episode_reward": [175616.80647179694, 220616.32246930082, -31303.742882406696, 380056.16993323114, -72525.75638177588, 132390.0398265397, 185173.8332439478, 227791.44094996297, 162343.12736452985, 323297.7146468852, 13064.996755461965, 383085.73120285344, -123191.0063803818, 287585.43557709845, 89682.6537072501, 587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [31828.736694022697, 69416.04314285157, -27748.924454043652, 86336.96541054796, -10037.554660274775, 40489.797808474636, 35457.952366793616, 49532.61694085891, 45113.640730046835, 77661.72879151924, 14032.28187471113, 94002.89473504895, -42786.87946792294, 79729.61368854724, 29380.992781972145, 170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627], "policy_policy_mean_reward": [37906.39589464731, 44130.60574774688, -12680.791596346324, 96994.9681306126, -23660.916157119398, 29075.640847754108, 50458.94321369847, 58758.18637141524, 27725.43119034962, 75142.89825392472, -6324.9834695227855, 109474.7403515188, -30660.94992316594, 61992.709959035696, 51214.13306780696, 103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207], "policy_policy_mm_reward": [20496.776860103197, 58046.3251875408, -5875.892858673035, 101836.39264628138, -26115.160043666907, 19298.35331082347, 48144.54235870552, 46075.29079387264, 53368.17908098991, 87295.13262307105, -7498.008946779961, 109830.99049390313, -38189.942454365744, 72102.25986326589, -1747.2467832989933, 111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137], "policy_policy_rl_reward": [85384.89702302378, 49023.3483911613, 15001.86602665639, 94887.84374578869, -12712.125520714875, 43526.24785948761, 51112.39530475005, 73425.34684381614, 36135.8763631435, 83197.95497837021, 12855.707297053565, 69777.10562238272, -11553.234534927251, 73760.85206624963, 10834.774640769958, 202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525241041026954, "mean_inference_ms": 0.7698973725635977, "mean_action_processing_ms": 0.11983794604277896, "mean_env_wait_ms": 2.4396098763974017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008282661437988281, "StateBufferConnector_ms": 0.0008255839347839355, "ViewRequirementAgentConnector_ms": 0.020121634006500244}, "num_episodes": 16, "episode_return_max": 949374.1581071967, "episode_return_min": -123191.0063803818, "episode_return_mean": 246225.5620940123, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.91384635655515, "num_env_steps_trained_throughput_per_sec": 266.91384635655515, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 15024.973, "restore_workers_time_ms": 0.07, "training_step_time_ms": 15024.852, "sample_time_ms": 14458.084, "learn_time_ms": 553.754, "learn_throughput": 7223.425, "synch_weights_time_ms": 6.517}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "ae48a_00000", "date": "2025-10-28_12-30-00", "timestamp": 1761672600, "time_this_iter_s": 14.990218877792358, "time_total_s": 1303.37642288208, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e9a80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1303.37642288208, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.595238095238095, "ram_util_percent": 82.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.793753981590271, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880788722634316, "policy_loss": -0.021143211105663796, "vf_loss": 9.960615789890289, "vf_explained_var": 2.3692846298217773e-06, "kl": 0.015666736736557614, "entropy": 6.925888049602508, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 949374.1581071967, "episode_reward_min": -115393.9103538828, "episode_reward_mean": 254137.6387367433, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -32138.77608568879, "policy_mean": -42197.14956792883, "policy_mm": -29973.387351084937, "policy_rl": -19818.878562034573}, "policy_reward_max": {"policy_mom": 255807.95931469108, "policy_mean": 235179.0754076041, "policy_mm": 256649.39521840474, "policy_rl": 283050.1736602137}, "policy_reward_mean": {"policy_mom": 60040.8811768814, "policy_mean": 53306.92530623631, "policy_mm": 57636.59572976455, "policy_rl": 83153.23652386102}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 60040.88671875, "('mom_0', 'policy_mom')_total_reward_min": -32138.775390625, "('mom_0', 'policy_mom')_total_reward_max": 255807.953125, "('mean_0', 'policy_mean')_total_reward_mean": 53306.92578125, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 57636.58984375, "('mm_0', 'policy_mm')_total_reward_min": -29973.38671875, "('mm_0', 'policy_mm')_total_reward_max": 256649.390625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 83153.2421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -19818.87890625, "('rl_trader_0', 'policy_rl')_total_reward_max": 283050.1875}, "hist_stats": {"episode_reward": [587862.4421760413, 280098.46924514795, 194652.87999536065, 178874.92299349513, 539967.3479465215, 269745.2353071646, -264.83645689962054, 199293.33807937524, 201220.65125320936, -60870.06326822076, 21747.333035786647, 535241.3171910006, 41172.104602978856, 316780.0872820504, 370717.78075715515, 351590.3618079512, 702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [170779.3200021192, 39906.87744766194, 33510.88038766682, 46911.679063659576, 133601.9645138039, 59790.30822010707, 6395.919543684887, 35578.774425285104, 49566.940504374914, -23700.440329635883, 13174.084290826308, 95322.50281697884, 9433.191295889155, 68795.96223188298, 69814.10582011707, 88054.11882894779, 99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138], "policy_policy_mean_reward": [103009.01670749128, 75597.3400779384, 43066.113943201, 52455.777957073544, 104050.07614979161, 50002.85460744792, -9891.31863021645, 54860.46297258335, 59401.199656363584, -21550.674992778197, -1256.6819020978219, 103558.46924254873, 7937.079170018115, 49242.708647263156, 91644.83198768916, 79260.09604168858, 115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534], "policy_policy_mm_reward": [111533.31109571134, 88664.43675857596, 56718.78802909702, 26794.524206281385, 158767.61265899468, 29867.126602253622, -20100.232379586796, 37959.50796731877, 49781.13962767474, -11205.038897602057, 1432.1740584285183, 99571.77489524844, -5444.1123727792765, 71991.39708712552, 91468.46846004872, 75391.5073662649, 211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073], "policy_policy_rl_reward": [202540.79437071914, 75929.81496097174, 61357.09763539589, 52712.94176648093, 143547.69462393183, 130084.94587735584, 23330.79500921874, 70894.59271418815, 42471.37146479661, -4413.909048204756, 8397.756588629496, 236788.57023622427, 29245.946509850975, 126750.01931577892, 117790.37448930068, 108884.63957104988, 276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252520088126712, "mean_inference_ms": 0.7698785082780808, "mean_action_processing_ms": 0.1198402372647566, "mean_env_wait_ms": 2.439689953189149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008289813995361328, "StateBufferConnector_ms": 0.0008218884468078613, "ViewRequirementAgentConnector_ms": 0.020048558712005615}, "num_episodes": 15, "episode_return_max": 949374.1581071967, "episode_return_min": -115393.9103538828, "episode_return_mean": 254137.6387367433, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.9347477758942, "num_env_steps_trained_throughput_per_sec": 263.9347477758942, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 15081.975, "restore_workers_time_ms": 0.128, "training_step_time_ms": 15081.796, "sample_time_ms": 14511.884, "learn_time_ms": 557.013, "learn_throughput": 7181.158, "synch_weights_time_ms": 6.387}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "ae48a_00000", "date": "2025-10-28_12-30-16", "timestamp": 1761672616, "time_this_iter_s": 15.159087896347046, "time_total_s": 1318.5355107784271, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7ea160>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1318.5355107784271, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 22.114285714285717, "ram_util_percent": 83.4761904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8705917596817017, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.880142840743066, "policy_loss": -0.02127121857047314, "vf_loss": 9.95981352031231, "vf_explained_var": 6.535835564136505e-06, "kl": 0.014993998825503192, "entropy": 6.852038951218129, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 949374.1581071967, "episode_reward_min": -115393.9103538828, "episode_reward_mean": 255554.90824229553, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -32138.77608568879, "policy_mean": -42197.14956792883, "policy_mm": -29973.387351084937, "policy_rl": -19818.878562034573}, "policy_reward_max": {"policy_mom": 255807.95931469108, "policy_mean": 235179.0754076041, "policy_mm": 256649.39521840474, "policy_rl": 283050.1736602137}, "policy_reward_mean": {"policy_mom": 60428.755766630944, "policy_mean": 54897.99734191399, "policy_mm": 59193.28269861046, "policy_rl": 81034.87243514013}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 60428.75390625, "('mom_0', 'policy_mom')_total_reward_min": -32138.775390625, "('mom_0', 'policy_mom')_total_reward_max": 255807.953125, "('mean_0', 'policy_mean')_total_reward_mean": 54898.00390625, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 59193.28515625, "('mm_0', 'policy_mm')_total_reward_min": -29973.38671875, "('mm_0', 'policy_mm')_total_reward_max": 256649.390625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 81034.8671875, "('rl_trader_0', 'policy_rl')_total_reward_min": -19818.87890625, "('rl_trader_0', 'policy_rl')_total_reward_max": 283050.1875}, "hist_stats": {"episode_reward": [702210.3806661718, 440158.5474543565, 101464.72431561917, 348449.6946041374, 2184.345790920238, 247065.53316960315, -12014.962862978206, 463110.67257656873, 65452.223505603695, 120970.0199103284, 282832.2858850623, 292477.4414956588, 563578.3104356558, 94104.64181485969, 21197.33427406966, -31724.487225449797, 323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [99563.52233091014, 93795.6132974815, 18940.943688580053, 90263.13434439142, -8376.717764695286, 59531.97818094117, 5727.595745712527, 118590.07735831587, 10894.130077222622, 8408.676095840305, 52660.12025648351, 64482.258642686895, 123097.8671387306, 3298.8102323175126, -319.46218808668743, -17429.90863532724, 79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703], "policy_policy_mean_reward": [115117.030009682, 80984.4462448589, 40811.769246257114, 117118.22355114255, 9055.694715027415, 37352.828959041646, -7662.225195632573, 118328.49731968644, 9373.809250781123, 39612.28637389725, 55226.630745668794, 38507.55334174, 139062.27190651087, 24986.586721422216, -11707.815202702595, 2501.734206152654, 97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724], "policy_policy_mm_reward": [211364.75858071502, 100868.52257095723, 11046.388911509679, 65249.563676132755, 10342.712626560804, 72723.3086646787, -10491.433697629232, 86450.55445437392, 15027.06055924749, 19888.01420960662, 40566.04494941421, 68444.19182016427, 145225.3572232223, 19726.502172867888, 2357.581088215817, -23242.12734280091, 65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467], "policy_policy_rl_reward": [276165.06974486413, 164509.965341059, 30665.622469272173, 75818.77303247017, -8837.34378597256, 77457.41736494182, 411.10028457088333, 139741.54344419227, 30157.223618352593, 53061.04323098422, 134379.48993349576, 121043.43769106752, 156192.81416719244, 46092.74268825198, 30867.03057664317, 6445.814546525765, 80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25251306803454093, "mean_inference_ms": 0.7698503388831682, "mean_action_processing_ms": 0.11984113423796243, "mean_env_wait_ms": 2.4397894846045576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008286833763122559, "StateBufferConnector_ms": 0.0008164048194885254, "ViewRequirementAgentConnector_ms": 0.02001965045928955}, "num_episodes": 16, "episode_return_max": 949374.1581071967, "episode_return_min": -115393.9103538828, "episode_return_mean": 255554.90824229553, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.5437713985327, "num_env_steps_trained_throughput_per_sec": 266.5437713985327, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 15096.866, "restore_workers_time_ms": 0.128, "training_step_time_ms": 15096.685, "sample_time_ms": 14540.873, "learn_time_ms": 543.579, "learn_throughput": 7358.639, "synch_weights_time_ms": 5.943}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "ae48a_00000", "date": "2025-10-28_12-30-31", "timestamp": 1761672631, "time_this_iter_s": 15.013220071792603, "time_total_s": 1333.5487308502197, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68c860>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1333.5487308502197, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 24.213636363636365, "ram_util_percent": 83.34545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0763027667999268, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.877910259366036, "policy_loss": -0.020055805856827646, "vf_loss": 9.958896434307098, "vf_explained_var": 1.1243857443332672e-05, "kl": 0.0153461431532383, "entropy": 7.128904949128628, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 972167.9808108415, "episode_reward_min": -133258.31050261826, "episode_reward_mean": 253479.2487567595, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35163.54672725093, "policy_mean": -42197.14956792883, "policy_mm": -29973.387351084937, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 255807.95931469108, "policy_mean": 235179.0754076041, "policy_mm": 272759.18789603043, "policy_rl": 320381.9343370447}, "policy_reward_mean": {"policy_mom": 60936.495455657474, "policy_mean": 53484.55583948736, "policy_mm": 59651.464267155345, "policy_rl": 79406.73319445929}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 60936.5, "('mom_0', 'policy_mom')_total_reward_min": -35163.546875, "('mom_0', 'policy_mom')_total_reward_max": 255807.953125, "('mean_0', 'policy_mean')_total_reward_mean": 53484.5546875, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 59651.4609375, "('mm_0', 'policy_mm')_total_reward_min": -29973.38671875, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 79406.7265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 320381.9375}, "hist_stats": {"episode_reward": [323930.5878790204, 266195.4709207766, 249209.3299818142, 306411.9531980517, 207904.5791014586, 361179.45898164186, 200125.88503579434, 429428.2621563966, 416989.35748803715, 396762.6611010353, -11334.46594767999, 650913.0449811517, 102926.98396627697, 180474.072103114, 49530.248912819116, 170666.27082787792, 74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [79876.96320357975, 98131.07503566796, 46688.73004904084, 70254.15277912971, 60619.47580852181, 84861.32773291832, 52597.90824184718, 102336.35829175092, 108859.35911554041, 94663.7137887911, -6719.834553455545, 171826.4114955706, 42125.42981899949, 57980.25656321596, 11788.346949742605, 38819.46025930178, 23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556], "policy_policy_mean_reward": [97796.80557935571, 48059.059563291696, 76780.32803911628, 84139.94011133784, 55815.68112307191, 75924.28288719412, 35939.36637875551, 91472.55395483786, 91004.96964856528, 77445.21303405217, -8325.285739104324, 108896.28209478968, 7631.0191158535, 21037.297931881873, 12745.694517643022, 56707.11507818221, 3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571], "policy_policy_mm_reward": [65597.37058951563, 65858.81041553858, 79046.77909807007, 60278.907765648895, 38845.82365459287, 72632.2953371666, 36309.87669724918, 110399.1355765647, 109851.71143144806, 118871.93402121766, -9631.323530946116, 118912.8847120719, 14187.858207751717, 46600.35455123545, 5887.953140781518, 27149.680968740347, 10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043], "policy_policy_rl_reward": [80659.44850656943, 54146.52590627776, 46693.492795586964, 91738.9525419353, 52623.59851527199, 127761.55302436314, 75278.73371794235, 125220.21433324297, 107273.31729248364, 105781.80025697402, 13341.977875826087, 251277.46667871907, 38982.676823672235, 54856.16305678061, 19108.25430465199, 47990.01452165368, 36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525262223947811, "mean_inference_ms": 0.7698908171431634, "mean_action_processing_ms": 0.11984941084167586, "mean_env_wait_ms": 2.43997108547944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008243322372436523, "StateBufferConnector_ms": 0.0008141994476318359, "ViewRequirementAgentConnector_ms": 0.019940078258514404}, "num_episodes": 16, "episode_return_max": 972167.9808108415, "episode_return_min": -133258.31050261826, "episode_return_mean": 253479.2487567595, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.90497669055534, "num_env_steps_trained_throughput_per_sec": 255.90497669055534, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 15157.383, "restore_workers_time_ms": 0.127, "training_step_time_ms": 15157.201, "sample_time_ms": 14596.654, "learn_time_ms": 546.999, "learn_throughput": 7312.629, "synch_weights_time_ms": 7.047}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "ae48a_00000", "date": "2025-10-28_12-30-46", "timestamp": 1761672646, "time_this_iter_s": 15.63500690460205, "time_total_s": 1349.1837377548218, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68f4c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1349.1837377548218, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 28.99090909090909, "ram_util_percent": 83.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.853525161743164, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.87608581483364, "policy_loss": -0.020039487259782617, "vf_loss": 9.957407024502754, "vf_explained_var": 6.890669465065003e-06, "kl": 0.014789689797090042, "entropy": 7.126477766036987, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 972167.9808108415, "episode_reward_min": -133258.31050261826, "episode_reward_mean": 247061.63471439685, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35163.54672725093, "policy_mean": -42197.14956792883, "policy_mm": -29973.387351084937, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 299444.40029271744, "policy_mean": 235179.0754076041, "policy_mm": 272759.18789603043, "policy_rl": 320381.9343370447}, "policy_reward_mean": {"policy_mom": 58899.04939521066, "policy_mean": 51429.426676025454, "policy_mm": 59742.57049662308, "policy_rl": 76990.58814653769}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58899.046875, "('mom_0', 'policy_mom')_total_reward_min": -35163.546875, "('mom_0', 'policy_mom')_total_reward_max": 299444.40625, "('mean_0', 'policy_mean')_total_reward_mean": 51429.42578125, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 235179.078125, "('mm_0', 'policy_mm')_total_reward_mean": 59742.56640625, "('mm_0', 'policy_mm')_total_reward_min": -29973.38671875, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76990.5859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 320381.9375}, "hist_stats": {"episode_reward": [74254.207811521, 149058.78587930603, 949374.1581071967, 195037.74598943154, 312020.5062289946, 192423.05598180552, 283285.52141357603, -44449.18529579662, 629162.765758751, 130375.02547355715, 805309.1829705541, 157265.69912672378, -2125.329323199365, 195676.50795106057, 288194.7020230058, -31546.45605653792, 292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [23193.031617351273, 22153.35272855059, 229360.4421998945, 46814.119764338684, 69521.925305574, 55955.1237996054, 54594.213383685405, -11848.2555899081, 121594.62006260845, 31690.66634604817, 158868.96907136467, 24547.354471574574, 5742.706542041188, 35343.87252172618, 89806.88123990275, -32138.77608568879, 96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744], "policy_policy_mean_reward": [3936.6354273740935, 37373.94991150206, 235179.0754076041, 37732.09683896963, 87426.98707581009, 45230.305374640935, 78319.11676784749, -8596.847218341596, 155364.31283774856, 29578.014567675025, 168118.48161420794, 31298.863900268323, -12466.700811634815, 53020.31423483152, 73515.2627993587, -14630.646613963294, 50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891], "policy_policy_mm_reward": [10847.405363501854, 51022.439082541234, 228544.80562369217, 26206.676664277617, 84651.8120567411, 50499.75407736118, 78115.67464395321, -9470.722894848477, 152984.26000880837, 20441.130554606283, 200618.92381199694, 36048.75017472216, 2096.5916189654586, 28901.41559247295, 54106.90330528576, -688.1361106142319, 61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834], "policy_policy_rl_reward": [36277.1354032937, 38509.04415671193, 256289.83487600798, 84284.85272184575, 70419.78179086954, 40737.872730197945, 72256.51661809035, -14533.359592698487, 199219.57284958524, 48665.214005227666, 277702.8084729843, 65370.73058015877, 2502.073327428629, 78410.9056020299, 70765.65467845819, 15911.102753728275, 84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25251402984390076, "mean_inference_ms": 0.7698493396084115, "mean_action_processing_ms": 0.11984702490828177, "mean_env_wait_ms": 2.4400387893858824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008127689361572266, "StateBufferConnector_ms": 0.0008053779602050781, "ViewRequirementAgentConnector_ms": 0.019775092601776123}, "num_episodes": 16, "episode_return_max": 972167.9808108415, "episode_return_min": -133258.31050261826, "episode_return_mean": 247061.63471439685, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.602629979257, "num_env_steps_trained_throughput_per_sec": 268.602629979257, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 15144.468, "restore_workers_time_ms": 0.15, "training_step_time_ms": 15144.263, "sample_time_ms": 14589.553, "learn_time_ms": 541.477, "learn_throughput": 7387.202, "synch_weights_time_ms": 6.694}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "ae48a_00000", "date": "2025-10-28_12-31-01", "timestamp": 1761672661, "time_this_iter_s": 14.896318197250366, "time_total_s": 1364.0800559520721, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e91c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1364.0800559520721, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 20.995238095238097, "ram_util_percent": 83.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.167539119720459, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.87707341313362, "policy_loss": -0.021002616829355246, "vf_loss": 9.95598112642765, "vf_explained_var": 3.368593752384186e-06, "kl": 0.017048774256819, "entropy": 6.941301092505455, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -133258.31050261826, "episode_reward_mean": 261138.80302542905, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35163.54672725093, "policy_mean": -42197.14956792883, "policy_mm": -29973.387351084937, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 267917.6976072964, "policy_mm": 272759.18789603043, "policy_rl": 349591.4527014713}, "policy_reward_mean": {"policy_mom": 62489.562279806276, "policy_mean": 53517.27979844739, "policy_mm": 62963.299365708895, "policy_rl": 82168.66158146653}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 62489.56640625, "('mom_0', 'policy_mom')_total_reward_min": -35163.546875, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 53517.2734375, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 267917.6875, "('mm_0', 'policy_mm')_total_reward_mean": 62963.30078125, "('mm_0', 'policy_mm')_total_reward_min": -29973.38671875, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 82168.65625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 349591.4375}, "hist_stats": {"episode_reward": [292350.02710100595, 74265.63565108801, 133869.6201603142, 28633.93662731822, 265966.6330258239, 377130.1079611132, 881420.3422592172, 642632.5833969658, -46593.62850093481, 76083.29885350647, 322199.2527360035, 470750.62724262744, 304252.80171737215, 382694.3376780589, 849050.1683808891, -78451.07607773822, 38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [96238.29820665721, 15638.16951575142, 49171.50115579156, 23576.104790404715, 84400.49471125688, 90336.9642909179, 255807.95931469108, 224175.64694543037, -5709.698040958288, 17817.838723117628, 95363.27182253847, 84831.84940555542, 69938.10723805764, 65086.12026174151, 199179.98388545867, -18947.60935580193, 19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653], "policy_policy_mean_reward": [50215.204950183426, 3545.1412194167674, 41078.28739731471, -10874.073603790905, 28680.293420748756, 60899.22674469285, 161319.807205066, 120863.51682125224, -25831.06605588417, 9855.202014588976, 80800.39087588446, 98229.57990743867, 55799.19180063374, 90330.39635324449, 151273.73179623677, -18337.12748733173, -3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674], "policy_policy_mm_reward": [61321.39677926839, 27552.63452097099, 4802.230468990088, -7382.268628657815, 75382.94621521275, 104589.78418620121, 181242.40207924705, 125107.17001528651, -14081.989281378983, 17623.403048303262, 63401.56418863928, 82106.36307318819, 87566.91776585198, 91121.52780744713, 256649.39521840474, -29973.387351084937, 8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234], "policy_policy_rl_reward": [84575.12716489706, 27529.69039494884, 38817.6011382178, 23314.17406936213, 77502.8986786058, 121304.13273930109, 283050.1736602137, 172486.24961499602, -970.8751227133961, 30786.855067496745, 82634.02584894137, 205582.83485644494, 90948.58491282859, 136156.29325562652, 241947.05748078733, -11192.951883519634, 14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25250678384772945, "mean_inference_ms": 0.7698276943404272, "mean_action_processing_ms": 0.11984756722225615, "mean_env_wait_ms": 2.4400877799060448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008137226104736328, "StateBufferConnector_ms": 0.0008059144020080566, "ViewRequirementAgentConnector_ms": 0.019834697246551514}, "num_episodes": 16, "episode_return_max": 1230242.9772235004, "episode_return_min": -133258.31050261826, "episode_return_mean": 261138.80302542905, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.77354764124914, "num_env_steps_trained_throughput_per_sec": 263.77354764124914, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 15161.48, "restore_workers_time_ms": 0.174, "training_step_time_ms": 15161.25, "sample_time_ms": 14604.34, "learn_time_ms": 543.823, "learn_throughput": 7355.332, "synch_weights_time_ms": 6.359}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "ae48a_00000", "date": "2025-10-28_12-31-16", "timestamp": 1761672676, "time_this_iter_s": 15.168469905853271, "time_total_s": 1379.2485258579254, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e87c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1379.2485258579254, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.022727272727273, "ram_util_percent": 84.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7525806427001953, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.870155394077301, "policy_loss": -0.025274652149528266, "vf_loss": 9.956971457600593, "vf_explained_var": 1.1168420314788819e-06, "kl": 0.014069050894886975, "entropy": 7.103804960846901, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -133258.31050261826, "episode_reward_mean": 247752.86187404685, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35163.54672725093, "policy_mean": -42197.14956792883, "policy_mm": -29172.45753000232, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 267917.6976072964, "policy_mm": 272759.18789603043, "policy_rl": 349591.4527014713}, "policy_reward_mean": {"policy_mom": 56940.203799792886, "policy_mean": 52956.36495239974, "policy_mm": 60220.87322666376, "policy_rl": 77635.41989519043}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56940.2109375, "('mom_0', 'policy_mom')_total_reward_min": -35163.546875, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 52956.37109375, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 267917.6875, "('mm_0', 'policy_mm')_total_reward_mean": 60220.86328125, "('mm_0', 'policy_mm')_total_reward_min": -29172.45703125, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77635.421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 349591.4375}, "hist_stats": {"episode_reward": [38974.34488950763, 160704.47473122532, -115393.9103538828, 266928.6797665997, 627427.5131650171, 58919.71752837425, 180905.1822080697, 80735.28481620773, 850167.7370488797, 220616.59625213343, 272010.7206808364, 114969.61641566797, 326644.44982539245, 120165.26827504541, 380464.65502176556, 253675.58518443108, -13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [19815.9874916078, 25453.12533372388, -30220.177214646825, 75350.7579988191, 134222.23707331627, 11255.055461794522, 41207.09532584427, 28721.32684313006, 254241.79272250683, 43821.11819470498, 57478.96447596037, 15849.154501254112, 50962.89595579831, 35515.50346700207, 94866.60506763551, 81869.018997243, -20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346], "policy_policy_mean_reward": [-3470.15279022685, 52049.7902693714, -38201.02754846958, 64240.93427584099, 124451.37304694207, 238.59616471644992, 45552.21611769462, 16451.806178573323, 136751.06300016298, 40766.03071360623, 75023.39388783231, 52484.16836304617, 65741.91191138639, 27323.073842608246, 91610.67223185218, 38697.77312250516, -4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734], "policy_policy_mm_reward": [8403.16798615588, 43480.78606129895, -27153.827028731826, 58256.57146964514, 136717.12407269137, 881.5798433917336, 32818.2177668197, 2660.9726338381693, 255280.56950734087, 50897.82487606852, 75064.23613816054, 27916.63529785594, 77283.59167667308, 35732.048379030886, 88765.98759717298, 46798.460948825414, 14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848], "policy_policy_rl_reward": [14225.3422019708, 39720.77306683096, -19818.878562034573, 69080.41602229408, 232036.77897206784, 46544.48605847149, 61327.652997711106, 32901.17916066609, 203894.31181887022, 85131.62246775348, 64444.12617888304, 18719.658253511763, 132656.05028153403, 21594.642586404174, 105221.39012510575, 86310.33211585764, -2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525108981578386, "mean_inference_ms": 0.7698419544008109, "mean_action_processing_ms": 0.11985162926925753, "mean_env_wait_ms": 2.440213387418437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008185505867004395, "StateBufferConnector_ms": 0.0008100271224975586, "ViewRequirementAgentConnector_ms": 0.01997518539428711}, "num_episodes": 16, "episode_return_max": 1230242.9772235004, "episode_return_min": -133258.31050261826, "episode_return_mean": 247752.86187404685, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.51454992122007, "num_env_steps_trained_throughput_per_sec": 259.51454992122007, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 15201.24, "restore_workers_time_ms": 0.169, "training_step_time_ms": 15201.011, "sample_time_ms": 14634.172, "learn_time_ms": 554.068, "learn_throughput": 7219.331, "synch_weights_time_ms": 6.031}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "ae48a_00000", "date": "2025-10-28_12-31-32", "timestamp": 1761672692, "time_this_iter_s": 15.41697382926941, "time_total_s": 1394.6654996871948, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7ea3e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1394.6654996871948, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.04090909090909, "ram_util_percent": 83.53636363636362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8047822713851929, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.876560446619987, "policy_loss": -0.022572879440849646, "vf_loss": 9.958949837088586, "vf_explained_var": -6.67572021484375e-07, "kl": 0.014350984792645707, "entropy": 6.950344264507294, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -133258.31050261826, "episode_reward_mean": 243166.23342940002, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -42197.14956792883, "policy_mm": -31375.554496396006, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 267917.6976072964, "policy_mm": 272759.18789603043, "policy_rl": 349591.4527014713}, "policy_reward_mean": {"policy_mom": 55124.77331368714, "policy_mean": 52581.32631430808, "policy_mm": 57385.321047822414, "policy_rl": 78074.81275358236}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55124.7734375, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 52581.32421875, "('mean_0', 'policy_mean')_total_reward_min": -42197.1484375, "('mean_0', 'policy_mean')_total_reward_max": 267917.6875, "('mm_0', 'policy_mm')_total_reward_mean": 57385.31640625, "('mm_0', 'policy_mm')_total_reward_min": -31375.5546875, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 78074.8125, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 349591.4375}, "hist_stats": {"episode_reward": [-13204.642168936163, 266415.7755787912, -98663.79120318317, 131069.27531391228, 337017.09768850263, 213960.93194564263, 274093.7354834977, 283470.9188696386, 246513.15842143915, 248602.8913236899, 133553.56459061123, 655959.901119116, 179941.34884705688, 376609.2464484243, 527485.9671997977, 47931.67011275831, 294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-20859.227977806866, 60520.610039284766, -24116.012331759317, 41253.07356841138, 91110.73594303858, 36628.694548992804, 58144.4050514032, 45437.692374793296, 52314.45580401961, 30228.53770614624, 49090.64204687349, 191454.44016987772, 34979.15201726793, 87383.96952582287, 124511.33212869856, -10600.625529806786, 54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416], "policy_policy_mean_reward": [-4317.339102662561, 77502.27694663027, -42197.14956792883, 28619.196938192534, 64314.46358933807, 71289.92217492979, 67732.98266881461, 42146.887370864155, 67296.87888936141, 71506.33272610695, 24246.16127067333, 149408.40808679545, 64045.78924089261, 77706.52273356396, 125799.34544070515, 18505.942605670807, 63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752], "policy_policy_mm_reward": [14812.155923873906, 49016.743432280186, -27333.661506061842, 11863.175953832073, 52013.32305874179, 34125.59457258727, 62247.94622946158, 107338.65551752252, 63720.36654251255, 67079.9723121181, 12586.28719940095, 169255.90660091283, 41847.64319987918, 90876.98491082872, 112111.16103776351, 28516.45442698819, 89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842], "policy_policy_rl_reward": [-2840.2310123405414, 79376.14516059641, -5016.967797433313, 49333.82885347631, 129578.57509738368, 71916.72064913274, 85968.40153381822, 88547.68360645848, 63181.4571855455, 79788.04857931864, 47630.47407366357, 145841.14626153035, 39068.764389017204, 120641.76927820899, 165064.12859263108, 11509.898609906113, 88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25251677511312254, "mean_inference_ms": 0.7698605116981869, "mean_action_processing_ms": 0.1198550627390959, "mean_env_wait_ms": 2.440356589525889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008097290992736816, "StateBufferConnector_ms": 0.0008003711700439453, "ViewRequirementAgentConnector_ms": 0.01997530460357666}, "num_episodes": 16, "episode_return_max": 1230242.9772235004, "episode_return_min": -133258.31050261826, "episode_return_mean": 243166.23342940002, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.4612049455264, "num_env_steps_trained_throughput_per_sec": 264.4612049455264, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 15183.209, "restore_workers_time_ms": 0.167, "training_step_time_ms": 15182.985, "sample_time_ms": 14608.656, "learn_time_ms": 562.044, "learn_throughput": 7116.879, "synch_weights_time_ms": 6.466}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "ae48a_00000", "date": "2025-10-28_12-31-47", "timestamp": 1761672707, "time_this_iter_s": 15.128983974456787, "time_total_s": 1409.7944836616516, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68e980>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1409.7944836616516, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.36190476190476, "ram_util_percent": 83.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.140726089477539, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.8910963088274, "policy_loss": -0.010719879598764238, "vf_loss": 9.958328726887704, "vf_explained_var": -3.3564865589141844e-07, "kl": 0.020452624167774526, "entropy": 7.03181206882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -139831.53368503362, "episode_reward_mean": 237419.09832211214, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -40027.17519815631, "policy_mm": -39465.641852607245, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 267917.6976072964, "policy_mm": 272759.18789603043, "policy_rl": 349591.4527014713}, "policy_reward_mean": {"policy_mom": 53249.08640611221, "policy_mean": 51177.774842327795, "policy_mm": 55879.00519925455, "policy_rl": 77113.23187441756}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53249.0859375, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 51177.7734375, "('mean_0', 'policy_mean')_total_reward_min": -40027.17578125, "('mean_0', 'policy_mean')_total_reward_max": 267917.6875, "('mm_0', 'policy_mm')_total_reward_mean": 55879.01171875, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 77113.2265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 349591.4375}, "hist_stats": {"episode_reward": [294803.075514864, 242182.13993635098, 111142.86968926602, -3712.194687313489, -49707.95980387895, 243208.97080381206, 270134.529467569, -6373.291321071194, 31766.525031067336, -92125.84995540194, 48078.76402694774, 273777.53113901464, -527.376912421384, 175282.82731302184, 434544.3818355781, 972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [54026.20291457058, 62806.77916671574, 16165.406807681413, 12041.827362227703, -14341.251981653266, 59375.76554940783, 55781.8899403598, -17723.08894853312, 10115.752769236135, -17081.802521460384, 15100.505063252569, 67957.11735632742, -5222.854214093893, 50817.637234142334, 100918.17143872127, 215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258], "policy_policy_mean_reward": [63266.8192221536, 55369.555513536136, 42223.264259325, -4364.72058895724, -8487.772540602016, 77145.77732611087, 76591.59702750307, -18592.847178812233, 5179.820430515662, -19527.5879507833, 17131.395727067353, 38986.07479097644, -21481.800708761308, 37042.53286895589, 85655.20864532285, 225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904], "policy_policy_mm_reward": [89153.33729594034, 63076.79266449188, 35793.28888534532, -10882.632406846467, 3838.8730379952235, 67595.39125692111, 57434.477720801406, -616.105960012003, -19403.480655275398, -28376.500033129407, -11025.84807986446, 68654.88440779834, 2567.328527620289, 28522.942256864473, 123706.44110830026, 210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926], "policy_policy_rl_reward": [88356.71608219939, 60929.012591607214, 16960.90973691428, -506.66905373752377, -30717.80831961879, 39092.03667137221, 80326.56477890442, 30558.750766286154, 35874.43248659072, -27139.95945002891, 26872.71131649237, 98179.45458391255, 23609.94948281359, 58899.71495305916, 124264.56064323337, 320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25252766530754367, "mean_inference_ms": 0.7698954305904511, "mean_action_processing_ms": 0.11986095844622464, "mean_env_wait_ms": 2.440485206871101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008056163787841797, "StateBufferConnector_ms": 0.0007948875427246094, "ViewRequirementAgentConnector_ms": 0.019908010959625244}, "num_episodes": 16, "episode_return_max": 1230242.9772235004, "episode_return_min": -139831.53368503362, "episode_return_mean": 237419.09832211214, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.5154403858013, "num_env_steps_trained_throughput_per_sec": 265.5154403858013, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 15154.944, "restore_workers_time_ms": 0.163, "training_step_time_ms": 15154.706, "sample_time_ms": 14570.736, "learn_time_ms": 571.187, "learn_throughput": 7002.964, "synch_weights_time_ms": 6.512}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "ae48a_00000", "date": "2025-10-28_12-32-02", "timestamp": 1761672722, "time_this_iter_s": 15.070473909378052, "time_total_s": 1424.8649575710297, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d55a8e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1424.8649575710297, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.58636363636364, "ram_util_percent": 83.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9911768436431885, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.878159469366073, "policy_loss": -0.0196503812490846, "vf_loss": 9.959622120857238, "vf_explained_var": 7.450580596923829e-10, "kl": 0.01165918628157722, "entropy": 7.361718539893627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -139831.53368503362, "episode_reward_mean": 246790.2026119233, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -40027.17519815631, "policy_mm": -39465.641852607245, "policy_rl": -34469.261128993734}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 267917.6976072964, "policy_mm": 272759.18789603043, "policy_rl": 349591.4527014713}, "policy_reward_mean": {"policy_mom": 56281.09240440632, "policy_mean": 53541.720120609, "policy_mm": 56908.09667408274, "policy_rl": 80059.29341282518}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56281.08984375, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 53541.7265625, "('mean_0', 'policy_mean')_total_reward_min": -40027.17578125, "('mean_0', 'policy_mean')_total_reward_max": 267917.6875, "('mm_0', 'policy_mm')_total_reward_mean": 56908.09375, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 272759.1875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 80059.2890625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34469.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 349591.4375}, "hist_stats": {"episode_reward": [972167.9808108415, -133258.31050261826, 381763.5367433609, 70522.70368914059, 874695.7948916206, 73813.36156197434, -57613.27351672936, 191970.49074992925, -132200.68596788702, -5066.598060450289, -49048.57448963169, 885085.7098809577, 141077.7193473281, 347405.2619011417, 246114.33425469347, 51812.067375336956, 446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [215353.28100455392, -35163.54672725093, 79961.45301906776, 16362.757012835584, 191690.82170924556, 38521.9354563889, -15517.055573782805, 52216.37416446341, -31972.21977343531, 3160.1627125686, -17803.010030456877, 154975.6381962877, 30635.065679549993, 50808.72326535518, 55791.704445172145, 16972.929919222428, 118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007], "policy_policy_mean_reward": [225651.38455444665, -37682.703605810755, 62815.292498607174, 16163.100643777803, 130735.6994223571, 13797.849203632937, -20461.917600631354, 36464.2931640563, -40027.17519815631, -7355.088687604507, -24863.456058717016, 213394.94029620668, 55642.9132360042, 112444.38320048875, 62413.2476329187, -5821.536398314135, 85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507], "policy_policy_mm_reward": [210781.38091479673, -25942.79904056283, 124878.88886549337, 5990.095097946536, 272759.18789603043, 7049.060382616132, -14427.020624693865, 54829.49732522695, -28882.219895526156, -19007.428806119733, -5366.371429128794, 261579.8995671351, 44364.44712349204, 79074.82055747419, 60091.95429397981, 9237.244391096358, 105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492], "policy_policy_rl_reward": [320381.9343370447, -34469.261128993734, 114107.90236019279, 32006.7509345804, 279510.0858639882, 14444.516519336321, -7207.279717621263, 48460.326096182136, -31319.071100769175, 18135.756720705325, -1015.7369713290939, 255135.23182132843, 10435.293308281573, 105077.33487782336, 67817.42788262262, 31423.429463332246, 135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525457960362897, "mean_inference_ms": 0.7699746490539298, "mean_action_processing_ms": 0.11987294242189347, "mean_env_wait_ms": 2.440742023296762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008007287979125977, "StateBufferConnector_ms": 0.000793159008026123, "ViewRequirementAgentConnector_ms": 0.019834697246551514}, "num_episodes": 15, "episode_return_max": 1230242.9772235004, "episode_return_min": -139831.53368503362, "episode_return_mean": 246790.2026119233, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.35222852954385, "num_env_steps_trained_throughput_per_sec": 248.35222852954385, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 15254.54, "restore_workers_time_ms": 0.171, "training_step_time_ms": 15254.297, "sample_time_ms": 14674.919, "learn_time_ms": 567.65, "learn_throughput": 7046.6, "synch_weights_time_ms": 5.419}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "ae48a_00000", "date": "2025-10-28_12-32-18", "timestamp": 1761672738, "time_this_iter_s": 16.109589099884033, "time_total_s": 1440.9745466709137, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7e91c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1440.9745466709137, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 34.256521739130434, "ram_util_percent": 83.50869565217391}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1357667446136475, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.87984712421894, "policy_loss": -0.019290218519745394, "vf_loss": 9.955799812078476, "vf_explained_var": 2.3515895009040833e-06, "kl": 0.013919549942602865, "entropy": 7.075600627064705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 1230242.9772235004, "episode_reward_min": -139831.53368503362, "episode_reward_mean": 241202.30176987022, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -38928.55336989373, "policy_mm": -39465.641852607245, "policy_rl": -31497.6277830284}, "policy_reward_max": {"policy_mom": 349422.97513077443, "policy_mean": 296839.48110753583, "policy_mm": 265720.23212036834, "policy_rl": 414119.665025646}, "policy_reward_mean": {"policy_mom": 55505.019729530766, "policy_mean": 53284.217104564625, "policy_mm": 52921.24115005811, "policy_rl": 79491.82378571676}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55505.01953125, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 349422.96875, "('mean_0', 'policy_mean')_total_reward_mean": 53284.21875, "('mean_0', 'policy_mean')_total_reward_min": -38928.5546875, "('mean_0', 'policy_mean')_total_reward_max": 296839.46875, "('mm_0', 'policy_mm')_total_reward_mean": 52921.23828125, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 265720.21875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 79491.828125, "('rl_trader_0', 'policy_rl')_total_reward_min": -31497.626953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 414119.65625}, "hist_stats": {"episode_reward": [446098.7051224068, 167352.37360787872, 293377.04237139266, 145347.05417724303, 914027.3081357394, -9674.780142146765, 958273.2084938308, 266118.3063899992, 473711.44035433576, 211092.47965931776, 67442.31495625494, 715040.0518858673, 129223.71348135867, 1230242.9772235004, 257631.95925522418, -9549.530884435853, 584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373, 22318.5517923767, -37722.14876417005, 684235.8114257755, -36069.39267252818, 251949.0937758216, 361772.2571033539, 85142.31734816304, 527771.1504390583, 213848.2041138297, 62043.76944485629, -84424.45946757396, 39286.26267218346, -22838.905895309355, 1145872.779065856, 42080.58810658797, 45185.55597542328], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [118978.12311073669, 45938.95487685765, 75298.72109223112, 33514.080701603605, 299444.40029271744, -894.8630664580882, 213360.88235597115, 65488.186734012525, 91553.82517974067, 55409.67367459544, 34379.9719280458, 103858.62021959166, 49868.46390438763, 349422.97513077443, 69504.61210398348, 7514.232383185306, 108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007, 4491.088005153903, -15422.437135257342, 145059.77683341695, 5317.544063644211, 52217.28877544035, 101091.34529365024, 19157.03762523857, 103300.41609484844, 66779.73968364831, 19680.651801043496, -29889.295361175886, 2714.38320479028, -18565.463858336527, 244471.02154563647, 21814.750507852008, 6169.8999126362105], "policy_policy_mean_reward": [85383.36257493228, 39011.21392514341, 48292.34098924425, 36278.54881868026, 122963.48787474891, 453.7530841014226, 203054.94647326443, 59887.600723087846, 79474.10670510947, 34923.20398170896, 11225.550515426146, 148143.54825114913, 24223.04623250494, 267917.6976072964, 64749.798229191954, -8344.615959527287, 84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507, 7673.819793426019, -1825.1839904358492, 189095.8385387862, -21289.435095539, 46319.37965378511, 74268.101352535, 10841.23524402058, 152948.20957683536, 46670.622191429225, -6132.710656795389, -35925.608034381876, 2412.48667924225, -7936.689163172178, 296839.48110753583, 14936.733975105168, -1335.3564735513846], "policy_policy_mm_reward": [105966.89694325968, 41142.908961418165, 72004.53917856362, 36532.21549425861, 265720.23212036834, -29172.45753000232, 221970.9022657954, 50471.340870391185, 133609.57557043876, 52651.245227274434, 11293.745359686276, 196583.54908775326, 25608.048401447893, 263310.85178395885, 55458.06925498415, 4406.190647202, 191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492, 21653.600869207763, -25945.22558007487, 172667.34054189172, -3542.7726136599026, 52930.01322425268, 79681.99836377366, 23520.185548531765, 108478.92440854649, 39893.34068940846, 9491.423765202802, -18345.955739500718, 6834.2712142234095, -8264.95601052802, 190442.61138704064, 295.8219820933064, -11465.537833616807], "policy_policy_rl_reward": [135770.32249347784, 41259.295844459426, 97781.44111135314, 39022.20916270057, 225899.1878479058, 19938.787370212205, 319886.4773987991, 90271.17806250794, 169073.93289904654, 68108.35677573882, 10543.047153096686, 266454.33432737336, 29524.154943018184, 349591.4527014713, 67919.47966706446, -13125.337955295734, 199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576, -11499.956875410955, 5470.697941598044, 177412.85551168123, -16554.729026973484, 100482.41212234403, 106730.81209339516, 31623.85893037236, 163043.60035882867, 60504.501549343804, 39004.40453540528, -263.6003325155943, 27325.121573927627, 11928.203136727461, 414119.665025646, 5033.281641537456, 51816.55036995518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2526199983154308, "mean_inference_ms": 0.7702244988125284, "mean_action_processing_ms": 0.11990608276189323, "mean_env_wait_ms": 2.441326213435377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008657574653625488, "StateBufferConnector_ms": 0.0008223056793212891, "ViewRequirementAgentConnector_ms": 0.02045750617980957}, "num_episodes": 16, "episode_return_max": 1230242.9772235004, "episode_return_min": -139831.53368503362, "episode_return_mean": 241202.30176987022, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.69575398417265, "num_env_steps_trained_throughput_per_sec": 242.69575398417265, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 15404.082, "restore_workers_time_ms": 0.165, "training_step_time_ms": 15403.846, "sample_time_ms": 14821.003, "learn_time_ms": 571.386, "learn_throughput": 7000.525, "synch_weights_time_ms": 5.154}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "ae48a_00000", "date": "2025-10-28_12-32-35", "timestamp": 1761672755, "time_this_iter_s": 16.485649824142456, "time_total_s": 1457.4601964950562, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7ea2a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1457.4601964950562, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 41.65217391304348, "ram_util_percent": 83.56521739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8796789646148682, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.87101652622223, "policy_loss": -0.02316923588514328, "vf_loss": 9.957745197415353, "vf_explained_var": 2.9094517230987547e-07, "kl": 0.011285012081317066, "entropy": 7.498554207384586, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 1145872.779065856, "episode_reward_min": -139831.53368503362, "episode_reward_mean": 206159.6859043456, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -38928.55336989373, "policy_mm": -39465.641852607245, "policy_rl": -31497.6277830284}, "policy_reward_max": {"policy_mom": 244471.02154563647, "policy_mean": 296839.48110753583, "policy_mm": 191486.31044237502, "policy_rl": 414119.665025646}, "policy_reward_mean": {"policy_mom": 44702.67841651935, "policy_mean": 47282.65663955803, "policy_mm": 44360.331195580264, "policy_rl": 69814.01965268793}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44702.67578125, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 244471.015625, "('mean_0', 'policy_mean')_total_reward_mean": 47282.65625, "('mean_0', 'policy_mean')_total_reward_min": -38928.5546875, "('mean_0', 'policy_mean')_total_reward_max": 296839.46875, "('mm_0', 'policy_mm')_total_reward_mean": 44360.3359375, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 191486.3125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69814.0234375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31497.626953125, "('rl_trader_0', 'policy_rl')_total_reward_max": 414119.65625}, "hist_stats": {"episode_reward": [584180.5254435313, -23821.31993915718, 93722.12557038832, 143081.85173830015, 604318.4016570081, 182314.8870880933, 7424.682844797583, 349846.92978709773, 407225.0772792859, 86869.2525942398, 297386.74887957424, 342493.0649373946, 231106.9765598779, 370365.13251537393, 545489.6512655679, 97280.34687371328, 52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373, 22318.5517923767, -37722.14876417005, 684235.8114257755, -36069.39267252818, 251949.0937758216, 361772.2571033539, 85142.31734816304, 527771.1504390583, 213848.2041138297, 62043.76944485629, -84424.45946757396, 39286.26267218346, -22838.905895309355, 1145872.779065856, 42080.58810658797, 45185.55597542328, 374859.48710722756, 515561.2715441009, 175238.47301349396, 531821.372334076, 140152.76559545138, 216785.3070200242, 132764.46703095737, 78503.8525830874, 75453.162203738, 5586.855096056216, -41063.547955034184, 13002.25757683909, -22509.736644422268, -34001.93193529416, 304138.72920624865, 285200.25375874975], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [108736.82205583005, -10907.711798908362, -2820.2068398355586, 47769.076841119735, 102006.97503219653, 32887.322293979676, -14.249701785852539, 61373.52330709543, 75514.50619269049, 44334.779183277366, 48435.68912867614, 72386.45567469194, 66581.75572938132, 66114.66746576685, 121907.33865489166, -2676.3922297006357, 19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007, 4491.088005153903, -15422.437135257342, 145059.77683341695, 5317.544063644211, 52217.28877544035, 101091.34529365024, 19157.03762523857, 103300.41609484844, 66779.73968364831, 19680.651801043496, -29889.295361175886, 2714.38320479028, -18565.463858336527, 244471.02154563647, 21814.750507852008, 6169.8999126362105, 87932.85711352993, 99282.29714228462, 35994.344214570185, 111333.25115079539, 6999.144138693267, 46851.310593400274, 22360.042953670596, 22815.871393072804, 9508.313869509011, -6754.615914886644, -9862.725705087689, -4207.213545667441, -17872.88129019125, -18213.205510005904, 92161.20288107295, 54078.73583607589], "policy_policy_mean_reward": [84826.98326174701, -20702.348656381797, 38158.02540024144, 31484.078686555164, 189709.15982061674, 69761.03316056501, -3313.708814665342, 88027.3915844937, 67931.67575956299, 18470.724674895213, 96642.33586417453, 86060.30328246424, 38936.0372498405, 102689.24985074157, 94408.68815322938, 35074.96554848376, 4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507, 7673.819793426019, -1825.1839904358492, 189095.8385387862, -21289.435095539, 46319.37965378511, 74268.101352535, 10841.23524402058, 152948.20957683536, 46670.622191429225, -6132.710656795389, -35925.608034381876, 2412.48667924225, -7936.689163172178, 296839.48110753583, 14936.733975105168, -1335.3564735513846, 65405.730312498556, 85518.86224877785, 33333.08528715624, 156466.1246464912, 43656.94640462908, 53839.58824941931, 40569.58543261923, 894.2865191270622, 14303.628103343648, 14277.910561554307, -18070.876894053792, 8608.224819281902, -12990.226007873363, -19286.455852992116, 64297.73033546946, 86657.39935995385], "policy_policy_mm_reward": [191486.31044237502, -14220.55035868366, 41087.51355347864, 33327.022025073245, 99129.21388087234, 46001.62768906622, -5500.619012805891, 77868.9478124876, 122867.95368084636, 18021.139497061282, 59698.17514773563, 86180.14190401451, 58164.053019642226, 103608.6239599899, 121315.04427590873, 22278.23414552999, 14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492, 21653.600869207763, -25945.22558007487, 172667.34054189172, -3542.7726136599026, 52930.01322425268, 79681.99836377366, 23520.185548531765, 108478.92440854649, 39893.34068940846, 9491.423765202802, -18345.955739500718, 6834.2712142234095, -8264.95601052802, 190442.61138704064, 295.8219820933064, -11465.537833616807, 76243.58401517254, 171960.31946143735, 60495.578180685196, 72954.30951014058, 25567.15482751463, 57585.72864765898, 33917.65902067097, 27139.897632218122, 4571.791936541892, -8456.336838056002, -5862.840202360812, -7267.126257485567, -3193.6971705391556, 2394.7862813448137, 74627.49338661373, 68788.5557574567], "policy_policy_rl_reward": [199130.4096835785, 22009.290874816656, 17296.793456503572, 30501.674185552027, 213473.05292332292, 33664.90394448221, 16253.260374054566, 122577.06708302091, 140910.94164618576, 6042.609239005862, 92610.54873898764, 97866.16407622413, 67425.13056101398, 97952.59123887574, 207858.5801815371, 42603.53940940021, 14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576, -11499.956875410955, 5470.697941598044, 177412.85551168123, -16554.729026973484, 100482.41212234403, 106730.81209339516, 31623.85893037236, 163043.60035882867, 60504.501549343804, 39004.40453540528, -263.6003325155943, 27325.121573927627, 11928.203136727461, 414119.665025646, 5033.281641537456, 51816.55036995518, 145277.31566602626, 158799.7926916018, 45415.465331082676, 191067.68702664797, 63929.5202246143, 58508.6795295456, 35917.17962399682, 27653.797038669283, 47069.42829434341, 6519.897287444552, -7267.105153531726, 15868.372560710319, 11547.067824181535, 1102.9431463590195, 73052.3026030929, 75675.56280526325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527007107598805, "mean_inference_ms": 0.7704826648881843, "mean_action_processing_ms": 0.11994082818198126, "mean_env_wait_ms": 2.4419650140285114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008620619773864746, "StateBufferConnector_ms": 0.0008155107498168945, "ViewRequirementAgentConnector_ms": 0.020500779151916504}, "num_episodes": 16, "episode_return_max": 1145872.779065856, "episode_return_min": -139831.53368503362, "episode_return_mean": 206159.6859043456, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.26257405198635, "num_env_steps_trained_throughput_per_sec": 260.26257405198635, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 15425.467, "restore_workers_time_ms": 0.114, "training_step_time_ms": 15425.278, "sample_time_ms": 14830.634, "learn_time_ms": 582.55, "learn_throughput": 6866.368, "synch_weights_time_ms": 5.57}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "ae48a_00000", "date": "2025-10-28_12-32-50", "timestamp": 1761672770, "time_this_iter_s": 15.374275207519531, "time_total_s": 1472.8344717025757, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7eb1a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1472.8344717025757, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 24.44545454545454, "ram_util_percent": 83.01363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1507761478424072, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.875564926862717, "policy_loss": -0.021453980793012306, "vf_loss": 9.954234483838082, "vf_explained_var": 2.6166439056396484e-06, "kl": 0.013250063385931331, "entropy": 7.063124641776085, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 1145872.779065856, "episode_reward_min": -151334.57142433204, "episode_reward_mean": 201115.11146722347, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35752.17634501668, "policy_mean": -48644.46193050291, "policy_mm": -39465.641852607245, "policy_rl": -39805.59849099432}, "policy_reward_max": {"policy_mom": 244471.02154563647, "policy_mean": 296839.48110753583, "policy_mm": 269946.41357024445, "policy_rl": 414119.665025646}, "policy_reward_mean": {"policy_mom": 44335.0066068324, "policy_mean": 45691.69675932975, "policy_mm": 42642.08735385063, "policy_rl": 68446.32074721064}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 44335.01171875, "('mom_0', 'policy_mom')_total_reward_min": -35752.17578125, "('mom_0', 'policy_mom')_total_reward_max": 244471.015625, "('mean_0', 'policy_mean')_total_reward_mean": 45691.6953125, "('mean_0', 'policy_mean')_total_reward_min": -48644.4609375, "('mean_0', 'policy_mean')_total_reward_max": 296839.46875, "('mm_0', 'policy_mm')_total_reward_mean": 42642.0859375, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 269946.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68446.328125, "('rl_trader_0', 'policy_rl')_total_reward_min": -39805.59765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 414119.65625}, "hist_stats": {"episode_reward": [52291.506841889124, 226450.3269051096, 107814.97093399553, 366320.31529370556, -33019.3175253161, -5367.018919979689, 69218.1074726199, 145552.16684224393, 12322.526915828419, 678576.2198545415, 306311.0798052306, 354411.1478154531, -110839.16499005805, -32193.11134018244, 480614.57512353256, 312829.4384053833, 290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373, 22318.5517923767, -37722.14876417005, 684235.8114257755, -36069.39267252818, 251949.0937758216, 361772.2571033539, 85142.31734816304, 527771.1504390583, 213848.2041138297, 62043.76944485629, -84424.45946757396, 39286.26267218346, -22838.905895309355, 1145872.779065856, 42080.58810658797, 45185.55597542328, 374859.48710722756, 515561.2715441009, 175238.47301349396, 531821.372334076, 140152.76559545138, 216785.3070200242, 132764.46703095737, 78503.8525830874, 75453.162203738, 5586.855096056216, -41063.547955034184, 13002.25757683909, -22509.736644422268, -34001.93193529416, 304138.72920624865, 285200.25375874975, 11492.648947490583, 2245.3257337430423, 238439.22211503313, 313003.20368871867, 952197.660983654, 4041.000426674514, 414945.895964121, 362478.52610581985, 262254.21419536317, 394324.84861114156, 146172.6428133637, 589335.4229420596, 97217.55650710178, 145834.35449963366, -151334.57142433204, 32178.939273282765], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [19103.00810623347, 72884.26019369252, 23673.309248900878, 91845.43057724259, -2382.2489557638346, -21120.824429609605, 11707.735284363127, 23905.362591324534, 5496.020952534215, 169573.7044566969, 85225.11888317866, 101256.19614798836, -35752.17634501668, -10574.332789506727, 90620.77154603558, 52923.77364856037, 78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007, 4491.088005153903, -15422.437135257342, 145059.77683341695, 5317.544063644211, 52217.28877544035, 101091.34529365024, 19157.03762523857, 103300.41609484844, 66779.73968364831, 19680.651801043496, -29889.295361175886, 2714.38320479028, -18565.463858336527, 244471.02154563647, 21814.750507852008, 6169.8999126362105, 87932.85711352993, 99282.29714228462, 35994.344214570185, 111333.25115079539, 6999.144138693267, 46851.310593400274, 22360.042953670596, 22815.871393072804, 9508.313869509011, -6754.615914886644, -9862.725705087689, -4207.213545667441, -17872.88129019125, -18213.205510005904, 92161.20288107295, 54078.73583607589, -8788.081581014572, 8653.412820112442, 29163.225724026637, 65431.23360567684, 190617.9316182068, 1713.863181976219, 90573.79613873965, 84795.97244203599, 77199.46579516839, 118450.87086160158, 44838.36443727364, 100198.11052863863, 15032.232587301045, 17351.7876549401, -31003.69583197919, -9365.319962033138], "policy_policy_mean_reward": [4480.40943356582, 34317.86095920734, 17435.511194653354, 110421.92297156811, -19588.182117850734, -5156.494237987234, 27152.978430198535, 29269.82330471941, -1679.1364955809886, 113154.12459796293, 83158.97157360724, 89194.53264063231, -31718.668113221334, -8259.688587423478, 119901.31939722192, 94411.70770065779, 57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507, 7673.819793426019, -1825.1839904358492, 189095.8385387862, -21289.435095539, 46319.37965378511, 74268.101352535, 10841.23524402058, 152948.20957683536, 46670.622191429225, -6132.710656795389, -35925.608034381876, 2412.48667924225, -7936.689163172178, 296839.48110753583, 14936.733975105168, -1335.3564735513846, 65405.730312498556, 85518.86224877785, 33333.08528715624, 156466.1246464912, 43656.94640462908, 53839.58824941931, 40569.58543261923, 894.2865191270622, 14303.628103343648, 14277.910561554307, -18070.876894053792, 8608.224819281902, -12990.226007873363, -19286.455852992116, 64297.73033546946, 86657.39935995385, 2285.6450459932053, -17141.139268122683, 58235.30110215394, 68531.22262185543, 234616.61308337236, 1807.391959694749, 107040.46774337813, 84363.43722406754, 40744.12739778766, 94919.56577347904, 32561.27345878126, 98977.14972569975, 43863.06215533163, 54460.563234299996, -48644.46193050291, 2448.3874764665784], "policy_policy_mm_reward": [14056.466776298732, 52762.92297244302, 7928.749306130713, 69906.74379865751, -2370.728771630848, 9511.273010639767, 4349.0136372549705, 16405.05093396515, 9123.876308870707, 112201.54272819532, 59507.442775887204, 64817.191527868155, -31375.554496396006, -17221.091246275886, 82329.14523687294, 66855.18527313342, 64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492, 21653.600869207763, -25945.22558007487, 172667.34054189172, -3542.7726136599026, 52930.01322425268, 79681.99836377366, 23520.185548531765, 108478.92440854649, 39893.34068940846, 9491.423765202802, -18345.955739500718, 6834.2712142234095, -8264.95601052802, 190442.61138704064, 295.8219820933064, -11465.537833616807, 76243.58401517254, 171960.31946143735, 60495.578180685196, 72954.30951014058, 25567.15482751463, 57585.72864765898, 33917.65902067097, 27139.897632218122, 4571.791936541892, -8456.336838056002, -5862.840202360812, -7267.126257485567, -3193.6971705391556, 2394.7862813448137, 74627.49338661373, 68788.5557574567, 1841.579647496285, -7067.149850418804, 64327.470118926685, 72704.0129531744, 269946.41357024445, -11070.223609439849, 104080.70885906038, 96154.01709768757, 54118.98470605848, 73134.26519745181, 31114.986805198118, 112349.09374594399, 14365.422856325407, 46351.28064378887, -31880.815170855705, -981.6000810136463], "policy_policy_rl_reward": [14651.62252579114, 66485.28277976689, 58777.40118431064, 94146.2179462369, -8678.157680070604, 11399.026736977281, 26008.38012080334, 75971.93001223479, -618.2338499954687, 283646.84807168646, 78419.54657255739, 99143.22749896446, -11992.766035424145, 3862.0012830237283, 187763.33894340147, 98638.77178303197, 89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576, -11499.956875410955, 5470.697941598044, 177412.85551168123, -16554.729026973484, 100482.41212234403, 106730.81209339516, 31623.85893037236, 163043.60035882867, 60504.501549343804, 39004.40453540528, -263.6003325155943, 27325.121573927627, 11928.203136727461, 414119.665025646, 5033.281641537456, 51816.55036995518, 145277.31566602626, 158799.7926916018, 45415.465331082676, 191067.68702664797, 63929.5202246143, 58508.6795295456, 35917.17962399682, 27653.797038669283, 47069.42829434341, 6519.897287444552, -7267.105153531726, 15868.372560710319, 11547.067824181535, 1102.9431463590195, 73052.3026030929, 75675.56280526325, 16153.505835015783, 17800.202032172205, 86713.22516992597, 106336.7345080119, 257016.7027118309, 11589.968894443386, 113250.92322294302, 97165.0993420291, 90191.63629634833, 107820.14677860883, 37658.01811211071, 277811.0689417763, 23956.838908143713, 27670.722966604593, -39805.59849099432, 40077.471839863014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25276946430492436, "mean_inference_ms": 0.7707012816058395, "mean_action_processing_ms": 0.1199707633777308, "mean_env_wait_ms": 2.442508882059383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008571147918701172, "StateBufferConnector_ms": 0.0008066296577453613, "ViewRequirementAgentConnector_ms": 0.020390093326568604}, "num_episodes": 16, "episode_return_max": 1145872.779065856, "episode_return_min": -151334.57142433204, "episode_return_mean": 201115.11146722347, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.08282404432816, "num_env_steps_trained_throughput_per_sec": 266.08282404432816, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 15428.067, "restore_workers_time_ms": 0.13, "training_step_time_ms": 15427.865, "sample_time_ms": 14834.713, "learn_time_ms": 581.887, "learn_throughput": 6874.181, "synch_weights_time_ms": 4.972}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "ae48a_00000", "date": "2025-10-28_12-33-05", "timestamp": 1761672785, "time_this_iter_s": 15.03712010383606, "time_total_s": 1487.8715918064117, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d7eb740>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1487.8715918064117, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 21.46363636363636, "ram_util_percent": 82.34545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1619760990142822, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.878025615215302, "policy_loss": -0.01780374353984371, "vf_loss": 9.954752501845359, "vf_explained_var": -7.21961259841919e-07, "kl": 0.013648834788273723, "entropy": 7.274258850514888, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 1145872.779065856, "episode_reward_min": -151334.57142433204, "episode_reward_mean": 199309.08739289653, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -32800.62418840091, "policy_mean": -48644.46193050291, "policy_mm": -39465.641852607245, "policy_rl": -39805.59849099432}, "policy_reward_max": {"policy_mom": 244471.02154563647, "policy_mean": 296839.48110753583, "policy_mm": 269946.41357024445, "policy_rl": 414119.665025646}, "policy_reward_mean": {"policy_mom": 43085.56760821355, "policy_mean": 44609.116624805334, "policy_mm": 43811.56004920113, "policy_rl": 67802.84311067656}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 43085.56640625, "('mom_0', 'policy_mom')_total_reward_min": -32800.625, "('mom_0', 'policy_mom')_total_reward_max": 244471.015625, "('mean_0', 'policy_mean')_total_reward_mean": 44609.11328125, "('mean_0', 'policy_mean')_total_reward_min": -48644.4609375, "('mean_0', 'policy_mean')_total_reward_max": 296839.46875, "('mm_0', 'policy_mm')_total_reward_mean": 43811.55859375, "('mm_0', 'policy_mm')_total_reward_min": -39465.640625, "('mm_0', 'policy_mm')_total_reward_max": 269946.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67802.84375, "('rl_trader_0', 'policy_rl')_total_reward_min": -39805.59765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 414119.65625}, "hist_stats": {"episode_reward": [290091.25841738447, 232976.08255068384, 270132.2722348793, 323952.31600333704, 50665.17479969382, -16910.310204004443, -139831.53368503362, -36357.29705587048, 288198.93377396197, 287274.2070289512, 352372.9183069464, 311874.8856632357, 269327.3925699374, 48426.22260590053, 324582.48532469536, -10361.618387631017, 137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373, 22318.5517923767, -37722.14876417005, 684235.8114257755, -36069.39267252818, 251949.0937758216, 361772.2571033539, 85142.31734816304, 527771.1504390583, 213848.2041138297, 62043.76944485629, -84424.45946757396, 39286.26267218346, -22838.905895309355, 1145872.779065856, 42080.58810658797, 45185.55597542328, 374859.48710722756, 515561.2715441009, 175238.47301349396, 531821.372334076, 140152.76559545138, 216785.3070200242, 132764.46703095737, 78503.8525830874, 75453.162203738, 5586.855096056216, -41063.547955034184, 13002.25757683909, -22509.736644422268, -34001.93193529416, 304138.72920624865, 285200.25375874975, 11492.648947490583, 2245.3257337430423, 238439.22211503313, 313003.20368871867, 952197.660983654, 4041.000426674514, 414945.895964121, 362478.52610581985, 262254.21419536317, 394324.84861114156, 146172.6428133637, 589335.4229420596, 97217.55650710178, 145834.35449963366, -151334.57142433204, 32178.939273282765, 670459.0695548465, 227807.92648383143, 223608.73506258908, 120650.88078794508, 455774.231144845, 84016.43437686139, -12758.278608925626, -65023.61282388118, 336314.9846072484, 281167.43109232944, 111368.25719750857, 141566.54793887117, 165202.6882596447, -21826.85854133884, 99149.14421369573, -66786.2187447605], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [78239.45808172421, 57050.546564091725, 62344.80180496109, 70927.1735095907, 17044.08317820416, -23910.234732772136, -29939.710679504416, -23216.29208296188, 99924.45051940944, 51786.22259673238, 116666.38908746798, 79499.96741147307, 75140.56417355436, 9578.908561828292, 57144.00798652218, -18406.887927472406, 10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007, 4491.088005153903, -15422.437135257342, 145059.77683341695, 5317.544063644211, 52217.28877544035, 101091.34529365024, 19157.03762523857, 103300.41609484844, 66779.73968364831, 19680.651801043496, -29889.295361175886, 2714.38320479028, -18565.463858336527, 244471.02154563647, 21814.750507852008, 6169.8999126362105, 87932.85711352993, 99282.29714228462, 35994.344214570185, 111333.25115079539, 6999.144138693267, 46851.310593400274, 22360.042953670596, 22815.871393072804, 9508.313869509011, -6754.615914886644, -9862.725705087689, -4207.213545667441, -17872.88129019125, -18213.205510005904, 92161.20288107295, 54078.73583607589, -8788.081581014572, 8653.412820112442, 29163.225724026637, 65431.23360567684, 190617.9316182068, 1713.863181976219, 90573.79613873965, 84795.97244203599, 77199.46579516839, 118450.87086160158, 44838.36443727364, 100198.11052863863, 15032.232587301045, 17351.7876549401, -31003.69583197919, -9365.319962033138, 111447.04257120827, 53929.02987028791, 50814.43848934499, 29864.53390875685, 63701.058490147065, 14658.10239038573, -12773.275590756166, -32800.62418840091, 92876.12023972445, 58053.84437676257, 24271.12222172052, 45344.02274551111, 44877.674983645185, -7547.740831909241, 26093.242546455247, -9367.382967914427], "policy_policy_mean_reward": [57759.14833058797, 61172.260175753676, 54142.149745090486, 75235.74550700444, -5531.014990946752, 2682.4442946390127, -38928.55336989373, 9000.06421734133, 33494.54418996198, 55687.95669388256, 89324.2974376019, 72425.86051303137, 47043.90417143406, -458.8736524927062, 109166.04447476298, -9075.553483988357, 46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507, 7673.819793426019, -1825.1839904358492, 189095.8385387862, -21289.435095539, 46319.37965378511, 74268.101352535, 10841.23524402058, 152948.20957683536, 46670.622191429225, -6132.710656795389, -35925.608034381876, 2412.48667924225, -7936.689163172178, 296839.48110753583, 14936.733975105168, -1335.3564735513846, 65405.730312498556, 85518.86224877785, 33333.08528715624, 156466.1246464912, 43656.94640462908, 53839.58824941931, 40569.58543261923, 894.2865191270622, 14303.628103343648, 14277.910561554307, -18070.876894053792, 8608.224819281902, -12990.226007873363, -19286.455852992116, 64297.73033546946, 86657.39935995385, 2285.6450459932053, -17141.139268122683, 58235.30110215394, 68531.22262185543, 234616.61308337236, 1807.391959694749, 107040.46774337813, 84363.43722406754, 40744.12739778766, 94919.56577347904, 32561.27345878126, 98977.14972569975, 43863.06215533163, 54460.563234299996, -48644.46193050291, 2448.3874764665784, 162914.96798732007, 59579.88152951272, 48247.19523658257, 15806.126669843277, 99136.71110353825, 8662.726441546081, -25445.276958820705, -9709.6299996712, 65933.94868316209, 54367.52724385924, 16477.774136600852, 25337.55744731981, 7641.7077148627795, 1422.1331506818356, 47147.75536435479, -29282.126551203826], "policy_policy_mm_reward": [64685.37150047239, 47092.06859776854, 61180.105817287455, 67281.40931428304, 13506.698422275842, -6868.807770937037, -39465.641852607245, -12719.082125366329, 55047.21509321508, 88091.61355772235, 70739.72631131642, 58745.33693348045, 68887.43101607024, 1534.1714651883142, 81902.47684945657, 1036.9283856301854, 26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492, 21653.600869207763, -25945.22558007487, 172667.34054189172, -3542.7726136599026, 52930.01322425268, 79681.99836377366, 23520.185548531765, 108478.92440854649, 39893.34068940846, 9491.423765202802, -18345.955739500718, 6834.2712142234095, -8264.95601052802, 190442.61138704064, 295.8219820933064, -11465.537833616807, 76243.58401517254, 171960.31946143735, 60495.578180685196, 72954.30951014058, 25567.15482751463, 57585.72864765898, 33917.65902067097, 27139.897632218122, 4571.791936541892, -8456.336838056002, -5862.840202360812, -7267.126257485567, -3193.6971705391556, 2394.7862813448137, 74627.49338661373, 68788.5557574567, 1841.579647496285, -7067.149850418804, 64327.470118926685, 72704.0129531744, 269946.41357024445, -11070.223609439849, 104080.70885906038, 96154.01709768757, 54118.98470605848, 73134.26519745181, 31114.986805198118, 112349.09374594399, 14365.422856325407, 46351.28064378887, -31880.815170855705, -981.6000810136463, 164203.90976097927, 46663.81322725086, 39693.932150777735, 13424.354918309336, 105881.74116408666, 37622.215118329084, -7890.371189675986, -7550.484740447399, 81173.25153044426, 63721.11518834213, 13780.332014107644, 34199.38433044532, 82106.00705045047, -7933.256414230628, -1056.802019939747, -22304.64278226332], "policy_policy_rl_reward": [89407.28050459962, 67661.20721306992, 92465.21486754017, 110507.98767245872, 25645.40819016039, 11186.2880050656, -31497.6277830284, -9421.98706488363, 99732.72397137548, 91708.41418061439, 75642.50547055993, 101203.72080525113, 78255.49320887892, 37772.01623137658, 76369.9560139528, 16083.89463819962, 53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576, -11499.956875410955, 5470.697941598044, 177412.85551168123, -16554.729026973484, 100482.41212234403, 106730.81209339516, 31623.85893037236, 163043.60035882867, 60504.501549343804, 39004.40453540528, -263.6003325155943, 27325.121573927627, 11928.203136727461, 414119.665025646, 5033.281641537456, 51816.55036995518, 145277.31566602626, 158799.7926916018, 45415.465331082676, 191067.68702664797, 63929.5202246143, 58508.6795295456, 35917.17962399682, 27653.797038669283, 47069.42829434341, 6519.897287444552, -7267.105153531726, 15868.372560710319, 11547.067824181535, 1102.9431463590195, 73052.3026030929, 75675.56280526325, 16153.505835015783, 17800.202032172205, 86713.22516992597, 106336.7345080119, 257016.7027118309, 11589.968894443386, 113250.92322294302, 97165.0993420291, 90191.63629634833, 107820.14677860883, 37658.01811211071, 277811.0689417763, 23956.838908143713, 27670.722966604593, -39805.59849099432, 40077.471839863014, 231893.14923533934, 67635.2018567803, 84853.16918588361, 61555.86529103554, 187054.720387073, 23073.390426600265, 33350.645130327124, -14962.873895361672, 96331.66415391734, 105024.94428336564, 56839.02882507972, 36685.58341559495, 30577.298510686327, -7767.99444588087, 26964.9483228255, -5832.066443378835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2528413892229478, "mean_inference_ms": 0.770933179755017, "mean_action_processing_ms": 0.12000237075208205, "mean_env_wait_ms": 2.4430783735783193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0008494853973388672, "StateBufferConnector_ms": 0.000805974006652832, "ViewRequirementAgentConnector_ms": 0.02028942108154297}, "num_episodes": 16, "episode_return_max": 1145872.779065856, "episode_return_min": -151334.57142433204, "episode_return_mean": 199309.08739289653, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.73487784087655, "num_env_steps_trained_throughput_per_sec": 259.73487784087655, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 15405.018, "restore_workers_time_ms": 0.129, "training_step_time_ms": 15404.818, "sample_time_ms": 14802.15, "learn_time_ms": 591.039, "learn_throughput": 6767.739, "synch_weights_time_ms": 5.023}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "ae48a_00000", "date": "2025-10-28_12-33-21", "timestamp": 1761672801, "time_this_iter_s": 15.406834840774536, "time_total_s": 1503.2784266471863, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d68f9c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1503.2784266471863, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 27.1, "ram_util_percent": 81.4090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8997173309326172, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.875586667656899, "policy_loss": -0.019746820841101, "vf_loss": 9.95784941315651, "vf_explained_var": -1.928210258483887e-06, "kl": 0.01073077293720013, "entropy": 7.338082529604435, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1145872.779065856, "episode_reward_min": -187668.27300349428, "episode_reward_mean": 194971.2275712652, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45740.22649291142, "policy_mean": -48644.46193050291, "policy_mm": -50302.00143541388, "policy_rl": -43747.348769580625}, "policy_reward_max": {"policy_mom": 244471.02154563647, "policy_mean": 296839.48110753583, "policy_mm": 269946.41357024445, "policy_rl": 414119.665025646}, "policy_reward_mean": {"policy_mom": 40522.78637480783, "policy_mean": 43815.016425720154, "policy_mm": 42875.02011422513, "policy_rl": 67758.40465651204}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 40522.78515625, "('mom_0', 'policy_mom')_total_reward_min": -45740.2265625, "('mom_0', 'policy_mom')_total_reward_max": 244471.015625, "('mean_0', 'policy_mean')_total_reward_mean": 43815.01953125, "('mean_0', 'policy_mean')_total_reward_min": -48644.4609375, "('mean_0', 'policy_mean')_total_reward_max": 296839.46875, "('mm_0', 'policy_mm')_total_reward_mean": 42875.01953125, "('mm_0', 'policy_mm')_total_reward_min": -50302.0, "('mm_0', 'policy_mm')_total_reward_max": 269946.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67758.40625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43747.34765625, "('rl_trader_0', 'policy_rl')_total_reward_max": 414119.65625}, "hist_stats": {"episode_reward": [137469.83184835786, 73575.18268298602, 192993.16815291572, 354642.77219123155, 798766.298025393, -22442.242228121715, -15508.74621115712, 185425.15032560955, -752.7088272368333, 625845.6580111673, 466719.37085304334, 83106.0082800444, 119438.73812577628, 366774.45400499395, 45923.16836155342, 84320.60387661253, 781222.3497401446, -29906.82296066778, -19207.947173537224, 238628.33688029373, 22318.5517923767, -37722.14876417005, 684235.8114257755, -36069.39267252818, 251949.0937758216, 361772.2571033539, 85142.31734816304, 527771.1504390583, 213848.2041138297, 62043.76944485629, -84424.45946757396, 39286.26267218346, -22838.905895309355, 1145872.779065856, 42080.58810658797, 45185.55597542328, 374859.48710722756, 515561.2715441009, 175238.47301349396, 531821.372334076, 140152.76559545138, 216785.3070200242, 132764.46703095737, 78503.8525830874, 75453.162203738, 5586.855096056216, -41063.547955034184, 13002.25757683909, -22509.736644422268, -34001.93193529416, 304138.72920624865, 285200.25375874975, 11492.648947490583, 2245.3257337430423, 238439.22211503313, 313003.20368871867, 952197.660983654, 4041.000426674514, 414945.895964121, 362478.52610581985, 262254.21419536317, 394324.84861114156, 146172.6428133637, 589335.4229420596, 97217.55650710178, 145834.35449963366, -151334.57142433204, 32178.939273282765, 670459.0695548465, 227807.92648383143, 223608.73506258908, 120650.88078794508, 455774.231144845, 84016.43437686139, -12758.278608925626, -65023.61282388118, 336314.9846072484, 281167.43109232944, 111368.25719750857, 141566.54793887117, 165202.6882596447, -21826.85854133884, 99149.14421369573, -66786.2187447605, 191965.9349221126, 19176.079286471264, 180032.95345917658, 195618.20728189373, 327613.28776982235, -187668.27300349428, -83145.48092833068, 124775.12101932405, 169646.22577176505, 647891.6101696511, -32695.491748332654, -74899.01924420471, 310862.4720726367, 128481.89821389252, 7846.266922888239, 487125.61581865203], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [10928.891525109431, 13178.766534891463, 25791.181426697058, 72315.47212500579, 143431.48780178258, -14872.233588835768, -1741.1882572884006, 51885.815865979435, 16260.487540409333, 182112.75734377984, 125168.65537323494, 23598.202910310953, 41773.022025522776, 106243.43861651755, 3270.9596639064134, 20139.789071825202, 173968.7217417956, -940.609345211754, -5898.7883752919, 32969.62717966007, 4491.088005153903, -15422.437135257342, 145059.77683341695, 5317.544063644211, 52217.28877544035, 101091.34529365024, 19157.03762523857, 103300.41609484844, 66779.73968364831, 19680.651801043496, -29889.295361175886, 2714.38320479028, -18565.463858336527, 244471.02154563647, 21814.750507852008, 6169.8999126362105, 87932.85711352993, 99282.29714228462, 35994.344214570185, 111333.25115079539, 6999.144138693267, 46851.310593400274, 22360.042953670596, 22815.871393072804, 9508.313869509011, -6754.615914886644, -9862.725705087689, -4207.213545667441, -17872.88129019125, -18213.205510005904, 92161.20288107295, 54078.73583607589, -8788.081581014572, 8653.412820112442, 29163.225724026637, 65431.23360567684, 190617.9316182068, 1713.863181976219, 90573.79613873965, 84795.97244203599, 77199.46579516839, 118450.87086160158, 44838.36443727364, 100198.11052863863, 15032.232587301045, 17351.7876549401, -31003.69583197919, -9365.319962033138, 111447.04257120827, 53929.02987028791, 50814.43848934499, 29864.53390875685, 63701.058490147065, 14658.10239038573, -12773.275590756166, -32800.62418840091, 92876.12023972445, 58053.84437676257, 24271.12222172052, 45344.02274551111, 44877.674983645185, -7547.740831909241, 26093.242546455247, -9367.382967914427, 40200.29681656783, -10989.316284762102, 33450.954579044905, 44806.1315487475, 66234.28452580445, -45740.22649291142, -30044.114264755295, 15276.847382840151, 40852.62978038011, 108597.11120132037, -11367.53312522481, -20582.6750562261, 71695.03903170639, 25620.16658025372, -6954.97392015249, 102540.70240964362], "policy_policy_mean_reward": [46904.28785336622, 7186.447629198251, 85306.14994274848, 53909.87386706721, 199582.58003525904, -11266.56896467497, -12426.174581756099, 73405.59271441, -8441.765049637208, 132233.8216227473, 110244.12732755119, -809.3784133813849, 25300.171477358148, 62187.08420773316, 11620.28089555029, 39475.13887809765, 194635.7010289906, -24351.124040222305, -9695.424993659988, 80420.36256256507, 7673.819793426019, -1825.1839904358492, 189095.8385387862, -21289.435095539, 46319.37965378511, 74268.101352535, 10841.23524402058, 152948.20957683536, 46670.622191429225, -6132.710656795389, -35925.608034381876, 2412.48667924225, -7936.689163172178, 296839.48110753583, 14936.733975105168, -1335.3564735513846, 65405.730312498556, 85518.86224877785, 33333.08528715624, 156466.1246464912, 43656.94640462908, 53839.58824941931, 40569.58543261923, 894.2865191270622, 14303.628103343648, 14277.910561554307, -18070.876894053792, 8608.224819281902, -12990.226007873363, -19286.455852992116, 64297.73033546946, 86657.39935995385, 2285.6450459932053, -17141.139268122683, 58235.30110215394, 68531.22262185543, 234616.61308337236, 1807.391959694749, 107040.46774337813, 84363.43722406754, 40744.12739778766, 94919.56577347904, 32561.27345878126, 98977.14972569975, 43863.06215533163, 54460.563234299996, -48644.46193050291, 2448.3874764665784, 162914.96798732007, 59579.88152951272, 48247.19523658257, 15806.126669843277, 99136.71110353825, 8662.726441546081, -25445.276958820705, -9709.6299996712, 65933.94868316209, 54367.52724385924, 16477.774136600852, 25337.55744731981, 7641.7077148627795, 1422.1331506818356, 47147.75536435479, -29282.126551203826, 49489.487042018234, -10443.660582925184, 35059.43027412691, 31783.761275882483, 66646.9857322762, -47878.69630558858, -29632.195134823796, 40767.278686265665, 34126.651910793335, 164726.51010367967, -4555.505627015116, -22429.90742562652, 65105.36173211321, 49651.70272263356, -2832.1940587953577, 114145.39400023872], "policy_policy_mm_reward": [26301.26646278154, 19072.9870638906, 55747.39438072561, 120163.28939019608, 151230.8193950926, -15395.758263244095, -3104.961756971464, 8874.319679692115, 2602.4244874247966, 80524.06117600432, 104418.4466937583, 8633.06605708203, 25347.75792134398, 100105.65700404342, 13272.707572572614, 10267.55271587325, 178794.7305649592, 5613.807400368965, -16786.34640888663, 69780.8726657492, 21653.600869207763, -25945.22558007487, 172667.34054189172, -3542.7726136599026, 52930.01322425268, 79681.99836377366, 23520.185548531765, 108478.92440854649, 39893.34068940846, 9491.423765202802, -18345.955739500718, 6834.2712142234095, -8264.95601052802, 190442.61138704064, 295.8219820933064, -11465.537833616807, 76243.58401517254, 171960.31946143735, 60495.578180685196, 72954.30951014058, 25567.15482751463, 57585.72864765898, 33917.65902067097, 27139.897632218122, 4571.791936541892, -8456.336838056002, -5862.840202360812, -7267.126257485567, -3193.6971705391556, 2394.7862813448137, 74627.49338661373, 68788.5557574567, 1841.579647496285, -7067.149850418804, 64327.470118926685, 72704.0129531744, 269946.41357024445, -11070.223609439849, 104080.70885906038, 96154.01709768757, 54118.98470605848, 73134.26519745181, 31114.986805198118, 112349.09374594399, 14365.422856325407, 46351.28064378887, -31880.815170855705, -981.6000810136463, 164203.90976097927, 46663.81322725086, 39693.932150777735, 13424.354918309336, 105881.74116408666, 37622.215118329084, -7890.371189675986, -7550.484740447399, 81173.25153044426, 63721.11518834213, 13780.332014107644, 34199.38433044532, 82106.00705045047, -7933.256414230628, -1056.802019939747, -22304.64278226332, 58834.89101412565, -2989.6128108825696, 46989.36295133665, 43785.971434868006, 71631.65579782888, -50302.00143541388, -17057.250020912892, 26465.8987225656, 39187.07887439306, 134914.72805714436, -21305.09284761817, -23427.301051115326, 83818.78691806491, 23404.070992604386, -19272.805749716477, 132344.64717038354], "policy_policy_rl_reward": [53335.38600710068, 34136.98145500555, 26148.442402744397, 108254.13680896185, 304521.41079325875, 19092.318588633112, 1763.5783848588678, 51259.422065527986, -11173.855805433759, 230975.01786863542, 126888.14145849961, 51684.1177260325, 27017.786701551566, 98238.27417669925, 17759.22022952432, 14438.12321081628, 233823.19640439938, -10228.896975602598, 13172.612604301405, 55457.474472319576, -11499.956875410955, 5470.697941598044, 177412.85551168123, -16554.729026973484, 100482.41212234403, 106730.81209339516, 31623.85893037236, 163043.60035882867, 60504.501549343804, 39004.40453540528, -263.6003325155943, 27325.121573927627, 11928.203136727461, 414119.665025646, 5033.281641537456, 51816.55036995518, 145277.31566602626, 158799.7926916018, 45415.465331082676, 191067.68702664797, 63929.5202246143, 58508.6795295456, 35917.17962399682, 27653.797038669283, 47069.42829434341, 6519.897287444552, -7267.105153531726, 15868.372560710319, 11547.067824181535, 1102.9431463590195, 73052.3026030929, 75675.56280526325, 16153.505835015783, 17800.202032172205, 86713.22516992597, 106336.7345080119, 257016.7027118309, 11589.968894443386, 113250.92322294302, 97165.0993420291, 90191.63629634833, 107820.14677860883, 37658.01811211071, 277811.0689417763, 23956.838908143713, 27670.722966604593, -39805.59849099432, 40077.471839863014, 231893.14923533934, 67635.2018567803, 84853.16918588361, 61555.86529103554, 187054.720387073, 23073.390426600265, 33350.645130327124, -14962.873895361672, 96331.66415391734, 105024.94428336564, 56839.02882507972, 36685.58341559495, 30577.298510686327, -7767.99444588087, 26964.9483228255, -5832.066443378835, 43441.26004940095, 43598.668965041164, 64533.205654667654, 75242.34302239581, 123100.36171391346, -43747.348769580625, -6411.921507838616, 42265.09622765278, 55479.865206198745, 239653.2608075071, 4532.639851525469, -8459.135711236931, 90243.28439075226, 29805.957918400825, 36906.240651552434, 138094.87223838634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25291122151251444, "mean_inference_ms": 0.7711562699040857, "mean_action_processing_ms": 0.12003327049766886, "mean_env_wait_ms": 2.4436635614303284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000859379768371582, "StateBufferConnector_ms": 0.0008211731910705566, "ViewRequirementAgentConnector_ms": 0.02039015293121338}, "num_episodes": 16, "episode_return_max": 1145872.779065856, "episode_return_min": -187668.27300349428, "episode_return_mean": 194971.2275712652, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.03958141113515, "num_env_steps_trained_throughput_per_sec": 264.03958141113515, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 15430.797, "restore_workers_time_ms": 0.117, "training_step_time_ms": 15430.567, "sample_time_ms": 14813.239, "learn_time_ms": 605.327, "learn_throughput": 6607.995, "synch_weights_time_ms": 5.326}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "ae48a_00000", "date": "2025-10-28_12-33-36", "timestamp": 1761672816, "time_this_iter_s": 15.153617143630981, "time_total_s": 1518.4320437908173, "pid": 86998, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {"coop_weight": 0.01, "comp_weight": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x14d559a80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (85,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1518.4320437908173, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 22.223809523809525, "ram_util_percent": 82.27619047619046}}
