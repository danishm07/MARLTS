{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4902433753013611, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.954069942235947, "policy_loss": -0.010834389246883801, "vf_loss": 9.963411921262741, "vf_explained_var": 5.587935447692871e-09, "kl": 0.007462024234229148, "entropy": 5.638084682822227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 991026.4747821934, "episode_reward_min": -8940.95821126069, "episode_reward_mean": 215959.85811779342, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 3780, "policy_reward_min": {"policy_mom": -9805.668498624455, "policy_mean": -795.4639152077631, "policy_mm": -317.9674159348478, "policy_rl": -13852.273710789397}, "policy_reward_max": {"policy_mom": 219401.98891035878, "policy_mean": 218867.406421229, "policy_mm": 218489.2966428898, "policy_rl": 334267.78280771646}, "policy_reward_mean": {"policy_mom": 46011.54090097329, "policy_mean": 59196.222514157045, "policy_mm": 52846.796858068585, "policy_rl": 57905.29784459448}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46011.5390625, "('mom_0', 'policy_mom')_total_reward_min": -9805.6689453125, "('mom_0', 'policy_mom')_total_reward_max": 219401.984375, "('mean_0', 'policy_mean')_total_reward_mean": 59196.22265625, "('mean_0', 'policy_mean')_total_reward_min": -795.4639282226562, "('mean_0', 'policy_mean')_total_reward_max": 218867.40625, "('mm_0', 'policy_mm')_total_reward_mean": 52846.796875, "('mm_0', 'policy_mm')_total_reward_min": -317.9674072265625, "('mm_0', 'policy_mm')_total_reward_max": 218489.296875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57905.30078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -13852.2734375, "('rl_trader_0', 'policy_rl')_total_reward_max": 334267.78125}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2207642821960526, "mean_inference_ms": 0.7252123498284976, "mean_action_processing_ms": 0.11241713096963799, "mean_env_wait_ms": 0.16345819274475204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006520748138427734, "StateBufferConnector_ms": 0.0006751219431559244, "ViewRequirementAgentConnector_ms": 0.01741488774617513}, "num_episodes": 15, "episode_return_max": 991026.4747821934, "episode_return_min": -8940.95821126069, "episode_return_mean": 215959.85811779342, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.0218940829426, "num_env_steps_trained_throughput_per_sec": 708.0218940829426, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5649.552, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5649.511, "sample_time_ms": 4977.35, "learn_time_ms": 669.799, "learn_throughput": 5971.942, "synch_weights_time_ms": 1.452}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-24", "timestamp": 1760509284, "time_this_iter_s": 5.654278039932251, "time_total_s": 5.654278039932251, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d77600>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.654278039932251, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.622222222222224, "ram_util_percent": 83.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5188954472541809, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.949272793531417, "policy_loss": -0.01105550108186435, "vf_loss": 9.958759692311286, "vf_explained_var": 1.0523945093154907e-07, "kl": 0.00784305568625428, "entropy": 5.5964832454919815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 991026.4747821934, "episode_reward_min": -28088.07644160942, "episode_reward_mean": 187390.563276049, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 7812, "policy_reward_min": {"policy_mom": -17087.299553108427, "policy_mean": -18158.860958711535, "policy_mm": -2870.7565594740468, "policy_rl": -13852.273710789397}, "policy_reward_max": {"policy_mom": 219401.98891035878, "policy_mean": 218867.406421229, "policy_mm": 218489.2966428898, "policy_rl": 334267.78280771646}, "policy_reward_mean": {"policy_mom": 42812.774045254344, "policy_mean": 53412.55391486563, "policy_mm": 45542.74662132785, "policy_rl": 45622.488694601205}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 42812.77734375, "('mom_0', 'policy_mom')_total_reward_min": -17087.298828125, "('mom_0', 'policy_mom')_total_reward_max": 219401.984375, "('mean_0', 'policy_mean')_total_reward_mean": 53412.55078125, "('mean_0', 'policy_mean')_total_reward_min": -18158.861328125, "('mean_0', 'policy_mean')_total_reward_max": 218867.40625, "('mm_0', 'policy_mm')_total_reward_mean": 45542.7421875, "('mm_0', 'policy_mm')_total_reward_min": -2870.756591796875, "('mm_0', 'policy_mm')_total_reward_max": 218489.296875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 45622.48828125, "('rl_trader_0', 'policy_rl')_total_reward_min": -13852.2734375, "('rl_trader_0', 'policy_rl')_total_reward_max": 334267.78125}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.221210099245074, "mean_inference_ms": 0.7225954217806914, "mean_action_processing_ms": 0.1124449149762546, "mean_env_wait_ms": 0.16353516299675347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006850688688216671, "StateBufferConnector_ms": 0.0006848765957740045, "ViewRequirementAgentConnector_ms": 0.01739378898374496}, "num_episodes": 16, "episode_return_max": 991026.4747821934, "episode_return_min": -28088.07644160942, "episode_return_mean": 187390.563276049, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 734.8213408956865, "num_env_steps_trained_throughput_per_sec": 734.8213408956865, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 5546.529, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5546.489, "sample_time_ms": 4960.071, "learn_time_ms": 584.25, "learn_throughput": 6846.386, "synch_weights_time_ms": 1.464}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-30", "timestamp": 1760509290, "time_this_iter_s": 5.447387933731079, "time_total_s": 11.10166597366333, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6fc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.10166597366333, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.91428571428571, "ram_util_percent": 82.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5177425742149353, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939119532704353, "policy_loss": -0.019374622078612447, "vf_loss": 9.956113666296005, "vf_explained_var": -3.091990947723389e-08, "kl": 0.011902784797803196, "entropy": 5.552313995361328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 991026.4747821934, "episode_reward_min": -107939.12104120241, "episode_reward_mean": 179705.6214615881, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 11844, "policy_reward_min": {"policy_mom": -29611.593447503405, "policy_mean": -28305.643903920085, "policy_mm": -21652.56099301163, "policy_rl": -28369.322696767114}, "policy_reward_max": {"policy_mom": 219401.98891035878, "policy_mean": 218867.406421229, "policy_mm": 218489.2966428898, "policy_rl": 334267.78280771646}, "policy_reward_mean": {"policy_mom": 40423.17512107932, "policy_mean": 48631.5650693863, "policy_mm": 44390.88176722313, "policy_rl": 46259.99950389939}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 40423.1796875, "('mom_0', 'policy_mom')_total_reward_min": -29611.59375, "('mom_0', 'policy_mom')_total_reward_max": 219401.984375, "('mean_0', 'policy_mean')_total_reward_mean": 48631.5625, "('mean_0', 'policy_mean')_total_reward_min": -28305.64453125, "('mean_0', 'policy_mean')_total_reward_max": 218867.40625, "('mm_0', 'policy_mm')_total_reward_mean": 44390.8828125, "('mm_0', 'policy_mm')_total_reward_min": -21652.560546875, "('mm_0', 'policy_mm')_total_reward_max": 218489.296875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 46260.0, "('rl_trader_0', 'policy_rl')_total_reward_min": -28369.322265625, "('rl_trader_0', 'policy_rl')_total_reward_max": 334267.78125}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22204763503061142, "mean_inference_ms": 0.7228674451921472, "mean_action_processing_ms": 0.11272578918313998, "mean_env_wait_ms": 0.1640169774414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006886238747454704, "StateBufferConnector_ms": 0.0006855802333101313, "ViewRequirementAgentConnector_ms": 0.017388830793664812}, "num_episodes": 16, "episode_return_max": 991026.4747821934, "episode_return_min": -107939.12104120241, "episode_return_mean": 179705.6214615881, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 705.7523735807943, "num_env_steps_trained_throughput_per_sec": 705.7523735807943, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5586.925, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5586.886, "sample_time_ms": 4997.84, "learn_time_ms": 585.202, "learn_throughput": 6835.247, "synch_weights_time_ms": 3.114}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-35", "timestamp": 1760509295, "time_this_iter_s": 5.672415018081665, "time_total_s": 16.774080991744995, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7600>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.774080991744995, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.275, "ram_util_percent": 83.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5675508379936218, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.943220108747482, "policy_loss": -0.01915824637544574, "vf_loss": 9.960301825404168, "vf_explained_var": -6.843358278274536e-07, "kl": 0.010382711952092925, "entropy": 5.436771467328072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 991026.4747821934, "episode_reward_min": -107939.12104120241, "episode_reward_mean": 194255.04008444853, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 15876, "policy_reward_min": {"policy_mom": -29611.593447503405, "policy_mean": -28305.643903920085, "policy_mm": -21652.56099301163, "policy_rl": -28369.322696767114}, "policy_reward_max": {"policy_mom": 219401.98891035878, "policy_mean": 218867.406421229, "policy_mm": 260623.8446174409, "policy_rl": 334267.78280771646}, "policy_reward_mean": {"policy_mom": 45757.62905897045, "policy_mean": 49892.21222479123, "policy_mm": 50508.257608011016, "policy_rl": 48096.941192675855}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45757.62890625, "('mom_0', 'policy_mom')_total_reward_min": -29611.59375, "('mom_0', 'policy_mom')_total_reward_max": 219401.984375, "('mean_0', 'policy_mean')_total_reward_mean": 49892.2109375, "('mean_0', 'policy_mean')_total_reward_min": -28305.64453125, "('mean_0', 'policy_mean')_total_reward_max": 218867.40625, "('mm_0', 'policy_mm')_total_reward_mean": 50508.2578125, "('mm_0', 'policy_mm')_total_reward_min": -21652.560546875, "('mm_0', 'policy_mm')_total_reward_max": 260623.84375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 48096.9453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -28369.322265625, "('rl_trader_0', 'policy_rl')_total_reward_max": 334267.78125}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2224282677859058, "mean_inference_ms": 0.7246886374023426, "mean_action_processing_ms": 0.11288959346805293, "mean_env_wait_ms": 0.16427973246727123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006968066805884952, "StateBufferConnector_ms": 0.0006776953500414652, "ViewRequirementAgentConnector_ms": 0.017428019690135167}, "num_episodes": 16, "episode_return_max": 991026.4747821934, "episode_return_min": -107939.12104120241, "episode_return_mean": 194255.04008444853, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 712.2329712625316, "num_env_steps_trained_throughput_per_sec": 712.2329712625316, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5594.232, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5594.193, "sample_time_ms": 5021.115, "learn_time_ms": 569.606, "learn_throughput": 7022.393, "synch_weights_time_ms": 2.807}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-41", "timestamp": 1760509301, "time_this_iter_s": 5.61991810798645, "time_total_s": 22.393999099731445, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db79c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.393999099731445, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.4, "ram_util_percent": 83.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5990349054336548, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.938178023695945, "policy_loss": -0.02475176363659557, "vf_loss": 9.960394558310508, "vf_explained_var": -3.481283783912659e-07, "kl": 0.01267609483479648, "entropy": 5.376239705085754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 991026.4747821934, "episode_reward_min": -107939.12104120241, "episode_reward_mean": 218838.16903851804, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 19908, "policy_reward_min": {"policy_mom": -29611.593447503405, "policy_mean": -28305.643903920085, "policy_mm": -21652.56099301163, "policy_rl": -28369.322696767114}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 260623.8446174409, "policy_rl": 334267.78280771646}, "policy_reward_mean": {"policy_mom": 51725.68280822723, "policy_mean": 55611.585137703914, "policy_mm": 55726.645584919395, "policy_rl": 55774.255507667534}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51725.69140625, "('mom_0', 'policy_mom')_total_reward_min": -29611.59375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 55611.58984375, "('mean_0', 'policy_mean')_total_reward_min": -28305.64453125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 55726.640625, "('mm_0', 'policy_mm')_total_reward_min": -21652.560546875, "('mm_0', 'policy_mm')_total_reward_max": 260623.84375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55774.2578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -28369.322265625, "('rl_trader_0', 'policy_rl')_total_reward_max": 334267.78125}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2230987967198557, "mean_inference_ms": 0.7265205020769497, "mean_action_processing_ms": 0.11316177067242154, "mean_env_wait_ms": 0.16481436013767384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007080126412307159, "StateBufferConnector_ms": 0.0006877923313575455, "ViewRequirementAgentConnector_ms": 0.017629771292964114}, "num_episodes": 16, "episode_return_max": 991026.4747821934, "episode_return_min": -107939.12104120241, "episode_return_mean": 218838.16903851804, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.5326646491001, "num_env_steps_trained_throughput_per_sec": 692.5326646491001, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5630.568, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5630.528, "sample_time_ms": 5059.485, "learn_time_ms": 566.891, "learn_throughput": 7056.034, "synch_weights_time_ms": 3.139}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-47", "timestamp": 1760509307, "time_this_iter_s": 5.780235052108765, "time_total_s": 28.17423415184021, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7ba0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.17423415184021, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.51111111111111, "ram_util_percent": 83.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.622333824634552, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.931903001666068, "policy_loss": -0.023342172698903596, "vf_loss": 9.952354726195335, "vf_explained_var": -3.7681311368942263e-07, "kl": 0.014452303333189346, "entropy": 5.315874503552914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -107939.12104120241, "episode_reward_mean": 214381.1318299048, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 23940, "policy_reward_min": {"policy_mom": -29611.593447503405, "policy_mean": -28305.643903920085, "policy_mm": -29459.303195036282, "policy_rl": -28369.322696767114}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 49980.6447525837, "policy_mean": 54006.00024869194, "policy_mm": 54462.67154145763, "policy_rl": 55931.81528717158}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49980.6484375, "('mom_0', 'policy_mom')_total_reward_min": -29611.59375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 54006.0, "('mean_0', 'policy_mean')_total_reward_min": -28305.64453125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 54462.671875, "('mm_0', 'policy_mm')_total_reward_min": -29459.302734375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55931.81640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -28369.322265625, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [-8940.95821126069, 239834.3313663626, 159561.15392150995, 51037.07537486023, 169820.28473940428, 254208.66625479635, 241665.80100776476, 991026.4747821934, 225386.12968950946, 129292.42051213588, 12588.119771648899, 58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2462.4717509019, 56492.94569222946, 31442.087443901415, 12505.302574592119, 25126.229772359566, 56841.447181182906, 54994.09748793532, 219401.98891035878, 55262.41805479005, 29914.41935483458, -9805.668498624455, 2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173], "policy_policy_mean_reward": [-795.4639152077631, 47068.931418597575, 65903.46495044061, 21690.86063415662, 30731.213087969452, 74138.08029890199, 98502.90848416032, 218867.406421229, 55966.872548071406, 53355.145406180636, 5270.047700549852, 14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789], "policy_policy_mm_reward": [-317.9674159348478, 54811.8584589755, 20168.69848777857, 1347.2590637977903, 56574.25521632481, 63248.493233267465, 67757.92796572002, 218489.2966428898, 52463.68943598292, 36679.91768521445, 30976.014280512976, 22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518], "policy_policy_rl_reward": [-5365.055129216142, 81460.59579655991, 42046.90303938955, 15493.653102313667, 57388.58666275054, 59980.645541443795, 20410.867069949014, 334267.78280771646, 61693.149650664986, 9342.93806590615, -13852.273710789397, 19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22343535618750693, "mean_inference_ms": 0.7273132725607514, "mean_action_processing_ms": 0.1133046126653171, "mean_env_wait_ms": 0.16507699946479834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006970606352153577, "StateBufferConnector_ms": 0.0006854534149169922, "ViewRequirementAgentConnector_ms": 0.017530792637875204}, "num_episodes": 16, "episode_return_max": 1028878.1519473698, "episode_return_min": -107939.12104120241, "episode_return_mean": 214381.1318299048, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 719.1154560855085, "num_env_steps_trained_throughput_per_sec": 719.1154560855085, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5619.206, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5619.166, "sample_time_ms": 5042.051, "learn_time_ms": 573.282, "learn_throughput": 6977.365, "synch_weights_time_ms": 2.909}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-52", "timestamp": 1760509312, "time_this_iter_s": 5.573143005371094, "time_total_s": 33.747377157211304, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d77600>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.747377157211304, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.1875, "ram_util_percent": 82.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.681559145450592, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.937616315484046, "policy_loss": -0.021901498414808884, "vf_loss": 9.957145202159882, "vf_explained_var": -1.912936568260193e-07, "kl": 0.011863035170324599, "entropy": 5.2533752277493475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -116525.03012620742, "episode_reward_mean": 222736.157166245, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -29611.593447503405, "policy_mean": -28305.643903920085, "policy_mm": -29459.303195036282, "policy_rl": -37243.063609366676}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 52073.534724364086, "policy_mean": 56347.67221526744, "policy_mm": 55903.72281979336, "policy_rl": 58411.22740682017}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52073.53125, "('mom_0', 'policy_mom')_total_reward_min": -29611.59375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 56347.67578125, "('mean_0', 'policy_mean')_total_reward_min": -28305.64453125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 55903.71875, "('mm_0', 'policy_mm')_total_reward_min": -29459.302734375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58411.2265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -37243.0625, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [58144.41427946352, 224935.82528287295, 231186.85958359542, 259651.27341204387, 177828.71358921466, 71690.39734262439, -3778.756499858164, 290074.246182923, 126135.26476876569, 253701.3196890278, 220286.12810947347, 158720.62133774874, -28088.07644160942, 41911.64100292076, 275043.86485815374, 123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [2140.009145825593, 62063.35522238896, 48625.08194668502, 47631.87097704201, 29298.066033708837, 14973.195727925362, -457.3453332109571, 58994.29251871586, 26843.574285965016, 69457.89905467757, 57344.40531206174, 36377.93138817706, -15329.52693892681, 25800.852328519104, 85234.06460347392, 25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797], "policy_policy_mean_reward": [14361.89612968841, 58786.44088682126, 72456.92787492047, 71638.6057858758, 59221.76940475556, 25935.66075814063, 1444.7439884433982, 94665.75562855892, 40249.331899931276, 80445.49430284697, 80066.99088321689, 46517.470369768875, -6245.802830787303, 5120.127279565134, 62685.57908041839, 43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361], "policy_policy_mm_reward": [22463.763020153296, 53471.16416835699, 45272.01241005289, 69295.57021793613, 38838.87379435426, 19486.949765331374, -2454.222143472023, 68314.08131184848, 36656.67769055572, 52513.829325106715, 39746.53073078511, 44620.40349093692, -2870.7565594740468, 16541.037043243585, 41864.30981295421, 34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144], "policy_policy_rl_reward": [19178.745983796227, 50614.86500530585, 64832.837351937174, 71085.22643118941, 50470.00435639597, 11294.591091226837, -2311.933011618624, 68100.11672379986, 22385.680892313714, 51284.097006396565, 43128.20118340955, 31204.816088866028, -3641.9901124211738, -5550.37564840711, 85259.91136130651, 20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22399152105389264, "mean_inference_ms": 0.728060453261492, "mean_action_processing_ms": 0.11351890950843839, "mean_env_wait_ms": 0.1654787803292803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007021427154541016, "StateBufferConnector_ms": 0.0006878972053527832, "ViewRequirementAgentConnector_ms": 0.01764369010925293}, "num_episodes": 16, "episode_return_max": 1028878.1519473698, "episode_return_min": -116525.03012620742, "episode_return_mean": 222736.157166245, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 718.5584507673234, "num_env_steps_trained_throughput_per_sec": 718.5584507673234, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5611.707, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5611.663, "sample_time_ms": 5038.332, "learn_time_ms": 569.067, "learn_throughput": 7029.055, "synch_weights_time_ms": 3.356}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "26ec2_00000", "date": "2025-10-15_01-21-58", "timestamp": 1760509318, "time_this_iter_s": 5.573869943618774, "time_total_s": 39.32124710083008, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4cc20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.32124710083008, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.2375, "ram_util_percent": 83.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6591881513595581, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.94635072350502, "policy_loss": -0.018879520514747127, "vf_loss": 9.962800613045692, "vf_explained_var": -4.3995678424835203e-07, "kl": 0.01214823730646234, "entropy": 5.251269897818565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 224336.78283216283, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37547.26084403059}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 52919.34056861785, "policy_mean": 56074.44674601286, "policy_mm": 56237.29598747037, "policy_rl": 59105.69953006178}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52919.3359375, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 56074.44921875, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 56237.296875, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59105.69921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37547.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [123749.1681872749, -22136.284300710962, 513485.0746934905, 103842.2958004408, 267243.9714707394, -38498.458867463414, 54128.5372311901, 26588.493892742008, 297648.8412302486, 10351.25466579483, 126229.40123886807, -107939.12104120241, 628122.0504534254, 12912.100764176083, 488421.55771420087, 331080.4894848141, -16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [25863.691463852265, -17087.299553108427, 124104.8222540314, 35605.9578957088, 79998.30084671461, -13415.63220483212, 13280.772307238656, 12815.346634225307, 59836.74492654768, 5852.667994666015, 17745.394829322424, -29611.593447503405, 159212.82516553436, -9650.483637660947, 153369.86408799974, 80634.50854557114, -12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143], "policy_policy_mean_reward": [43219.201441635545, -18158.860958711535, 168550.43872737835, 39857.409178740236, 44270.52449457711, -20506.431373094412, -4061.1620692755555, 4527.143482035203, 92306.66245967023, 11084.638097305531, 29231.010065849234, -28305.643903920085, 166748.58651498586, -9458.34461645236, 111159.41109447692, 101838.96116434084, -1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013], "policy_policy_mm_reward": [34491.648920007516, 8191.306904215652, 128773.52250154235, 27335.489973576718, 67073.509828622, -17163.28308889053, 8806.373253379967, -2922.5754750137676, 84749.78426690835, 10554.829288189667, 27662.539140338897, -21652.56099301163, 131120.2820904268, 19500.340487588215, 109472.14936785123, 78360.58395128077, 8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154], "policy_policy_rl_reward": [20174.6263617795, 4918.569306893383, 92056.29121053858, 1043.4387524151439, 75901.63630082573, 12586.887799353599, 36102.55373984721, 12168.579251495212, 60755.649577123135, -17140.88071436641, 51590.4572033576, -28369.322696767114, 171040.35668247758, 12520.588530701334, 114420.1331638728, 70246.43582362145, -10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2251048279118897, "mean_inference_ms": 0.7314973684719522, "mean_action_processing_ms": 0.11403346849711343, "mean_env_wait_ms": 0.16645621535707744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007275938987731934, "StateBufferConnector_ms": 0.0007025599479675293, "ViewRequirementAgentConnector_ms": 0.018153905868530273}, "num_episodes": 15, "episode_return_max": 1028878.1519473698, "episode_return_min": -155745.83041281765, "episode_return_mean": 224336.78283216283, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 622.078093025377, "num_env_steps_trained_throughput_per_sec": 622.078093025377, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5714.003, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5713.957, "sample_time_ms": 5142.341, "learn_time_ms": 567.194, "learn_throughput": 7052.257, "synch_weights_time_ms": 3.482}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-04", "timestamp": 1760509324, "time_this_iter_s": 6.438438892364502, "time_total_s": 45.75968599319458, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d76f20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.75968599319458, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 75.05555555555556, "ram_util_percent": 83.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6908385157585144, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.941252806782723, "policy_loss": -0.02048096991784405, "vf_loss": 9.959113445878028, "vf_explained_var": -1.6354024410247802e-07, "kl": 0.013101745807784972, "entropy": 5.2900868445634845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 245312.8486782425, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37547.26084403059}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 58529.67660903851, "policy_mean": 60733.98352639296, "policy_mm": 60327.5136342951, "policy_rl": 65721.67490851588}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58529.67578125, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 60733.984375, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 60327.515625, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 65721.671875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37547.26171875, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [-16382.646877049161, 358488.2666996264, 126523.07215363471, 57093.73402273083, 282289.1743713847, 344674.75218678213, 167769.9257013535, 199120.0295725196, 167167.52162687882, 380310.5121970457, 352281.86984034785, 85298.70787340333, -56943.686918822226, 136633.5309536567, 192801.07005773069, 827427.5086709923, 206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-12187.03000240735, 41109.84387021839, 15557.437091167132, 3017.4814395360804, 75125.08768822013, 105328.56592881976, 36439.56512153094, 52268.02346526361, 36999.05082093317, 91227.11382304788, 117510.34068656786, 25047.763460782466, -15372.312943948014, 31228.337415775237, 39395.84696364842, 170282.69465961712, 50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436], "policy_policy_mean_reward": [-1696.318308725297, 64496.20453577426, 29165.856143361605, 15065.714854198632, 68298.09875979119, 73191.71403542713, 42365.6733220533, 44890.994990135965, 34272.14694405776, 77724.0761348443, 62696.92510562382, 37142.03029677412, -11082.28367261097, 24048.412250500114, 41984.34368192306, 199920.534115911, 62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802], "policy_policy_mm_reward": [8031.781677357069, 94958.3578059389, 55400.1605360314, 22961.244707976617, 64706.290781971795, 80897.07630585751, 41450.80904064935, 55186.96002308313, 42881.39196168161, 112128.83402924171, 91426.91693570308, 11309.311009099194, -16385.537370286707, 52985.87935477402, 62525.94990666246, 260623.8446174409, 52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848], "policy_policy_rl_reward": [-10531.080243273627, 157923.86048769494, 26399.618383074318, 16049.29302101954, 74159.6971414017, 85257.39591667784, 47513.878217119825, 46774.05109403686, 53014.93190020572, 99230.48820991232, 80647.68711245334, 11799.603106747616, -14103.552931976466, 28370.90193260757, 48894.92950549683, 196600.43527802403, 41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2261162521063764, "mean_inference_ms": 0.7348603490974261, "mean_action_processing_ms": 0.11448564987600501, "mean_env_wait_ms": 0.167347509654268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007340908050537109, "StateBufferConnector_ms": 0.0007041692733764648, "ViewRequirementAgentConnector_ms": 0.018224895000457764}, "num_episodes": 16, "episode_return_max": 1028878.1519473698, "episode_return_min": -155745.83041281765, "episode_return_mean": 245312.8486782425, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 705.3377831641229, "num_env_steps_trained_throughput_per_sec": 705.3377831641229, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5709.231, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5709.185, "sample_time_ms": 5139.316, "learn_time_ms": 565.284, "learn_throughput": 7076.086, "synch_weights_time_ms": 3.561}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-10", "timestamp": 1760509330, "time_this_iter_s": 5.676183700561523, "time_total_s": 51.4358696937561, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db76a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.4358696937561, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.362500000000004, "ram_util_percent": 84.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8156831860542297, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.935838052630425, "policy_loss": -0.02449083549872739, "vf_loss": 9.957197958230973, "vf_explained_var": 2.551823854446411e-07, "kl": 0.01565461878574297, "entropy": 5.162269791960716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 259744.55241707817, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 62049.44944411552, "policy_mean": 63416.94820763649, "policy_mm": 63049.663208742066, "policy_rl": 71228.49155658408}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 62049.44921875, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 63416.94921875, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 63049.65625, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71228.4921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [206861.40811801722, -40187.88957203888, 318536.47325742035, 58982.4055295428, 451169.1775307858, 386210.70947024826, 11030.140052610584, 295191.1776846252, 283956.9801945099, 606199.733302155, 199361.36721851403, 265975.69655133627, 221533.5123276233, 33064.98203082423, 324636.8965360885, -72755.39134467869, 828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [50680.476852837266, 15442.609058681517, 100987.3330563901, -2973.13078071403, 128349.12243517682, 125487.50401649071, 8138.657082237544, 72721.17554385758, 74343.60794429763, 98863.83772407207, 64272.25408774508, 48841.45496105089, 57991.10764617084, 17029.05808614269, 66567.13814330693, -25181.247909488196, 162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638], "policy_policy_mean_reward": [62505.00012685254, -25712.00422681901, 62804.963163127075, 53750.23799774079, 77023.04763515033, 64416.943733805485, -18871.297690085845, 78786.26777534164, 71113.95995882271, 152306.08874494312, 39135.68487209172, 81875.44599260559, 33714.31531522701, 21286.249673639348, 73473.73459169462, -19361.84898044438, 298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912], "policy_policy_mm_reward": [52010.14227334657, -10595.092371062065, 58581.75831487738, 17458.52748289801, 183162.01473124104, 74356.69364270027, 13003.328854472047, 62869.620955990125, 73796.11367435649, 144710.79856136156, 42971.079269326845, 75064.309879829, 56895.328808351675, -5156.807873411716, 79496.75436543862, -4945.378192553884, 176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882], "policy_policy_rl_reward": [41665.788864980335, -19323.40203283928, 96162.41872302559, -9253.229170381968, 62634.99272921764, 121949.56807725181, 8759.4518059869, 80814.11340943546, 64703.2986170331, 210319.0082717785, 52982.34898935054, 60194.48571785084, 72932.76055787358, -93.51785554597296, 105099.26943564812, -23266.916262192393, 191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2273679721709782, "mean_inference_ms": 0.7385372532751596, "mean_action_processing_ms": 0.115096794844382, "mean_env_wait_ms": 0.16849837330972026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007464885711669922, "StateBufferConnector_ms": 0.0007189512252807617, "ViewRequirementAgentConnector_ms": 0.01852351427078247}, "num_episodes": 16, "episode_return_max": 1028878.1519473698, "episode_return_min": -155745.83041281765, "episode_return_mean": 259744.55241707817, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 643.5172218518252, "num_env_steps_trained_throughput_per_sec": 643.5172218518252, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5759.893, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5759.843, "sample_time_ms": 5191.578, "learn_time_ms": 563.209, "learn_throughput": 7102.159, "synch_weights_time_ms": 4.001}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-16", "timestamp": 1760509336, "time_this_iter_s": 6.2232208251953125, "time_total_s": 57.659090518951416, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6d40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.659090518951416, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.31111111111111, "ram_util_percent": 83.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7846023440361023, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.938753402233123, "policy_loss": -0.022495348888332954, "vf_loss": 9.958208695054054, "vf_explained_var": 1.521781086921692e-07, "kl": 0.015200240300555426, "entropy": 5.122191424667835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 1028878.1519473698, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 255946.1676314313, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 255228.28223230067, "policy_mean": 298588.826627273, "policy_mm": 293637.6772552899, "policy_rl": 348087.35355316184}, "policy_reward_mean": {"policy_mom": 61226.64823530536, "policy_mean": 63387.201825877346, "policy_mm": 60718.19620210718, "policy_rl": 70614.12136814136}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 61226.6484375, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 255228.28125, "('mean_0', 'policy_mean')_total_reward_mean": 63387.19921875, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 298588.8125, "('mm_0', 'policy_mm')_total_reward_mean": 60718.1953125, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 293637.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70614.125, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 348087.34375}, "hist_stats": {"episode_reward": [828824.5795787694, 815403.9786335168, 146250.49694284535, 496384.5172212945, 208878.45232238751, 1028878.1519473698, 84367.35543253184, 72388.90563507809, 75170.80690653015, -64167.803004360016, 301394.33918618574, -73804.63478433299, 653197.7992540066, 106698.93605563906, 57767.60996661475, -47785.1277873543, 967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [162609.95970137327, 255228.28223230067, 48873.723376512564, 90151.39470378813, 37660.40379495468, 179358.37868490547, 5959.717567093689, 13178.572440280488, 18760.92637548874, -21231.781152734253, 73742.69826232477, -24528.263378226235, 138552.68561128262, 9105.437120521294, 18733.965876535374, 1320.0020458284173, -3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134], "policy_policy_mean_reward": [298588.826627273, 154915.62182180697, 41672.498899594786, 127048.41576596096, 50004.9486144856, 207794.7424540131, 17570.33032739282, 29061.802865941958, 42206.793613921196, -8436.246338751409, 81789.40779212427, -8882.943365605708, 131273.81307812652, 24614.173862080333, 3816.7318995446967, 3483.220870621691, 3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474], "policy_policy_mm_reward": [176244.5438587882, 199057.5968481028, 28533.41054991278, 133351.27544098394, 70136.10326028861, 293637.6772552899, 43696.81256075061, 5140.051232085173, 4511.867310228631, -16037.26711076665, 54953.043385692494, -17093.04263505206, 198163.0102629725, 38494.666736711115, 22653.412639239425, -29459.303195036282, -413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515], "policy_policy_rl_reward": [191381.24939133506, 206202.47773130497, 27170.864116825327, 145833.43131056134, 51076.99665265868, 348087.35355316184, 17140.494977294693, 25008.4790967705, 9691.219606891704, -18462.508402107815, 90909.18974604362, -23300.38540544902, 185208.29030162477, 34484.65833632623, 12563.499551295281, -23129.0475087682, 1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2283099271278436, "mean_inference_ms": 0.7411037370507834, "mean_action_processing_ms": 0.11556427019995102, "mean_env_wait_ms": 0.1693637919552323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007491707801818848, "StateBufferConnector_ms": 0.0007222890853881836, "ViewRequirementAgentConnector_ms": 0.018573522567749023}, "num_episodes": 16, "episode_return_max": 1028878.1519473698, "episode_return_min": -155745.83041281765, "episode_return_mean": 255946.1676314313, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.1438024313684, "num_env_steps_trained_throughput_per_sec": 722.1438024313684, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5748.848, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5748.784, "sample_time_ms": 5195.96, "learn_time_ms": 547.825, "learn_throughput": 7301.604, "synch_weights_time_ms": 3.994}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-22", "timestamp": 1760509342, "time_this_iter_s": 5.5433349609375, "time_total_s": 63.202425479888916, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db65c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 63.202425479888916, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.737500000000004, "ram_util_percent": 82.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8130258321762085, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.933736443519592, "policy_loss": -0.02396831882360857, "vf_loss": 9.95465603172779, "vf_explained_var": -1.1026859283447266e-07, "kl": 0.01524365560162556, "entropy": 5.058427836000919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 868056.913067807, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 230435.15861878652, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 222011.51519857495, "policy_mean": 210459.1306778001, "policy_mm": 252831.62921217704, "policy_rl": 301348.07242475875}, "policy_reward_mean": {"policy_mom": 56726.08819022531, "policy_mean": 55873.021666593755, "policy_mm": 54669.83470569492, "policy_rl": 63166.21405627256}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56726.0859375, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 222011.515625, "('mean_0', 'policy_mean')_total_reward_mean": 55873.0234375, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 210459.125, "('mm_0', 'policy_mm')_total_reward_mean": 54669.828125, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 252831.625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63166.21484375, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 301348.0625}, "hist_stats": {"episode_reward": [967.8565375226525, 51188.79032734568, 368858.4448692261, 134859.02848400478, 328011.71077202464, 328870.83876706514, 215056.63640342047, 23796.739945194702, 225235.14629509219, 581218.2902644273, -116525.03012620742, 810104.3485541024, 28330.549561047454, 183606.16195991373, 750078.9092578959, -233.92559669076948, 48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-3838.3636949018837, 16141.434906895918, 99601.64395606254, 37909.94501209039, 99065.31001205173, 72078.94452751294, 48180.241550946455, 12310.836112374827, 50951.442445135974, 131463.57397938916, -24141.41479218289, 179017.15368538935, -13036.679637971954, 55573.71364571131, 214254.36122202122, -21268.49756124956, 8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475], "policy_policy_mean_reward": [3502.029705633599, 6184.8434361527, 107613.89282909453, 32096.910949597186, 63565.29376723789, 92472.08501210956, 47013.9261323252, 8673.221568404382, 69796.24949498667, 188355.12695823587, -26482.965206694684, 167128.61539058818, 11687.731146413216, 42672.394772754546, 143321.81789144428, 15008.826674081874, 19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125], "policy_policy_mm_reward": [-413.0708619676058, 5158.381850934212, 72764.85593983547, 33795.47216956081, 61582.22768936518, 74246.17740451063, 58204.20006866612, -2519.232435860096, 50455.570919098296, 102333.45221312057, -28657.58651796306, 252831.62921217704, 20359.56117445454, 42082.1522138088, 143073.26214064014, -12331.015789221054, 17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415], "policy_policy_rl_reward": [1717.2613887585624, 23704.130133362985, 88878.05214423369, 31056.700352756412, 103798.87930336971, 90073.63182293125, 61658.26865148274, 5331.914700275612, 54031.88343587135, 159066.13711368275, -37243.063609366676, 211126.95026594857, 9319.936878151604, 43277.90132763926, 249429.4680037902, 18356.761079697946, 1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22908502910781067, "mean_inference_ms": 0.7437118298502398, "mean_action_processing_ms": 0.1159535137014971, "mean_env_wait_ms": 0.17008699117817672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007429718971252441, "StateBufferConnector_ms": 0.0007148981094360352, "ViewRequirementAgentConnector_ms": 0.018390655517578125}, "num_episodes": 16, "episode_return_max": 868056.913067807, "episode_return_min": -155745.83041281765, "episode_return_mean": 230435.15861878652, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.8733363972681, "num_env_steps_trained_throughput_per_sec": 709.8733363972681, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5767.979, "restore_workers_time_ms": 0.023, "training_step_time_ms": 5767.915, "sample_time_ms": 5206.98, "learn_time_ms": 555.333, "learn_throughput": 7202.889, "synch_weights_time_ms": 4.576}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-28", "timestamp": 1760509348, "time_this_iter_s": 5.639968156814575, "time_total_s": 68.84239363670349, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.84239363670349, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 45.05, "ram_util_percent": 82.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8727458715438843, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.942948931455613, "policy_loss": -0.01849262671530596, "vf_loss": 9.958645132184028, "vf_explained_var": -1.333653926849365e-07, "kl": 0.013982168701727516, "entropy": 5.016331239044666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 868056.913067807, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 227199.53713322635, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 222011.51519857495, "policy_mean": 210459.1306778001, "policy_mm": 250963.3961242131, "policy_rl": 301348.07242475875}, "policy_reward_mean": {"policy_mom": 55871.73257358162, "policy_mean": 54633.14873237904, "policy_mm": 54534.7374601631, "policy_rl": 62159.91836710257}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55871.73046875, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 222011.515625, "('mean_0', 'policy_mean')_total_reward_mean": 54633.14453125, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 210459.125, "('mm_0', 'policy_mm')_total_reward_mean": 54534.73828125, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 250963.390625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62159.921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 301348.0625}, "hist_stats": {"episode_reward": [48076.41942199604, 349026.69247040915, 243326.79776030916, 310767.3610939184, 392151.7559605734, 277079.1711706774, 141813.75836319014, 289225.49453320197, 71881.7444867565, 206476.11231449427, 321427.3936752144, 448094.5046660474, 68673.84597754088, 276533.7518749605, 120516.78520021998, -24095.098837883106, -155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [8785.561180552435, 75927.64155131912, 41949.49461421279, 47901.12431253701, 108957.52032791797, 62196.76411614994, 32027.498013466764, 76311.98332856315, 43174.61800008381, 51548.65390206103, 85128.89906074788, 126020.10403835164, 8601.118250178444, 48044.6856377957, 35648.89797839698, 10344.863001593478, -47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729], "policy_policy_mean_reward": [19624.9339194295, 94842.27051925576, 62926.74552394598, 138626.6792089342, 99229.00592984361, 93762.65014850082, 27220.82927195761, 85206.5579770033, 14271.976484647792, 44096.501415879764, 107861.73811677768, 85717.14470330374, 12310.294855365328, 96470.17124781453, 39181.89671416951, -9562.904671023865, -35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752], "policy_policy_mm_reward": [17736.696971279755, 99903.65905413694, 64104.71105247978, 54441.47856362921, 82353.21235043144, 65349.13004538568, 41973.002514626605, 73346.10393493842, 7968.24934584881, 49882.647733876125, 53602.39116117064, 107213.91755123301, 21422.229356913722, 60739.87971582528, 26800.59885309728, -8825.753714035318, -34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197], "policy_policy_rl_reward": [1929.2273507343812, 78353.12134569678, 74345.84656967055, 69798.07900881817, 101612.01735238067, 55770.626860640776, 40592.42856313927, 54360.84929269674, 6466.9006561761735, 60948.30926267732, 74834.36533651837, 129143.33837315904, 26340.20351508333, 71279.01527352497, 18885.39165455627, -16051.303454417382, -37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2297950379577651, "mean_inference_ms": 0.7461432707053035, "mean_action_processing_ms": 0.116310425599955, "mean_env_wait_ms": 0.17074373754666056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007418394088745117, "StateBufferConnector_ms": 0.0007163286209106445, "ViewRequirementAgentConnector_ms": 0.018362998962402344}, "num_episodes": 16, "episode_return_max": 868056.913067807, "episode_return_min": -155745.83041281765, "episode_return_mean": 227199.53713322635, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.687984876686, "num_env_steps_trained_throughput_per_sec": 729.687984876686, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5749.388, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5749.324, "sample_time_ms": 5195.583, "learn_time_ms": 548.683, "learn_throughput": 7290.189, "synch_weights_time_ms": 4.065}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-33", "timestamp": 1760509353, "time_this_iter_s": 5.486111879348755, "time_total_s": 74.32850551605225, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x149a8b4c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.32850551605225, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.45, "ram_util_percent": 81.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8353090286254883, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.932518842816354, "policy_loss": -0.025466473065898755, "vf_loss": 9.95486452281475, "vf_explained_var": 9.190291166305542e-07, "kl": 0.015603871914390837, "entropy": 5.001080518960952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 868056.913067807, "episode_reward_min": -155745.83041281765, "episode_reward_mean": 214861.65445576742, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -47918.36097172937, "policy_mean": -35813.124137101215, "policy_mm": -34467.08445995665, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 222011.51519857495, "policy_mean": 210459.1306778001, "policy_mm": 250963.3961242131, "policy_rl": 301348.07242475875}, "policy_reward_mean": {"policy_mom": 52819.59345450064, "policy_mean": 49756.08240827568, "policy_mm": 51821.87334312755, "policy_rl": 60464.105249863554}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52819.59375, "('mom_0', 'policy_mom')_total_reward_min": -47918.359375, "('mom_0', 'policy_mom')_total_reward_max": 222011.515625, "('mean_0', 'policy_mean')_total_reward_mean": 49756.0859375, "('mean_0', 'policy_mean')_total_reward_min": -35813.125, "('mean_0', 'policy_mean')_total_reward_max": 210459.125, "('mm_0', 'policy_mm')_total_reward_mean": 51821.87109375, "('mm_0', 'policy_mm')_total_reward_min": -34467.0859375, "('mm_0', 'policy_mm')_total_reward_max": 250963.390625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60464.10546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 301348.0625}, "hist_stats": {"episode_reward": [-155745.83041281765, 74317.58778070775, 166621.06994030724, 234686.0123565235, 365643.4969526101, 452436.5990563478, 577552.0106674229, -845.8515635968819, 392520.6072577528, 287777.2349041583, -57732.70423371909, 779593.6128336381, 118089.73576093021, 463248.0657198008, 160741.08270264466, 310867.31940499815, 305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-47918.36097172937, 15619.723176130015, 21925.21623521286, 64903.64693140143, 113264.00065096693, 120371.68078443012, 136799.7485378057, -11459.05940847156, 91663.24022112993, 68831.47859486962, -24651.11951686541, 163252.38143578742, 29296.352898245394, 143173.7762913711, 39114.922957566625, 102049.91208121637, 66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668], "policy_policy_mean_reward": [-35813.124137101215, 18021.416435583793, 59437.87206788765, 41845.42388594013, 77143.19465477557, 124802.8260421491, 127057.22257505171, 18886.327146928277, 102732.5002592887, 101221.45039401251, -8829.837992877892, 165145.66409516195, 31700.147908518476, 90052.06644247702, 29194.14480895934, 81100.03380662108, 69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023], "policy_policy_mm_reward": [-34467.08445995665, 16110.410252845377, 42997.12567412197, 53004.692880481154, 70125.06369619831, 116542.39983075173, 139082.76390416984, -10551.63770673672, 84701.02285276426, 65568.61634985081, -3980.1102057187877, 149847.49487792928, 30641.977416874895, 108629.70136737182, 41618.44599075281, 41660.55452238545, 93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023], "policy_policy_rl_reward": [-37547.26084403059, 24566.037916148554, 42260.85596308455, 74932.24865870088, 105111.23795066983, 90719.69239901757, 174612.2756503952, 2278.518404683153, 113423.84392456988, 52155.68956542482, -20271.636518257063, 301348.07242475875, 26451.257537291352, 121392.52161858091, 50813.56894536595, 86056.8189947752, 76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2300048354517456, "mean_inference_ms": 0.7467366549581277, "mean_action_processing_ms": 0.11642200058625513, "mean_env_wait_ms": 0.17092451113596238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007165670394897461, "StateBufferConnector_ms": 0.0007047057151794434, "ViewRequirementAgentConnector_ms": 0.01801997423171997}, "num_episodes": 16, "episode_return_max": 868056.913067807, "episode_return_min": -155745.83041281765, "episode_return_mean": 214861.65445576742, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.8782099144686, "num_env_steps_trained_throughput_per_sec": 731.8782099144686, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5734.312, "restore_workers_time_ms": 0.023, "training_step_time_ms": 5734.25, "sample_time_ms": 5180.119, "learn_time_ms": 549.123, "learn_throughput": 7284.341, "synch_weights_time_ms": 4.005}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-39", "timestamp": 1760509359, "time_this_iter_s": 5.4690258502960205, "time_total_s": 79.79753136634827, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4dd00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.79753136634827, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.442857142857143, "ram_util_percent": 82.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8292458653450012, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.941684263944627, "policy_loss": -0.020819532018504106, "vf_loss": 9.959655153751374, "vf_explained_var": 2.7194619178771973e-07, "kl": 0.01424355346212004, "entropy": 5.012504932284355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -124087.72191237843, "episode_reward_mean": 200373.26882923808, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35646.8130079049, "policy_mean": -27270.833203908223, "policy_mm": -29467.320685152732, "policy_rl": -37822.60628271195}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 210459.1306778001, "policy_mm": 254108.1016333491, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 48175.20893814933, "policy_mean": 46631.50467905584, "policy_mm": 48546.5001496622, "policy_rl": 57020.05506237071}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48175.2109375, "('mom_0', 'policy_mom')_total_reward_min": -35646.8125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 46631.51171875, "('mean_0', 'policy_mean')_total_reward_min": -27270.833984375, "('mean_0', 'policy_mean')_total_reward_max": 210459.125, "('mm_0', 'policy_mm')_total_reward_mean": 48546.5, "('mm_0', 'policy_mm')_total_reward_min": -29467.3203125, "('mm_0', 'policy_mm')_total_reward_max": 254108.109375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57020.0546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -37822.60546875, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [305782.65637218725, 202720.13962420638, -15485.245318173464, 569927.1970847871, 213643.8803899351, 238243.49449581164, 209067.2254157413, 438728.065130073, 590117.0592811884, 705935.8733408569, 43020.075576278236, 257670.7513284661, 690295.3132334527, -26654.79959869468, 868056.913067807, 44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [66828.92974542754, 65639.74371813271, -4396.586048979916, 159810.0892077436, 40173.44047191116, 45278.01787341092, 67292.46396307382, 107750.02843017463, 152948.51249774295, 222011.51519857495, 19724.420923040827, 85603.1328981673, 95907.2385843294, -5134.343555507305, 191286.96361870653, 6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608], "policy_policy_mean_reward": [69614.3088744353, 40550.59910479217, 2976.1254447776246, 144910.4482724802, 70175.07392393616, 39669.11654500822, 48391.37029029644, 112256.10392615004, 92252.27307164339, 180973.13972272587, 21346.368161789167, 47795.995215410396, 115657.50388356946, 4141.955174493764, 164702.65066089763, 14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473], "policy_policy_mm_reward": [93271.96059706582, 44936.92017306104, -4895.52345879349, 136176.05489155848, 50150.78746004661, 83580.41633589158, 44401.470236738365, 80075.95889969273, 166232.0632186834, 148144.66923590744, 14174.34982674775, 69381.55690457759, 250963.3961242131, -8792.690907005019, 218009.17595941512, 8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382], "policy_policy_rl_reward": [76067.45715525873, 51592.87662822042, -9169.261255177737, 129030.60471300354, 53144.578534040855, 69715.9437415007, 48981.92092563253, 138645.97387405534, 178684.210493119, 154806.54918364921, -12225.063335299586, 54890.06631031103, 227767.17464134083, -16869.720310676203, 294058.1228287881, 14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2300836456612226, "mean_inference_ms": 0.7464796779753745, "mean_action_processing_ms": 0.11641396396326607, "mean_env_wait_ms": 0.17086251805346195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007038116455078125, "StateBufferConnector_ms": 0.0007007718086242676, "ViewRequirementAgentConnector_ms": 0.01771378517150879}, "num_episodes": 16, "episode_return_max": 1083289.290723151, "episode_return_min": -124087.72191237843, "episode_return_mean": 200373.26882923808, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 717.6881917022847, "num_env_steps_trained_throughput_per_sec": 717.6881917022847, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5714.067, "restore_workers_time_ms": 0.023, "training_step_time_ms": 5714.006, "sample_time_ms": 5161.39, "learn_time_ms": 547.7, "learn_throughput": 7303.262, "synch_weights_time_ms": 3.832}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-44", "timestamp": 1760509364, "time_this_iter_s": 5.576488971710205, "time_total_s": 85.37402033805847, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4c720>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.37402033805847, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.45, "ram_util_percent": 82.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9007630348205566, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.94266918003559, "policy_loss": -0.021757765421352816, "vf_loss": 9.96099704504013, "vf_explained_var": -3.635883331298828e-07, "kl": 0.017149390331223997, "entropy": 4.876281148195266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -155045.9543944369, "episode_reward_mean": 182813.85129506767, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35646.8130079049, "policy_mean": -47097.93055807722, "policy_mm": -39222.20483685811, "policy_rl": -40735.12178862662}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 210459.1306778001, "policy_mm": 295074.2899947176, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 43691.426678805554, "policy_mean": 43270.77571517271, "policy_mm": 44248.88594467941, "policy_rl": 51602.76295640999}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 43691.4296875, "('mom_0', 'policy_mom')_total_reward_min": -35646.8125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 43270.78125, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 210459.125, "('mm_0', 'policy_mm')_total_reward_mean": 44248.88671875, "('mm_0', 'policy_mm')_total_reward_min": -39222.203125, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51602.765625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40735.12109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [44588.86598069861, 110005.83173462287, -124087.72191237843, 656316.7881423606, 132776.10040956264, -16389.662071250303, 346804.00358179235, -28794.682286562642, 160594.0820619666, 35496.02225340819, 114816.52144652982, 199725.9827622055, 538826.0311981594, 154245.6837345781, 216444.50544404762, 349791.19006247557, 292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [6954.52051822175, 23463.861385661796, -35646.8130079049, 116790.666780304, 30551.4664165638, 4769.7442497523225, 67106.20412913788, -9762.84047054378, 67503.27017265471, 10905.40897516075, 32491.314533525667, 87051.11461605519, 126048.07700409244, 39486.40045621851, 66948.3797931091, 94572.7729854727, 79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835], "policy_policy_mean_reward": [14301.195626974835, 38992.8706740449, -21783.45285354265, 122319.28269668743, 19589.144593307912, -21432.933090039623, 94070.36367087613, 1637.0210010571057, 34969.74783446243, 10074.053031577085, 8961.934514942632, 39471.49950823388, 124713.0453946122, 57627.47228127916, 55147.40258612274, 94202.77688375491, 54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526], "policy_policy_mm_reward": [8974.099970620631, 12288.631594235436, -28834.84976821902, 160219.66838144383, 44335.52529488882, 8712.366055611335, 100877.13581979071, -7107.884923812089, 25615.114018012282, 2449.947929641768, 30544.870427816313, 22720.127454469963, 132323.73239546537, 25642.26552430573, 26940.023000858382, 75847.15517942497, 81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455], "policy_policy_rl_reward": [14359.049864881406, 35260.46808068071, -37822.60628271195, 256987.17028392505, 38299.96410480216, -8438.839286574375, 84750.29996198716, -13560.977893263876, 32505.95003683725, 12066.612317028636, 42818.40197024515, 50483.24118344666, 155741.1764039887, 31489.54547277475, 67408.7000639575, 85168.48501382244, 78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22984283422342108, "mean_inference_ms": 0.7452662208756103, "mean_action_processing_ms": 0.11624342137298616, "mean_env_wait_ms": 0.17053538358200718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000702977180480957, "StateBufferConnector_ms": 0.0006957650184631348, "ViewRequirementAgentConnector_ms": 0.017685890197753906}, "num_episodes": 15, "episode_return_max": 1083289.290723151, "episode_return_min": -155045.9543944369, "episode_return_mean": 182813.85129506767, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 727.5118707533716, "num_env_steps_trained_throughput_per_sec": 727.5118707533716, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5707.647, "restore_workers_time_ms": 0.022, "training_step_time_ms": 5707.588, "sample_time_ms": 5164.431, "learn_time_ms": 538.298, "learn_throughput": 7430.831, "synch_weights_time_ms": 3.781}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-50", "timestamp": 1760509370, "time_this_iter_s": 5.502246141433716, "time_total_s": 90.87626647949219, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4efc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.87626647949219, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.9125, "ram_util_percent": 82.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9832245111465454, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.933086523413658, "policy_loss": -0.02719266836065799, "vf_loss": 9.956465190649032, "vf_explained_var": 1.1011958122253419e-06, "kl": 0.0190701142632407, "entropy": 4.815240579843521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 188797.45135316422, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -47097.93055807722, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 240133.69313105813, "policy_mm": 295074.2899947176, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 45017.61708356553, "policy_mean": 45227.438263754164, "policy_mm": 46938.875379824036, "policy_rl": 51613.520626020545}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45017.62109375, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 45227.43359375, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 46938.875, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51613.515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [292583.1512064474, -31185.702065368536, 154847.39156845273, 732312.4019535717, -50188.020527552755, 18960.932952239305, 200224.469682849, 406025.1248556818, -47172.468777553746, -2908.3882827439033, 140589.4619321624, 327843.8818419391, -27601.90797849399, -30106.77868155416, 466502.28904930805, 196508.61925102628, 12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [79095.48512066502, -10896.156829453697, 18874.266424565947, 169933.28605070992, -24845.890143882134, 15852.74685573463, 51817.50451228032, 90403.27599067515, 5105.3424334365, -3610.473055378147, 39495.67342506709, 103064.85242049734, -7668.565271190139, -20045.440197586435, 96577.86568150234, 67013.80029887448, -6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984], "policy_policy_mean_reward": [54024.26466726998, 9890.763683580766, 46934.366720106205, 210459.1306778001, -15478.758857856474, 8579.3388508138, 35067.09102903687, 104481.82941472366, -20696.882656386464, 5133.47602785588, 37740.43438767568, 92206.0423659922, -10662.166647289585, -17303.067287718033, 64231.06868641285, 24419.79028434727, -1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565], "policy_policy_mm_reward": [81124.0374823973, -5292.771760454214, 25129.355057530396, 140881.16469425964, -5874.146641642515, -3595.6889320068963, 49455.967722018744, 114340.95890794134, -17497.85377148971, 3413.3039505540296, 9764.095259290383, 70732.40610465695, 1726.3610026837287, 8878.526166966765, 183614.27287585151, 71531.12235092424, 7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771], "policy_policy_rl_reward": [78339.36393611527, -24887.537159041418, 63909.403366250095, 211038.82053080213, -3989.224884171632, -1875.4638223022293, 63883.9064195129, 96799.06054234173, -14083.074783114127, -7844.695205775695, 53589.25886012931, 61840.5809507928, -10997.537062697931, -1636.7973632164721, 122079.08180554141, 33543.906316880435, 13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2295273546830397, "mean_inference_ms": 0.7437876361573659, "mean_action_processing_ms": 0.11602642293045733, "mean_env_wait_ms": 0.1701344591921779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006936192512512207, "StateBufferConnector_ms": 0.0006883144378662109, "ViewRequirementAgentConnector_ms": 0.01743227243423462}, "num_episodes": 16, "episode_return_max": 1083289.290723151, "episode_return_min": -163016.94044088648, "episode_return_mean": 188797.45135316422, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.477540910492, "num_env_steps_trained_throughput_per_sec": 711.477540910492, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5713.187, "restore_workers_time_ms": 0.022, "training_step_time_ms": 5713.13, "sample_time_ms": 5167.577, "learn_time_ms": 540.599, "learn_throughput": 7399.2, "synch_weights_time_ms": 3.879}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "26ec2_00000", "date": "2025-10-15_01-22-55", "timestamp": 1760509375, "time_this_iter_s": 5.627990007400513, "time_total_s": 96.5042564868927, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6980>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.5042564868927, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.824999999999996, "ram_util_percent": 82.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9312781095504761, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.938426032662392, "policy_loss": -0.022067252016859128, "vf_loss": 9.95718389749527, "vf_explained_var": -2.4028122425079346e-07, "kl": 0.016546986028788613, "entropy": 4.78754490762949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 198196.22935457897, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -47097.93055807722, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 240133.69313105813, "policy_mm": 295074.2899947176, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 47269.72918818091, "policy_mean": 48529.41568986582, "policy_mm": 48273.14279640329, "policy_rl": 54123.94168012898}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47269.73046875, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 48529.42578125, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 48273.14453125, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 54123.9453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [12880.53946647132, -7316.153249950377, 14876.719248093725, 208559.04427232142, 260882.07666044816, 96253.58839047377, 335254.53481068613, 248596.6711863386, 288752.5190788704, -41241.34591584713, 276373.7890768002, -80410.3878462815, 201869.3222026218, 250135.58758388972, 223523.49062941692, 576749.9842789171, -12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-6582.318570235384, -3989.0468038259305, 16763.170868984096, 51756.23601216745, 61465.474153219475, 34694.34724176867, 48226.403034116745, 78343.91121684018, 99527.60508785657, -4840.96412279169, 81255.71420774848, -28462.21998610926, 26513.751474090495, 67925.63154619116, 31392.41964959894, 163036.15332523527, 10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148], "policy_policy_mean_reward": [-1428.5333004074719, 7964.9120025081975, 3993.8205043274234, 56495.32672090867, 54881.64247737125, 18231.234126929256, 85298.02085809581, 64651.33653269208, 58553.60310610282, 1969.9983958275611, 66374.87600030041, -23698.254799987822, 56097.95626421388, 64896.413528315556, 53592.96410788077, 116146.75799507202, 291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809], "policy_policy_mm_reward": [7385.574415876737, -13823.256550413636, -3427.025173290107, 49135.693951084875, 69513.25047831415, 8238.095039677657, 70814.60322253966, 48502.54660912346, 64354.547605588894, -11845.325180247357, 53872.385457741446, -4599.362953583876, 37948.11299574232, 69129.17260863043, 72279.56618367977, 167381.86733685268, -11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924], "policy_policy_rl_reward": [13505.816921237403, 2531.2381017809785, -2453.2469519276037, 51171.787588160405, 75021.70955154317, 35089.911982098165, 130915.50769593459, 57098.876827682885, 66316.76327932249, -26525.055008635667, 74870.8134110101, -23650.550106600742, 81309.50146857515, 48184.36990075267, 66258.54068825756, 130185.20562175714, -10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22933023106900827, "mean_inference_ms": 0.7424447898978603, "mean_action_processing_ms": 0.11586837177975096, "mean_env_wait_ms": 0.16984637233611438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007013678550720215, "StateBufferConnector_ms": 0.0006935000419616699, "ViewRequirementAgentConnector_ms": 0.017569303512573242}, "num_episodes": 16, "episode_return_max": 1083289.290723151, "episode_return_min": -163016.94044088648, "episode_return_mean": 198196.22935457897, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 698.6557805973415, "num_env_steps_trained_throughput_per_sec": 698.6557805973415, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5642.709, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5642.649, "sample_time_ms": 5092.672, "learn_time_ms": 544.758, "learn_throughput": 7342.704, "synch_weights_time_ms": 4.184}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-01", "timestamp": 1760509381, "time_this_iter_s": 5.732445001602173, "time_total_s": 102.23670148849487, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d2ba60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.23670148849487, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.6375, "ram_util_percent": 83.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9596608877182007, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.941995084285736, "policy_loss": -0.02169323330017505, "vf_loss": 9.96034465432167, "vf_explained_var": -4.4479966163635256e-07, "kl": 0.016718530966750314, "entropy": 4.804397650063038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 196489.6938983786, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -47097.93055807722, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 240133.69313105813, "policy_mm": 295074.2899947176, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 46229.36504100386, "policy_mean": 48556.10739325343, "policy_mm": 47735.40926269582, "policy_rl": 53968.81220142547}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46229.36328125, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 48556.10546875, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 47735.3984375, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 53968.80859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [-12436.477323244595, 498621.45073541487, -36992.07709607863, 274834.28672210843, 489977.4112052801, -25445.731757320493, -8912.245983586348, 164298.70286508292, -81757.36166943576, 323249.14370533766, 457130.4649329579, 107701.94813791133, 80297.87963331824, -28570.489567112952, 304171.49412022, 269090.06596928183, 65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [10112.059839800448, 110899.26216309656, -14589.905127611995, 57430.21812778672, 107363.69602729, 3393.731213819638, 5487.810498201064, 49974.67021994216, -29155.518737044775, 45653.142783773656, 112505.21753135989, 30440.90501552109, 4250.520916433096, -16816.67467128079, 92870.84226055263, 50912.40665301913, 21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904], "policy_policy_mean_reward": [291.0629353399404, 90239.93475842565, -20227.292774768604, 79199.40752733573, 137004.68853911752, -13124.72811262296, -27270.833203908223, 23188.395385653803, -12521.142634656831, 68017.90718830489, 123037.32704064545, 16595.062189406493, 26319.723428027202, 19390.141546012357, 78775.44635310181, 71018.11262204117, 6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343], "policy_policy_mm_reward": [-11983.357542828358, 113898.44178100754, -3973.259688403634, 72620.96236326157, 112817.316999197, -1321.2451531368936, 17521.52745857988, 54816.05074006554, -12770.498284599767, 86326.01839080005, 80648.22103612464, 22887.8665935442, 21649.34589717027, -17363.376999347965, 75568.27859589216, 64232.21980625725, 14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802], "policy_policy_rl_reward": [-10856.242555556613, 183583.81203288495, 1798.3804947056187, 65583.69870372438, 132791.70963967548, -14393.489705380205, -4650.750736458967, 36319.586519420925, -27310.20201313445, 123252.07534245923, 140939.69932482787, 37778.11433943953, 28078.289391687656, -13780.579442496522, 56956.92691067345, 82927.3268879641, 22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22940193196984382, "mean_inference_ms": 0.7421296948421605, "mean_action_processing_ms": 0.11584133241090008, "mean_env_wait_ms": 0.16982837085147806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007064938545227051, "StateBufferConnector_ms": 0.0006899833679199219, "ViewRequirementAgentConnector_ms": 0.017721951007843018}, "num_episodes": 16, "episode_return_max": 1083289.290723151, "episode_return_min": -163016.94044088648, "episode_return_mean": 196489.6938983786, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 628.4465553297608, "num_env_steps_trained_throughput_per_sec": 628.4465553297608, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5712.095, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5712.035, "sample_time_ms": 5154.248, "learn_time_ms": 552.621, "learn_throughput": 7238.238, "synch_weights_time_ms": 4.209}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-08", "timestamp": 1760509388, "time_this_iter_s": 6.372344970703125, "time_total_s": 108.609046459198, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d77420>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.609046459198, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.099999999999994, "ram_util_percent": 83.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9709869623184204, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.936549898982047, "policy_loss": -0.02469333287444897, "vf_loss": 9.957681143283844, "vf_explained_var": 2.9783695936203004e-07, "kl": 0.017810550193644394, "entropy": 4.810332080721855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1083289.290723151, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 210913.39681577258, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -47097.93055807722, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 223733.41471690388, "policy_mean": 240133.69313105813, "policy_mm": 295074.2899947176, "policy_rl": 415254.4442639835}, "policy_reward_mean": {"policy_mom": 49616.49368067285, "policy_mean": 51711.80467348527, "policy_mm": 52113.45698910838, "policy_rl": 57471.64147250613}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49616.484375, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 223733.421875, "('mean_0', 'policy_mean')_total_reward_mean": 51711.80078125, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 52113.46484375, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57471.640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 415254.4375}, "hist_stats": {"episode_reward": [65245.36124076627, 268956.06090953026, 92217.61411251618, 275540.14681128983, 43975.1689249779, 178939.41233492474, 434404.24504514656, 201560.41513194557, 127918.04280090214, -79660.6061201548, -97299.14190008312, 1083289.290723151, -71853.49948440732, 113.75375620894434, 234671.91664976202, 110633.09787908291, -44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [21369.86361485961, 52959.32267432628, 18684.163938919603, 90935.62429038166, 23889.48720304668, 33237.651411168146, 84498.98140100378, 41652.4654188795, 38664.23114723713, -26108.021447187708, -15776.263130423298, 223733.41471690388, -24010.52964571553, 9658.352036724105, 41603.02584302057, 10782.91638014389, -11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132], "policy_policy_mean_reward": [6560.183513331429, 51548.82394328628, 19282.834367521467, 71207.50081020403, 2055.1045191210023, 52374.602755309454, 143550.0119029065, 46571.53394806149, 39633.203673348995, -21063.74595248948, -24667.337223920764, 190193.3301089145, -7156.745588999312, 13425.303051193854, 64571.97005543393, 28919.336207316825, -3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192], "policy_policy_mm_reward": [14577.358553028953, 58485.96849996905, 30083.202066414273, 40832.712341992716, 10552.093244527023, 39077.17249222522, 88935.36768498614, 62169.11815460617, 18960.967621263335, -24550.602827902436, -29467.320685152732, 254108.1016333491, -20962.119345200343, -19185.6691546582, 45710.72957951381, 33769.04866043457, -12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693], "policy_policy_rl_reward": [22737.955559546182, 105961.94579194885, 24167.413739660806, 72564.30936871152, 7478.483958283167, 54249.98567622198, 117419.88405625011, 51167.29761039872, 30659.64035905257, -7938.23589257516, -27388.22086058629, 415254.4442639835, -19724.104904492186, -3784.2321770508024, 82786.19117179353, 37161.7966311873, -17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22960906417092475, "mean_inference_ms": 0.7421934195709987, "mean_action_processing_ms": 0.11587191257646348, "mean_env_wait_ms": 0.16991162489850667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007256865501403809, "StateBufferConnector_ms": 0.0007017850875854492, "ViewRequirementAgentConnector_ms": 0.01824408769607544}, "num_episodes": 16, "episode_return_max": 1083289.290723151, "episode_return_min": -163016.94044088648, "episode_return_mean": 210913.39681577258, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 697.0748081230419, "num_env_steps_trained_throughput_per_sec": 697.0748081230419, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5664.338, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5664.28, "sample_time_ms": 5107.182, "learn_time_ms": 551.975, "learn_throughput": 7246.7, "synch_weights_time_ms": 4.203}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-13", "timestamp": 1760509393, "time_this_iter_s": 5.743310928344727, "time_total_s": 114.35235738754272, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db74c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.35235738754272, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.955555555555556, "ram_util_percent": 83.55555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.025254726409912, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.941309332847595, "policy_loss": -0.020198473148047923, "vf_loss": 9.958053150773049, "vf_explained_var": 1.1719763278961182e-06, "kl": 0.017273176456774408, "entropy": 4.759154841303825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 824740.2185233282, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 226522.67708814467, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -47097.93055807722, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 204920.0919274779, "policy_mean": 240133.69313105813, "policy_mm": 295074.2899947176, "policy_rl": 242625.40668270335}, "policy_reward_mean": {"policy_mom": 53529.470681844345, "policy_mean": 55465.76100840796, "policy_mm": 58356.50660307539, "policy_rl": 59170.93879481702}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53529.4765625, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 204920.09375, "('mean_0', 'policy_mean')_total_reward_mean": 55465.765625, "('mean_0', 'policy_mean')_total_reward_min": -47097.9296875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 58356.51171875, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 295074.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59170.93359375, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 242625.40625}, "hist_stats": {"episode_reward": [-44631.18539472136, 81038.84811741512, 294825.1424639291, 296696.13074021705, -29714.37626854667, 145433.11486021662, 1702.9858691905463, 641853.7142301184, 267598.28946266504, 293422.7410136713, 213154.72195849393, -155045.9543944369, -38120.055537233544, 824740.2185233282, 208586.10652509882, 125174.37296687787, 676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-11278.864281399721, 17044.93690618038, 83602.14758845394, 49480.78033483089, 5013.864584115608, 51547.73196014207, 4283.425494515105, 151097.63055556835, 84426.40285956864, 67034.83657816179, 68837.83077664916, -27990.697210874838, -13302.663466165313, 189188.2788524475, 39110.706324199535, 10088.388060117122, 144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246], "policy_policy_mean_reward": [-3542.947386888735, 40858.033588169215, 61282.815272350985, 105475.33501363195, -19185.1439529473, 25369.011325372496, -6026.212707415128, 147194.03147488218, 67685.41607885156, 76360.94631354598, 56126.61376348379, -47097.93055807722, -8871.493204039838, 143078.20311082824, 32413.609283711667, 46408.86820436634, 174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964], "policy_policy_mm_reward": [-12488.80758609408, 10726.931590342358, 72182.61377721906, 66483.63896835966, -1475.0526657404382, 38434.8810686284, -2081.753966787097, 179797.1970162368, 55966.66336773358, 78426.3417784605, 36124.20764702078, -39222.20483685811, -8052.228575774483, 295074.2899947176, 54981.16505863304, 45298.99369544609, 150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721], "policy_policy_rl_reward": [-17320.566140338706, 12408.946032723305, 77757.56582590571, 75256.37642339466, -14068.04423397445, 30081.490506073435, 5527.527048877645, 163764.85518343098, 59519.80715651082, 71600.61634350283, 52066.069771340735, -40735.12178862662, -7893.670291253918, 197399.44656533553, 82080.62585855482, 23378.12300694839, 208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22975475962881775, "mean_inference_ms": 0.7424880995527429, "mean_action_processing_ms": 0.11593754653114846, "mean_env_wait_ms": 0.17005415695127993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007293820381164551, "StateBufferConnector_ms": 0.0007152557373046875, "ViewRequirementAgentConnector_ms": 0.018469929695129395}, "num_episodes": 16, "episode_return_max": 824740.2185233282, "episode_return_min": -163016.94044088648, "episode_return_mean": 226522.67708814467, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.1294372006657, "num_env_steps_trained_throughput_per_sec": 711.1294372006657, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5672.914, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5672.868, "sample_time_ms": 5115.279, "learn_time_ms": 551.905, "learn_throughput": 7247.618, "synch_weights_time_ms": 4.734}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-19", "timestamp": 1760509399, "time_this_iter_s": 5.632490158081055, "time_total_s": 119.98484754562378, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4d300>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.98484754562378, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 47.4875, "ram_util_percent": 83.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0568848848342896, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939868241548538, "policy_loss": -0.020976326380332467, "vf_loss": 9.957204633951187, "vf_explained_var": 5.207955837249756e-07, "kl": 0.018199770902720142, "entropy": 4.850922837853432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 812748.2426433789, "episode_reward_min": -163016.94044088648, "episode_reward_mean": 218071.01525582795, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -42864.50697557394, "policy_mean": -35779.57892676388, "policy_mm": -40416.636901171434, "policy_rl": -43956.21763737696}, "policy_reward_max": {"policy_mom": 204920.0919274779, "policy_mean": 240133.69313105813, "policy_mm": 199190.81792024366, "policy_rl": 242625.40668270335}, "policy_reward_mean": {"policy_mom": 51269.28505067297, "policy_mean": 53138.93044751468, "policy_mm": 55965.86144732392, "policy_rl": 57696.938310316385}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51269.28515625, "('mom_0', 'policy_mom')_total_reward_min": -42864.5078125, "('mom_0', 'policy_mom')_total_reward_max": 204920.09375, "('mean_0', 'policy_mean')_total_reward_mean": 53138.93359375, "('mean_0', 'policy_mean')_total_reward_min": -35779.578125, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 55965.859375, "('mm_0', 'policy_mm')_total_reward_min": -40416.63671875, "('mm_0', 'policy_mm')_total_reward_max": 199190.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57696.93359375, "('rl_trader_0', 'policy_rl')_total_reward_min": -43956.21875, "('rl_trader_0', 'policy_rl')_total_reward_max": 242625.40625}, "hist_stats": {"episode_reward": [676863.2314353441, 17018.56039939517, 86025.68134173262, 226719.11735242032, 212838.47413273566, 427135.1788066307, 115907.62460644859, 225933.22395499065, 38299.33145999239, 309218.77021429833, 97824.46336206769, 312283.28097080917, -25229.051101412522, 239671.14079573154, 163360.20168797378, -163016.94044088648, 812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [144176.11202842265, -821.1308900736963, 21608.995521435376, 73059.49414745835, 58779.09850829121, 87938.99019982129, 28533.716020006697, 64959.304328454775, 14896.293657834196, 69799.42524644223, 12825.173086580435, 88878.67200171476, -4502.555153998016, 75136.43908327814, 40145.29805292087, -42864.50697557394, 204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283], "policy_policy_mean_reward": [174021.89467635239, 20681.364152562055, 25769.841525023836, 66225.97244464526, 31331.072447042858, 93008.04844673067, 58488.12847778662, 56642.60342778439, -8489.508638514799, 59578.216180767544, 20485.532256873146, 92095.65009983326, -847.2307988011814, 44111.89160671262, 30661.28699704104, -35779.57892676388, 240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244], "policy_policy_mm_reward": [150046.68381257396, -12145.567497166081, 31017.018716767656, 52383.457719889455, 70434.89225184052, 144179.1079772801, 22111.921810258067, 62389.51232228897, 24037.775275385677, 61843.36560493737, 32411.34602728304, 62509.66634725885, 3565.062492570882, 75261.07747233481, 53595.08981010077, -40416.636901171434, 162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216], "policy_policy_rl_reward": [208618.54091799498, 9303.894634072898, 7629.8255785058, 35050.19304042734, 52293.41092556079, 102009.03218279827, 6773.858298397287, 41941.80387646262, 7854.771165287534, 117997.76318215125, 32102.411991330977, 68799.2925220023, -23444.327641184143, 45161.7326334062, 38958.52682791095, -43956.21763737696, 204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22990472695436226, "mean_inference_ms": 0.7429206747118152, "mean_action_processing_ms": 0.11602425564313262, "mean_env_wait_ms": 0.17023124774636375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007413625717163086, "StateBufferConnector_ms": 0.0007207393646240234, "ViewRequirementAgentConnector_ms": 0.018536388874053955}, "num_episodes": 16, "episode_return_max": 812748.2426433789, "episode_return_min": -163016.94044088648, "episode_return_mean": 218071.01525582795, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 712.7964714203607, "num_env_steps_trained_throughput_per_sec": 712.7964714203607, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5670.604, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5670.557, "sample_time_ms": 5118.145, "learn_time_ms": 547.35, "learn_throughput": 7307.939, "synch_weights_time_ms": 4.138}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-25", "timestamp": 1760509405, "time_this_iter_s": 5.6155478954315186, "time_total_s": 125.6003954410553, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4dda0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 125.6003954410553, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 40.775000000000006, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1672675609588623, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.941652637720107, "policy_loss": -0.02008708158682566, "vf_loss": 9.9583221077919, "vf_explained_var": 4.6566128730773926e-07, "kl": 0.01708812869715088, "entropy": 4.932875844836235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 818070.6035702559, "episode_reward_min": -102755.06500955237, "episode_reward_mean": 233234.49611067172, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35098.25566389924, "policy_mean": -32169.809647586168, "policy_mm": -29419.62776570976, "policy_rl": -24156.215325164132}, "policy_reward_max": {"policy_mom": 225344.33752174786, "policy_mean": 240133.69313105813, "policy_mm": 199190.81792024366, "policy_rl": 274968.7569074206}, "policy_reward_mean": {"policy_mom": 54932.667463424725, "policy_mean": 56385.41407315593, "policy_mm": 58272.99534811583, "policy_rl": 63643.419225975274}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54932.6640625, "('mom_0', 'policy_mom')_total_reward_min": -35098.25390625, "('mom_0', 'policy_mom')_total_reward_max": 225344.34375, "('mean_0', 'policy_mean')_total_reward_mean": 56385.421875, "('mean_0', 'policy_mean')_total_reward_min": -32169.810546875, "('mean_0', 'policy_mean')_total_reward_max": 240133.6875, "('mm_0', 'policy_mm')_total_reward_mean": 58272.98828125, "('mm_0', 'policy_mm')_total_reward_min": -29419.626953125, "('mm_0', 'policy_mm')_total_reward_max": 199190.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63643.4140625, "('rl_trader_0', 'policy_rl')_total_reward_min": -24156.21484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 274968.75}, "hist_stats": {"episode_reward": [812748.2426433789, 354116.41904472484, 216390.7192938644, 152038.46892052516, 806786.6509892025, 270175.4634982516, 336091.7820725117, 199073.86541418673, 253364.90454169427, 512426.0509597558, -35253.61408576495, 115531.2765255855, 52133.56806924842, 25070.24787016005, 136905.3925922406, 205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [204920.0919274779, 78205.9511788553, 53418.93300229384, 30782.264849079984, 180584.4125735858, 48636.9005228653, 75267.69602257929, 35733.85246014305, 70876.09969696867, 140866.28186283773, -10776.11434011704, 26715.888538194562, 22615.706166812106, 15081.353999152327, 26063.812943452856, 64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915], "policy_policy_mean_reward": [240133.69313105813, 101084.14670795528, 42044.63327327328, 43979.09452371565, 233930.63684057118, 63599.686593579354, 102081.98010181132, 40867.06509952792, 73782.83935950755, 115594.31818799127, -11415.481803730025, 14304.973707610903, 17593.165002415386, 3828.2033563732675, 39963.41418151278, 54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475], "policy_policy_mm_reward": [162750.257953196, 77836.74718497843, 55306.125695505936, 42731.56054496771, 169530.01535008106, 88948.02529099003, 67001.68556740416, 68558.43562292577, 40030.99657911816, 149388.31395406544, -9779.988956202387, 22909.768193306572, 3575.206755962085, 2175.880391101863, 30166.171715005024, 36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335], "policy_policy_rl_reward": [204944.1996316466, 96989.57397293596, 65621.02732279131, 34545.54900276208, 222741.58622496566, 68990.85109081637, 91740.42038071658, 53914.512231589724, 68674.96890609969, 106577.13695486162, -3282.028985715417, 51600.646086473585, 8349.490144058844, 3984.810123532598, 40711.99375226963, 50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23007293920285657, "mean_inference_ms": 0.7435690265403682, "mean_action_processing_ms": 0.11611911221570584, "mean_env_wait_ms": 0.1704130874444843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007423162460327148, "StateBufferConnector_ms": 0.0007224082946777344, "ViewRequirementAgentConnector_ms": 0.018543243408203125}, "num_episodes": 16, "episode_return_max": 818070.6035702559, "episode_return_min": -102755.06500955237, "episode_return_mean": 233234.49611067172, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 690.2115018273275, "num_env_steps_trained_throughput_per_sec": 690.2115018273275, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5701.956, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5701.911, "sample_time_ms": 5136.5, "learn_time_ms": 560.343, "learn_throughput": 7138.489, "synch_weights_time_ms": 4.142}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-30", "timestamp": 1760509410, "time_this_iter_s": 5.8000710010528564, "time_total_s": 131.40046644210815, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4c040>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.40046644210815, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 81.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0313875675201416, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939511930942535, "policy_loss": -0.021776467995368875, "vf_loss": 9.95805533528328, "vf_explained_var": 8.238479495048523e-07, "kl": 0.016165154226882902, "entropy": 4.948813039064407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 818070.6035702559, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 217536.41377470962, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -26688.35122012107}, "policy_reward_max": {"policy_mom": 225344.33752174786, "policy_mean": 236341.51959050272, "policy_mm": 199190.81792024366, "policy_rl": 274968.7569074206}, "policy_reward_mean": {"policy_mom": 52311.03986373577, "policy_mean": 51431.69190438677, "policy_mm": 53986.66936316251, "policy_rl": 59807.01264342463}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52311.0390625, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 225344.34375, "('mean_0', 'policy_mean')_total_reward_mean": 51431.69140625, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 236341.515625, "('mm_0', 'policy_mm')_total_reward_mean": 53986.6640625, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 199190.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59807.01171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -26688.3515625, "('rl_trader_0', 'policy_rl')_total_reward_max": 274968.75}, "hist_stats": {"episode_reward": [205746.61344821804, 163225.89068136044, 27155.757597423973, 265995.31460001046, 352683.09334779857, 172186.3522071386, 121393.25197186718, 246228.71735353832, 228877.7504594544, 99149.26827770734, 105625.42851221685, -5031.107727045101, 265665.63287015044, 272298.0879712717, 215525.32084473612, 121740.91717411754, -80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [64171.157389876906, 24479.777404162982, 24371.825699660185, 75099.19651355936, 75590.93672432148, 18216.477690126274, 33717.71304279932, 69115.10829144914, 39073.77131253656, 29118.311895662453, 11409.794816927315, 10592.50761866603, 69432.48241628837, 15929.374686752146, 56735.950620007774, 26537.345674972083, -12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713], "policy_policy_mean_reward": [54601.61611196162, 51720.90002856287, -12807.013548866891, 81610.31799242139, 89967.8427462809, 78114.78880485617, 8480.045133788757, 54404.95993017838, 77804.3325895159, 35503.48907724315, 34560.666342273194, -901.6288908433675, 48990.3568523461, 95290.34665837012, 60315.28187525794, 30457.30530096732, -32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933], "policy_policy_mm_reward": [36029.97377423528, 47939.05282099504, 4739.942848184935, 60386.078079245315, 80158.29414098924, 41666.99653289339, 31470.496139741703, 20604.07235678782, 40872.098014993106, 2100.641060354135, 32005.650903948015, 7398.585681615164, 64663.16361967812, 59284.04247225099, 45020.52715113497, 46488.475466473836, -22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845], "policy_policy_rl_reward": [50943.86617214438, 39086.160427639516, 10851.002598445737, 48899.72201478415, 106966.0197362066, 34188.08917926282, 47724.9976555377, 102104.5767751234, 71127.54854240915, 32426.82624444756, 27649.31644906848, -22120.572136482948, 82579.62998183792, 101794.3241538985, 53453.56119833543, 18257.790731704317, -13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23024041843875076, "mean_inference_ms": 0.7441244931033819, "mean_action_processing_ms": 0.11620342657784953, "mean_env_wait_ms": 0.17056376815547783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007352828979492188, "StateBufferConnector_ms": 0.0007135868072509766, "ViewRequirementAgentConnector_ms": 0.018511950969696045}, "num_episodes": 15, "episode_return_max": 818070.6035702559, "episode_return_min": -136278.88714393263, "episode_return_mean": 217536.41377470962, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.1263441528691, "num_env_steps_trained_throughput_per_sec": 707.1263441528691, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5721.087, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5721.042, "sample_time_ms": 5149.541, "learn_time_ms": 566.414, "learn_throughput": 7061.971, "synch_weights_time_ms": 4.157}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-36", "timestamp": 1760509416, "time_this_iter_s": 5.660722970962524, "time_total_s": 137.06118941307068, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fce0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.06118941307068, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.9375, "ram_util_percent": 81.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1092907190322876, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.934804835915566, "policy_loss": -0.027022659589420073, "vf_loss": 9.957885095477105, "vf_explained_var": 1.5664845705032348e-07, "kl": 0.0197121266364321, "entropy": 4.932337184250355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 818070.6035702559, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 227636.96228607176, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -26688.35122012107}, "policy_reward_max": {"policy_mom": 225344.33752174786, "policy_mean": 236341.51959050272, "policy_mm": 199190.81792024366, "policy_rl": 274968.7569074206}, "policy_reward_mean": {"policy_mom": 55313.67273810723, "policy_mean": 52676.940089164855, "policy_mm": 56326.37878062199, "policy_rl": 63319.97067817782}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55313.671875, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 225344.34375, "('mean_0', 'policy_mean')_total_reward_mean": 52676.94140625, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 236341.515625, "('mm_0', 'policy_mm')_total_reward_mean": 56326.37890625, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 199190.8125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63319.96484375, "('rl_trader_0', 'policy_rl')_total_reward_min": -26688.3515625, "('rl_trader_0', 'policy_rl')_total_reward_max": 274968.75}, "hist_stats": {"episode_reward": [-80728.06262925515, 299526.04298192164, 301118.2984078703, 76655.09316382078, 254855.4424137202, 327215.53490396397, 363406.6461879786, 280634.7397329243, 233873.86027603596, 575077.3952347285, 264246.1783294651, 591153.3067078157, 197567.79152405265, 240231.65492125362, 50224.26367037543, 263057.71550309274, -102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-12830.131506861495, 72130.36295948715, 95282.65667408552, 19151.196561570363, 59376.930862681904, 86337.08074829676, 86640.77257795948, 78946.24855205217, 61963.39827753289, 100144.71293001615, 39012.05196618995, 139892.74534843225, 66550.70992838257, 57055.7117841134, 11398.862683194508, 49671.64131260722, -35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099], "policy_policy_mean_reward": [-32169.809647586168, 93187.66870631947, 58887.77158740641, 18550.64982368569, 25215.02071513343, 67487.27913524072, 51023.933235646626, 68700.41158125816, 75200.76902915895, 169540.90648964612, 81846.35466232001, 107740.03851608677, 11098.000211375394, 88995.43170875174, 22435.40664361651, 61663.17961545555, -14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337], "policy_policy_mm_reward": [-22561.431431687415, 76851.74348987934, 86484.7264491391, 31226.172751920752, 67511.13201744802, 74514.70409629324, 118013.43620901916, 72834.95447435364, 27690.465261395904, 140785.72147603825, 75006.9165633473, 163380.99179197577, 70305.63465926875, 38944.35166810676, 10716.06343734128, 81082.72009435909, -29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816], "policy_policy_rl_reward": [-13166.690043119996, 57356.2678262353, 60463.143697239284, 7727.074026644038, 102752.35881845714, 98876.47092413287, 107728.50416535379, 60153.12512526034, 69019.2277079479, 164606.05433902718, 68380.85513760778, 180139.5310513222, 49613.44672502594, 55236.15976028235, 5673.930906223364, 70640.174480671, -24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23032235603795492, "mean_inference_ms": 0.7442834025394709, "mean_action_processing_ms": 0.11625258217531229, "mean_env_wait_ms": 0.17063139367900465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007353425025939941, "StateBufferConnector_ms": 0.0007240772247314453, "ViewRequirementAgentConnector_ms": 0.018508076667785645}, "num_episodes": 16, "episode_return_max": 818070.6035702559, "episode_return_min": -136278.88714393263, "episode_return_mean": 227636.96228607176, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 691.1999883984377, "num_env_steps_trained_throughput_per_sec": 691.1999883984377, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 5742.446, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5742.4, "sample_time_ms": 5170.902, "learn_time_ms": 566.511, "learn_throughput": 7060.767, "synch_weights_time_ms": 4.32}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-42", "timestamp": 1760509422, "time_this_iter_s": 5.792404890060425, "time_total_s": 142.8535943031311, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d2ba60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 142.8535943031311, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 40.5875, "ram_util_percent": 83.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1150075197219849, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939295846223832, "policy_loss": -0.024639912898419426, "vf_loss": 9.960234892368316, "vf_explained_var": -5.971640348434449e-07, "kl": 0.018504437240346762, "entropy": 4.9244588136672975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 818070.6035702559, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 213446.74807847512, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -26688.35122012107}, "policy_reward_max": {"policy_mom": 225344.33752174786, "policy_mean": 236341.51959050272, "policy_mm": 245378.77476613573, "policy_rl": 274968.7569074206}, "policy_reward_mean": {"policy_mom": 51216.43149833616, "policy_mean": 50176.249687165146, "policy_mm": 53196.43702742287, "policy_rl": 58857.62986555093}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51216.43359375, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 225344.34375, "('mean_0', 'policy_mean')_total_reward_mean": 50176.25, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 236341.515625, "('mm_0', 'policy_mm')_total_reward_mean": 53196.44140625, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58857.62890625, "('rl_trader_0', 'policy_rl')_total_reward_min": -26688.3515625, "('rl_trader_0', 'policy_rl')_total_reward_max": 274968.75}, "hist_stats": {"episode_reward": [-102755.06500955237, 269675.12531156605, 628678.1271334133, -58520.13558476187, 93861.61752718494, 307167.3199100027, 225636.59151901683, 39223.21272260972, 395058.6872865172, 112128.90077417169, 274575.68022351805, 638154.3495245221, 260453.4763857194, 269247.09260393307, 112285.28145630794, 366465.1843970627, 783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-35098.25566389924, 53890.99853070032, 147622.751526083, -21190.290340684413, 36606.10852058132, 95798.75876034178, 46756.320803365066, 5702.95951112418, 85594.81789773639, 34552.5719486729, 73317.86126294892, 165531.14556966556, 35590.647147510164, 74184.62313584785, 28518.00502228577, 83068.38790523674, 143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696], "policy_policy_mean_reward": [-14080.966254779292, 71048.82137914198, 122672.59792736036, -17614.82535548713, 7745.602285846192, 79907.83593596784, 74820.27312663014, 10517.552110307992, 98146.53517400331, 29514.959802967, 68539.43147905648, 117152.77664758795, 47882.72364593257, 41858.52549734415, 25783.550689926487, 78218.16840572827, 236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908], "policy_policy_mm_reward": [-29419.62776570976, 66367.77716722034, 179596.3279375119, -5063.075031875373, 28621.922596191693, 76689.32251861412, 45982.94866033564, 22758.911236057364, 108116.38920398818, 22657.092659375965, 89858.69754242858, 199190.81792024366, 99286.93348516374, 88170.51017921597, 24302.278615251125, 111518.47174280864, 161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573], "policy_policy_rl_reward": [-24156.215325164132, 78367.52823450346, 178786.4497424584, -14651.944856715047, 20887.984124565777, 54771.402695078395, 58077.04892868596, 243.78986512013168, 103200.9450107897, 25404.276363155794, 42859.68993908412, 156279.60938702532, 77693.17210711293, 65033.433791525036, 33681.44712884448, 93660.15634328901, 242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23032680478967685, "mean_inference_ms": 0.744334932127588, "mean_action_processing_ms": 0.11626709027638756, "mean_env_wait_ms": 0.17062979295719116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007164478302001953, "StateBufferConnector_ms": 0.0007075071334838867, "ViewRequirementAgentConnector_ms": 0.0179443359375}, "num_episodes": 16, "episode_return_max": 818070.6035702559, "episode_return_min": -136278.88714393263, "episode_return_mean": 213446.74807847512, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.6262980176908, "num_env_steps_trained_throughput_per_sec": 692.6262980176908, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 5770.139, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5770.092, "sample_time_ms": 5196.717, "learn_time_ms": 568.285, "learn_throughput": 7038.72, "synch_weights_time_ms": 4.418}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-48", "timestamp": 1760509428, "time_this_iter_s": 5.779879093170166, "time_total_s": 148.63347339630127, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7100>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.63347339630127, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 45.333333333333336, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.203303337097168, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.938443702459335, "policy_loss": -0.02467199992679525, "vf_loss": 9.95953494310379, "vf_explained_var": -2.6337802410125733e-07, "kl": 0.017903868733265087, "entropy": 4.912409646809101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 840778.1768114977, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 223862.60458415718, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -26688.35122012107}, "policy_reward_max": {"policy_mom": 236092.6532078369, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 54576.246736739864, "policy_mean": 52283.02552623742, "policy_mm": 52887.77248267755, "policy_rl": 64115.559838502304}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54576.25, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 236092.65625, "('mean_0', 'policy_mean')_total_reward_mean": 52283.0234375, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 52887.7734375, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64115.56640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -26688.3515625, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [783582.171119195, 367202.9164217123, 152661.84215722955, -9132.086300674206, 134868.68585192523, 179020.82940831545, 557673.3643245016, 99.97467061884966, 196582.38991964728, 356381.88922710286, 6064.430066760737, -20997.466974996914, -11193.418181201147, -51205.422601355494, 171107.14735781652, -27204.80717508933, 423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [143548.77591070958, 59105.67904919127, 47739.798585729564, 619.6357793092938, 37442.39768076246, 34502.00059442504, 145273.17984911316, 22029.098481532612, 37208.17503624153, 76948.6572638226, -975.8981469595345, -2327.6313813394067, -7186.230866601155, -12347.364692560112, 35044.607690172736, -15237.928200039356, 93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443], "policy_policy_mean_reward": [236341.51959050272, 95118.13483295885, 27906.348008172008, -6877.684804744824, 27570.89344046964, 46555.188656632876, 82470.79614181424, 5891.890086433961, 69511.22969498795, 75782.3544636917, 79.12224903086447, -2624.8383085470145, -4952.561382227779, -25357.378845326064, 39876.53347439658, 4701.65382125498, 90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363], "policy_policy_mm_reward": [161066.4689352796, 98422.52324373642, 42524.499793700925, 1172.880940320687, 35682.34323957721, 49976.93698518225, 131011.49367337931, -7003.832983637966, 38085.47400461981, 112240.52383078562, -2844.5818536812, -6955.298885167073, 2085.0358291667544, -1495.1189921798536, 52354.36279592378, -3916.82836448265, 126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447], "policy_policy_rl_reward": [242625.40668270335, 114556.5792958261, 34491.19576962694, -4046.9182155593458, 34173.05149111569, 47986.70317207569, 198917.89466019502, -20817.180913709744, 51777.51118379813, 91410.35366880264, 9805.787818370574, -9089.698399943429, -1139.6617615389416, -12005.560071289425, 43831.643397323496, -12751.704431822198, 112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23035560632796412, "mean_inference_ms": 0.744511432343273, "mean_action_processing_ms": 0.11628879858551155, "mean_env_wait_ms": 0.17066167269558272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000720977783203125, "StateBufferConnector_ms": 0.0007120370864868164, "ViewRequirementAgentConnector_ms": 0.01815354824066162}, "num_episodes": 16, "episode_return_max": 840778.1768114977, "episode_return_min": -136278.88714393263, "episode_return_mean": 223862.60458415718, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.5399240216183, "num_env_steps_trained_throughput_per_sec": 680.5399240216183, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 5795.698, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5795.651, "sample_time_ms": 5218.432, "learn_time_ms": 572.18, "learn_throughput": 6990.808, "synch_weights_time_ms": 4.386}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-54", "timestamp": 1760509434, "time_this_iter_s": 5.883792877197266, "time_total_s": 154.51726627349854, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7e20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.51726627349854, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 43.1125, "ram_util_percent": 83.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1492424011230469, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.942082330584526, "policy_loss": -0.02188158472417854, "vf_loss": 9.960251089930534, "vf_explained_var": -3.5464763641357423e-07, "kl": 0.01856414095504999, "entropy": 4.897413469851017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 244453.31147529648, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -27110.525372837703}, "policy_reward_max": {"policy_mom": 236092.6532078369, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 59891.46812810517, "policy_mean": 56926.364797213544, "policy_mm": 58333.024563137275, "policy_rl": 69302.45398684038}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 59891.46875, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 236092.65625, "('mean_0', 'policy_mean')_total_reward_mean": 56926.36328125, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 58333.03125, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69302.4609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -27110.525390625, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [423957.08782283857, 85211.92490374167, 203179.48053742704, 219093.14295362672, -6221.91435514894, 711366.3267418118, 76486.91130331425, 220630.62813217184, 124330.86745798, 33172.06563271597, 66176.90743162537, 221835.45077722555, 269493.73673767113, 188143.92012066866, 196081.48655411988, 359456.6974859784, 324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [93961.18973180614, 14303.714671737316, 56548.277662270746, 39705.8594554939, 24716.465650255283, 225344.33752174786, 11105.667830307448, 30514.67564828193, 45130.615524215485, 20986.41224013405, 12510.237215232419, 44813.9646771927, 84686.77946326754, 42961.44924981189, 36163.8952250845, 58355.62024139942, 101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799], "policy_policy_mean_reward": [90896.7335949286, 10046.389460980236, 57789.607853487585, 50609.60354634937, -16430.224977391244, 127429.41089426287, 9748.608464256638, 62581.182997374955, 21900.519565386396, -13459.018584760403, 31748.297920065586, 50043.91807701026, 67271.436429085, 47877.34833596284, 47901.8541548563, 113919.4076844947, 73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977], "policy_policy_mm_reward": [126749.37838866403, 18097.868535468468, 51470.50349126578, 74722.47980947114, -3466.035508381216, 109601.58176016001, 23271.117644160342, 53621.24465170532, 42101.95259692802, 11693.303227590848, 20979.771102235278, 70728.88386103167, 47476.26680131657, 44322.717470736985, 59718.45434632798, 105810.52325000477, 53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396], "policy_policy_rl_reward": [112349.78610743993, 42763.952235555545, 37371.09153040279, 54055.20014231233, -11042.119519631711, 248990.99656564114, 32361.51736458986, 73913.5248348095, 15197.77977144991, 13951.368749751438, 938.601194091926, 56248.684161991136, 70059.25404400194, 52982.405064157225, 52297.28282785095, 81371.14631008075, 94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2303631227788027, "mean_inference_ms": 0.7446442145666538, "mean_action_processing_ms": 0.11630131450581023, "mean_env_wait_ms": 0.1706771867525357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007075071334838867, "StateBufferConnector_ms": 0.0006998181343078613, "ViewRequirementAgentConnector_ms": 0.017959773540496826}, "num_episodes": 16, "episode_return_max": 875754.9923428028, "episode_return_min": -136278.88714393263, "episode_return_mean": 244453.31147529648, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 714.2400527484414, "num_env_steps_trained_throughput_per_sec": 714.2400527484414, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 5783.205, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5783.163, "sample_time_ms": 5207.528, "learn_time_ms": 571.203, "learn_throughput": 7002.763, "synch_weights_time_ms": 3.784}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "26ec2_00000", "date": "2025-10-15_01-23-59", "timestamp": 1760509439, "time_this_iter_s": 5.6051390171051025, "time_total_s": 160.12240529060364, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x142c7c9a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.12240529060364, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.474999999999994, "ram_util_percent": 83.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1972734928131104, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939388853311538, "policy_loss": -0.019904474401846527, "vf_loss": 9.956047281622887, "vf_explained_var": 2.8312206268310546e-08, "kl": 0.01623019208213931, "entropy": 4.8735301285982136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -136278.88714393263, "episode_reward_mean": 241713.7400727191, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37608.73539279776, "policy_mean": -36602.017153111265, "policy_mm": -46733.44472971329, "policy_rl": -31613.839637749352}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 59700.872345801654, "policy_mean": 55418.76634202052, "policy_mm": 56151.493994610886, "policy_rl": 70442.60739028595}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 59700.87109375, "('mom_0', 'policy_mom')_total_reward_min": -37608.734375, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 55418.76953125, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 56151.5, "('mm_0', 'policy_mm')_total_reward_min": -46733.4453125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70442.609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31613.83984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [324319.50277621526, 818070.6035702559, 115123.86890554332, 548578.3997309592, 203933.00110439712, 76937.0625116276, -136278.88714393263, 216826.9788361482, 383878.5137162258, 20576.72976200954, 234243.5520534845, 356570.4630293047, 304676.050851968, 280245.83659005637, 135439.43366496082, 297539.7136177645, 122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [101858.15175856187, 148252.11069972932, 48111.29292076115, 147979.2463275731, 40112.6035948915, 23010.834315709042, -37608.73539279776, 45517.76218348892, 114012.51893663153, 20666.110003066453, 80981.7411776854, 92975.51508391109, 79750.26036026914, 72750.67836124671, 47326.26579692445, 84627.93266841376, 19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727], "policy_policy_mean_reward": [73939.56478268009, 215196.61773627513, 24314.775201574135, 130553.80733422913, 41665.8159464475, 20159.864560903658, -25248.355801300288, 56690.17980246335, 68858.05589792295, 874.0802032265048, 56494.82642408706, 79300.22525113405, 82324.25806898746, 69350.55365630137, 38592.074839617046, 83758.4215652771, 29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232], "policy_policy_mm_reward": [53669.3181584036, 179653.11822683114, 19352.072713748035, 118898.3060504509, 63038.53145999335, 12049.368927156173, -46733.44472971329, 52163.73858896749, 72233.02717428752, -694.8448901216436, 49111.594020806115, 85020.63506752405, 63155.61901698344, 65677.18429268459, 12673.940480428613, 59515.97816836156, 36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158], "policy_policy_rl_reward": [94852.46807656971, 274968.7569074206, 23345.72806946003, 151147.04001870536, 59116.05010306477, 21716.994707858783, -26688.35122012107, 62455.29826122824, 128774.91170738392, -268.61555416174417, 47655.39043090636, 99274.08762673564, 79445.91340572815, 72467.42027982353, 36847.152547990576, 69637.38121571187, 37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23039187891379392, "mean_inference_ms": 0.7447651935088385, "mean_action_processing_ms": 0.11632705751683385, "mean_env_wait_ms": 0.17072222438202836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007085204124450684, "StateBufferConnector_ms": 0.0007095932960510254, "ViewRequirementAgentConnector_ms": 0.01805669069290161}, "num_episodes": 16, "episode_return_max": 875754.9923428028, "episode_return_min": -136278.88714393263, "episode_return_mean": 241713.7400727191, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 696.0097421026086, "num_env_steps_trained_throughput_per_sec": 696.0097421026086, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 5721.419, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5721.378, "sample_time_ms": 5151.824, "learn_time_ms": 565.049, "learn_throughput": 7079.034, "synch_weights_time_ms": 3.868}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-05", "timestamp": 1760509445, "time_this_iter_s": 5.754886150360107, "time_total_s": 165.87729144096375, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6b60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.87729144096375, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 40.162499999999994, "ram_util_percent": 83.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2126073837280273, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.937654632329942, "policy_loss": -0.02407986994512612, "vf_loss": 9.957794517278671, "vf_explained_var": -6.478279829025269e-07, "kl": 0.01969995431563818, "entropy": 4.858311021327973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -100070.79460915887, "episode_reward_mean": 237691.28182775178, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -25041.91294724765, "policy_mean": -36602.017153111265, "policy_mm": -31075.20745271259, "policy_rl": -31613.839637749352}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 57643.22476124982, "policy_mean": 53702.3963572614, "policy_mm": 57253.28503878102, "policy_rl": 69092.37567045951}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57643.21875, "('mom_0', 'policy_mom')_total_reward_min": -25041.912109375, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 53702.390625, "('mean_0', 'policy_mean')_total_reward_min": -36602.015625, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 57253.2734375, "('mm_0', 'policy_mm')_total_reward_min": -31075.20703125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69092.375, "('rl_trader_0', 'policy_rl')_total_reward_min": -31613.83984375, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [122408.82578672531, 208738.60863744857, -90049.28391020648, 226037.60674977116, 178614.7745633284, 56411.921160582155, 499883.9562069028, 246001.83956425134, 274207.2736434043, 261451.02665249235, 213977.29779561353, -17849.308261163835, 548338.5920672228, 32181.990617265827, 288778.38958200393, 223928.17744611582, -7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [19817.76125630764, 48182.47601132592, -4964.687219721893, 49783.93789282713, 35782.059786060076, 35631.54493230485, 148369.9194563996, 55623.779221169934, 67989.32317491238, 43886.51595732168, 40906.490615367555, -5927.434371465506, 124621.95388515803, -6679.55276712223, 79150.3846120699, 63870.58185941718, -7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626], "policy_policy_mean_reward": [29120.545738918318, 35775.75780799967, -36602.017153111265, 66551.68052382933, 51947.86174025376, 3457.2495901858138, 101918.41645887477, 68507.90494956836, 62696.82889478646, 51426.37678421548, 67720.96110325359, 7910.10530620832, 105026.91417553498, 22173.993321310354, 72986.38703275632, 38130.30222395281, 233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243], "policy_policy_mm_reward": [36218.50561005218, 64995.179797152596, -27927.968371704315, 45038.090194206845, 35249.80929601687, 4880.9287169039, 115078.78543487268, 45743.30448853825, 76912.7346351833, 91598.36273387894, 36864.32514019272, -241.02097395722123, 114652.37291476798, 1274.5925372422712, 79385.14996588365, 55735.58603794194, -5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685], "policy_policy_rl_reward": [37252.01318144723, 59785.19502097036, -20554.611165669034, 64663.89813890757, 55635.043740998044, 12442.197921187319, 134516.83485675455, 76126.85090497456, 66608.3869385221, 74539.77117707625, 68485.5209367999, -19590.958221949444, 204037.3510917618, 15412.957525835485, 57256.46797129406, 66191.70732480395, 4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23042526547700995, "mean_inference_ms": 0.7450827198949433, "mean_action_processing_ms": 0.11636170317329324, "mean_env_wait_ms": 0.1707915366556149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007150173187255859, "StateBufferConnector_ms": 0.0007178783416748047, "ViewRequirementAgentConnector_ms": 0.01810818910598755}, "num_episodes": 16, "episode_return_max": 875754.9923428028, "episode_return_min": -100070.79460915887, "episode_return_mean": 237691.28182775178, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.9675018311805, "num_env_steps_trained_throughput_per_sec": 683.9675018311805, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 5732.415, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5732.378, "sample_time_ms": 5160.844, "learn_time_ms": 567.722, "learn_throughput": 7045.704, "synch_weights_time_ms": 3.211}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-11", "timestamp": 1760509451, "time_this_iter_s": 5.853050947189331, "time_total_s": 171.73034238815308, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4cb80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 171.73034238815308, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.18888888888889, "ram_util_percent": 83.74444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1303507089614868, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.939807584881782, "policy_loss": -0.023715159240236972, "vf_loss": 9.960293418169021, "vf_explained_var": -4.446133971214294e-07, "kl": 0.016146764179802767, "entropy": 4.745437289774418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -150204.7199147035, "episode_reward_mean": 229391.23530044974, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39075.32393179681, "policy_mean": -53284.230202306426, "policy_mm": -31075.20745271259, "policy_rl": -34450.029934743565}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 56806.673374523765, "policy_mean": 52308.266837302705, "policy_mm": 55252.31603946919, "policy_rl": 65023.979049154004}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56806.671875, "('mom_0', 'policy_mom')_total_reward_min": -39075.32421875, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 52308.26953125, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 55252.3203125, "('mm_0', 'policy_mm')_total_reward_min": -31075.20703125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 65023.9765625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.03125, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [-7871.617218806047, 572549.983216824, 74331.89916533066, 423584.9445248184, 561965.3921843448, -46009.56629461289, 580259.3341181842, -57849.94962842692, -46582.11195622909, 222179.95811637637, 34245.933727745265, 265448.5587540436, -18151.73571643011, 243811.47024693378, -100070.79460915887, 121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-7793.899207520633, 129160.35952671793, 24515.13421961135, 114747.8583345099, 123307.39316805478, -8499.256265028187, 99817.26632512306, -21815.126121779787, -19337.100079613552, 67896.68191668874, 4303.532422518733, 71613.76118492607, -18416.65236895082, 63340.71433756746, -23114.000217403933, 17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984], "policy_policy_mean_reward": [233.201698583679, 155513.8849086037, 10283.668174401173, 92704.36911963337, 121157.42663270276, -8048.596135803377, 189832.9897513719, -17220.078924111087, -10048.529500716935, 36077.98470170741, 24078.547009661506, 68089.90609826554, 13761.268241533346, 76689.64172708963, -31716.62637505766, 32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365], "policy_policy_mm_reward": [-5078.181419387366, 95404.31407040566, 28677.862965057826, 78660.10626592816, 147937.94478492645, -19627.166138173958, 179843.51821377207, -6777.8704015585645, -4679.796954219196, 27344.603397798615, 12624.225410855974, 61034.240470368146, -7291.323383340111, 45876.50260486647, -21524.747407196766, 57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979], "policy_policy_rl_reward": [4767.261709518311, 192471.42471109677, 10855.233806260143, 137472.6108047473, 169562.6275986601, -9834.54775560737, 110765.5598279176, -12036.87418097746, -12516.685421679398, 90860.68810018178, -6760.37111529096, 64710.65100048344, -6205.028205672511, 57904.611577410345, -23715.420609500514, 13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2304288388366343, "mean_inference_ms": 0.7452775415203245, "mean_action_processing_ms": 0.11637662270482792, "mean_env_wait_ms": 0.1708242873308343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007161498069763184, "StateBufferConnector_ms": 0.0007166266441345215, "ViewRequirementAgentConnector_ms": 0.01816403865814209}, "num_episodes": 16, "episode_return_max": 875754.9923428028, "episode_return_min": -150204.7199147035, "episode_return_mean": 229391.23530044974, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.4226930852158, "num_env_steps_trained_throughput_per_sec": 716.4226930852158, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5728.26, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5728.223, "sample_time_ms": 5155.154, "learn_time_ms": 569.487, "learn_throughput": 7023.861, "synch_weights_time_ms": 2.959}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-17", "timestamp": 1760509457, "time_this_iter_s": 5.588058233261108, "time_total_s": 177.31840062141418, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ff60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.31840062141418, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.4125, "ram_util_percent": 83.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2087199687957764, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.942374885082245, "policy_loss": -0.022299626815947705, "vf_loss": 9.960955706238746, "vf_explained_var": -4.965811967849732e-07, "kl": 0.018593963409057484, "entropy": 4.694771552085877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -150204.7199147035, "episode_reward_mean": 231057.82522255305, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39075.32393179681, "policy_mean": -53284.230202306426, "policy_mm": -31075.20745271259, "policy_rl": -34450.029934743565}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 252974.36697119425, "policy_mm": 245378.77476613573, "policy_rl": 281125.69530077395}, "policy_reward_mean": {"policy_mom": 57249.79357769234, "policy_mean": 52832.80711716976, "policy_mm": 56513.47545858998, "policy_rl": 64461.74906910091}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57249.796875, "('mom_0', 'policy_mom')_total_reward_min": -39075.32421875, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 52832.8046875, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 252974.359375, "('mm_0', 'policy_mm')_total_reward_mean": 56513.4765625, "('mm_0', 'policy_mm')_total_reward_min": -31075.20703125, "('mm_0', 'policy_mm')_total_reward_max": 245378.78125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64461.74609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.03125, "('rl_trader_0', 'policy_rl')_total_reward_max": 281125.6875}, "hist_stats": {"episode_reward": [121372.19970924588, 39008.44157637695, -17562.683896365997, 273235.96702928416, 763794.067208779, -34305.75154222489, 104920.01052491703, 173665.53986630775, 88816.50357335055, 30404.041282615683, 540187.2623524852, 739086.6459072011, 792245.1044682113, -43898.25192625749, 840778.1768114977, 728135.4875326819, 270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [17872.337163039756, 24250.031883615215, -16062.612391681023, 61532.537477932325, 174311.31924762696, -2951.3859827131682, 28750.874812922953, 27537.6913233673, 26694.443202349477, 12001.22862928604, 136295.1924400464, 236092.6532078369, 205112.7494823362, -25041.91294724765, 128577.6063117357, 228885.16845919492, 90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922], "policy_policy_mean_reward": [32417.004149535664, 16254.445821843023, -10031.067202943226, 62950.52727026653, 155089.12854819908, -16272.467460395244, 23466.594867518517, 35764.77450660439, 13050.428915037339, 19599.579496425504, 93163.1005519131, 172730.89146518658, 156510.11667716617, -12385.025697050249, 252974.36697119425, 97883.18714527831, 60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437], "policy_policy_mm_reward": [57818.48814377925, 3908.2860181252104, -9062.671893972109, 86991.12005611953, 245378.77476613573, 2398.2715113289237, 34377.52842765022, 52071.337675717485, 37359.572276248815, 2558.4719616834986, 135001.44526847178, 143695.62648944283, 166189.04739006722, -4305.205783663106, 178100.50822779266, 150305.87185765503, 36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769], "policy_policy_rl_reward": [13264.370252891094, -5404.322147206546, 17593.667592230475, 61761.78222496528, 189014.8446468173, -17480.169610445595, 18325.012416825346, 58291.73636061866, 11712.059179714883, -3755.2388047793925, 175727.5240920538, 186567.47474473497, 264433.1909186408, -2166.1074982963755, 281125.69530077395, 251061.26007055287, 82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23037858080118176, "mean_inference_ms": 0.7451743260038622, "mean_action_processing_ms": 0.11636176119240259, "mean_env_wait_ms": 0.1708027555079373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007147789001464844, "StateBufferConnector_ms": 0.0007154345512390137, "ViewRequirementAgentConnector_ms": 0.018084228038787842}, "num_episodes": 15, "episode_return_max": 875754.9923428028, "episode_return_min": -150204.7199147035, "episode_return_mean": 231057.82522255305, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.4847369133008, "num_env_steps_trained_throughput_per_sec": 739.4847369133008, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5708.007, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5707.97, "sample_time_ms": 5136.127, "learn_time_ms": 568.251, "learn_throughput": 7039.143, "synch_weights_time_ms": 2.958}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-22", "timestamp": 1760509462, "time_this_iter_s": 5.413424968719482, "time_total_s": 182.73182559013367, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6b60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 182.73182559013367, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.44285714285714, "ram_util_percent": 83.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3402793407440186, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.93816212117672, "policy_loss": -0.022660513750452083, "vf_loss": 9.956907534599305, "vf_explained_var": -1.3317912817001343e-07, "kl": 0.019575415489339474, "entropy": 4.675299122929573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 875754.9923428028, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 224356.29291039088, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -53284.230202306426, "policy_mm": -38260.23180864908, "policy_rl": -35655.96296917217}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 202991.47659362084, "policy_mm": 237239.35231063247, "policy_rl": 271029.7510400388}, "policy_reward_mean": {"policy_mom": 56072.72008446224, "policy_mean": 53131.60553497277, "policy_mm": 53448.38283286049, "policy_rl": 61703.58445809532}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56072.71875, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 53131.60546875, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 202991.484375, "('mm_0', 'policy_mm')_total_reward_mean": 53448.37890625, "('mm_0', 'policy_mm')_total_reward_min": -38260.23046875, "('mm_0', 'policy_mm')_total_reward_max": 237239.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 61703.5859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -35655.96484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 271029.75}, "hist_stats": {"episode_reward": [270447.96134550794, 146043.55389186094, 105390.52057894306, 256823.55060292684, 134180.7414794131, 262436.14830284176, 875754.9923428028, 125632.15292950373, -39438.59689621355, 281592.5858645851, 19649.990879728124, 566909.5896688512, 831535.4227653788, 108563.84027723956, 638878.2707391704, -63610.677878830524, 206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [90852.23686520704, 28426.72262898827, 43377.467003314574, 55369.88731728239, 26448.312623978443, 65734.37425459216, 204328.03681112363, 38999.14414147652, -5625.779313814036, 66282.59882420662, -9286.711367018435, 138344.2333529901, 210491.75648333374, 23595.87053221264, 115651.68781181295, -23836.439140551436, 74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854], "policy_policy_mean_reward": [60550.45769329034, 37561.20747756774, 29335.41218518494, 60033.37035980786, 28825.15125003363, 76676.34177513281, 166578.35742091094, 15775.346279041993, -7095.034264479229, 60595.754397684286, 11476.099886490696, 124130.97599073438, 181895.59190060123, 21259.983777545553, 168512.82645190245, -22509.678913763943, 32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998], "policy_policy_mm_reward": [36874.0248514498, 48115.7206853673, 16861.088634919543, 59627.99525293249, 38537.93946522447, 64948.41313085792, 237239.35231063247, 40130.55190962217, -15683.449943286632, 81999.7727197372, 6895.241486298366, 136602.191848877, 219008.0675795073, 31024.229346026863, 147696.84004730504, 9845.965548322476, 52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757], "policy_policy_rl_reward": [82171.24193556095, 31939.903099937677, 15816.552755523795, 81792.2976729039, 40369.33814017648, 55077.01914225868, 267609.2458001346, 30727.110599363063, -11034.333374633625, 72714.4599229569, 10565.360873957443, 167832.1884762502, 220140.00680193558, 32683.756621454493, 207016.9164281501, -27110.525372837703, 47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2302886764658046, "mean_inference_ms": 0.7449527493379753, "mean_action_processing_ms": 0.11633610017450831, "mean_env_wait_ms": 0.17075294713205535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007057785987854004, "StateBufferConnector_ms": 0.0007088780403137207, "ViewRequirementAgentConnector_ms": 0.01786673069000244}, "num_episodes": 16, "episode_return_max": 875754.9923428028, "episode_return_min": -169687.2425257917, "episode_return_mean": 224356.29291039088, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.8691232366683, "num_env_steps_trained_throughput_per_sec": 707.8691232366683, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5693.552, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5693.512, "sample_time_ms": 5133.159, "learn_time_ms": 556.473, "learn_throughput": 7188.127, "synch_weights_time_ms": 3.233}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-28", "timestamp": 1760509468, "time_this_iter_s": 5.655714750289917, "time_total_s": 188.38754034042358, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4b80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.38754034042358, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 34.974999999999994, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3160279989242554, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 9.936348170042038, "policy_loss": -0.022160749891190788, "vf_loss": 9.954401972889901, "vf_explained_var": 3.13781201839447e-06, "kl": 0.020534898445294127, "entropy": 4.6321407616138455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 797646.4531967425, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 208136.01313997435, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -53284.230202306426, "policy_mm": -38779.1420785002, "policy_rl": -35655.96296917217}, "policy_reward_max": {"policy_mom": 244803.2073682727, "policy_mean": 202991.47659362084, "policy_mm": 226331.50990409707, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 52919.99467308145, "policy_mean": 49039.64851534119, "policy_mm": 47907.34210238619, "policy_rl": 58269.02784916552}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52919.99609375, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 244803.203125, "('mean_0', 'policy_mean')_total_reward_mean": 49039.64453125, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 202991.484375, "('mm_0', 'policy_mm')_total_reward_mean": 47907.34375, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 226331.515625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58269.03515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -35655.96484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [206339.8010392547, 302980.121804173, 585282.998931631, 39224.025739460965, 102852.46189585613, -57103.91612258247, 699637.8161114035, 31073.684651301744, 202314.11125124164, 192159.7364544663, 302091.26077298285, 1609.2171885016458, -94734.06239032486, -1851.2597474253953, 65990.27111078182, 199141.9536958672, 242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [74539.33317513418, 85875.92300897275, 90681.16197720649, 13723.896101145103, 43410.00511721799, -13274.462074490728, 218833.28322232448, -1104.8322626716777, 44894.55390760236, 62285.74102910145, 85136.72888168292, -3042.1812019073304, -16441.73117324943, -3471.7625190590707, -2653.8149743297017, 12048.02845211232, 56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743], "policy_policy_mean_reward": [32472.412180276584, 70035.82812483361, 202991.47659362084, 11909.721439611396, 21621.125176968977, -21559.897550861664, 101229.5189171465, 5171.607446132341, 37467.183326649734, 38190.53091599327, 64625.55636540368, 4956.645980529066, -15603.284126613451, 11420.128779303326, 12154.370711495663, 45810.82091954256, 39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033], "policy_policy_mm_reward": [52236.29937549111, 80772.34489413326, 131235.26999510697, 3044.9386362521723, 19936.061353612396, -19943.175430203937, 123314.85302759426, 2035.6606828101924, 49859.262147249196, 48229.076307407886, 63462.9571244397, 3661.4873810950776, -31075.20745271259, -19152.19088607603, 33010.33903285662, 84951.30141047729, 55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002], "policy_policy_rl_reward": [47091.75630835276, 66296.02577623422, 160375.09036569635, 10545.469562452268, 17885.270248056688, -2326.3810670260495, 256260.1609443373, 24971.24878503091, 70093.11186974029, 43454.388201963775, 88866.01840145621, -3966.7349712151067, -31613.839637749352, 9352.564878406349, 23479.376340759343, 56331.802913734915, 90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2301834161210855, "mean_inference_ms": 0.7447931394389972, "mean_action_processing_ms": 0.11630040855309459, "mean_env_wait_ms": 0.17068339349115086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007071495056152344, "StateBufferConnector_ms": 0.0007096529006958008, "ViewRequirementAgentConnector_ms": 0.01781332492828369}, "num_episodes": 16, "episode_return_max": 797646.4531967425, "episode_return_min": -169687.2425257917, "episode_return_mean": 208136.01313997435, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.8606387460541, "num_env_steps_trained_throughput_per_sec": 710.8606387460541, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5690.581, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5690.539, "sample_time_ms": 5134.821, "learn_time_ms": 551.858, "learn_throughput": 7248.24, "synch_weights_time_ms": 3.219}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-33", "timestamp": 1760509473, "time_this_iter_s": 5.631276845932007, "time_total_s": 194.0188171863556, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e7a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.0188171863556, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.125, "ram_util_percent": 82.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4034837484359741, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.943648067116737, "policy_loss": -0.0235749176266836, "vf_loss": 9.96126148402691, "vf_explained_var": 6.373971700668335e-07, "kl": 0.019871643688748185, "entropy": 4.595552872121334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 222231.74903983317, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -53284.230202306426, "policy_mm": -38779.1420785002, "policy_rl": -35655.96296917217}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 218153.30039985466, "policy_mm": 227205.35164358164, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 57036.606508538884, "policy_mean": 53307.24170446605, "policy_mm": 51500.86095334868, "policy_rl": 60387.03987347963}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57036.60546875, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 53307.24609375, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 218153.296875, "('mm_0', 'policy_mm')_total_reward_mean": 51500.859375, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 227205.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60387.0390625, "('rl_trader_0', 'policy_rl')_total_reward_min": -35655.96484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [242519.56167506, 212223.59627435688, 211171.21591864052, 160709.0550092973, 751485.3381264657, -45709.77591226964, 797646.4531967425, 442594.3563854465, 355161.39862589096, 28785.950183576184, 153302.75552902164, 156762.1904617139, 82731.54623605456, -61820.56108539748, 135112.61067005375, 140838.42584002664, 185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [56409.498773113286, 63678.11991588468, 51127.71916238421, 23521.487271116373, 244803.2073682727, -18535.8474641966, 171879.2188532026, 113840.57993221305, 85345.0002990993, 22245.430709652665, 55679.94665313196, 40788.84795137596, 17747.79317693524, -24778.37403182769, 29858.754571647194, 48878.25807985727, 32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285], "policy_policy_mean_reward": [39692.01095398144, 53135.225657957664, 69309.56993334179, 53576.25875822044, 109538.9829088232, -12910.777435532764, 176463.12060709947, 81665.99777654809, 78837.09064121108, 8023.935575641929, 33668.33150248189, 45088.498798273475, 23081.653866337198, -29060.950355026267, 36800.411551186466, 18178.71652082118, 46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807], "policy_policy_mm_reward": [55917.022372521045, 45453.789169875716, 27189.628312963596, 45718.75456641911, 126113.39680933158, 1024.2215246226708, 226331.50990409707, 131688.21990710028, 76633.25440624538, 4361.27983376239, 17812.889496177133, 40136.19792473636, 13310.259955422063, -4226.7030900307955, 36242.84692795709, 43200.10756410073, 43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302], "policy_policy_rl_reward": [90501.02957544435, 49956.46153063902, 63544.298509950815, 37892.554413541475, 271029.7510400388, -15287.37253716299, 222972.60383234368, 115399.55876958549, 114346.05327933509, -5844.695935480814, 46141.587877230326, 30748.645787328172, 28591.83923736019, -3754.533608512918, 32210.59761926319, 30581.343675247652, 62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23006899964484526, "mean_inference_ms": 0.7446081127676162, "mean_action_processing_ms": 0.1162585056805837, "mean_env_wait_ms": 0.1706051882836343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007058382034301758, "StateBufferConnector_ms": 0.0006969571113586426, "ViewRequirementAgentConnector_ms": 0.017708301544189453}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -169687.2425257917, "episode_return_mean": 222231.74903983317, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.8233526509107, "num_env_steps_trained_throughput_per_sec": 710.8233526509107, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5674.605, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5674.563, "sample_time_ms": 5116.768, "learn_time_ms": 553.671, "learn_throughput": 7224.503, "synch_weights_time_ms": 3.462}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-39", "timestamp": 1760509479, "time_this_iter_s": 5.633230209350586, "time_total_s": 199.65204739570618, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4c4a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.65204739570618, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.862500000000004, "ram_util_percent": 83.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.35270094871521, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.939288860559463, "policy_loss": -0.02298449703375809, "vf_loss": 9.957275980710984, "vf_explained_var": -8.586794137954712e-08, "kl": 0.016657927158098752, "entropy": 4.467666287720204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 226847.23936560098, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -53284.230202306426, "policy_mm": -38779.1420785002, "policy_rl": -35655.96296917217}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 218153.30039985466, "policy_mm": 261818.53069547567, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 57239.25286960419, "policy_mean": 55446.22749256491, "policy_mm": 53491.185277031575, "policy_rl": 60670.57372640039}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57239.25390625, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 55446.2265625, "('mean_0', 'policy_mean')_total_reward_min": -53284.23046875, "('mean_0', 'policy_mean')_total_reward_max": 218153.296875, "('mm_0', 'policy_mm')_total_reward_mean": 53491.1796875, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60670.57421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -35655.96484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [185009.93796886725, 679998.8955656642, 260529.20207400617, 284629.58381687914, 182862.02952398494, 238728.03160853242, 167754.82460351044, 105429.09954413849, 155214.16349536437, -74115.6986831874, 4652.118338040445, 76504.29089562864, 390.53655571149926, 284843.876115035, -150204.7199147035, 306558.00381301343, 291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [32495.301875834244, 163770.11018578438, 59433.97010904344, 73856.38875870529, 32054.150680422626, 53885.008176647585, 55619.99113821424, 28405.443738352817, 49389.835735164386, -15964.091013688698, -2672.1664810449042, 30152.885934359034, 386.8645538262963, 69484.66141269487, -39075.32393179681, 62309.224538756025, 77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812], "policy_policy_mean_reward": [46148.02933184213, 168043.57948711116, 64054.23230842957, 79598.74157127627, 27507.155246214243, 48609.44385845024, 44188.567821745455, 10566.888969289905, 32681.12726796377, -24138.498348111887, -10927.145921533503, 8378.458387484457, -3622.04240464507, 100697.20637668385, -53284.230202306426, 122274.25314997991, 48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673], "policy_policy_mm_reward": [43629.122166294, 150463.2102600883, 78983.73695156204, 62933.383600904, 46439.70981076685, 64692.66844253884, 36035.600028300636, 28468.890977588955, 48298.801549156415, -20802.94750804046, 9941.06508158859, 16704.968815725984, 20073.076239573285, 59268.60858669612, -23395.13584585675, 67325.3614806994, 78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228], "policy_policy_rl_reward": [62737.484594896836, 197721.99563268048, 58057.26270497092, 68241.06988599348, 76861.01378658095, 71540.91113089587, 31910.66561525009, 37987.875858906846, 24844.398943080007, -13210.161813346378, 8310.365659030249, 21267.977758059158, -16447.361833042985, 55393.399738960135, -34450.029934743565, 54649.16464357795, 87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22993255087220413, "mean_inference_ms": 0.7442512414726327, "mean_action_processing_ms": 0.11620223300723226, "mean_env_wait_ms": 0.1705009359836148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007006525993347168, "StateBufferConnector_ms": 0.0006893277168273926, "ViewRequirementAgentConnector_ms": 0.017656266689300537}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -169687.2425257917, "episode_return_mean": 226847.23936560098, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 718.8348897748564, "num_env_steps_trained_throughput_per_sec": 718.8348897748564, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5653.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5653.508, "sample_time_ms": 5095.634, "learn_time_ms": 553.799, "learn_throughput": 7222.84, "synch_weights_time_ms": 3.391}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-45", "timestamp": 1760509485, "time_this_iter_s": 5.568861961364746, "time_total_s": 205.22090935707092, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e700>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 205.22090935707092, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.7, "ram_util_percent": 83.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4206722974777222, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.940405648946761, "policy_loss": -0.024038463902252262, "vf_loss": 9.958888581395149, "vf_explained_var": 5.962327122688294e-07, "kl": 0.018518516801089104, "entropy": 4.628457051515579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 234817.0894383014, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -50604.69662751822, "policy_mm": -38779.1420785002, "policy_rl": -37745.3660354142}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 223608.29938943262, "policy_mm": 261818.53069547567, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 58856.61598443078, "policy_mean": 56869.75395962933, "policy_mm": 55139.79218147132, "policy_rl": 63950.92731276997}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58856.61328125, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 56869.75, "('mean_0', 'policy_mean')_total_reward_min": -50604.6953125, "('mean_0', 'policy_mean')_total_reward_max": 223608.296875, "('mm_0', 'policy_mm')_total_reward_mean": 55139.796875, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63950.92578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -37745.3671875, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [291644.54257928196, -25533.255723634116, 673742.4828324358, 183516.64231554736, 203932.09719683236, -121653.5468951804, 125293.17184273088, 701718.4200944132, 454003.10708612925, 260965.30050401462, -105797.3396945386, 163842.66498553616, 267596.06172447326, 23166.2895752916, 250548.5404552576, 327412.81896348234, 24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [77241.38331898062, 4579.032557679012, 211524.90170802528, 88872.59512540675, 38249.66911814984, -30539.729849827516, 29328.12693182591, 157949.57843834217, 107343.54845338175, 71568.43896542692, -30647.20770471912, 48695.641249957545, 74376.26966440638, 9604.266849261276, 74550.60601425031, 41508.69569563008, -14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381], "policy_policy_mean_reward": [48596.59017399274, -6032.6369464783975, 188315.3881530259, 40608.36721000428, 62424.57895712365, -35775.46651435307, 33821.5277266752, 202332.749818384, 105441.63056141224, 50109.69325721331, -24382.260116286747, 84773.04976970873, 75316.27858271476, -2265.587651105861, 60227.35204596563, 84921.3339293944, 18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112], "policy_policy_mm_reward": [78467.44845542894, -5184.884396544854, 115541.10732769224, 30656.884611330577, 49270.32438010979, -28434.955944061854, 51126.63732332922, 160073.95622714306, 121038.5886735112, 67364.59365871083, -26842.128516045217, 23024.14911908554, 45934.2107723885, -6687.245205340862, 52121.22436047561, 116230.54818167373, 17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007], "policy_policy_rl_reward": [87339.12063087968, -18894.766938289984, 158361.0856436922, 23378.79536880557, 53987.524741449044, -26903.394586938015, 11016.879860900535, 181362.13561054398, 120179.33939782383, 71922.57462266344, -23925.743357487747, 7349.82484678421, 71969.30270496361, 22514.85558247697, 63649.35803456626, 84752.24115678365, 2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22983342342303273, "mean_inference_ms": 0.7440594815517388, "mean_action_processing_ms": 0.11616009216485168, "mean_env_wait_ms": 0.17042397425004324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006986856460571289, "StateBufferConnector_ms": 0.0006965398788452148, "ViewRequirementAgentConnector_ms": 0.0177651047706604}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -169687.2425257917, "episode_return_mean": 234817.0894383014, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 682.1264833325757, "num_env_steps_trained_throughput_per_sec": 682.1264833325757, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5652.193, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5652.141, "sample_time_ms": 5102.4, "learn_time_ms": 545.551, "learn_throughput": 7332.043, "synch_weights_time_ms": 3.489}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-50", "timestamp": 1760509490, "time_this_iter_s": 5.869227886199951, "time_total_s": 211.09013724327087, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 211.09013724327087, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 52.96666666666667, "ram_util_percent": 83.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3664554357528687, "cur_kl_coeff": 0.3, "cur_lr": 0.0003, "total_loss": 9.940695789456367, "policy_loss": -0.02662549480155576, "vf_loss": 9.960994684696198, "vf_explained_var": 8.52532684803009e-07, "kl": 0.021088594515186028, "entropy": 4.491053450107574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -169687.2425257917, "episode_reward_mean": 221364.67886775848, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -45166.35112045213, "policy_mean": -50604.69662751822, "policy_mm": -38779.1420785002, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 223608.29938943262, "policy_mm": 261818.53069547567, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 54699.133065071335, "policy_mean": 53365.22325488816, "policy_mm": 52579.959519303535, "policy_rl": 60720.36302849545}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54699.13671875, "('mom_0', 'policy_mom')_total_reward_min": -45166.3515625, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 53365.2265625, "('mean_0', 'policy_mean')_total_reward_min": -50604.6953125, "('mean_0', 'policy_mean')_total_reward_max": 223608.296875, "('mm_0', 'policy_mm')_total_reward_mean": 52579.96484375, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60720.359375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [24689.827733680417, 109603.46097072637, -19371.441295088258, 406483.35479034437, 499447.4415734674, 623516.0152368043, -169687.2425257917, 176545.98252235397, 528046.3583150839, 506204.75970215496, -80140.93079383428, 633028.3378215751, 556807.4934003872, 308984.84151470225, 169702.52906526322, 113070.66728413184, 52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-14697.99693526857, 15898.481566010778, -8048.899864089525, 97148.8680176922, 77371.40192957723, 169115.41445419556, -45166.35112045213, 99546.13336572504, 136149.44279874864, 114344.71977084504, -6704.781533302158, 171479.94569518339, 146255.81094776583, 73621.94583919758, 44294.06269711714, 27658.357634708107, -3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518], "policy_policy_mean_reward": [18894.201963936033, 30413.28572637179, 7172.050203495457, 82843.2458110437, 130945.50705609609, 163548.52143906022, -50604.69662751822, 5006.662245006641, 110961.88610831033, 117240.14538301843, -31330.087544553364, 166009.52790232855, 193841.5912368531, 86690.62213998356, 38220.28698782437, 29853.05572054045, 21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309], "policy_policy_mm_reward": [17632.166341752738, 33401.48992896059, -11099.509359507903, 123656.44883010769, 130353.51659565158, 115865.91230402004, -38260.23180864908, 42728.02860811437, 114350.31062353867, 107604.15763837364, -26975.154461563336, 143420.04656953143, 106727.72656833076, 72357.07149293665, 55877.646069578426, 23292.070227764565, 12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772], "policy_policy_rl_reward": [2861.456363260163, 29890.203749383287, -7395.082274986304, 102834.7921315005, 160777.01599214258, 174986.16703952834, -35655.96296917217, 29265.158303508026, 166584.71878448644, 167015.73690991796, -15130.907254415386, 152118.8176545306, 109982.36464743789, 76315.20204258469, 31310.53331074322, 32267.18370111862, 22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22975616080154806, "mean_inference_ms": 0.7439554328026952, "mean_action_processing_ms": 0.11613937777856002, "mean_env_wait_ms": 0.17037025659703212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006927847862243652, "StateBufferConnector_ms": 0.0006867647171020508, "ViewRequirementAgentConnector_ms": 0.0177420973777771}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -169687.2425257917, "episode_return_mean": 221364.67886775848, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 706.589713943299, "num_env_steps_trained_throughput_per_sec": 706.589713943299, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5658.265, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5658.202, "sample_time_ms": 5106.28, "learn_time_ms": 547.738, "learn_throughput": 7302.76, "synch_weights_time_ms": 3.5}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "26ec2_00000", "date": "2025-10-15_01-24-56", "timestamp": 1760509496, "time_this_iter_s": 5.668362855911255, "time_total_s": 216.75850009918213, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7560>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.75850009918213, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.1, "ram_util_percent": 82.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3593320846557617, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.93889807164669, "policy_loss": -0.026138045769766905, "vf_loss": 9.958461007475853, "vf_explained_var": 3.7159770727157593e-07, "kl": 0.014611381639315602, "entropy": 4.4634844869375225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -137097.50386402497, "episode_reward_mean": 205336.9711493074, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41365.950237796715, "policy_mean": -32681.604950278524, "policy_mm": -38779.1420785002, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 223608.29938943262, "policy_mm": 261818.53069547567, "policy_rl": 280637.7594550132}, "policy_reward_mean": {"policy_mom": 49672.65801568089, "policy_mean": 49861.87962524206, "policy_mm": 49586.54966707245, "policy_rl": 56215.883841311996}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49672.66015625, "('mom_0', 'policy_mom')_total_reward_min": -41365.94921875, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 49861.87890625, "('mean_0', 'policy_mean')_total_reward_min": -32681.60546875, "('mean_0', 'policy_mean')_total_reward_max": 223608.296875, "('mm_0', 'policy_mm')_total_reward_mean": 49586.5546875, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 56215.88671875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 280637.75}, "hist_stats": {"episode_reward": [52193.48372266096, 210626.62284144765, -7227.788437240829, 348610.95801871765, 213411.82591661057, 795533.4743110607, 93010.53470157347, 282622.8841839016, -68117.84899725688, 399796.6951531168, 518450.75790257676, 148612.6258092514, 33197.83138307545, -9253.224173317867, 19540.134966913793, 518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-3775.8793711684843, 57515.01789004688, -3432.2792235287, 87877.61122197854, 56731.78166811431, 211368.2459280013, 22951.07252124417, 96647.32508506686, -10606.684845510832, 62136.79779976318, 125096.4581933955, 28670.892655772728, 30439.834290927458, 1035.8309695908697, 15012.371452360114, 115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132], "policy_policy_mean_reward": [21081.124207536734, 43432.4171281403, 3781.9222168335027, 94366.94220661998, 43728.464788194855, 121398.00459538029, 11271.707990160583, 67007.65509745342, -17210.24137695852, 112972.6203667789, 94053.59818399354, 35476.269969762005, 11421.362412237055, 2968.0154305689043, 18526.079464390197, 136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637], "policy_policy_mm_reward": [12534.387001667172, 37904.16200111701, -7286.903006353071, 85784.4633955757, 42280.587231022866, 182129.46433266543, 27893.193139961168, 44056.092027441824, -24106.292835394666, 85198.59495420629, 123375.61552311489, 57576.535916503286, -16849.02848120081, -9000.465990333123, -10651.729247685626, 118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927], "policy_policy_rl_reward": [22353.851884625616, 71775.02582214358, -290.52842419256416, 80581.94119454361, 70670.99222927859, 280637.7594550132, 30894.56105020752, 74911.81197393905, -16194.629939392833, 139488.68203236882, 175925.0860020734, 26888.927267212992, 8185.663161111885, -4256.604583144528, -3346.586702150901, 147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22969070524439927, "mean_inference_ms": 0.7438635877441642, "mean_action_processing_ms": 0.11612048675955629, "mean_env_wait_ms": 0.17032172515298022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000691533088684082, "StateBufferConnector_ms": 0.0006816387176513672, "ViewRequirementAgentConnector_ms": 0.01775413751602173}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -137097.50386402497, "episode_return_mean": 205336.9711493074, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.5247344980544, "num_env_steps_trained_throughput_per_sec": 716.5247344980544, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5641.814, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5641.747, "sample_time_ms": 5094.702, "learn_time_ms": 543.013, "learn_throughput": 7366.31, "synch_weights_time_ms": 3.381}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-02", "timestamp": 1760509502, "time_this_iter_s": 5.58774209022522, "time_total_s": 222.34624218940735, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7100>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 222.34624218940735, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.0625, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5251412391662598, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.9457288980484, "policy_loss": -0.022945166513090955, "vf_loss": 9.960476049780846, "vf_explained_var": 8.67992639541626e-07, "kl": 0.018217807379187725, "entropy": 4.48861563205719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -137097.50386402497, "episode_reward_mean": 209978.77918123253, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41365.950237796715, "policy_mean": -32681.604950278524, "policy_mm": -38779.1420785002, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 223608.29938943262, "policy_mm": 261818.53069547567, "policy_rl": 302318.5715907073}, "policy_reward_mean": {"policy_mom": 48704.917467530024, "policy_mean": 52662.37334163119, "policy_mm": 51678.61111571576, "policy_rl": 56932.877256355554}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48704.9140625, "('mom_0', 'policy_mom')_total_reward_min": -41365.94921875, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 52662.37890625, "('mean_0', 'policy_mean')_total_reward_min": -32681.60546875, "('mean_0', 'policy_mean')_total_reward_max": 223608.296875, "('mm_0', 'policy_mm')_total_reward_mean": 51678.60546875, "('mm_0', 'policy_mm')_total_reward_min": -38779.140625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 56932.875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 302318.5625}, "hist_stats": {"episode_reward": [518038.9290475093, -71068.335913378, -78260.93526345208, 240344.22468789885, -137097.50386402497, -37595.98472815228, 373019.52431970666, 121200.26652372298, 164873.74751402272, 169001.20532884818, 900593.1541914932, -1279.5736605249544, 565524.5719171332, 293799.42802118725, 123055.79927856273, 135226.40321809286, 963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [115567.67176402002, -18878.508634995826, -10922.675203127137, 66730.31012668065, -38099.86608024743, -5164.979133659933, 116263.76706384131, 30445.683565341715, 46897.55145660561, 47139.94048846808, 244868.20295949047, 15544.008547828249, 137832.34472533828, 52322.283413944024, 46974.821247043896, 37857.52687508115, 257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734], "policy_policy_mean_reward": [136871.41344416142, -20424.830973376113, -32681.604950278524, 48423.76718903898, -29395.81992698033, -17037.556864320824, 58566.02426142098, 39644.24358762915, 72137.98419890956, 43394.0459540096, 218153.30039985466, -2994.68145857427, 143024.1361540238, 102290.5069991838, 23642.818809339195, 37823.95562385877, 212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446], "policy_policy_mm_reward": [118320.01501728779, -21684.157315993223, -17223.98547462428, 63084.57510789196, -38779.1420785002, -6648.989086518498, 87090.53267470823, 20726.518091288337, 28890.717716693576, 48907.5649311611, 194513.75715013227, 8994.818919273737, 143360.26598200572, 68980.54347429796, 38565.97464613469, 9418.673001442952, 227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466], "policy_policy_rl_reward": [147279.82882204003, -10080.838989012804, -17432.66963542219, 62105.57226428743, -30822.67577829704, -8744.459643653052, 111099.20031973725, 30383.82127946399, 16947.494141814128, 29559.653955209622, 243057.8936820161, -22823.719669052567, 141307.8250557656, 70206.0941337618, 13872.184576045025, 50126.24771771006, 266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2296457364782515, "mean_inference_ms": 0.743744805238866, "mean_action_processing_ms": 0.11611100944176583, "mean_env_wait_ms": 0.17028945638836235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006909370422363281, "StateBufferConnector_ms": 0.0006788969039916992, "ViewRequirementAgentConnector_ms": 0.017811596393585205}, "num_episodes": 15, "episode_return_max": 963981.4935313062, "episode_return_min": -137097.50386402497, "episode_return_mean": 209978.77918123253, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.7209574203886, "num_env_steps_trained_throughput_per_sec": 708.7209574203886, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5621.4, "restore_workers_time_ms": 0.028, "training_step_time_ms": 5621.308, "sample_time_ms": 5075.595, "learn_time_ms": 541.675, "learn_throughput": 7384.506, "synch_weights_time_ms": 3.382}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-07", "timestamp": 1760509507, "time_this_iter_s": 5.649223804473877, "time_total_s": 227.99546599388123, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4ae0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.99546599388123, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 42.3625, "ram_util_percent": 81.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6782993078231812, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.945814493298531, "policy_loss": -0.022124490831629373, "vf_loss": 9.960306584835052, "vf_explained_var": 2.0097941160202027e-07, "kl": 0.01696076092871438, "entropy": 4.408509837090969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 963981.4935313062, "episode_reward_min": -136214.14550448905, "episode_reward_mean": 221576.39868693348, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41365.950237796715, "policy_mean": -32035.734078451278, "policy_mm": -38530.9093154775, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 257503.14936137453, "policy_mean": 230485.8839319091, "policy_mm": 261818.53069547567, "policy_rl": 302318.5715907073}, "policy_reward_mean": {"policy_mom": 48705.3246617872, "policy_mean": 55654.012837018476, "policy_mm": 55169.989828674145, "policy_rl": 62047.07135945372}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48705.3203125, "('mom_0', 'policy_mom')_total_reward_min": -41365.94921875, "('mom_0', 'policy_mom')_total_reward_max": 257503.15625, "('mean_0', 'policy_mean')_total_reward_mean": 55654.015625, "('mean_0', 'policy_mean')_total_reward_min": -32035.734375, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 55169.99609375, "('mm_0', 'policy_mm')_total_reward_min": -38530.91015625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 62047.0703125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 302318.5625}, "hist_stats": {"episode_reward": [963981.4935313062, 122035.24364783386, -29124.097769712735, 350066.26626991574, -27795.635230959466, 135114.4334165, 197463.05585329994, 86426.17177688287, 267172.3616757721, 166067.20142863554, 338786.72466503456, 594913.9800942224, 135732.93449011855, 300915.6886331557, 123250.03766432936, 284433.3285937292, 110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [257503.14936137453, 26913.48363803944, -13274.107493349653, 63958.22650110002, -2980.849003952285, 31939.84564611491, 58528.37307920028, 27007.14731722651, 76239.3312796909, 44798.521674464384, 89493.70246014663, 168170.7228591856, 14314.009075889147, 81599.69243102279, 39643.71563822488, 61970.85253089036, 1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232], "policy_policy_mean_reward": [212674.98416076796, 21329.493636625986, 661.5805155992616, 105565.95463017937, -9223.72649598807, 25588.52000951693, 40566.63908594435, 14974.985003497863, 66821.30010059144, 45083.24338851066, 93514.86820563061, 161859.19422784846, 40503.664487496986, 48403.50600934687, 23620.58047071592, 79230.18945312811, 32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963], "policy_policy_mm_reward": [227205.35164358164, 41232.35049127438, -4652.779486549789, 86953.91440681147, -8608.051859955302, 33483.019741927026, 50692.12470474557, 24683.129868782835, 68975.10740169632, 37284.99576052981, 60179.69425746525, 87016.18136919783, 53715.51146735757, 104159.29713537655, 16156.394956664908, 51935.29557963858, 44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034], "policy_policy_rl_reward": [266598.00836558145, 32559.91588189409, -11858.791305412638, 93588.17073182487, -6983.0078710638245, 44103.048018941205, 47675.918983409734, 19760.90958737573, 55136.62289379343, 38900.44060513086, 95598.45974179152, 177867.88163799015, 27199.749459374725, 66753.19305740975, 43829.34659872364, 91296.99103007188, 32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2296077713573745, "mean_inference_ms": 0.7437229782268254, "mean_action_processing_ms": 0.11610390989606768, "mean_env_wait_ms": 0.17026425831737757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006889700889587402, "StateBufferConnector_ms": 0.000677943229675293, "ViewRequirementAgentConnector_ms": 0.017832577228546143}, "num_episodes": 16, "episode_return_max": 963981.4935313062, "episode_return_min": -136214.14550448905, "episode_return_mean": 221576.39868693348, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 697.9505511916238, "num_env_steps_trained_throughput_per_sec": 697.9505511916238, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5636.175, "restore_workers_time_ms": 0.027, "training_step_time_ms": 5636.088, "sample_time_ms": 5090.316, "learn_time_ms": 542.045, "learn_throughput": 7379.462, "synch_weights_time_ms": 3.099}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-13", "timestamp": 1760509513, "time_this_iter_s": 5.736743927001953, "time_total_s": 233.73220992088318, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db72e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 233.73220992088318, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 36.425, "ram_util_percent": 81.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4349231719970703, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.945645123720169, "policy_loss": -0.019757509247574488, "vf_loss": 9.959492015838624, "vf_explained_var": -3.2540410757064817e-07, "kl": 0.013134645098216652, "entropy": 4.462055984139442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 874926.799669386, "episode_reward_min": -136214.14550448905, "episode_reward_mean": 214446.06600508976, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41365.950237796715, "policy_mean": -32035.734078451278, "policy_mm": -38530.9093154775, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 223724.12189761494, "policy_mean": 230485.8839319091, "policy_mm": 261818.53069547567, "policy_rl": 302318.5715907073}, "policy_reward_mean": {"policy_mom": 47233.094037175106, "policy_mean": 53223.70513329383, "policy_mm": 53525.89382046726, "policy_rl": 60463.37301415359}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47233.08984375, "('mom_0', 'policy_mom')_total_reward_min": -41365.94921875, "('mom_0', 'policy_mom')_total_reward_max": 223724.125, "('mean_0', 'policy_mean')_total_reward_mean": 53223.69921875, "('mean_0', 'policy_mean')_total_reward_min": -32035.734375, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 53525.890625, "('mm_0', 'policy_mm')_total_reward_min": -38530.91015625, "('mm_0', 'policy_mm')_total_reward_max": 261818.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60463.375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 302318.5625}, "hist_stats": {"episode_reward": [110333.4255062541, 534108.3143923599, 78123.86089788008, 874926.799669386, -2705.169046094867, 108631.23718521533, 297544.3110712445, -115977.18515104141, 185656.06533862985, 666990.3157069637, 581413.6614897874, -64324.0274669606, 860550.853797991, -127843.80233547174, 107530.36490804346, 92453.2535541018, 290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [1293.1480304489992, 88348.3205989267, 15751.823418346092, 217403.01306659702, -13747.941777980812, 15095.149295181665, 82923.86785438476, -18718.751544660357, 36185.2559439636, 91807.16649063503, 143355.26683446794, -20857.649220009233, 223724.12189761494, -41365.950237796715, 45017.82736194852, 35246.504606292765, 77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365], "policy_policy_mean_reward": [32530.933535885524, 131806.11562923624, 25426.86484165625, 157323.0670983221, 11732.984523923673, 20236.484351692536, 67686.4284466846, -27619.232214161617, 59709.82814623797, 162651.66866746137, 81409.80114934575, -21234.631023502843, 223608.29938943262, -31212.96670785923, 11098.390959724155, 1007.8681627189038, 71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192], "policy_policy_mm_reward": [44167.36345920341, 157213.27298716185, 37382.214252166035, 261818.53069547567, -2923.025683798228, 45333.61407221717, 82309.37043924976, -31893.83535680538, 40242.0540729853, 194466.19028174484, 155411.49218921107, -12870.822222516701, 161712.21544997906, -18091.631359039457, 25732.95048960858, 10124.288393227858, 56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246], "policy_policy_rl_reward": [32341.980480716204, 156740.60517703474, -437.0416142882403, 238382.18880899227, 2232.8138917604583, 27965.989466123945, 64624.64433092538, -37745.3660354142, 49518.92717544304, 218065.2902671221, 201237.1013167632, -9360.925000931888, 251506.2170609646, -37173.25403077633, 25681.19609676209, 46074.59239186218, 84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22960081609097352, "mean_inference_ms": 0.7437824457391733, "mean_action_processing_ms": 0.11611257848113586, "mean_env_wait_ms": 0.1702673176743383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000698089599609375, "StateBufferConnector_ms": 0.0006821751594543457, "ViewRequirementAgentConnector_ms": 0.017945706844329834}, "num_episodes": 16, "episode_return_max": 874926.799669386, "episode_return_min": -136214.14550448905, "episode_return_mean": 214446.06600508976, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.1858554492944, "num_env_steps_trained_throughput_per_sec": 660.1858554492944, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5701.148, "restore_workers_time_ms": 0.027, "training_step_time_ms": 5701.058, "sample_time_ms": 5121.418, "learn_time_ms": 575.342, "learn_throughput": 6952.384, "synch_weights_time_ms": 3.614}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-19", "timestamp": 1760509519, "time_this_iter_s": 6.072280168533325, "time_total_s": 239.8044900894165, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5760>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 239.8044900894165, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 50.27777777777778, "ram_util_percent": 82.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6211051940917969, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.94333512187004, "policy_loss": -0.019833718441077508, "vf_loss": 9.954229235649109, "vf_explained_var": -4.1052699089050294e-07, "kl": 0.019865790321410046, "entropy": 4.345180414617062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 751705.0820611905, "episode_reward_min": -136214.14550448905, "episode_reward_mean": 200117.03719094011, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37618.661148078616, "policy_mean": -32035.734078451278, "policy_mm": -38530.9093154775, "policy_rl": -40874.91496273855}, "policy_reward_max": {"policy_mom": 163646.45011959705, "policy_mean": 230485.8839319091, "policy_mm": 196470.9031894853, "policy_rl": 302318.5715907073}, "policy_reward_mean": {"policy_mom": 45469.803136640796, "policy_mean": 51438.53068982215, "policy_mm": 47525.39703012628, "policy_rl": 55683.30633435095}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45469.80078125, "('mom_0', 'policy_mom')_total_reward_min": -37618.66015625, "('mom_0', 'policy_mom')_total_reward_max": 163646.453125, "('mean_0', 'policy_mean')_total_reward_mean": 51438.53125, "('mean_0', 'policy_mean')_total_reward_min": -32035.734375, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 47525.3984375, "('mm_0', 'policy_mm')_total_reward_min": -38530.91015625, "('mm_0', 'policy_mm')_total_reward_max": 196470.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55683.3046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40874.9140625, "('rl_trader_0', 'policy_rl')_total_reward_max": 302318.5625}, "hist_stats": {"episode_reward": [290057.1617937684, 142518.7492556004, -6214.935536003008, 120833.09396236236, 365950.06501628825, 134269.6720659977, -31865.061471983023, -136214.14550448905, 156634.00124502074, 265859.8047017398, 243697.83431566713, 98910.57425436717, -34955.503234287586, 232679.0080622746, 137975.68269521437, 328886.31624770234, 305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [77621.47950271143, 46847.327230943956, -4712.184103184567, 51367.93841393522, 51731.19656750381, 24322.503101469865, 8964.895312004213, -24772.58714782183, 39524.11363658856, 71013.36037870485, 51927.81836420676, 20402.790156772146, -8310.66081706126, 53841.16199092057, 13758.948410262154, 78126.93962177237, 95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956], "policy_policy_mean_reward": [71257.09079772135, 42203.4147292389, 10938.649413956513, 17990.1161502946, 113397.20318733112, 23187.000472612766, -15979.338588929886, -32035.734078451278, 36785.21088552136, 63115.671372208286, 59298.4953622569, 28691.461632643055, 558.166409188063, 77068.62561820321, 37393.78060118238, 88053.54281859388, 84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198], "policy_policy_mm_reward": [56746.73259536544, 26583.849332967944, -6505.823281310131, 18248.857568175277, 106371.3084165007, 53813.84714145586, -3837.9951311133914, -38530.9093154775, 42448.46730109244, 57558.52687138804, 69082.78187223295, 18450.813128806785, -5439.832227128764, 38361.81280060584, 55939.73645642883, 69814.52646444362, 42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376], "policy_policy_rl_reward": [84431.85889797001, 26884.157962449568, -5935.577565464833, 33226.18182995722, 94450.35684495271, 32946.321350459126, -21012.623063944073, -40874.91496273855, 37876.20942181813, 74172.24607943867, 63388.738716970416, 31365.509336144845, -21763.176599285744, 63407.407652544774, 30883.21722734093, 92891.30734289237, 82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22972089227846346, "mean_inference_ms": 0.7443081166708992, "mean_action_processing_ms": 0.11620324516773765, "mean_env_wait_ms": 0.17042868790130236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007207393646240234, "StateBufferConnector_ms": 0.0006926059722900391, "ViewRequirementAgentConnector_ms": 0.018215656280517578}, "num_episodes": 16, "episode_return_max": 751705.0820611905, "episode_return_min": -136214.14550448905, "episode_return_mean": 200117.03719094011, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 591.5928116668767, "num_env_steps_trained_throughput_per_sec": 591.5928116668767, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 5812.216, "restore_workers_time_ms": 0.036, "training_step_time_ms": 5812.112, "sample_time_ms": 5230.498, "learn_time_ms": 577.254, "learn_throughput": 6929.353, "synch_weights_time_ms": 3.667}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-26", "timestamp": 1760509526, "time_this_iter_s": 6.766715049743652, "time_total_s": 246.57120513916016, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6f20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 246.57120513916016, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 61.87777777777777, "ram_util_percent": 84.02222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6651897430419922, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.944741532206535, "policy_loss": -0.02037159820465604, "vf_loss": 9.95742670595646, "vf_explained_var": -1.8199905753135682e-06, "kl": 0.017080873543364093, "entropy": 4.395398251712322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 751705.0820611905, "episode_reward_min": -113047.31904679856, "episode_reward_mean": 196732.86739248165, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37618.661148078616, "policy_mean": -27536.029756839558, "policy_mm": -35133.13284261901, "policy_rl": -27749.662794133517}, "policy_reward_max": {"policy_mom": 163646.45011959705, "policy_mean": 230485.8839319091, "policy_mm": 196470.9031894853, "policy_rl": 302318.5715907073}, "policy_reward_mean": {"policy_mom": 45110.48034299069, "policy_mean": 50205.95289628703, "policy_mm": 46274.66396836989, "policy_rl": 55141.77018483408}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45110.48046875, "('mom_0', 'policy_mom')_total_reward_min": -37618.66015625, "('mom_0', 'policy_mom')_total_reward_max": 163646.453125, "('mean_0', 'policy_mean')_total_reward_mean": 50205.94921875, "('mean_0', 'policy_mean')_total_reward_min": -27536.029296875, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 46274.6640625, "('mm_0', 'policy_mm')_total_reward_min": -35133.1328125, "('mm_0', 'policy_mm')_total_reward_max": 196470.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55141.76953125, "('rl_trader_0', 'policy_rl')_total_reward_min": -27749.662109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 302318.5625}, "hist_stats": {"episode_reward": [305209.6271740247, 200677.72336029736, -17699.63423675955, 290842.423185777, 154248.61792721812, -19992.860182228087, 317752.8554330809, 7147.363187877008, 202788.77791048842, -113047.31904679856, 84787.84200536062, 174533.83559633317, -28310.337935619085, -75312.50643388105, 248082.6633506043, 308692.4385594875, 140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [95649.25673026145, 47186.51708060833, -6428.981746934581, 72689.1616973978, 20562.287831081518, 756.8351945915897, 66484.16212195143, -1178.9575348872029, 45164.592813166535, -37618.661148078616, 34494.85224346715, 28438.854252864196, -22999.801264269983, -24588.728174122014, 67521.29407444042, 86930.72256502036, 27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009], "policy_policy_mean_reward": [84274.94277648944, 38746.15537651633, 13020.906702942217, 66099.56472788424, 49701.06639441309, -4279.234310103059, 89940.95791985413, 16817.668877330387, 39767.79676041183, -27536.029756839558, 16227.186678375187, 49173.92339114188, -9032.967017359018, -18220.293898790256, 71628.78056979614, 57512.60067909684, 31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557], "policy_policy_mm_reward": [42419.60030174016, 49640.806527992674, -470.406588397204, 80575.02035141885, 57890.39685661772, -25376.950077314195, 92961.75911253838, -2698.9372409986177, 68604.0305877653, -21368.345371008585, 38162.10023114037, 63875.188815784946, 11809.76241463998, -24146.084719321436, 34292.41218742304, 88442.82173050709, 41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461], "policy_policy_rl_reward": [82865.8273655336, 65104.244375179835, -23821.15260436994, 71478.67640907635, 26094.866845105807, 8906.489010597585, 68365.97627873695, -5792.4109135675135, 49252.35774914449, -26524.282770871716, -4096.297147622246, 33045.86913654228, -8087.332068630104, -8357.39964164724, 74640.17651894446, 75806.29358486275, 39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22984674114040624, "mean_inference_ms": 0.7448279953339249, "mean_action_processing_ms": 0.11629135321332765, "mean_env_wait_ms": 0.17060015321179023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000729680061340332, "StateBufferConnector_ms": 0.0007001757621765137, "ViewRequirementAgentConnector_ms": 0.01835101842880249}, "num_episodes": 16, "episode_return_max": 751705.0820611905, "episode_return_min": -113047.31904679856, "episode_return_mean": 196732.86739248165, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 682.9411658869071, "num_env_steps_trained_throughput_per_sec": 682.9411658869071, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 5835.22, "restore_workers_time_ms": 0.037, "training_step_time_ms": 5835.114, "sample_time_ms": 5251.301, "learn_time_ms": 579.393, "learn_throughput": 6903.773, "synch_weights_time_ms": 3.721}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-32", "timestamp": 1760509532, "time_this_iter_s": 5.863019943237305, "time_total_s": 252.43422508239746, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db72e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 252.43422508239746, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 53.84444444444445, "ram_util_percent": 83.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6988489627838135, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.94328299164772, "policy_loss": -0.025017970164481085, "vf_loss": 9.960295566916466, "vf_explained_var": -2.2742897272109984e-07, "kl": 0.01778972539036681, "entropy": 4.256687067449093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -171334.07115011624, "episode_reward_mean": 221841.0386023662, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -34384.60867659995, "policy_mean": -41965.27607817621, "policy_mm": -48878.23090567767, "policy_rl": -46105.95548966245}, "policy_reward_max": {"policy_mom": 205000.50539531244, "policy_mean": 230485.8839319091, "policy_mm": 196470.9031894853, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 50873.65209810969, "policy_mean": 55034.90591972374, "policy_mm": 51558.718599759435, "policy_rl": 64373.76198477334}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50873.6484375, "('mom_0', 'policy_mom')_total_reward_min": -34384.609375, "('mom_0', 'policy_mom')_total_reward_max": 205000.5, "('mean_0', 'policy_mean')_total_reward_mean": 55034.8984375, "('mean_0', 'policy_mean')_total_reward_min": -41965.27734375, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 51558.7265625, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 196470.90625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64373.76171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -46105.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [140852.52103615375, 334008.4548031856, 605218.2512495859, 269260.70201840735, 327698.00191881706, 290282.0582345293, 92434.97426957753, 691937.2450429448, 704277.888141531, 267437.3162328726, 695652.4145715792, -54434.50382165621, 22595.20282724665, 247504.7523216211, 42106.218380068036, 97564.5364517359, 69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [27963.354746336612, 78948.76527047652, 152672.98431514748, 33817.0416549252, 58811.73919358132, 70223.61199113705, 15702.053437190947, 143501.7065553836, 89905.49074212152, 59244.87989526042, 117370.89986175463, -21886.95588667679, 11120.582731400174, 49433.573362175324, 31607.755067042097, 14221.834562542894, 18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907], "policy_policy_mean_reward": [31139.808971066923, 83000.39415030536, 184762.67943710502, 70689.94973946847, 97778.22059632637, 61757.71772289831, 31014.511295067998, 172988.3053149692, 211695.70886376293, 67149.71485370342, 204460.85166062188, -18703.171781732723, -10882.966879629894, 86454.37884980217, 11655.984839345703, 29365.527342016012, 10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394], "policy_policy_mm_reward": [41957.84670904138, 86402.21706215151, 85494.30151389819, 83235.25980589699, 89943.32818368927, 69637.13535442724, 11151.606293902163, 196470.9031894853, 100358.11694493995, 85289.02192613043, 165317.4019280889, 4314.689089031579, 13159.53861680496, 64420.16922093966, -6956.080004636294, 36630.36681029745, 13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631], "policy_policy_rl_reward": [39791.51060970877, 85657.07832025223, 182288.28598343444, 81518.45081811713, 81164.71394522022, 88663.59316606671, 34566.80324341646, 178976.32998310676, 302318.5715907073, 55753.69955777825, 208503.26112111539, -18159.06524227829, 9198.048358671478, 47196.63088870359, 5798.558478316374, 17346.807736879422, 27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2300276463876202, "mean_inference_ms": 0.7456496411766796, "mean_action_processing_ms": 0.11640680909153885, "mean_env_wait_ms": 0.1708309277558638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007503032684326172, "StateBufferConnector_ms": 0.0007155537605285645, "ViewRequirementAgentConnector_ms": 0.01867908239364624}, "num_episodes": 16, "episode_return_max": 952695.057766875, "episode_return_min": -171334.07115011624, "episode_return_mean": 221841.0386023662, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 646.9574630462555, "num_env_steps_trained_throughput_per_sec": 646.9574630462555, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 5890.771, "restore_workers_time_ms": 0.039, "training_step_time_ms": 5890.66, "sample_time_ms": 5303.834, "learn_time_ms": 581.851, "learn_throughput": 6874.61, "synch_weights_time_ms": 4.208}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-38", "timestamp": 1760509538, "time_this_iter_s": 6.188395023345947, "time_total_s": 258.6226201057434, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db6840>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 258.6226201057434, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 49.32222222222222, "ram_util_percent": 84.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5224599838256836, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.940004920959472, "policy_loss": -0.024189689381455538, "vf_loss": 9.957523852586746, "vf_explained_var": 4.973262548446655e-08, "kl": 0.014823715804459686, "entropy": 4.13563182502985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 197913.8241606129, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40630.576659068036, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 205000.50539531244, "policy_mean": 230485.8839319091, "policy_mm": 187683.24958042114, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 47495.870720046, "policy_mean": 47464.31565991654, "policy_mm": 47087.04852909373, "policy_rl": 55866.58925155664}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47495.87109375, "('mom_0', 'policy_mom')_total_reward_min": -40630.578125, "('mom_0', 'policy_mom')_total_reward_max": 205000.5, "('mean_0', 'policy_mean')_total_reward_mean": 47464.31640625, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 230485.890625, "('mm_0', 'policy_mm')_total_reward_mean": 47087.0546875, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 187683.25, "('rl_trader_0', 'policy_rl')_total_reward_mean": 55866.58984375, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [69465.51816346841, -89654.28178584533, 200464.0387207839, 217556.39274514306, 253180.52554367454, 681737.1039828291, 201684.05013892183, 88228.51060819588, 75843.84187520145, 295532.3350123069, 204160.36851882827, 698872.4660462656, 751705.0820611905, 270957.36363822175, 129219.33016903774, 38970.67803649443, -61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [18184.992943066703, -22192.75101111016, 56017.42700194803, 48439.240167728734, 57633.00033625698, 163646.45011959705, 44355.95063613995, 15579.470876986781, 6936.839507398623, 69723.23855117439, 63404.75568729398, 99652.03313168944, 103928.89136804722, 58214.93468771787, 26675.3774152025, 20471.082706461773, -24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326], "policy_policy_mean_reward": [10597.8296760733, -8419.834465038028, 41269.43639320023, 53921.3206349446, 45356.020126618445, 148786.38301447983, 41207.02805904048, 18734.97402496355, 16169.392800683449, 73381.95333517753, 26622.00596769885, 230485.8839319091, 214858.73580299856, 90477.9026539722, 19526.18592149477, 17581.70105182828, -21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832], "policy_policy_mm_reward": [13127.529617940942, -34420.97613012146, 62810.69787122071, 58734.700098187466, 69252.30958533281, 123850.02966182366, 53396.48778804184, 15431.122724439021, 38679.743928249634, 66600.79817666413, 64849.835373614915, 183904.13439936834, 172920.51571970183, 40736.77193905031, 57983.869471068974, 9804.405329671508, -1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519], "policy_policy_rl_reward": [27555.165926387523, -24620.72017957562, 40366.47745441489, 56461.13184428226, 80939.19549546618, 245454.24118692827, 62724.5836556995, 38482.94298180637, 14057.865638869862, 85826.34494929083, 49283.77149022034, 184830.41458329925, 259996.93917044334, 81527.75435748122, 25033.897361271444, -8886.511051467127, -14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2302362614618783, "mean_inference_ms": 0.7465449474703522, "mean_action_processing_ms": 0.11653486811820941, "mean_env_wait_ms": 0.17108466100523828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007543563842773438, "StateBufferConnector_ms": 0.0007221102714538574, "ViewRequirementAgentConnector_ms": 0.018760204315185547}, "num_episodes": 16, "episode_return_max": 952695.057766875, "episode_return_min": -179694.66312487537, "episode_return_mean": 197913.8241606129, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 688.7596504445064, "num_env_steps_trained_throughput_per_sec": 688.7596504445064, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 5915.059, "restore_workers_time_ms": 0.046, "training_step_time_ms": 5914.95, "sample_time_ms": 5326.795, "learn_time_ms": 583.207, "learn_throughput": 6858.624, "synch_weights_time_ms": 4.187}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-44", "timestamp": 1760509544, "time_this_iter_s": 5.812617063522339, "time_total_s": 264.43523716926575, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.43523716926575, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 50.3125, "ram_util_percent": 84.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7992756366729736, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.94690881371498, "policy_loss": -0.019393370485340712, "vf_loss": 9.958268639445304, "vf_explained_var": 1.514330506324768e-07, "kl": 0.017852442521143846, "entropy": 4.03557543233037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 205814.91078332163, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40630.576659068036, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 205000.50539531244, "policy_mean": 246458.66950893812, "policy_mm": 187683.24958042114, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 50840.855089851255, "policy_mean": 47468.71532463006, "policy_mm": 48819.57742072489, "policy_rl": 58685.76294811549}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50840.8515625, "('mom_0', 'policy_mom')_total_reward_min": -40630.578125, "('mom_0', 'policy_mom')_total_reward_max": 205000.5, "('mean_0', 'policy_mean')_total_reward_mean": 47468.71875, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 48819.57421875, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 187683.25, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58685.76171875, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [-61948.474749073466, 64088.550247527724, 82964.47352829197, 663940.6665308321, 302477.26044907066, 141692.1748560362, 315947.0862419913, 71791.23164158936, 329622.6132380838, 254067.6113976144, 203693.6600993377, 21159.153771328736, 136813.60077109578, 550897.5652321755, -48670.36242194495, 85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-24616.80284401711, 19056.722918085423, 14778.658510602749, 145978.19899873232, 95197.50818470622, 28095.72018167678, 100656.13255707255, 26957.76741121192, 68945.73347946239, 66715.10129048133, 24828.19102641684, 18847.76727307672, 28626.81596196199, 155543.45675102645, -26140.49215346822, 19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092], "policy_policy_mean_reward": [-21317.15551655642, 16196.143813302788, 24898.997075305975, 157635.49992370963, 62150.574165576676, 34050.01324544998, 66051.99592135755, 10248.888120542368, 72353.48193928676, 47781.36257678769, 93131.73224272176, 4797.435204233994, 35142.19328881834, 104656.43599772875, 205.50983621390216, 32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273], "policy_policy_mm_reward": [-1556.0809481097724, 18555.78890854194, 19604.858562360863, 161640.96343270034, 68155.73838526053, 48309.62969880108, 78071.83363663426, 8282.244235068176, 80336.07207083996, 58167.30559876945, 31657.10402555654, -7743.345809829282, 41454.56710014225, 140774.66473175588, -7327.956441275778, 20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545], "policy_policy_rl_reward": [-14458.435440390225, 10279.894607597547, 23681.959380022563, 198686.00417569035, 76973.43971352738, 31236.81173010852, 71167.12412692678, 26302.331874766864, 107987.32574849472, 81403.84193157592, 54076.632804642904, 5257.29710384735, 31590.024420173228, 149923.00775166551, -15407.423663414917, 12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23048330219111354, "mean_inference_ms": 0.7474947930771981, "mean_action_processing_ms": 0.11668753089433252, "mean_env_wait_ms": 0.1713805645042924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007559657096862793, "StateBufferConnector_ms": 0.000723719596862793, "ViewRequirementAgentConnector_ms": 0.01875203847885132}, "num_episodes": 16, "episode_return_max": 952695.057766875, "episode_return_min": -179694.66312487537, "episode_return_mean": 205814.91078332163, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 665.2434649899961, "num_env_steps_trained_throughput_per_sec": 665.2434649899961, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 5929.941, "restore_workers_time_ms": 0.046, "training_step_time_ms": 5929.831, "sample_time_ms": 5333.73, "learn_time_ms": 590.95, "learn_throughput": 6768.765, "synch_weights_time_ms": 4.372}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-50", "timestamp": 1760509550, "time_this_iter_s": 6.020850896835327, "time_total_s": 270.4560880661011, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156d77240>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 270.4560880661011, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 56.77777777777778, "ram_util_percent": 84.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6171756982803345, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.93998892903328, "policy_loss": -0.025013820698222843, "vf_loss": 9.957471254467965, "vf_explained_var": -3.28943133354187e-07, "kl": 0.016736736233179138, "entropy": 4.064466328918934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 206874.53651220555, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 227978.17168008376, "policy_mean": 246458.66950893812, "policy_mm": 199941.28077712722, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 50207.55109782177, "policy_mean": 48084.71522407441, "policy_mm": 50176.630165591705, "policy_rl": 58405.64002471771}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50207.5546875, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 227978.171875, "('mean_0', 'policy_mean')_total_reward_mean": 48084.71484375, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 50176.62890625, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 199941.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58405.640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [85164.69543217614, 449810.7204380746, 18060.555310897253, 271042.774887944, 192835.57921021906, 52852.42964423204, 210243.48828478093, 131631.68883416682, -32109.15686755457, 175727.23489862948, 273906.8961618406, 76351.05181244652, 684883.430658691, 78880.86083609324, 20552.00740777397, -95278.14281953474, 538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [19212.625270314504, 130173.11074126534, 8897.207482268539, 97245.53633479906, 34800.572741789365, 12968.51414548074, 53699.55312582211, 55436.490768929565, -15742.388933025613, 60534.15929407359, 65766.47757169623, 13781.187570743461, 134777.91835891188, 47250.313983000015, -4734.860162231578, -23792.550551264456, 159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783], "policy_policy_mean_reward": [32100.700412433573, 93902.3361942171, -1087.7586296596226, 21427.64113233869, 51231.66486890192, 10753.97431082066, 53637.56000327024, 28676.50632655922, -5003.534890698323, 42594.48303876796, 49494.20637866188, 22067.14737902026, 225579.0142574072, 14979.018529619998, 9607.796860319082, -8602.79663151774, 92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129], "policy_policy_mm_reward": [20873.03545978942, 86329.38602880044, 9769.957322599777, 66258.69443728284, 42633.006137660246, 16412.427788283985, 43282.797363916856, 29706.021204322045, -596.6641061859464, 30097.634446221327, 62305.641232191985, 17450.188500112617, 119082.49324494695, 13242.758928325053, 6860.22853768192, -35133.13284261901, 79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273], "policy_policy_rl_reward": [12978.334289638644, 139405.88747379187, 481.14913568855457, 86110.90298352351, 64170.33546186733, 12717.513399646834, 59623.57779177157, 17812.670534355962, -10766.568937644539, 42500.9581195664, 96340.57097929087, 23052.528362570192, 205444.00479742486, 3408.769395148064, 8818.842172004524, -27749.662794133517, 205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23084877009516128, "mean_inference_ms": 0.7495765167633417, "mean_action_processing_ms": 0.1169095065801005, "mean_env_wait_ms": 0.1717913554832594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007830262184143066, "StateBufferConnector_ms": 0.0007417798042297363, "ViewRequirementAgentConnector_ms": 0.019574224948883057}, "num_episodes": 15, "episode_return_max": 952695.057766875, "episode_return_min": -179694.66312487537, "episode_return_mean": 206874.53651220555, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.8612392740937, "num_env_steps_trained_throughput_per_sec": 504.8612392740937, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 6156.138, "restore_workers_time_ms": 0.049, "training_step_time_ms": 6156.023, "sample_time_ms": 5555.112, "learn_time_ms": 595.228, "learn_throughput": 6720.114, "synch_weights_time_ms": 4.782}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "26ec2_00000", "date": "2025-10-15_01-25-58", "timestamp": 1760509558, "time_this_iter_s": 7.929049730300903, "time_total_s": 278.385137796402, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed53a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 278.385137796402, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 61.31818181818182, "ram_util_percent": 84.06363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8856194019317627, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.0003, "total_loss": 9.950440138578415, "policy_loss": -0.019959880739043, "vf_loss": 9.961071702837945, "vf_explained_var": -6.174668669700623e-07, "kl": 0.020729704462428673, "entropy": 4.032322462648153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 224274.2719803311, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 227978.17168008376, "policy_mean": 246458.66950893812, "policy_mm": 199941.28077712722, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 53555.674022317275, "policy_mean": 51889.90197107774, "policy_mm": 55012.70776198618, "policy_rl": 63815.98822494992}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53555.67578125, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 227978.171875, "('mean_0', 'policy_mean')_total_reward_mean": 51889.90625, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 55012.703125, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 199941.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63815.99609375, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [538109.0080081394, -66914.49554841159, 54383.406387852156, 284358.56550870213, 366931.1248954805, 3911.507205984086, 295623.09532380616, -11526.930458578561, -9373.869596045091, 31988.830892963782, 218520.61095597962, 68129.73921489938, 509901.9533506557, -88231.05098454171, 38389.29420127225, 178888.97140367184, 436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [159913.64490522607, -19693.428163225813, 9568.175490375885, 64063.62694503715, 111335.24821537956, 27753.79619074033, 68521.1671315467, -17254.090527032622, -6302.643387474128, 1724.6779550761228, 47885.542801278774, 21250.607708618663, 116729.93210893068, -14873.763241201854, 6736.408644123157, 48448.66305504646, 136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827], "policy_policy_mean_reward": [92943.74439392226, -24930.4469703527, 31743.978350256508, 82939.66231825521, 101164.1469553198, 7719.78753172115, 55472.09820793568, 2359.352905124087, 20251.09759533741, 28994.11893112969, 37019.582296189044, 15745.21488358618, 135466.38437486504, -16245.065038010729, 23474.02239162332, 24702.063921348752, 103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651], "policy_policy_mm_reward": [79687.55988867112, -13029.62642181803, 4940.845560354893, 68708.8891114291, 107066.5006901376, -12508.43053442893, 79713.63654639717, -2498.132319508266, -13656.154875777262, 1414.8641900051166, 75909.0772924491, 23845.716237470446, 89777.71119819875, -30898.107007609313, 3760.9281205728407, 46874.515521966845, 79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906], "policy_policy_rl_reward": [205564.05882031913, -9260.993993015003, 8130.406986864712, 68646.38713398078, 47365.22903464345, -19053.64598204842, 91916.19343792647, 5865.939482838188, -9666.16892813093, -144.83018324725927, 57706.408566062855, 7288.200385224112, 167927.92566866134, -26214.115697719757, 4417.935044953025, 58863.728905309625, 116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23126965309053463, "mean_inference_ms": 0.7518112856570466, "mean_action_processing_ms": 0.1171562721668661, "mean_env_wait_ms": 0.17225108165041209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007889866828918457, "StateBufferConnector_ms": 0.0007635354995727539, "ViewRequirementAgentConnector_ms": 0.019782602787017822}, "num_episodes": 16, "episode_return_max": 952695.057766875, "episode_return_min": -179694.66312487537, "episode_return_mean": 224274.2719803311, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 589.0195764246484, "num_env_steps_trained_throughput_per_sec": 589.0195764246484, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 6276.988, "restore_workers_time_ms": 0.051, "training_step_time_ms": 6276.864, "sample_time_ms": 5668.192, "learn_time_ms": 602.591, "learn_throughput": 6637.997, "synch_weights_time_ms": 5.119}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-05", "timestamp": 1760509565, "time_this_iter_s": 6.801736831665039, "time_total_s": 285.186874628067, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4fe0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 285.186874628067, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.57000000000001, "ram_util_percent": 84.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5971086025238037, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.942788648605347, "policy_loss": -0.02561260563961696, "vf_loss": 9.95956618785858, "vf_explained_var": -3.7252902984619143e-10, "kl": 0.013089000670879942, "entropy": 4.029540548473596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 952695.057766875, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 221757.85627557695, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 227978.17168008376, "policy_mean": 246458.66950893812, "policy_mm": 199941.28077712722, "policy_rl": 352034.312690836}, "policy_reward_mean": {"policy_mom": 53169.24263270839, "policy_mean": 50256.97026792335, "policy_mm": 55229.46857018938, "policy_rl": 63102.17480475585}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53169.23828125, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 227978.171875, "('mean_0', 'policy_mean')_total_reward_mean": 50256.96484375, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 55229.46875, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 199941.28125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63102.1796875, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 352034.3125}, "hist_stats": {"episode_reward": [436050.71345830767, 9448.746369735823, -41229.59288433197, 339314.4107522523, -9201.091182640137, 385860.8543063102, 368561.9544085822, 490866.31805086305, 104736.6009710959, 195814.98825459048, 952695.057766875, 203742.05219874636, 181746.16083038462, -53574.71464899114, 748956.9849128427, 105508.50574847723, 162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [136279.42598586986, 10857.031735769457, -13073.798988269738, 73292.26615477329, 7747.537926923009, 69887.65578260014, 103006.71275820553, 97625.63392208288, 22398.099025162875, 35921.559132784576, 205000.50539531244, 42177.31325847551, 56757.18559292953, -12811.029000116636, 154307.27763192178, 22628.90423256076, 43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221], "policy_policy_mean_reward": [103908.68536374389, 9488.366495467684, -14449.907723696475, 65360.666552774535, -600.8912590813557, 78374.27170694145, 99311.70319653119, 100857.25687097125, 18420.959871338186, 72044.07880040926, 207976.99010030588, 75507.72283988283, 28239.109548377986, -10968.4219636869, 149834.28537199646, 29111.872210522404, 30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746], "policy_policy_mm_reward": [79331.37402190802, -22186.367817983428, -11982.235833816712, 117297.13974392966, 9837.859335021461, 111977.84341773414, 89780.93702967354, 127730.39637957595, 29252.130068669827, 49733.744093686124, 187683.24958042114, 27843.12346293506, 60619.83645208342, -11202.23282160291, 185693.89006509024, 29111.226207153803, 34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826], "policy_policy_rl_reward": [116531.22808678613, 11289.715956482065, -1723.650338549184, 83364.33830077482, -26185.597185503273, 125621.08339903418, 76462.60142417256, 164653.03087823302, 34665.41200592503, 38115.6062277103, 352034.312690836, 58213.89263745297, 36130.02923699341, -18593.030863584678, 259121.53184383543, 24656.50309824055, 54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23168530598360298, "mean_inference_ms": 0.754016322923728, "mean_action_processing_ms": 0.11739978076611206, "mean_env_wait_ms": 0.1727028849332793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007843375205993652, "StateBufferConnector_ms": 0.0007640719413757324, "ViewRequirementAgentConnector_ms": 0.019809424877166748}, "num_episodes": 16, "episode_return_max": 952695.057766875, "episode_return_min": -179694.66312487537, "episode_return_mean": 221757.85627557695, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 651.0023782603005, "num_env_steps_trained_throughput_per_sec": 651.0023782603005, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 6327.02, "restore_workers_time_ms": 0.044, "training_step_time_ms": 6326.909, "sample_time_ms": 5717.079, "learn_time_ms": 603.376, "learn_throughput": 6629.363, "synch_weights_time_ms": 5.479}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-11", "timestamp": 1760509571, "time_this_iter_s": 6.152964115142822, "time_total_s": 291.33983874320984, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5d00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 291.33983874320984, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 50.575, "ram_util_percent": 84.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.137887954711914, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.955375030636787, "policy_loss": -0.018077076214831324, "vf_loss": 9.960330241918564, "vf_explained_var": 1.989305019378662e-07, "kl": 0.019439718611284084, "entropy": 4.086375863850117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -179694.66312487537, "episode_reward_mean": 209144.9357570297, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -48730.63371017669, "policy_mm": -48878.23090567767, "policy_rl": -46653.957952324534}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 246458.66950893812, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 50891.010200442506, "policy_mean": 46922.96482011487, "policy_mm": 51477.6520588684, "policy_rl": 59853.308677603934}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50891.00390625, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 46922.96484375, "('mean_0', 'policy_mean')_total_reward_min": -48730.6328125, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 51477.6484375, "('mm_0', 'policy_mm')_total_reward_min": -48878.23046875, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59853.31640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -46653.95703125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [162437.04272748766, 322048.64377499017, -171334.07115011624, 345588.88415376673, 207563.36853780472, 375190.10510082205, 207550.8053894984, 246183.9826405067, -28529.7145126096, 252744.2293200717, -179694.66312487537, 219274.99841875458, 101718.13240938452, -55164.4259991566, 234920.61792900183, -51046.4990544078, 23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [43532.03964076584, 82162.05258655848, -34384.60867659995, 117671.07788987605, 43500.20307593907, 118605.70192397962, 61580.93285321601, 75152.15179152467, 8386.086801490415, 42343.58661561258, -40630.576659068036, 59522.68678480525, 4345.6783601314355, -16262.43082119321, 44837.06710260285, -18282.55098482043, 10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576], "policy_policy_mean_reward": [30002.886386199836, 73638.46873891402, -41965.27607817621, 53741.747476276716, 52610.67313802394, 59410.04622576521, 51524.40313633733, 58026.50126298255, -19826.264480909984, 54871.13767546531, -48730.63371017669, 57373.64469969225, 30576.739728374992, -6672.007831946472, 67607.06715580937, -6942.658758758662, 3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793], "policy_policy_mm_reward": [34568.580076994134, 79999.82455990663, -48878.23090567767, 78784.5115577239, 50319.80903511631, 110073.52797544187, 59750.588412418816, 48039.346003150284, 2494.353698667798, 67344.78051977398, -43679.49480330608, 59405.41609688849, 33372.604352978145, -5910.554051327039, 61346.67187315231, -1235.6587786682599, -4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603], "policy_policy_rl_reward": [54333.53662352771, 86248.29788961106, -46105.95548966245, 95391.54722989013, 61132.68328872534, 87100.82897563546, 34694.880987526194, 64965.98358284921, -19583.89053185789, 88184.72450921961, -46653.957952324534, 42973.25083736848, 33423.10996789994, -26319.433294689956, 61129.811797437054, -24585.630532160445, 14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23207413583529266, "mean_inference_ms": 0.7560214813183025, "mean_action_processing_ms": 0.11762624517092587, "mean_env_wait_ms": 0.1731226933701446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007676482200622559, "StateBufferConnector_ms": 0.0007450580596923828, "ViewRequirementAgentConnector_ms": 0.01947551965713501}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -179694.66312487537, "episode_return_mean": 209144.9357570297, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.1933954785036, "num_env_steps_trained_throughput_per_sec": 694.1933954785036, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 6330.13, "restore_workers_time_ms": 0.074, "training_step_time_ms": 6329.981, "sample_time_ms": 5718.185, "learn_time_ms": 605.325, "learn_throughput": 6608.026, "synch_weights_time_ms": 5.496}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-17", "timestamp": 1760509577, "time_this_iter_s": 5.76682186126709, "time_total_s": 297.10666060447693, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4d9e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 297.10666060447693, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 42.77777777777777, "ram_util_percent": 84.22222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0864691734313965, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.95149251818657, "policy_loss": -0.01749364787247032, "vf_loss": 9.958661836385726, "vf_explained_var": -7.120892405509949e-07, "kl": 0.015295304519099773, "entropy": 3.8529665276408194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -136468.48049198854, "episode_reward_mean": 239266.80885299243, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -37807.788644052496, "policy_mm": -42467.79853081936, "policy_rl": -22845.362740694265}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 246458.66950893812, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 56742.53921181874, "policy_mean": 54905.49754140113, "policy_mm": 58081.43331793985, "policy_rl": 69537.33878183266}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56742.546875, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 54905.50390625, "('mean_0', 'policy_mean')_total_reward_min": -37807.7890625, "('mean_0', 'policy_mean')_total_reward_max": 246458.671875, "('mm_0', 'policy_mm')_total_reward_mean": 58081.43359375, "('mm_0', 'policy_mm')_total_reward_min": -42467.796875, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69537.34375, "('rl_trader_0', 'policy_rl')_total_reward_min": -22845.36328125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [23442.011266395606, 346308.6556124823, 337012.99113797396, 294642.8289477021, 57120.534021329215, 11842.402658181496, 418659.86174492765, 282519.71210179833, 176265.73381270582, 363226.27937287884, -1908.4086659095817, 885177.8215207986, 87977.45577798465, 240119.94386480167, 272493.3234419098, 612641.2043606002, 307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [10236.073289203832, 65356.945374131945, 89047.12347716876, 48223.35620562418, 42419.347579019326, 3376.9785500284634, 127951.92880478219, 62955.58504162744, 35830.47877749314, 115941.27020639068, -10072.836050875327, 151579.41165884896, 13973.890517988038, 55723.57589035344, 43439.88774025004, 202505.2983233447, 60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981], "policy_policy_mean_reward": [3219.0679146153316, 91381.06375019682, 75707.34448090673, 74793.50448994344, 14949.633256082832, -6453.899483149005, 78094.78597942143, 62468.473479096625, 48112.44398059848, 73044.69361180099, 3733.4531701423625, 246458.66950893812, -1938.9223768789648, 58647.12694955334, 83137.35792367806, 101633.1118463035, 65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745], "policy_policy_mm_reward": [-4040.994889971162, 91688.80628903284, 106678.92639332051, 90953.19085536317, 3377.305630601519, 9668.282511993231, 99586.21869250038, 73223.75848081101, 36789.1693022853, 73387.59643879085, 6742.505723721148, 176878.88161234392, 48436.1582613703, 43117.28799604021, 66284.74847552236, 88496.11098406342, 71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811], "policy_policy_rl_reward": [14027.864952547663, 97881.84019912087, 65579.59678657759, 80672.77739677137, -3625.752444374472, 5251.041079308745, 113026.92826822231, 83871.89510026318, 55533.64175232879, 100852.71911589599, -2311.5315088979055, 310260.85874066764, 27506.329375505444, 82631.95302885467, 79631.32930245934, 220006.68320688853, 109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23243059249746773, "mean_inference_ms": 0.7579735518174363, "mean_action_processing_ms": 0.11783531768664325, "mean_env_wait_ms": 0.17351326601190564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007640719413757324, "StateBufferConnector_ms": 0.0007494091987609863, "ViewRequirementAgentConnector_ms": 0.019400179386138916}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -136468.48049198854, "episode_return_mean": 239266.80885299243, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 669.3351692703591, "num_env_steps_trained_throughput_per_sec": 669.3351692703591, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 6321.851, "restore_workers_time_ms": 0.073, "training_step_time_ms": 6321.7, "sample_time_ms": 5726.36, "learn_time_ms": 589.053, "learn_throughput": 6790.555, "synch_weights_time_ms": 5.306}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-23", "timestamp": 1760509583, "time_this_iter_s": 5.984385251998901, "time_total_s": 303.09104585647583, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 303.09104585647583, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.225, "ram_util_percent": 84.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.072352886199951, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.949166789650917, "policy_loss": -0.019971701301983558, "vf_loss": 9.95865658223629, "vf_explained_var": -1.3984739780426025e-06, "kl": 0.015528715527102954, "entropy": 3.970920919626951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 232749.13170680695, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43566.383615112456, "policy_mean": -43432.89535589121, "policy_mm": -42467.79853081936, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 245041.16680612272, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 54987.05799685223, "policy_mean": 53276.734914107954, "policy_mm": 56566.04490828664, "policy_rl": 67919.29388756007}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54987.05859375, "('mom_0', 'policy_mom')_total_reward_min": -43566.3828125, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 53276.734375, "('mean_0', 'policy_mean')_total_reward_min": -43432.89453125, "('mean_0', 'policy_mean')_total_reward_max": 245041.171875, "('mm_0', 'policy_mm')_total_reward_mean": 56566.046875, "('mm_0', 'policy_mm')_total_reward_min": -42467.796875, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67919.2890625, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [307509.6018980841, -9894.795056401734, 547613.8618773968, 539330.4122937749, 144457.5747420666, 858250.2000808904, 134153.0235694146, 130796.2934239374, 124451.87661119546, -111588.23019351036, 144218.70470589938, 286165.4024129288, 192761.54992125434, 149597.65978743747, 690027.2982292441, 174504.0230828368, 230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [60143.59968204694, -2697.9419495533184, 129101.41034840679, 139609.70209141204, 35807.13147358092, 227978.17168008376, 14229.240687483074, 28926.078050263477, 15091.660236846115, -43566.383615112456, 14706.851065404237, 46139.24097035698, 58266.47157396336, 56013.03331846843, 127656.47340815762, 47481.09305434011, 64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653], "policy_policy_mean_reward": [65686.20247305246, 723.4128634869971, 77059.81395315599, 113495.88999347312, 37094.27152872273, 134857.2614881905, 39826.954604726016, 30474.023394000014, 41041.947331040814, -28738.78700310736, 36950.575449342956, 71380.5102146575, 42582.16026058452, 19763.575601331628, 202155.30022519367, 55310.100545719084, 43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062], "policy_policy_mm_reward": [71768.95019174267, 2093.5143652624265, 175364.12402593615, 157461.91279625223, 41615.64485873545, 199941.28077712722, 51210.141031824365, 33789.28338394856, 38733.89674890921, -16437.69683459632, 32610.22645099854, 107101.7164056773, 60313.956429158774, 27452.890785914773, 192297.1727067872, 34303.723142799296, 81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577], "policy_policy_rl_reward": [109910.84955124202, -10013.78033559785, 166088.51354989735, 128762.90741263723, 29940.526881027577, 295473.48613548937, 28886.687245381036, 37606.90859572529, 29584.372294399273, -22845.362740694265, 59951.05174015382, 61543.93482223707, 31598.96165754743, 46368.160081722635, 167918.35188910604, 37409.106339978396, 41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23286148782681593, "mean_inference_ms": 0.7601335940758088, "mean_action_processing_ms": 0.11807432380641977, "mean_env_wait_ms": 0.1739637523840752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000798642635345459, "StateBufferConnector_ms": 0.0007904171943664551, "ViewRequirementAgentConnector_ms": 0.020161330699920654}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -158548.34290695356, "episode_return_mean": 232749.13170680695, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 595.9574097524402, "num_env_steps_trained_throughput_per_sec": 595.9574097524402, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 6316.896, "restore_workers_time_ms": 0.066, "training_step_time_ms": 6316.756, "sample_time_ms": 5704.623, "learn_time_ms": 605.876, "learn_throughput": 6602.013, "synch_weights_time_ms": 5.261}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-30", "timestamp": 1760509590, "time_this_iter_s": 6.71809196472168, "time_total_s": 309.8091378211975, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4c720>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 309.8091378211975, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 62.25, "ram_util_percent": 84.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7259441614151, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.947535589337349, "policy_loss": -0.020392068033106624, "vf_loss": 9.95968462228775, "vf_explained_var": -3.520213067531586e-06, "kl": 0.012211909561756638, "entropy": 4.10065321624279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 197102.55367896528, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -39579.13120767667, "policy_mean": -43432.89535589121, "policy_mm": -42467.79853081936, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 245041.16680612272, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 46850.922488028846, "policy_mean": 45883.798489785324, "policy_mm": 46265.262745863765, "policy_rl": 58102.569955287305}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 46850.921875, "('mom_0', 'policy_mom')_total_reward_min": -39579.1328125, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 45883.80078125, "('mean_0', 'policy_mean')_total_reward_min": -43432.89453125, "('mean_0', 'policy_mean')_total_reward_max": 245041.171875, "('mm_0', 'policy_mm')_total_reward_mean": 46265.265625, "('mm_0', 'policy_mm')_total_reward_min": -42467.796875, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58102.578125, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [230787.96316883535, 2939.4247088030647, 62189.96361378183, 65244.23059939738, 124544.04136651856, 142053.26678041325, 785669.282674604, -82386.41293373864, 68931.2061818084, 435353.97955540346, 422871.33920036553, 113943.40940067571, 267060.7476872427, 678491.6745105486, 254459.03215940951, 155304.96120690127, 248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [64656.393797594974, -12141.929539879275, 15895.881766111324, 18807.80388999783, 9733.000934480926, 37950.04374389931, 159053.18477567323, -28370.168690387836, 45907.28467853333, 70343.53575369643, 112837.60510958817, 36636.31115412724, 71433.89422498585, 172933.50285269503, 72667.51654648899, 37132.52520097316, 48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597], "policy_policy_mean_reward": [43705.44550526876, 18888.996630342295, 33370.55926179256, 28014.47426983129, 24118.480130094507, 31475.91711205598, 231083.78091240613, -16674.835780648424, -1177.0185092131858, 75073.07760991082, 106809.45319927021, 38372.28695773302, 63597.36139621024, 128819.23909206009, 88089.18819871743, 29110.693792692444, 44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586], "policy_policy_mm_reward": [81377.58537809328, -1054.4477569930893, 8154.095166138067, 24294.837858109273, 46595.08873482634, 37649.04445346527, 152891.2764048175, -15876.366602509754, 648.6354366984809, 144232.59461707014, 102957.94917029433, 16409.799500964255, 52652.71365619096, 151595.4980869372, 36246.469581750316, 63328.56402081255, 85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275], "policy_policy_rl_reward": [41048.5384878785, -2753.1946246669013, 4769.427419739645, -5872.885418540985, 44097.471567116874, 34978.26147099242, 242641.04058170674, -21465.041860192574, 23552.30457578972, 145704.77157472642, 100266.33172121321, 22525.01178785116, 79376.77840985537, 225143.43447885622, 57455.8578324524, 25733.1781924232, 68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2332222205276582, "mean_inference_ms": 0.761412569855567, "mean_action_processing_ms": 0.11825540563391897, "mean_env_wait_ms": 0.1743360529344694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007604360580444336, "StateBufferConnector_ms": 0.0007677674293518066, "ViewRequirementAgentConnector_ms": 0.019347012042999268}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -158548.34290695356, "episode_return_mean": 197102.55367896528, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 659.9009174105518, "num_env_steps_trained_throughput_per_sec": 659.9009174105518, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 6337.346, "restore_workers_time_ms": 0.077, "training_step_time_ms": 6337.194, "sample_time_ms": 5724.018, "learn_time_ms": 606.645, "learn_throughput": 6593.645, "synch_weights_time_ms": 5.511}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-36", "timestamp": 1760509596, "time_this_iter_s": 6.066404104232788, "time_total_s": 315.8755419254303, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ef20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 315.8755419254303, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.612500000000004, "ram_util_percent": 83.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6195205450057983, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.941761419177055, "policy_loss": -0.022431708939257076, "vf_loss": 9.956457084417343, "vf_explained_var": -1.5124678611755372e-07, "kl": 0.011460890007493008, "entropy": 4.094882253557444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 173984.28991903912, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -43432.89535589121, "policy_mm": -42467.79853081936, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 245041.16680612272, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 41169.89232632039, "policy_mean": 40327.915899116626, "policy_mm": 41262.21607990026, "policy_rl": 51224.265613701864}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 41169.890625, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 40327.9140625, "('mean_0', 'policy_mean')_total_reward_min": -43432.89453125, "('mean_0', 'policy_mean')_total_reward_max": 245041.171875, "('mm_0', 'policy_mm')_total_reward_mean": 41262.21875, "('mm_0', 'policy_mm')_total_reward_min": -42467.796875, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51224.26953125, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [248120.25493206212, 595650.8809464293, 146142.97649306353, -21680.97921827721, -17317.22999655946, 301567.5995981673, -66362.83579968469, 229010.9983005868, 132387.55042154668, 16114.081346514333, 222905.22242757984, -96041.0147066155, 118860.78741421095, 284212.4511329472, 36939.830734089664, -60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [48714.81171597872, 133606.52773808327, 48021.15937600174, -3514.574922693827, -7959.227256727268, 81130.5298917441, -5475.994024647954, 42889.304337230715, 48297.70328418162, -12256.837210293843, 65902.39249355646, -27814.762548673007, 22849.711447535763, 79899.58074214897, -14104.445569581438, -20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755], "policy_policy_mean_reward": [44544.226520357406, 162736.06379245757, 29512.347774452097, -13613.627957761651, 2735.0829460855516, 65934.43009296605, -20311.951105234566, 76911.3981893154, 33002.89451737048, 17896.641082605936, 55721.56481338085, -30312.8512658451, 33495.439743207695, 70349.09748258982, 15097.459479723218, -31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572], "policy_policy_mm_reward": [85952.13974589667, 116453.4991370788, 28891.200501185933, -8445.873122699906, -4107.135884707652, 74526.52028880146, -19574.62277045669, 59783.85569531923, 26553.73975987306, 7351.422872105324, 48828.251905306766, -15072.575754986445, 22632.117785336137, 61070.72701744257, 23367.063738036795, 3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496], "policy_policy_rl_reward": [68909.07694982924, 182854.7902788097, 39718.26884142389, 3893.096784878345, -7985.949801210059, 79976.11932465574, -21000.26789934535, 49426.440078721695, 24533.21286012169, 3122.8546020967965, 52453.01321533527, -22840.825137111067, 39883.51843813155, 72893.0458907658, 12579.753085910957, -11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23343657607838988, "mean_inference_ms": 0.7619566533983627, "mean_action_processing_ms": 0.11835485391479846, "mean_env_wait_ms": 0.17455477999189864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007471442222595215, "StateBufferConnector_ms": 0.0007486343383789062, "ViewRequirementAgentConnector_ms": 0.018964409828186035}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -158548.34290695356, "episode_return_mean": 173984.28991903912, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 686.9668623113711, "num_env_steps_trained_throughput_per_sec": 686.9668623113711, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 6301.338, "restore_workers_time_ms": 0.076, "training_step_time_ms": 6301.191, "sample_time_ms": 5686.992, "learn_time_ms": 608.594, "learn_throughput": 6572.527, "synch_weights_time_ms": 4.512}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-42", "timestamp": 1760509602, "time_this_iter_s": 5.8277740478515625, "time_total_s": 321.70331597328186, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6020>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 321.70331597328186, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 41.477777777777774, "ram_util_percent": 84.01111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.939078688621521, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.947869408130646, "policy_loss": -0.025540441463817842, "vf_loss": 9.962706208229065, "vf_explained_var": 2.000480890274048e-07, "kl": 0.015857292695591503, "entropy": 3.9321767129004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 194114.02961675034, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -43432.89535589121, "policy_mm": -45390.74947494426, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 251832.43931114796, "policy_mean": 245041.16680612272, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 45945.70424995904, "policy_mean": 43572.32122152409, "policy_mm": 46635.224173680675, "policy_rl": 57960.77997158654}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45945.69921875, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 251832.4375, "('mean_0', 'policy_mean')_total_reward_mean": 43572.32421875, "('mean_0', 'policy_mean')_total_reward_min": -43432.89453125, "('mean_0', 'policy_mean')_total_reward_max": 245041.171875, "('mm_0', 'policy_mm')_total_reward_mean": 46635.2265625, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 57960.78515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [-60093.17872480742, 312766.38912638585, -6432.192513278739, 98453.5005288326, 654476.2309965019, 155340.04481990982, -136468.48049198854, -45112.72237026202, 369836.9830656038, 879456.9826709676, 50511.78498014392, -105320.18987547125, -28562.817740293835, 173493.0023854448, 112682.39695371872, -7901.9699073417205, 85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-20716.529695776495, 74133.92835337415, 3174.4469585238835, 35597.98242013769, 221616.6432488221, 30094.017847321615, -39579.13120767667, -1051.6563705403594, 82150.17047224291, 251832.43931114796, 50754.7695445078, -22008.34960541497, -8740.827236119327, 52063.28439106885, 8141.446040777637, 20008.000257988795, 38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088], "policy_policy_mean_reward": [-31227.377655509288, 52910.63763116653, -20668.810649141145, 26171.097481856228, 107821.8199482746, 51482.2264995934, -37807.788644052496, -22774.070779734677, 74169.87968651367, 192255.44017470375, -5924.978416953508, -28406.452663592416, -10191.022394887792, 33690.62539063689, 48098.02833214334, -19178.601682266955, 8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474], "policy_policy_mm_reward": [3117.610454518774, 95402.46547191893, 8443.791415692966, 19415.068551932833, 119047.57347269826, 36981.379890627315, -42467.79853081936, -7900.297799838078, 110226.38798313755, 147085.05369647004, 1466.18161931964, -35621.563594069296, 807.3647790175326, 28683.78705574358, 37471.2669529929, -7974.874288405288, 22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649], "policy_policy_rl_reward": [-11266.881828040414, 90319.35766992641, 2618.3797616455863, 17269.35207490634, 205990.1943267064, 36782.42058236752, -16613.76210944, -13386.697420148916, 103290.54492371078, 288284.04948864534, 4215.8122332700905, -19283.824012394532, -10438.332888304263, 59055.30554799554, 18971.65562780472, -756.4941946583431, 16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23360058124556005, "mean_inference_ms": 0.7624023314935635, "mean_action_processing_ms": 0.11842793448221042, "mean_env_wait_ms": 0.17471713314418097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007408857345581055, "StateBufferConnector_ms": 0.0007335543632507324, "ViewRequirementAgentConnector_ms": 0.01881951093673706}, "num_episodes": 15, "episode_return_max": 993384.4307779723, "episode_return_min": -158548.34290695356, "episode_return_mean": 194114.02961675034, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 632.3071912832958, "num_env_steps_trained_throughput_per_sec": 632.3071912832958, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 6353.186, "restore_workers_time_ms": 0.068, "training_step_time_ms": 6353.048, "sample_time_ms": 5715.765, "learn_time_ms": 630.922, "learn_throughput": 6339.928, "synch_weights_time_ms": 5.15}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-48", "timestamp": 1760509608, "time_this_iter_s": 6.333923101425171, "time_total_s": 328.03723907470703, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4a40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 328.03723907470703, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 47.76666666666667, "ram_util_percent": 84.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9248626232147217, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.946579745411873, "policy_loss": -0.023024538406752983, "vf_loss": 9.959479588270188, "vf_explained_var": -1.8887221813201905e-07, "kl": 0.014999538409438634, "entropy": 3.7656770065426826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 993384.4307779723, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 200656.04483078455, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -43432.89535589121, "policy_mm": -45390.74947494426, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 203944.74911049844, "policy_mean": 245041.16680612272, "policy_mm": 219564.04555682794, "policy_rl": 346812.8267084628}, "policy_reward_mean": {"policy_mom": 45811.24084106616, "policy_mean": 46514.145982468566, "policy_mm": 48097.62886885383, "policy_rl": 60233.02913839594}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45811.23828125, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 203944.75, "('mean_0', 'policy_mean')_total_reward_mean": 46514.1484375, "('mean_0', 'policy_mean')_total_reward_min": -43432.89453125, "('mean_0', 'policy_mean')_total_reward_max": 245041.171875, "('mm_0', 'policy_mm')_total_reward_mean": 48097.625, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 219564.046875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 60233.03515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 346812.8125}, "hist_stats": {"episode_reward": [85398.95959494048, -34831.00560152665, 993384.4307779723, 630666.7278630043, 65431.77033355554, 570057.6874925394, 361336.94833539927, -59608.27593653683, 389405.23755059193, -43700.071133305995, 730886.5559217053, 568360.3058277104, 320783.08698673657, 761445.258197838, 224686.26364702493, 153294.9034514128, 263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [38372.88344923772, -11913.547072324809, 203944.74911049844, 84384.07382370839, 45726.714563975576, 146537.68766524838, 63187.99899191201, -14524.103455291159, 80394.03629180968, -3914.232391561666, 188294.20098051475, 126981.93203333956, 77948.73610146773, 122849.79586395473, 56043.048354751874, 26928.32932546326, 73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482], "policy_policy_mean_reward": [8429.677850323262, 6905.109607468299, 245041.16680612272, 123974.76940612476, 19252.19402980793, 147914.57706438427, 91631.5099172091, -13348.179810235544, 120112.08293856125, -18697.599832965483, 126224.14058137305, 142229.7528879555, 53698.645317735725, 202057.98253586682, 57516.52275530786, 32619.53377761663, 62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445], "policy_policy_mm_reward": [22282.210776351894, -14605.060097126272, 197585.68815288725, 219564.04555682794, -8243.509900736603, 98406.31985975175, 128203.46026093456, -20993.14561757568, 86050.38349031824, -17351.455745674997, 170796.82843031804, 123834.22739242636, 104706.18768003416, 161244.2000494546, 63329.75802138532, 40997.374049563055, 63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354], "policy_policy_rl_reward": [16314.187519027579, -15217.508039543922, 346812.8267084628, 202743.8390763429, 8696.371640508656, 177199.10290315407, 78313.97916534347, -10742.84705343452, 102848.73482990317, -3736.7831631037693, 245571.38592949923, 175314.3935139885, 84429.51788749931, 275293.27974856267, 47796.934515580004, 52749.6662987703, 64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2337664256136337, "mean_inference_ms": 0.7628363715051154, "mean_action_processing_ms": 0.11850061712936338, "mean_env_wait_ms": 0.17487397872386828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007471442222595215, "StateBufferConnector_ms": 0.00074005126953125, "ViewRequirementAgentConnector_ms": 0.018877267837524414}, "num_episodes": 16, "episode_return_max": 993384.4307779723, "episode_return_min": -158548.34290695356, "episode_return_mean": 200656.04483078455, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.3405882604296, "num_env_steps_trained_throughput_per_sec": 687.3405882604296, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 6333.859, "restore_workers_time_ms": 0.07, "training_step_time_ms": 6333.717, "sample_time_ms": 5699.232, "learn_time_ms": 628.804, "learn_throughput": 6361.283, "synch_weights_time_ms": 4.432}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "26ec2_00000", "date": "2025-10-15_01-26-54", "timestamp": 1760509614, "time_this_iter_s": 5.824412107467651, "time_total_s": 333.8616511821747, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5da0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 333.8616511821747, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 51.2, "ram_util_percent": 84.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8106775283813477, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.946229746937751, "policy_loss": -0.023569772779592314, "vf_loss": 9.960301852226257, "vf_explained_var": -8.121132850646973e-08, "kl": 0.014070634081963716, "entropy": 3.8782213598489763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 998981.5558966434, "episode_reward_min": -158548.34290695356, "episode_reward_mean": 180498.9407369207, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -44910.560055530346, "policy_mm": -45390.74947494426, "policy_rl": -45444.81923367926}, "policy_reward_max": {"policy_mom": 220320.93494736002, "policy_mean": 245539.54060428968, "policy_mm": 271694.40310350846, "policy_rl": 299762.02766564465}, "policy_reward_mean": {"policy_mom": 42590.737999954625, "policy_mean": 41907.05022131274, "policy_mm": 44501.107812727896, "policy_rl": 51500.04470292543}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 42590.734375, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 220320.9375, "('mean_0', 'policy_mean')_total_reward_mean": 41907.05078125, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 245539.546875, "('mm_0', 'policy_mm')_total_reward_mean": 44501.109375, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 51500.046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -45444.8203125, "('rl_trader_0', 'policy_rl')_total_reward_max": 299762.03125}, "hist_stats": {"episode_reward": [263902.54102711054, 247786.2354406029, 291498.5087938418, 322605.1930774866, 98898.3674770304, -1938.404181586279, 456637.59364001924, 174934.4831822212, 358036.1118701965, 35849.521957603145, -158548.34290695356, 164769.59633536948, 322867.5825057276, 321432.76475963456, 794718.4658281178, 745628.8200700416, -15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [73124.36612394112, 68785.6636610807, 75427.40191256392, 76881.79239996949, 12285.345563278981, -5001.915474855731, 81872.14597750748, 37365.10390280216, 117141.20491270698, 2881.8410440072707, -35873.71642262971, 45136.02744667514, 55225.55274775785, 93750.99317501708, 169816.15199950052, 165664.5494898309, 6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551], "policy_policy_mean_reward": [62644.46126379322, 85809.2620695923, 62577.00211488299, 81219.79649033179, 29290.256821090745, 2704.240148906344, 111202.53900453741, 37270.31664420383, 83609.52315114302, 23048.096875143696, -43432.89535589121, 31356.459076798565, 90815.765098804, 45326.61572798824, 232052.47784151803, 120609.16874734714, -5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346], "policy_policy_mm_reward": [63783.2724157441, 45675.02894192427, 73344.86148673634, 90066.64184628967, 34080.25896874811, 12829.089789719788, 95351.36800400291, 63441.246276557125, 69604.7544794585, -2536.1839451129345, -33796.91189475363, 36900.87113156597, 82216.64292357973, 72399.6166252883, 192940.48957396107, 162615.7236288757, -20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654], "policy_policy_rl_reward": [64350.44122363213, 47516.280768005534, 80149.24327965906, 74436.96234089641, 23242.506123912477, -12469.81864535661, 168211.54065397143, 36857.81635865817, 87680.62932688693, 12455.767983565092, -45444.81923367926, 51376.23868032988, 94609.62173558628, 109955.53923134047, 199909.3464131377, 296739.37820398866, 3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23392640340725343, "mean_inference_ms": 0.7631960443001587, "mean_action_processing_ms": 0.11857056791301361, "mean_env_wait_ms": 0.17502186238391051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007430315017700195, "StateBufferConnector_ms": 0.0007401704788208008, "ViewRequirementAgentConnector_ms": 0.01889491081237793}, "num_episodes": 16, "episode_return_max": 998981.5558966434, "episode_return_min": -158548.34290695356, "episode_return_mean": 180498.9407369207, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 701.4671625861791, "num_env_steps_trained_throughput_per_sec": 701.4671625861791, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 6111.789, "restore_workers_time_ms": 0.064, "training_step_time_ms": 6111.661, "sample_time_ms": 5487.788, "learn_time_ms": 618.699, "learn_throughput": 6465.183, "synch_weights_time_ms": 4.042}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-00", "timestamp": 1760509620, "time_this_iter_s": 5.706939697265625, "time_total_s": 339.5685908794403, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6980>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.5685908794403, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 42.1875, "ram_util_percent": 83.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1674180030822754, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.949379947781562, "policy_loss": -0.02089776243956294, "vf_loss": 9.960278171300889, "vf_explained_var": -1.7937272787094116e-07, "kl": 0.01481413014316824, "entropy": 3.795054641366005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 998981.5558966434, "episode_reward_min": -138633.4227330745, "episode_reward_mean": 183246.2537205397, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -44910.560055530346, "policy_mm": -45390.74947494426, "policy_rl": -42662.48207528455}, "policy_reward_max": {"policy_mom": 220320.93494736002, "policy_mean": 245539.54060428968, "policy_mm": 271694.40310350846, "policy_rl": 299762.02766564465}, "policy_reward_mean": {"policy_mom": 43188.73233720514, "policy_mean": 41736.36761987233, "policy_mm": 46047.125104867446, "policy_rl": 52274.0286585948}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 43188.734375, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 220320.9375, "('mean_0', 'policy_mean')_total_reward_mean": 41736.36328125, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 245539.546875, "('mm_0', 'policy_mm')_total_reward_mean": 46047.12890625, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 52274.03515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -42662.48046875, "('rl_trader_0', 'policy_rl')_total_reward_max": 299762.03125}, "hist_stats": {"episode_reward": [-15579.105912038547, 159802.23570879153, -18025.526634168255, 272664.8235209572, 142524.01661407787, 103927.55266266529, -84299.02338009136, -122488.56748446837, -132795.47167173075, 202820.01832843816, -48100.99226287775, -43247.46252896178, 43462.90703043639, -61751.45440937414, -95216.41869374864, 1461.992476425857, 62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [6561.079068546945, 55930.375168743936, -1481.1530783738106, 66724.15992601127, 27227.794005479653, 21714.645809961654, -16031.511578669442, -33904.97107928659, -27454.503533982977, 35906.684675854405, -12996.46819315403, -12894.160795982321, 14459.008492741164, -19396.812454189978, -17759.488439585642, -6576.401901525388, 7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784], "policy_policy_mean_reward": [-5271.566004467408, 9121.894486725514, 699.1955879684283, 70527.07144090053, 34472.7432803062, 31654.77484027018, -19015.28721854021, -23087.545700411436, -32027.216336324374, 44195.38344699859, -6018.562220179797, -9483.163458404268, -1530.0607107496303, -27434.635536549566, -34356.716614334306, 18938.48564150993, 20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166], "policy_policy_mm_reward": [-20512.036163345416, 29397.743540851327, -4998.09199900639, 69031.98444316127, 34842.80537766577, 27272.2942179038, -20978.720783716202, -35891.05127917588, -30651.269726138842, 74659.33098852875, -26798.94064040032, -10184.160283929086, 27955.282539852797, -7184.136249941767, -17120.43628782481, 535.8598527029502, 20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588], "policy_policy_rl_reward": [3643.417187227521, 65352.22251247079, -12245.477144756465, 66381.60771088427, 45980.67395062639, 23285.837794529532, -28273.503799165403, -29604.999425594568, -42662.48207528455, 48058.61921705656, -2287.0212091435287, -10685.977990645992, 2578.6767085919914, -7735.870168692786, -25979.77735200404, -11435.951116261567, 13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23405658394118412, "mean_inference_ms": 0.7635470395860176, "mean_action_processing_ms": 0.11862631879503407, "mean_env_wait_ms": 0.17514061807436285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00072479248046875, "StateBufferConnector_ms": 0.000706791877746582, "ViewRequirementAgentConnector_ms": 0.018491506576538086}, "num_episodes": 16, "episode_return_max": 998981.5558966434, "episode_return_min": -138633.4227330745, "episode_return_mean": 183246.2537205397, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 613.6423404764425, "num_env_steps_trained_throughput_per_sec": 613.6423404764425, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 6084.53, "restore_workers_time_ms": 0.062, "training_step_time_ms": 6084.415, "sample_time_ms": 5439.901, "learn_time_ms": 639.638, "learn_throughput": 6253.533, "synch_weights_time_ms": 3.753}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-06", "timestamp": 1760509626, "time_this_iter_s": 6.524315118789673, "time_total_s": 346.09290599823, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7420>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 346.09290599823, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 48.190000000000005, "ram_util_percent": 84.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.21663236618042, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.954384374618531, "policy_loss": -0.01725181687215809, "vf_loss": 9.960231098532677, "vf_explained_var": 1.9222497940063477e-07, "kl": 0.01689641403468197, "entropy": 3.7702717326581476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138633.4227330745, "episode_reward_mean": 223875.2234273363, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -43093.36862395867, "policy_mean": -44910.560055530346, "policy_mm": -45390.74947494426, "policy_rl": -34597.788346347355}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 260019.58644237946, "policy_mm": 271694.40310350846, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 53058.52102738036, "policy_mean": 51493.77501613849, "policy_mm": 54167.136656164716, "policy_rl": 65155.790727652755}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53058.515625, "('mom_0', 'policy_mom')_total_reward_min": -43093.3671875, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 51493.78125, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 260019.59375, "('mm_0', 'policy_mm')_total_reward_mean": 54167.13671875, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 65155.796875, "('rl_trader_0', 'policy_rl')_total_reward_min": -34597.7890625, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [62198.45681503944, 264426.17409302003, 298051.97921662725, 376661.30715609225, -27414.342745210717, 320345.4335252547, 759.0029218067808, -138633.4227330745, 283888.8723064701, 116815.1458058616, -125611.70954006584, 30057.757321539135, -40667.49603962455, 63922.686871644255, 109822.22972973135, 81612.31059485533, -49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [7872.295692200937, 49763.41052317112, 56410.18365987017, 89589.44628928478, 12570.924027101597, 92017.43713685703, 11838.323113013372, -40898.302446316695, 59863.26057437763, 22426.153073329, -43093.36862395867, 648.4566461963182, -17770.273106857272, 18315.527540198298, 20474.28294324657, 23193.772978493213, -12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921], "policy_policy_mean_reward": [20845.77903291333, 76209.17672593342, 87260.10640258176, 99895.06629701113, -25676.014100417586, 60109.62176359115, -1739.1278750664778, -30150.59801695538, 61258.20812558752, 41129.65690434711, -35886.40087963473, 3863.974446823862, -1855.2171705332626, 9685.96671445403, 24611.106846878316, 20146.12045197127, 4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824], "policy_policy_mm_reward": [20190.105958696113, 50037.22130068071, 59712.79482199412, 70753.50607524908, -2765.1594802918275, 74513.7198590084, -5546.74685044044, -32986.7339234552, 74974.1978460137, 36423.93749570444, -18481.905889627382, 14957.35249508419, -6733.372975246639, 20857.39169151565, 28525.42136573922, 21962.089737570008, -10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366], "policy_policy_rl_reward": [13290.276131229064, 88416.36554323482, 94668.89433218133, 116423.28849454725, -11544.093191602895, 93704.65476579784, -3793.445465699728, -34597.788346347355, 87793.20576049158, 16835.398332481054, -28150.034146845057, 10587.97373343461, -14308.63278698716, 15063.80092547625, 36211.41857386725, 16310.327426820892, -30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23420069990662398, "mean_inference_ms": 0.7639957583497903, "mean_action_processing_ms": 0.11869784603658118, "mean_env_wait_ms": 0.17527256689518672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007426142692565918, "StateBufferConnector_ms": 0.0007152557373046875, "ViewRequirementAgentConnector_ms": 0.01893138885498047}, "num_episodes": 16, "episode_return_max": 1013388.970630286, "episode_return_min": -138633.4227330745, "episode_return_mean": 223875.2234273363, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 606.473848759219, "num_env_steps_trained_throughput_per_sec": 606.473848759219, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 6129.644, "restore_workers_time_ms": 0.059, "training_step_time_ms": 6129.533, "sample_time_ms": 5471.473, "learn_time_ms": 653.446, "learn_throughput": 6121.393, "synch_weights_time_ms": 3.507}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-13", "timestamp": 1760509633, "time_this_iter_s": 6.600837707519531, "time_total_s": 352.6937437057495, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e0c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 352.6937437057495, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 83.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9728940725326538, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.942260512709618, "policy_loss": -0.023274966794997454, "vf_loss": 9.956391879916191, "vf_explained_var": -4.328787326812744e-07, "kl": 0.013546120275851054, "entropy": 3.8425139516592024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 235371.24009679566, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -44910.560055530346, "policy_mm": -45390.74947494426, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 260019.58644237946, "policy_mm": 271694.40310350846, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 55305.70703326934, "policy_mean": 54848.526147106226, "policy_mm": 57127.79093484043, "policy_rl": 68089.2159815797}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55305.7109375, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 54848.5234375, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 260019.59375, "('mm_0', 'policy_mm')_total_reward_mean": 57127.796875, "('mm_0', 'policy_mm')_total_reward_min": -45390.75, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68089.2265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [-49115.79936460524, 268380.5181953027, 148552.5543609705, 354656.79206131975, -9153.142129025653, 125309.68629686687, 124822.68967957911, 129458.13786294789, 691777.9228612632, 222931.19142279983, 361440.48577357363, 799053.8849067852, -36219.471381769516, 341053.69364339946, -137926.51703308424, 284948.46981509717, 308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-12761.28373333304, 81995.11986492075, 24107.88238868678, 82063.13118351853, -5046.7495046382755, 34997.73062989909, 37443.928894950885, 49196.92699811114, 120363.16133187909, 59788.44901328477, 90488.7627108264, 148833.6107470777, 1099.2720195017532, 75380.87825512027, -36565.08454571001, 53426.73311484293, 84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033], "policy_policy_mean_reward": [4629.988859070348, 64976.85793165648, 37684.36473349841, 115154.82389194985, -6530.506015983572, 30341.137447489717, 23400.200529599326, 23271.234600614305, 119404.70008243503, 24719.1566041053, 88056.33799633817, 152301.77202519713, -7147.756192803534, 79658.12660803166, -24679.708779868703, 52185.24836484354, 69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194], "policy_policy_mm_reward": [-10357.442315822742, 68437.21271673952, 56277.70390548544, 82725.85356679984, -3750.0076147533496, 26484.706374361755, 38384.7514830428, 37906.88977303714, 162850.79363686347, 77153.34413952191, 93914.72035577928, 198156.47446886505, -6029.5775354595635, 92351.29563924107, -45390.74947494426, 101747.6816557055, 75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695], "policy_policy_rl_reward": [-30627.062174519786, 52971.32768198589, 30482.603333300158, 74712.98341905186, 6174.121006349531, 33486.11184511629, 25593.808771986092, 19083.086491185375, 289159.26781008625, 61270.24166588788, 88980.66471062996, 299762.02766564465, -24141.40967300823, 93663.39314100609, -31290.97423256119, 77588.8066797052, 79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23436752026098837, "mean_inference_ms": 0.7645320069265519, "mean_action_processing_ms": 0.11878421100611314, "mean_env_wait_ms": 0.1754280401712493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007574558258056641, "StateBufferConnector_ms": 0.000725865364074707, "ViewRequirementAgentConnector_ms": 0.01920264959335327}, "num_episodes": 16, "episode_return_max": 1013388.970630286, "episode_return_min": -138854.88734625824, "episode_return_mean": 235371.24009679566, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 632.8822236698526, "num_env_steps_trained_throughput_per_sec": 632.8822236698526, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 6185.462, "restore_workers_time_ms": 0.03, "training_step_time_ms": 6185.379, "sample_time_ms": 5508.844, "learn_time_ms": 670.432, "learn_throughput": 5966.304, "synch_weights_time_ms": 4.96}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-19", "timestamp": 1760509639, "time_this_iter_s": 6.328423023223877, "time_total_s": 359.0221667289734, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fe20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 359.0221667289734, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 47.955555555555556, "ram_util_percent": 84.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0317065715789795, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.942137145996094, "policy_loss": -0.02548888094315771, "vf_loss": 9.95719121992588, "vf_explained_var": 1.9531697034835814e-06, "kl": 0.015459025966720694, "entropy": 3.8375539340078832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 239806.40384279363, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -44910.560055530346, "policy_mm": -34726.13590730916, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 266707.32476721826, "policy_mm": 271694.40310350846, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 56395.14066589421, "policy_mean": 56688.421016244596, "policy_mm": 58054.43553184743, "policy_rl": 68668.40662880742}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 56395.140625, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 56688.42578125, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 58054.43359375, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68668.3984375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [308000.48760639626, 392407.3946493524, 233887.19171052967, 302539.29598344315, -33789.95797705489, 236428.8992656642, 357547.76603848755, -6323.252625490823, 252500.42119933828, 193602.15022130182, 26474.669344663493, -68248.04892213427, 84291.2590675419, -4366.6719340456375, 651461.1922421957, 124421.37390159321, 826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [84556.4650324411, 104421.66413734565, 66301.55730752644, 88033.01621061088, -20702.944272973302, 47336.3529226977, 94518.87433363941, 2332.3107303760426, 69662.87897026012, 43367.260727840105, 17040.88980110532, -32093.89851765102, 22918.136515369384, 8749.707058940623, 166028.71696171322, 29785.303844661157, 181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642], "policy_policy_mean_reward": [69029.52290050432, 113351.02893014542, 46990.83926003814, 77256.9079697474, -11091.333455732816, 71990.86691723307, 101700.29796477946, 15120.541278836921, 77055.34929239887, 28857.425448763723, 3404.2878773298144, -14064.036424784596, 17482.781666465733, -3604.244519150349, 116788.48383002475, 13900.791146176383, 165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211], "policy_policy_mm_reward": [75052.65292511992, 93778.26259610351, 41258.281484770014, 57891.61276956649, 2826.219032738884, 62927.14799498745, 28113.755003930877, -17166.75044183715, 36281.33049423281, 49713.339269495904, 5427.642389475591, -5126.275594772284, 16355.501647466059, -769.1665990113066, 151171.20538072655, 44613.44456674856, 197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163], "policy_policy_rl_reward": [79361.84674833076, 80856.43898575827, 79336.51365819512, 79357.75903351867, -4821.899281087566, 54174.53143074562, 133214.83873613842, -6609.3541928666555, 69500.86244244715, 71664.12477520225, 601.8492767527133, -16963.83838492637, 27534.839238240882, -8742.967874824768, 217472.7860697312, 36121.834344006944, 282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23452237815555532, "mean_inference_ms": 0.7649758060620349, "mean_action_processing_ms": 0.11886283009187672, "mean_env_wait_ms": 0.17556600976755793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007483363151550293, "StateBufferConnector_ms": 0.0007166862487792969, "ViewRequirementAgentConnector_ms": 0.01906275749206543}, "num_episodes": 16, "episode_return_max": 1013388.970630286, "episode_return_min": -138854.88734625824, "episode_return_mean": 239806.40384279363, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.3254734799799, "num_env_steps_trained_throughput_per_sec": 681.3254734799799, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 6174.957, "restore_workers_time_ms": 0.034, "training_step_time_ms": 6174.861, "sample_time_ms": 5509.69, "learn_time_ms": 659.426, "learn_throughput": 6065.877, "synch_weights_time_ms": 4.65}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-25", "timestamp": 1760509645, "time_this_iter_s": 5.876327991485596, "time_total_s": 364.898494720459, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 364.898494720459, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 84.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0216870307922363, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.945720982551574, "policy_loss": -0.02049444594013039, "vf_loss": 9.956557276844979, "vf_explained_var": 7.806345820426941e-07, "kl": 0.014308404083658827, "entropy": 3.969103740900755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 256252.96522242093, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -44910.560055530346, "policy_mm": -34726.13590730916, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 266707.32476721826, "policy_mm": 271694.40310350846, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 58293.71291284455, "policy_mean": 61066.64691893132, "policy_mm": 63177.522057994414, "policy_rl": 73715.08333265065}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 58293.71484375, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 61066.64453125, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 63177.515625, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 271694.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73715.0859375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [826830.789407396, -32116.10523947446, 320930.27019861614, 141682.53111888358, 244918.08911643902, 59492.10297466163, 152712.44608814668, 998981.5558966434, 157952.34514543638, -11163.974608337507, 194996.29677463722, 154993.3341209856, 642671.5893276816, 51255.07684169278, 258779.04137157433, 248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [181918.55479412893, -2272.5889059979027, 71464.20519850265, 23970.53367848482, 64984.17643969394, 14436.87172270257, 31468.166275440057, 220320.93494736002, 20618.243339247503, -2883.2548788550757, 71919.5006809338, 18206.91885461096, 202486.45553765845, 8555.189834565756, 63305.83073408233, 64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085], "policy_policy_mean_reward": [165175.71812089827, -16331.663081722825, 109016.5313243549, 29201.330967326445, 47728.26124380247, 16649.72504014737, 41484.958891200826, 245539.54060428968, 24506.47556896126, 10693.77162387187, 21491.346071258748, 51743.081664407975, 162565.94050887568, 11196.557462269413, 81922.46796448408, 53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258], "policy_policy_mm_reward": [197027.62646758463, -9370.33304186331, 61772.50818642515, 36626.671891925354, 68228.267795499, 16130.432514296528, 44043.10973954138, 271694.40310350846, 77960.31102668782, -5132.103192660143, 62609.706999133756, 45169.78172910802, 129584.87055839901, 13699.507623792679, 49472.72952115546, 62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507], "policy_policy_rl_reward": [282708.8900247844, -4141.520209890416, 78677.02548933338, 51883.99458114706, 63977.383637443476, 12275.073697515185, 35716.21118196443, 261426.67724148525, 34867.3152105399, -13842.388160694067, 38975.7430233106, 39873.55187285862, 148034.32272274842, 17803.821921065082, 64078.0131518523, 68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346543522179696, "mean_inference_ms": 0.7654945709895629, "mean_action_processing_ms": 0.11892705623027541, "mean_env_wait_ms": 0.175680327841108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007470846176147461, "StateBufferConnector_ms": 0.0007179379463195801, "ViewRequirementAgentConnector_ms": 0.019019603729248047}, "num_episodes": 16, "episode_return_max": 1013388.970630286, "episode_return_min": -138854.88734625824, "episode_return_mean": 256252.96522242093, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 664.2597311194214, "num_env_steps_trained_throughput_per_sec": 664.2597311194214, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 6105.941, "restore_workers_time_ms": 0.032, "training_step_time_ms": 6105.848, "sample_time_ms": 5448.175, "learn_time_ms": 650.776, "learn_throughput": 6146.51, "synch_weights_time_ms": 5.824}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-31", "timestamp": 1760509651, "time_this_iter_s": 6.028610706329346, "time_total_s": 370.92710542678833, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5f80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 370.92710542678833, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.625, "ram_util_percent": 83.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9970219135284424, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.940754115581512, "policy_loss": -0.02388944371341495, "vf_loss": 9.955325952172279, "vf_explained_var": -1.7680227756500245e-06, "kl": 0.01380378299627449, "entropy": 3.7057553365826608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 242408.3169041711, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -44910.560055530346, "policy_mm": -34726.13590730916, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 266707.32476721826, "policy_mm": 241751.505990401, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 55652.091659772996, "policy_mean": 57076.84230871033, "policy_mm": 58609.1902348807, "policy_rl": 71070.19270080708}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55652.09375, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 57076.83984375, "('mean_0', 'policy_mean')_total_reward_min": -44910.55859375, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 58609.19140625, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 241751.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71070.1875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [248972.68811982175, 256935.70635285467, 262345.524336745, 166007.8225137429, -138561.27045004777, 218951.07816054157, 581165.6901046234, 94962.5855619849, 307955.47450245917, 423959.1860287219, 247848.34522124258, 197050.8765456871, 738553.1102639117, -45743.8262248179, 258217.09811579686, 213688.05094442712, 614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [64258.734972667415, 53460.53106882042, 75710.97229386117, 34958.17311155776, -32615.42540879551, 67710.58779512436, 149082.35651528355, 26826.510998121514, 53928.73155542605, 134166.4154952606, 48881.74318617269, 57543.15087800807, 155641.55315294725, -8729.38016817106, 75513.57354896946, 59033.82871874222, 86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596], "policy_policy_mean_reward": [53840.04700063394, 75924.25169283967, 30964.35051861244, 53512.093916947444, -44910.560055530346, 59070.22091302148, 104314.9075642368, 15935.788030703658, 84551.77157120599, 105057.60535526561, 77383.27529749514, 18942.373908809208, 140423.74826703235, -15987.305766431007, 54456.9100795808, 35594.4974675946, 122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644], "policy_policy_mm_reward": [62294.393709779375, 58103.29254423847, 94818.94237530605, 40699.11311703948, -33221.352418279654, 48788.61948245957, 125646.50068049415, 18664.482410987435, 66527.10680207434, 89205.89744752871, 74548.31455481269, 70163.42505530616, 188469.27677857399, -5578.82581260135, 88743.41255119484, 61016.06510590994, 185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207], "policy_policy_rl_reward": [68579.5124367412, 69447.6310469563, 60851.259148965466, 36838.442368198215, -27813.93256744239, 43381.64996993633, 202121.9253446083, 33535.804122172245, 102947.86457375287, 95529.26773066683, 47035.012182761995, 50401.92670356378, 254018.53206535743, -15448.31447761438, 39503.20193605165, 58043.65965218036, 220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23478409563496272, "mean_inference_ms": 0.765990697501333, "mean_action_processing_ms": 0.11898751550893358, "mean_env_wait_ms": 0.17578979679372264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007508993148803711, "StateBufferConnector_ms": 0.0007140040397644043, "ViewRequirementAgentConnector_ms": 0.019047796726226807}, "num_episodes": 15, "episode_return_max": 1013388.970630286, "episode_return_min": -138854.88734625824, "episode_return_mean": 242408.3169041711, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.1118363548659, "num_env_steps_trained_throughput_per_sec": 689.1118363548659, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 6080.246, "restore_workers_time_ms": 0.021, "training_step_time_ms": 6080.167, "sample_time_ms": 5422.783, "learn_time_ms": 650.723, "learn_throughput": 6147.005, "synch_weights_time_ms": 5.521}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-37", "timestamp": 1760509657, "time_this_iter_s": 5.80890679359436, "time_total_s": 376.7360122203827, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fe20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.7360122203827, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 39.911111111111104, "ram_util_percent": 83.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.202845811843872, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.947703841328622, "policy_loss": -0.02000863165012561, "vf_loss": 9.95649322271347, "vf_explained_var": 1.5886500477790832e-06, "kl": 0.016621127993039796, "entropy": 3.8541802003979684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1013388.970630286, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 227093.32831813133, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -35646.193160738796, "policy_mm": -34726.13590730916, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 250667.91654026485, "policy_mean": 266707.32476721826, "policy_mm": 241751.505990401, "policy_rl": 336338.72280127875}, "policy_reward_mean": {"policy_mom": 52152.64577438477, "policy_mean": 53196.148403001156, "policy_mm": 53968.38704242981, "policy_rl": 67776.14709831562}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52152.6484375, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 250667.921875, "('mean_0', 'policy_mean')_total_reward_mean": 53196.1484375, "('mean_0', 'policy_mean')_total_reward_min": -35646.19140625, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 53968.39453125, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 241751.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67776.1484375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 336338.71875}, "hist_stats": {"episode_reward": [614344.7323798762, 38007.493605412565, 277477.4204412129, 259293.41465084424, 288079.60693644837, -81277.40828018892, 264824.66459874227, 564784.1052507195, 17842.534384180875, 292886.84279107547, 104618.03037768308, 945377.8779461543, 241484.0261243143, 56168.36997904214, 291027.99817086663, 1013388.970630286, 227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [86333.68439313091, 204.91678813476656, 59739.5681117332, 56600.92066856591, 71803.78054675784, -14188.973998670064, 42574.345399978585, 159127.54631616082, 14329.306087750541, 62723.66774023684, 49003.77236771659, 206714.17527549955, 67684.24618991796, 35446.1855385283, 58332.215612910215, 250667.91654026485, 47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994], "policy_policy_mean_reward": [122234.46496051371, 12535.502828059929, 91201.37959664919, 74090.31268217244, 59229.372820241166, -16506.22549799929, 50286.846700766386, 119534.33591577785, -3354.391218549539, 90223.40002490542, 8471.187115203433, 260019.58644237946, 60235.03290092074, 11260.927267798366, 73831.25188644021, 254564.78031967647, 49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067], "policy_policy_mm_reward": [185101.94432156012, 12228.808236518187, 53217.03382828048, 55988.43391028554, 80788.00411315588, -17055.389612854487, 90745.34596606538, 122132.33005214865, 305.00236470894316, 64794.312919722186, 16847.002723543483, 142305.39342699692, 51786.312969090424, 5575.645730402179, 46751.80209062178, 192697.36332413537, 46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725], "policy_policy_rl_reward": [220674.63870467112, 13038.265752699654, 73319.43890454984, 72613.74738982055, 76258.4494562932, -33526.81917066506, 81218.12653193164, 163989.89296663174, 6562.617150271073, 75145.46210621079, 30296.06817121951, 336338.72280127875, 61778.434064385205, 3885.611442313189, 112112.72858089399, 315458.91044620925, 84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23489303882016815, "mean_inference_ms": 0.7663419124388097, "mean_action_processing_ms": 0.11903748248099853, "mean_env_wait_ms": 0.17587728255479854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007420778274536133, "StateBufferConnector_ms": 0.0007026791572570801, "ViewRequirementAgentConnector_ms": 0.01893746852874756}, "num_episodes": 16, "episode_return_max": 1013388.970630286, "episode_return_min": -138854.88734625824, "episode_return_mean": 227093.32831813133, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.6579105371462, "num_env_steps_trained_throughput_per_sec": 694.6579105371462, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 6073.799, "restore_workers_time_ms": 0.02, "training_step_time_ms": 6073.72, "sample_time_ms": 5418.051, "learn_time_ms": 648.907, "learn_throughput": 6164.212, "synch_weights_time_ms": 5.79}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-43", "timestamp": 1760509663, "time_this_iter_s": 5.763456106185913, "time_total_s": 382.4994683265686, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed53a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 382.4994683265686, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 40.8875, "ram_util_percent": 84.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1015512943267822, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.944801071286202, "policy_loss": -0.02454275678610429, "vf_loss": 9.958603081107139, "vf_explained_var": -3.725290298461914e-09, "kl": 0.01591225879547033, "entropy": 3.693168721348047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 901381.9436034549, "episode_reward_min": -138854.88734625824, "episode_reward_mean": 199379.66212582611, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -38902.9450122583, "policy_mean": -35646.193160738796, "policy_mm": -34726.13590730916, "policy_rl": -40957.04453948115}, "policy_reward_max": {"policy_mom": 218559.88435231763, "policy_mean": 266707.32476721826, "policy_mm": 241751.505990401, "policy_rl": 277774.8825013242}, "policy_reward_mean": {"policy_mom": 45499.3593435084, "policy_mean": 46016.661004391695, "policy_mm": 47999.745470013295, "policy_rl": 59863.89630791273}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 45499.35546875, "('mom_0', 'policy_mom')_total_reward_min": -38902.9453125, "('mom_0', 'policy_mom')_total_reward_max": 218559.890625, "('mean_0', 'policy_mean')_total_reward_mean": 46016.65625, "('mean_0', 'policy_mean')_total_reward_min": -35646.19140625, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 47999.74609375, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 241751.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59863.890625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40957.04296875, "('rl_trader_0', 'policy_rl')_total_reward_max": 277774.875}, "hist_stats": {"episode_reward": [227446.1633184574, 247371.15943791805, 202946.32673318186, 5227.580966339365, -26060.748384781764, 84279.18303828702, 549212.1038435431, 418889.21486317465, 644889.6269593618, -51029.92465014021, 88271.41397809696, 96964.88915241596, 157014.67490184054, 300116.4174654812, 106499.93206726015, -138854.88734625824, 110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [47510.92692474927, 44074.245280806776, 37941.035696313345, 859.4842784111704, 4207.049859533921, 26760.64574442313, 103971.8195717994, 43377.62298224021, 134651.32646873975, -23631.591545972635, 17632.486609696032, 27219.673426515445, 37007.75684599389, 68096.55565640362, 39097.40517100469, -38902.9450122583, 51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418], "policy_policy_mean_reward": [49100.49393042249, 59733.92201576762, 35595.84146704292, -2330.43259589093, -23541.022123327824, 24298.213173836924, 124819.36311337767, 129173.23106000808, 189365.79914118198, 11347.950134203917, 9840.720472829347, 2435.1403429570178, 51590.597268166246, 80989.45448365426, 30382.51901914053, -35646.193160738796, 24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323], "policy_policy_mm_reward": [46376.56245965413, 58531.9634064114, 65472.08229151256, 6005.5103311642615, 8106.372233591366, -1091.183802421296, 181910.5725172074, 122847.40031269462, 129619.82076247854, -16705.304949296547, 18313.370829177147, 23891.966390698628, 33251.77390091981, 78939.31830876741, 9379.929280672093, -23348.704633779733, 10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465], "policy_policy_rl_reward": [84458.1800036315, 85031.02873493216, 63937.3672783128, 693.0189526549817, -14833.148354579162, 34311.5079224483, 138510.34864115913, 123490.96050823195, 191252.6805869627, -22040.978289074876, 42484.83606639451, 43418.10899224487, 35164.5468867606, 72091.0890166554, 27640.078596442814, -40957.04453948115, 24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2349325565208082, "mean_inference_ms": 0.7665050691031554, "mean_action_processing_ms": 0.1190537789141077, "mean_env_wait_ms": 0.1759041992354659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007163882255554199, "StateBufferConnector_ms": 0.0006896853446960449, "ViewRequirementAgentConnector_ms": 0.018207311630249023}, "num_episodes": 16, "episode_return_max": 901381.9436034549, "episode_return_min": -138854.88734625824, "episode_return_mean": 199379.66212582611, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 635.334384295745, "num_env_steps_trained_throughput_per_sec": 635.334384295745, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 6070.787, "restore_workers_time_ms": 0.027, "training_step_time_ms": 6070.698, "sample_time_ms": 5428.936, "learn_time_ms": 635.635, "learn_throughput": 6292.921, "synch_weights_time_ms": 5.268}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-49", "timestamp": 1760509669, "time_this_iter_s": 6.300613164901733, "time_total_s": 388.80008149147034, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed74c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.80008149147034, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 40.82222222222222, "ram_util_percent": 83.77777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3116369247436523, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.947329941391946, "policy_loss": -0.02298874480475206, "vf_loss": 9.958666098117828, "vf_explained_var": -8.828938007354736e-08, "kl": 0.017263130071888125, "entropy": 3.7504597656428813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 901381.9436034549, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 209891.87238822295, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35321.08948771283, "policy_mean": -34531.90215785144, "policy_mm": -34726.13590730916, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 218559.88435231763, "policy_mean": 266707.32476721826, "policy_mm": 241751.505990401, "policy_rl": 285979.55706630263}, "policy_reward_mean": {"policy_mom": 49064.208287739486, "policy_mean": 48101.41453177722, "policy_mm": 49409.9053055454, "policy_rl": 63316.344263160834}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49064.203125, "('mom_0', 'policy_mom')_total_reward_min": -35321.08984375, "('mom_0', 'policy_mom')_total_reward_max": 218559.890625, "('mean_0', 'policy_mean')_total_reward_mean": 48101.41015625, "('mean_0', 'policy_mean')_total_reward_min": -34531.90234375, "('mean_0', 'policy_mean')_total_reward_max": 266707.3125, "('mm_0', 'policy_mm')_total_reward_mean": 49409.8984375, "('mm_0', 'policy_mm')_total_reward_min": -34726.13671875, "('mm_0', 'policy_mm')_total_reward_max": 241751.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63316.3515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 285979.5625}, "hist_stats": {"episode_reward": [110434.3410739546, 144389.4150528827, 272230.4671676176, -98264.47432830068, 140793.6590066872, 309677.52708017826, 351016.38913618773, -60557.0023410379, 255548.43455828412, 901381.9436034549, 77993.11741002358, -44573.04140298557, 640686.6833067025, 37151.2728406949, 25068.572924430562, 78885.766979743, 117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [51116.22431525559, 30068.28148516536, 69033.26956272086, -19118.063183567705, 21559.662510946033, 30018.078422528637, 69944.60192595636, -10069.206679737368, 68217.57474098243, 161751.2080374809, 34295.45483413396, -10138.549038611865, 114110.63614761939, 20491.625500149334, 12326.08873246154, 21109.577329284428, 32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336], "policy_policy_mean_reward": [24290.27199764854, 34006.080214361624, 62329.6701890237, -15168.590735999103, 21128.312052606194, 87606.59499069038, 93643.77420321216, -11430.334252685478, 76792.61422495132, 266707.32476721826, 10397.400663425007, -23844.524462996495, 87042.73656092385, 25659.687646024093, 3562.5382057910724, 27858.87474351175, 24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131], "policy_policy_mm_reward": [10397.947351195047, 48925.25512682774, 67448.38796103766, -34726.13590730916, 53404.83394689695, 85081.2247283893, 96311.34350865253, -12934.151075477976, 31371.426597158792, 241751.505990401, 13853.16617906603, 1721.3004949253416, 206450.10619311337, -4530.242434824896, 3085.5493993653145, 16585.397242809144, 27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193], "policy_policy_rl_reward": [24629.897409855315, 31389.798226528, 73419.1394548352, -29251.684501424625, 44700.85049623806, 106971.62893857007, 91116.6694983664, -26123.310333137153, 79166.81899519164, 231171.90480835436, 19447.095733398506, -12311.26839630265, 233083.20440504604, -4469.797870653719, 6094.396586812668, 13331.91766413766, 33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.234912048847332, "mean_inference_ms": 0.7664667391412382, "mean_action_processing_ms": 0.11903743800295842, "mean_env_wait_ms": 0.17586947620381274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007055401802062988, "StateBufferConnector_ms": 0.0006830692291259766, "ViewRequirementAgentConnector_ms": 0.018003761768341064}, "num_episodes": 16, "episode_return_max": 901381.9436034549, "episode_return_min": -134431.81111469964, "episode_return_mean": 209891.87238822295, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.6635370161733, "num_env_steps_trained_throughput_per_sec": 709.6635370161733, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 6052.483, "restore_workers_time_ms": 0.026, "training_step_time_ms": 6052.394, "sample_time_ms": 5415.395, "learn_time_ms": 631.025, "learn_throughput": 6338.891, "synch_weights_time_ms": 5.178}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "26ec2_00000", "date": "2025-10-15_01-27-55", "timestamp": 1760509675, "time_this_iter_s": 5.640716075897217, "time_total_s": 394.44079756736755, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4ca40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 394.44079756736755, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 39.325, "ram_util_percent": 83.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.222290515899658, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.948710936307908, "policy_loss": -0.022099423155304977, "vf_loss": 9.960264593362808, "vf_explained_var": 7.817521691322326e-07, "kl": 0.01562333572189859, "entropy": 3.534717016667128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 916099.2928147662, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 232600.97416638405, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35321.08948771283, "policy_mean": -34531.90215785144, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 218559.88435231763, "policy_mean": 205148.81017735915, "policy_mm": 216297.95192056108, "policy_rl": 316039.27716203686}, "policy_reward_mean": {"policy_mom": 54623.656217365526, "policy_mean": 52739.70496820001, "policy_mm": 52661.546592473875, "policy_rl": 72576.06638834464}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54623.65625, "('mom_0', 'policy_mom')_total_reward_min": -35321.08984375, "('mom_0', 'policy_mom')_total_reward_max": 218559.890625, "('mean_0', 'policy_mean')_total_reward_mean": 52739.703125, "('mean_0', 'policy_mean')_total_reward_min": -34531.90234375, "('mean_0', 'policy_mean')_total_reward_max": 205148.8125, "('mm_0', 'policy_mm')_total_reward_mean": 52661.5546875, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 216297.953125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72576.0625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 316039.28125}, "hist_stats": {"episode_reward": [117986.93955552626, 461647.8244827614, 748282.9041155474, 97440.03102892432, 65850.10829278172, 425099.4971189936, 649166.5386442923, 313892.68145499437, 460387.48209109664, 391546.39473948133, 189071.56863555216, 380594.4682159009, 219549.0994623345, 170606.9270669809, 231858.49162359847, 250608.30232084825, -42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [32656.949255564556, 101347.03283826265, 208128.17081174714, 41396.03416751216, 18170.555606091642, 83841.15288283622, 147710.96039759097, 85868.452638016, 103484.87440032535, 49827.47135780781, 58003.73221372964, 81361.42595158688, 46069.564269932154, 45311.33386593681, 71881.29624267842, 63208.82744730869, -6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967], "policy_policy_mean_reward": [24569.601644177965, 122651.30063230176, 148479.31283286138, 83.19210162208893, 21635.37109898211, 74078.51179505346, 181201.9985016872, 66516.74645938867, 105432.22319637492, 121744.20687919811, 31677.301692438617, 87317.97957712543, 73352.51958290591, 20557.734845588868, 46462.297863024134, 72973.45313538851, -17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968], "policy_policy_mm_reward": [27504.93895218208, 102089.2925348245, 203267.05635858845, 31262.682415431922, 20657.513390556163, 151002.7466995201, 152040.71100788654, 81314.89377782331, 88374.05608148375, 76971.37708850011, 53508.4873330151, 108890.19932885743, 54672.28006845922, 33180.96695566786, 60005.62328171528, 48937.500864763286, -13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959], "policy_policy_rl_reward": [33255.449703601626, 135560.19847737183, 188408.36411235027, 24698.122344357984, 5386.668197151882, 116177.08574158335, 168212.86873712763, 80192.58857976673, 163096.3284129128, 143003.33941397528, 45882.04739636881, 103024.86335833109, 45454.73554103725, 71556.89139978752, 53509.27423618064, 65488.52087338784, -4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23485586977367626, "mean_inference_ms": 0.7663066888901156, "mean_action_processing_ms": 0.11900106319428462, "mean_env_wait_ms": 0.17579960077078083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007062554359436035, "StateBufferConnector_ms": 0.0006842613220214844, "ViewRequirementAgentConnector_ms": 0.017799556255340576}, "num_episodes": 16, "episode_return_max": 916099.2928147662, "episode_return_min": -134431.81111469964, "episode_return_mean": 232600.97416638405, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 724.768722396547, "num_env_steps_trained_throughput_per_sec": 724.768722396547, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 6034.149, "restore_workers_time_ms": 0.026, "training_step_time_ms": 6034.061, "sample_time_ms": 5399.333, "learn_time_ms": 628.727, "learn_throughput": 6362.061, "synch_weights_time_ms": 5.215}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-00", "timestamp": 1760509680, "time_this_iter_s": 5.52306604385376, "time_total_s": 399.9638636112213, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7ec0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 399.9638636112213, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 33.025, "ram_util_percent": 83.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.016007900238037, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.941906687617301, "policy_loss": -0.028451775180292314, "vf_loss": 9.960257104039192, "vf_explained_var": 1.9837170839309692e-07, "kl": 0.014965019391911968, "entropy": 3.7060037441551685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 916099.2928147662, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 216061.46495971593, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35321.08948771283, "policy_mean": -34531.90215785144, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 218559.88435231763, "policy_mean": 205148.81017735915, "policy_mm": 216297.95192056108, "policy_rl": 316039.27716203686}, "policy_reward_mean": {"policy_mom": 51097.297781760135, "policy_mean": 48845.17097588765, "policy_mm": 47864.841883005116, "policy_rl": 68254.15431906305}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51097.30078125, "('mom_0', 'policy_mom')_total_reward_min": -35321.08984375, "('mom_0', 'policy_mom')_total_reward_max": 218559.890625, "('mean_0', 'policy_mean')_total_reward_mean": 48845.171875, "('mean_0', 'policy_mean')_total_reward_min": -34531.90234375, "('mean_0', 'policy_mean')_total_reward_max": 205148.8125, "('mm_0', 'policy_mm')_total_reward_mean": 47864.83984375, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 216297.953125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68254.15625, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 316039.28125}, "hist_stats": {"episode_reward": [-42234.869612803406, 627587.429050964, 105546.31479521196, 1851.4163151098082, 320358.56581195956, 189792.48700536301, 257931.0636325863, 247961.00705110366, 143931.80858220975, 369315.40844063315, 184038.46635680748, 195508.99723491594, -44092.08675545561, 32414.4853073564, 66954.01204182158, 202045.67179182154, 279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-6809.401214147886, 61230.5971356971, 13252.828939751582, 8232.110537416524, 69638.28939247085, 41559.37360888587, 62857.54542381009, 50508.033645932155, 25324.710472494877, 110813.81595409772, 72621.88639603432, 51577.87695254598, -3530.8343404615443, -2959.501809365001, 17990.77513258842, 51482.00243912432, 38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513], "policy_policy_mean_reward": [-17704.736240336144, 205148.81017735915, 37126.671369853684, -8483.267449933577, 64589.64896633258, 58947.31436870216, 62615.596692818974, 66217.73421001098, 30270.619957005845, 40173.71523294068, 32041.258597950102, 51091.651563053456, -15801.295709856911, 25254.934965118933, 865.5117229198838, 65998.50247263594, 56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172], "policy_policy_mm_reward": [-13205.226650990968, 134497.24366523657, 19641.12321037526, -3946.7614699666324, 108771.63429209507, 33834.73068951875, 49316.65023641824, 63584.71778760533, 30670.45661562491, 78334.97540957926, 38968.6971865888, 52634.57131927852, -11024.256691182358, 171.04330769586034, 21066.81842928677, 49027.42163069633, 62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873], "policy_policy_rl_reward": [-4515.505507328607, 226710.77807267144, 35525.691275231286, 6049.334697593449, 77358.99316106076, 55451.068338256424, 83141.2712795388, 67650.52140755503, 57666.021537084074, 139992.90184401578, 40406.624176234254, 40204.89740003786, -13735.700013954742, 9948.008843906646, 27030.906757026372, 35537.745249364765, 122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23479341276752494, "mean_inference_ms": 0.7660155271904173, "mean_action_processing_ms": 0.11896210910729871, "mean_env_wait_ms": 0.17572664747714484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000696718692779541, "StateBufferConnector_ms": 0.0006797313690185547, "ViewRequirementAgentConnector_ms": 0.01778101921081543}, "num_episodes": 16, "episode_return_max": 916099.2928147662, "episode_return_min": -134431.81111469964, "episode_return_mean": 216061.46495971593, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 705.787169941367, "num_env_steps_trained_throughput_per_sec": 705.787169941367, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 5949.047, "restore_workers_time_ms": 0.026, "training_step_time_ms": 5948.959, "sample_time_ms": 5337.938, "learn_time_ms": 605.059, "learn_throughput": 6610.921, "synch_weights_time_ms": 5.162}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-06", "timestamp": 1760509686, "time_this_iter_s": 5.6723010540008545, "time_total_s": 405.63616466522217, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e700>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 405.63616466522217, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 36.5125, "ram_util_percent": 83.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.487941265106201, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.953826153278351, "policy_loss": -0.019778486258292104, "vf_loss": 9.96095335483551, "vf_explained_var": 1.4472752809524537e-07, "kl": 0.01874272028708277, "entropy": 3.546641857922077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 916099.2928147662, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 232504.98120301793, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35321.08948771283, "policy_mean": -34531.90215785144, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 218559.88435231763, "policy_mean": 262944.7067128369, "policy_mm": 216297.95192056108, "policy_rl": 316039.27716203686}, "policy_reward_mean": {"policy_mom": 54454.97891252428, "policy_mean": 52764.352227873474, "policy_mm": 51896.31908987276, "policy_rl": 73389.33097274747}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54454.9765625, "('mom_0', 'policy_mom')_total_reward_min": -35321.08984375, "('mom_0', 'policy_mom')_total_reward_max": 218559.890625, "('mean_0', 'policy_mean')_total_reward_mean": 52764.3515625, "('mean_0', 'policy_mean')_total_reward_min": -34531.90234375, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 51896.3203125, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 216297.953125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 73389.328125, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 316039.28125}, "hist_stats": {"episode_reward": [279901.6119923318, 338040.7162817127, 127690.34243459771, 187016.5653121913, 220784.611823043, 184219.9529323359, 445029.7303381745, 844842.8810260331, -72092.51418199668, 78593.51278554749, 134438.45512778946, 202096.37346506355, -18500.813606559557, 10314.720369509889, 38172.0298909113, 660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [38225.939260785235, 105877.18009338094, 55865.95599865467, 46122.85371689596, 47549.964100593555, 55534.08956247147, 144730.241086145, 218559.88435231763, -14762.707014156442, 29450.01740647516, 34732.41172510941, 51637.61965867708, 8083.813753035134, -25813.275368297047, 120.49789642856754, 203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377], "policy_policy_mean_reward": [56642.12702305895, 48051.040186509, 34283.432957111654, 46951.43871234644, 43960.96676785891, 23467.39976990502, 120222.25442392733, 162506.31858414802, -24261.952606462473, 1158.376584104063, 53883.03241201132, 38991.46392072602, -8110.899846994125, 137.375633540871, 27545.710846558683, 67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481], "policy_policy_mm_reward": [62684.81164379924, 77237.20416878976, 12868.867462930475, 43307.59941453207, 74650.13654188062, 48708.58282908824, 66459.22655449378, 207698.57083707603, -11641.074345586665, 20153.143105575655, 30009.69764991896, 47417.95343224104, -6452.197987673708, 20972.11727001525, 11350.909369368763, 111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614], "policy_policy_rl_reward": [122348.7340646885, 106875.291833033, 24672.086015900913, 50634.673468416986, 54623.544412710165, 56509.880770871685, 113618.00827360904, 256078.1072524911, -21426.78021579099, 27831.975689392664, 15813.313340749495, 64049.336453419215, -12021.529524926857, 15018.502834250872, -845.0882214447811, 277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23471568251746636, "mean_inference_ms": 0.7656910737336375, "mean_action_processing_ms": 0.11891743206483213, "mean_env_wait_ms": 0.17564160655905298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006930828094482422, "StateBufferConnector_ms": 0.0006845593452453613, "ViewRequirementAgentConnector_ms": 0.01770251989364624}, "num_episodes": 16, "episode_return_max": 916099.2928147662, "episode_return_min": -134431.81111469964, "episode_return_mean": 232504.98120301793, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 706.0893774667252, "num_env_steps_trained_throughput_per_sec": 706.0893774667252, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 5855.994, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5855.91, "sample_time_ms": 5261.308, "learn_time_ms": 588.747, "learn_throughput": 6794.084, "synch_weights_time_ms": 5.049}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-12", "timestamp": 1760509692, "time_this_iter_s": 5.669702053070068, "time_total_s": 411.30586671829224, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4dd00>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 411.30586671829224, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 83.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.172931671142578, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.950536996126175, "policy_loss": -0.02271191424224526, "vf_loss": 9.962698158621787, "vf_explained_var": -1.1846423149108887e-07, "kl": 0.01563075601234281, "entropy": 3.808852645009756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 916099.2928147662, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 232481.16350215382, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -35321.08948771283, "policy_mean": -34531.90215785144, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 262944.7067128369, "policy_mm": 216297.95192056108, "policy_rl": 316039.27716203686}, "policy_reward_mean": {"policy_mom": 55156.744108540144, "policy_mean": 52572.815328990946, "policy_mm": 52204.707354545535, "policy_rl": 72546.89671007721}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55156.74609375, "('mom_0', 'policy_mom')_total_reward_min": -35321.08984375, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 52572.8203125, "('mean_0', 'policy_mean')_total_reward_min": -34531.90234375, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 52204.703125, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 216297.953125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72546.8984375, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 316039.28125}, "hist_stats": {"episode_reward": [660442.8921193073, -32200.49407694875, -36406.750732787645, -127189.48375583738, -31735.822029868217, 40882.69639912607, -31812.100802221106, 351123.4757928057, 219098.4192607144, 139446.4253531113, -7426.101601866956, -4132.169443811048, 326010.5220870267, 546613.535007055, -54470.33778304073, -21737.660445116064, 362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [203111.67914452375, -17586.941619911893, -20508.674597307065, -35321.08948771283, -14090.061423217994, -8219.748046908111, -13952.411649512493, 124126.52136828999, 22512.680234459393, 34632.74125990585, 2514.212825495282, -9475.015701822087, 71238.71851957013, 108788.8781275563, -28212.378874190348, 2148.5120436155476, 112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344], "policy_policy_mean_reward": [67711.19081708854, -16251.31607240361, -3457.6167626437727, -30549.06213716921, 4051.342856904067, 11139.949513452128, -12862.685956993237, 95052.4388899652, 35119.42981230984, 35048.57896218005, -13442.159800057243, -7038.621102801443, 72702.13437581254, 139906.0194732151, 336.94489915057744, -20419.910227336004, 70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078], "policy_policy_mm_reward": [111845.13965637125, -281.2694281194672, -3759.7218912311805, -28001.134320214096, -4321.734133468725, 10884.352877301872, -668.8865423678434, 73204.88357688954, 78578.01426286882, 25647.732599972867, 9777.425136413676, -1241.0322857697367, 100289.01179417984, 49412.571806743545, -18856.26092540845, -11274.399603558166, 58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224], "policy_policy_rl_reward": [277774.8825013242, 1919.0330434862717, -8680.737481605645, -33318.19781074117, -17375.369330085705, 27078.142055280285, -4328.116653347431, 58739.63195766087, 82888.29495107658, 44117.37253105229, -6275.579763718704, 13622.49964658219, 81780.65739746435, 248506.06559953975, -7738.642882592638, 7808.137342162599, 121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346617941239283, "mean_inference_ms": 0.7654480694424458, "mean_action_processing_ms": 0.11888671366539848, "mean_env_wait_ms": 0.1755836080447248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007018446922302246, "StateBufferConnector_ms": 0.0006847977638244629, "ViewRequirementAgentConnector_ms": 0.017824113368988037}, "num_episodes": 15, "episode_return_max": 916099.2928147662, "episode_return_min": -134431.81111469964, "episode_return_mean": 232481.16350215382, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.6104336674275, "num_env_steps_trained_throughput_per_sec": 660.6104336674275, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 5829.46, "restore_workers_time_ms": 0.023, "training_step_time_ms": 5829.384, "sample_time_ms": 5242.355, "learn_time_ms": 582.423, "learn_throughput": 6867.855, "synch_weights_time_ms": 3.842}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-18", "timestamp": 1760509698, "time_this_iter_s": 6.060574054718018, "time_total_s": 417.36644077301025, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed7100>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 417.36644077301025, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 43.166666666666664, "ram_util_percent": 84.04444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.309199571609497, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.94590263068676, "policy_loss": -0.021370709591428748, "vf_loss": 9.9564428627491, "vf_explained_var": 5.494803190231323e-08, "kl": 0.016045143877909597, "entropy": 3.5933643095195293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 949576.7732103419, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 268352.08344602014, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -32002.71789254579, "policy_mean": -35877.34789973415, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 262944.7067128369, "policy_mm": 245025.34186810185, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 62789.56148477204, "policy_mean": 61711.33596102745, "policy_mm": 61421.1816519688, "policy_rl": 82430.00434825182}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 62789.55859375, "('mom_0', 'policy_mom')_total_reward_min": -32002.71875, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 61711.33984375, "('mean_0', 'policy_mean')_total_reward_min": -35877.34765625, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 61421.18359375, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 245025.34375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 82430.0, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [362146.17292374896, 91262.40926491065, 281942.3594745461, -60161.27432907252, 238175.68959822823, 101884.86338832552, -18139.95372840731, 248067.9992802448, -38722.3849164747, 267240.8447138426, 676025.8794811136, 731514.0810286634, 406649.83523441915, 231462.7955284204, 348631.42558197916, 122528.43427281456, 167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [112289.3233978084, 18096.649937252594, 67038.33597074251, -1390.324155687616, 39631.93523440418, 28964.5405612504, 1431.9018677806644, 39514.37852054442, -13024.48723092169, 36602.93163787332, 148278.27612711873, 162672.71845339515, 91066.0768785987, 98983.35644509562, 86025.74257791255, 37076.857015115376, 30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253], "policy_policy_mean_reward": [70069.20191787822, 21271.567831484474, 51083.719749822376, -15816.636983165183, 87759.05352909323, 22245.032258189058, -1011.8781589030639, 58006.83586832469, -19508.38598426708, 89903.25285212467, 181748.7919045502, 147623.5544649852, 105893.35939592644, 46615.296942294466, 85152.53355555404, 30920.86780503331, 23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256], "policy_policy_mm_reward": [58783.73506967127, 13244.651177011356, 77276.6428922232, -9492.227181669328, 51778.974468226465, 11431.111860888139, -3210.192073343998, 84228.28560067817, 3755.224307364443, 50190.63002890904, 132452.51948646305, 135238.25104398068, 132774.294195515, 25431.202002118178, 82398.21856256844, 23258.765131173845, 51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323], "policy_policy_rl_reward": [121003.91253839062, 38649.54031916222, 86543.66086175777, -33462.08600855036, 59005.72636650463, 39244.17870799745, -15349.785363940904, 66318.49929069748, -9944.736008650218, 90544.0301949352, 213546.29196298224, 285979.55706630263, 76916.10476437886, 60432.94013891177, 95054.93088594367, 31271.94432149221, 62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23469014758759513, "mean_inference_ms": 0.7654579578306161, "mean_action_processing_ms": 0.11890223056742073, "mean_env_wait_ms": 0.17561001307878768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007342696189880371, "StateBufferConnector_ms": 0.0007029175758361816, "ViewRequirementAgentConnector_ms": 0.018732964992523193}, "num_episodes": 16, "episode_return_max": 949576.7732103419, "episode_return_min": -134431.81111469964, "episode_return_mean": 268352.08344602014, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.9600606107078, "num_env_steps_trained_throughput_per_sec": 543.9600606107078, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 5977.708, "restore_workers_time_ms": 0.022, "training_step_time_ms": 5977.638, "sample_time_ms": 5329.79, "learn_time_ms": 642.335, "learn_throughput": 6227.276, "synch_weights_time_ms": 4.616}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-25", "timestamp": 1760509705, "time_this_iter_s": 7.366782188415527, "time_total_s": 424.7332229614258, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db68e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 424.7332229614258, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 63.21, "ram_util_percent": 83.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0347726345062256, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.940983495116233, "policy_loss": -0.028067940878827358, "vf_loss": 9.9591088950634, "vf_explained_var": 9.63360071182251e-07, "kl": 0.014729656310237682, "entropy": 3.5762357197701933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 949576.7732103419, "episode_reward_min": -134431.81111469964, "episode_reward_mean": 252777.94815678586, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -32002.71789254579, "policy_mean": -35877.34789973415, "policy_mm": -34066.88248582806, "policy_rl": -34450.60216062285}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 262944.7067128369, "policy_mm": 245025.34186810185, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 59076.681401194146, "policy_mean": 58029.63655052943, "policy_mm": 59137.31709020734, "policy_rl": 76534.31311485493}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 59076.6796875, "('mom_0', 'policy_mom')_total_reward_min": -32002.71875, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 58029.63671875, "('mean_0', 'policy_mean')_total_reward_min": -35877.34765625, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 59137.3203125, "('mm_0', 'policy_mm')_total_reward_min": -34066.8828125, "('mm_0', 'policy_mm')_total_reward_max": 245025.34375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76534.3046875, "('rl_trader_0', 'policy_rl')_total_reward_min": -34450.6015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [167798.61625720467, 192807.0353502918, 253036.85766044434, -134431.81111469964, 408049.63456568064, 812908.0113538129, 742551.1415194079, 609714.3212212179, -76049.3896906705, 273607.4206736474, 219132.89193339107, 276130.1476476806, 916099.2928147662, 551199.9900106761, 286782.04457854753, 235432.4054844464, -22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [30508.269808501413, 51476.05671899306, 78125.95206236497, -31382.424310397222, 80038.24524828336, 130975.90131878974, 169210.8071907497, 126297.78279424281, -32002.71789254579, 80775.49341209461, 63197.78476183878, 53675.69051246849, 196574.39431277858, 114825.76663520429, 106659.97540463951, 45873.786418473894, 3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315], "policy_policy_mean_reward": [23175.89567258308, 27715.640831815945, 68123.47002364363, -34531.90215785144, 113558.58520718131, 184702.04048250767, 168299.80231666384, 115978.66645295241, -19260.42726582448, 58993.86079274862, 54478.55521605396, 59803.71855883191, 202548.03159009627, 132976.1488862384, 68429.88770356528, 78479.03570507087, -11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196], "policy_policy_mm_reward": [51189.46468424611, 47641.50228200342, 38496.570263605965, -34066.88248582806, 101308.4683023193, 216297.95192056108, 154057.727395693, 120226.79017145434, -25908.13947286062, 72510.55393479687, 39069.693601754254, 66675.52725612938, 200937.5897498545, 76807.8990663024, 35445.11554697174, 34443.97818309147, 12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721], "policy_policy_rl_reward": [62924.986091874096, 65973.83551747953, 68290.86531082961, -34450.60216062285, 113144.33580789737, 280932.11763195496, 250982.8046163003, 247211.08180256776, 1121.8949405603837, 61327.512534007066, 62386.85835374356, 95975.21132025064, 316039.27716203686, 226590.17542293118, 76247.06592337086, 76635.60517781005, -26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2348194886343189, "mean_inference_ms": 0.7658305408533227, "mean_action_processing_ms": 0.11897174580763548, "mean_env_wait_ms": 0.17574632697526782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007648468017578125, "StateBufferConnector_ms": 0.0007253885269165039, "ViewRequirementAgentConnector_ms": 0.019375920295715332}, "num_episodes": 16, "episode_return_max": 949576.7732103419, "episode_return_min": -134431.81111469964, "episode_return_mean": 252777.94815678586, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 572.623742749203, "num_env_steps_trained_throughput_per_sec": 572.623742749203, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 6074.084, "restore_workers_time_ms": 0.034, "training_step_time_ms": 6073.979, "sample_time_ms": 5425.996, "learn_time_ms": 643.115, "learn_throughput": 6219.725, "synch_weights_time_ms": 3.922}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-32", "timestamp": 1760509712, "time_this_iter_s": 6.993579149246216, "time_total_s": 431.726802110672, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed63e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 431.726802110672, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 83.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.082730531692505, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.943931871652604, "policy_loss": -0.025055513784172943, "vf_loss": 9.958550277352334, "vf_explained_var": 2.7008354663848877e-08, "kl": 0.015462364083669449, "entropy": 3.680470685660839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 976628.9481203151, "episode_reward_min": -99211.67190755594, "episode_reward_mean": 231327.62001078218, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -34360.09902912402, "policy_mean": -35877.34789973415, "policy_mm": -25857.0836700167, "policy_rl": -26463.3536224644}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 262944.7067128369, "policy_mm": 250884.4965115219, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 54426.834138232516, "policy_mean": 53358.706222226334, "policy_mm": 55760.893984495524, "policy_rl": 67781.18566582781}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 54426.8359375, "('mom_0', 'policy_mom')_total_reward_min": -34360.09765625, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 53358.703125, "('mean_0', 'policy_mean')_total_reward_min": -35877.34765625, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 55760.89453125, "('mm_0', 'policy_mm')_total_reward_min": -25857.083984375, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67781.1953125, "('rl_trader_0', 'policy_rl')_total_reward_min": -26463.353515625, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [-22539.94649631918, 209127.07050238666, 244814.14389980922, 149967.34152322868, -16103.637091401106, 440744.89443626936, 275776.8212217414, 685766.2226678627, 41958.81674616005, 56832.182729402404, 257913.6440414379, 233722.39743158908, -24477.19840456747, 313691.9809995082, 214072.3830862379, 344491.50304102595, 226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [3024.6468315965176, 43632.975265507645, 77787.8698178097, 41013.065269873194, -861.9644481499967, 115122.00390525292, 57327.972099661485, 165487.14081020874, 8799.374396720892, 7132.35747873303, 91683.43924911978, 61314.38286231503, -19462.075223638913, 47022.90849695394, 59392.77571743517, 138750.73092031607, 50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195], "policy_policy_mean_reward": [-11106.464628856687, 52705.03109748697, 61042.72863110125, 28305.447131258963, -1964.5880199099968, 77149.50497275058, 92035.55829592116, 184940.96702814347, 5871.446191863874, 11836.914076861789, 38484.94283794997, 60273.98226074498, -7586.771844300967, 111551.43072915124, 41660.71604818548, 34919.77601008729, 47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613], "policy_policy_mm_reward": [12005.224923405429, 63505.90529190297, 50325.518628418, 28686.411358927722, 4273.296438671959, 96305.03271906794, 53020.34818389682, 98346.92487057463, 18187.99564176843, 20596.218625572845, 49786.1482859336, 50673.63038196933, 858.6289294788895, 69203.81211518851, 60868.49607838592, 88582.0465825186, 78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564], "policy_policy_rl_reward": [-26463.3536224644, 49283.15884748935, 55658.02682248003, 51962.41776316887, -17550.38106201317, 152168.35283919756, 73392.94264226244, 236991.18995893488, 9100.000515806993, 17266.692548234714, 77959.11366843445, 61460.40192655989, 1713.0197338933085, 85913.82965821425, 52150.39524223171, 82238.94952810463, 50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2350046048506348, "mean_inference_ms": 0.7664395734842901, "mean_action_processing_ms": 0.11906378344858407, "mean_env_wait_ms": 0.17592128953416622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007833242416381836, "StateBufferConnector_ms": 0.0007376670837402344, "ViewRequirementAgentConnector_ms": 0.02117025852203369}, "num_episodes": 16, "episode_return_max": 976628.9481203151, "episode_return_min": -99211.67190755594, "episode_return_mean": 231327.62001078218, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 638.8624989647225, "num_env_steps_trained_throughput_per_sec": 638.8624989647225, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 6119.742, "restore_workers_time_ms": 0.044, "training_step_time_ms": 6119.624, "sample_time_ms": 5472.333, "learn_time_ms": 642.51, "learn_throughput": 6225.583, "synch_weights_time_ms": 3.927}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-39", "timestamp": 1760509719, "time_this_iter_s": 6.265660762786865, "time_total_s": 437.99246287345886, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed7920>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 437.99246287345886, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 45.36666666666666, "ram_util_percent": 83.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4078314304351807, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.945554420351982, "policy_loss": -0.023844985506730153, "vf_loss": 9.95669790506363, "vf_explained_var": 4.1816383600234985e-07, "kl": 0.018817020673487183, "entropy": 3.6737910650670527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 976628.9481203151, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 235049.91432293903, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -37747.619464925614, "policy_mean": -38945.34595412309, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 262944.7067128369, "policy_mm": 250884.4965115219, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 52887.59050246212, "policy_mean": 54257.39880272399, "policy_mm": 57895.38650789717, "policy_rl": 70009.53850985579}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52887.58984375, "('mom_0', 'policy_mom')_total_reward_min": -37747.62109375, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 54257.39453125, "('mean_0', 'policy_mean')_total_reward_min": -38945.34765625, "('mean_0', 'policy_mean')_total_reward_max": 262944.71875, "('mm_0', 'policy_mm')_total_reward_mean": 57895.390625, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70009.53125, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [226829.8396681378, 136335.342386173, 169346.71247115935, 164893.98805992398, -18261.192399254083, -99211.67190755594, 815967.9086494902, 23980.69140308404, 713971.1015898149, 110683.6546685201, 368977.43016069115, 565090.5450702024, -7242.943262358449, 148422.9482320937, 143807.63824378897, 256848.86258700455, 179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [50392.91088432811, 43176.55788567704, 36435.593911315606, 26334.157265500904, -3278.239873510513, -20843.604707548184, 91699.91121428013, 5182.9564405322135, 160931.03407822415, 23633.348472500562, 107141.53333151132, 112647.8641332527, 4927.469687636477, 50498.20586311861, 37935.53110947224, 50386.4932527876, 47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837], "policy_policy_mean_reward": [47938.63470673173, 23790.98248839924, 39219.69588066443, 50181.61639043752, -2989.043466708172, -32773.80812852069, 262944.7067128369, 13733.499215980168, 188477.9381399618, 31646.794819737883, 65141.50788933376, 134773.77212852196, -9295.75434759334, 8496.769861152043, 26988.98316918272, 86337.72304943712, 68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381], "policy_policy_mm_reward": [78071.88719334797, 21570.53640078222, 44744.49039359707, 62590.7174263961, 602.9413639214873, -25857.0836700167, 194666.7460633073, 15869.886995107132, 122768.6537566245, 33629.61771361478, 81207.99832962654, 140692.25411625218, 5575.938506115814, 43389.87112492437, 31226.423466431796, 56884.4744318929, 4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787], "policy_policy_rl_reward": [50426.40688373027, 47797.26561131446, 48946.932285582356, 25787.496977589486, -12596.850422956759, -19737.175401470347, 266656.5446590655, -10805.6512485355, 241793.47561500513, 21773.89366266689, 115486.39061021939, 176976.65469217487, -8450.59710851733, 46038.10138289875, 47656.70049870209, 63240.17185288687, 58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23520954638033081, "mean_inference_ms": 0.7671150321997883, "mean_action_processing_ms": 0.11916737070234718, "mean_env_wait_ms": 0.17611695971905317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007831454277038574, "StateBufferConnector_ms": 0.0007451772689819336, "ViewRequirementAgentConnector_ms": 0.021281957626342773}, "num_episodes": 16, "episode_return_max": 976628.9481203151, "episode_return_min": -149370.3561424426, "episode_return_mean": 235049.91432293903, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.1442227273135, "num_env_steps_trained_throughput_per_sec": 683.1442227273135, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 6129.447, "restore_workers_time_ms": 0.043, "training_step_time_ms": 6129.329, "sample_time_ms": 5485.412, "learn_time_ms": 639.053, "learn_throughput": 6259.265, "synch_weights_time_ms": 3.991}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-45", "timestamp": 1760509725, "time_this_iter_s": 5.861308813095093, "time_total_s": 443.85377168655396, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7c40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 443.85377168655396, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 39.0375, "ram_util_percent": 83.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0578770637512207, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.9431912869215, "policy_loss": -0.027101231733104213, "vf_loss": 9.959543511271477, "vf_explained_var": 3.207474946975708e-07, "kl": 0.015924469010702012, "entropy": 3.766429223865271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 976628.9481203151, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 221136.45939563419, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 239472.43675803542, "policy_mean": 232617.35920363842, "policy_mm": 250884.4965115219, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 50545.93691535262, "policy_mean": 51240.85801286175, "policy_mm": 54527.816161311865, "policy_rl": 64821.848306107975}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50545.9453125, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 239472.4375, "('mean_0', 'policy_mean')_total_reward_mean": 51240.859375, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 232617.359375, "('mm_0', 'policy_mm')_total_reward_mean": 54527.81640625, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64821.85546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [179640.71779191424, 138459.7266271075, 690884.016998438, 150705.48757101368, 302275.68695655506, 296028.0670018556, 636248.1947139854, 35100.139639554916, 388878.0057152217, -50486.989151436355, 156869.25883501966, -40213.03993217897, 283931.1390404655, 355313.5862861772, 104421.31226996542, -54744.208791396566, 92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [47811.921341142915, 27979.703258591802, 161395.99150903506, 34829.919478436575, 63399.94328031377, 73378.05899426961, 239472.43675803542, -7403.961564392043, 107008.85742010747, -11969.398301695937, 55664.21118472825, 8200.528395826586, 67858.15721806618, 103134.30217493486, 27608.69617722903, -16482.410604471796, 32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958], "policy_policy_mean_reward": [68820.74919576145, 37277.63843751099, 118991.00869350113, 36764.373664404564, 51944.8935939481, 75673.85827766068, 72838.89762813892, 32324.75283241405, 89406.68684336325, -20200.06724059349, 42207.42374628648, -20465.254587837542, 54098.16064672676, 85036.32540832368, 29325.93478941869, -12445.060598944447, 29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005], "policy_policy_mm_reward": [4427.865642197953, 40192.78185153518, 181472.4630700309, 30918.43797286273, 98425.23028411614, 60131.12901746686, 135668.233369184, 5392.759642441469, 108410.79635523655, -9800.234015512968, 34197.68336141341, -7886.2847658261, 83064.94228548456, 81861.29586628768, 17442.56244916415, -7917.57047669192, 17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692], "policy_policy_rl_reward": [58580.181612811684, 33009.603079469656, 229024.5537258721, 48192.75645530976, 88505.61979817694, 86845.02071245844, 188268.62695862656, 4786.58872909145, 84051.66509651477, -8517.289593633954, 24799.94054259167, -20062.02897434172, 78909.87889018799, 85281.66283663086, 30044.118854153574, -17899.167111288323, 12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23543243054493698, "mean_inference_ms": 0.7678034262804642, "mean_action_processing_ms": 0.1192804879006658, "mean_env_wait_ms": 0.1763277012400141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007928609848022461, "StateBufferConnector_ms": 0.0007436275482177734, "ViewRequirementAgentConnector_ms": 0.02147430181503296}, "num_episodes": 16, "episode_return_max": 976628.9481203151, "episode_return_min": -149370.3561424426, "episode_return_mean": 221136.45939563419, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.1340163574043, "num_env_steps_trained_throughput_per_sec": 687.1340163574043, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 6081.984, "restore_workers_time_ms": 0.037, "training_step_time_ms": 6081.876, "sample_time_ms": 5443.932, "learn_time_ms": 633.19, "learn_throughput": 6317.218, "synch_weights_time_ms": 3.892}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-50", "timestamp": 1760509730, "time_this_iter_s": 5.826616048812866, "time_total_s": 449.6803877353668, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e480>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 449.6803877353668, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 39.41111111111112, "ram_util_percent": 83.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1470649242401123, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.942531237006188, "policy_loss": -0.028424112498760222, "vf_loss": 9.959524047374725, "vf_explained_var": 1.4808028936386108e-07, "kl": 0.01693528637074505, "entropy": 3.633630149066448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 976628.9481203151, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 220515.4489366501, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 283132.40115985944, "policy_mean": 232617.35920363842, "policy_mm": 250884.4965115219, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 49656.77434972304, "policy_mean": 52593.79416846738, "policy_mm": 53890.41409931238, "policy_rl": 64374.46631914723}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49656.7734375, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 283132.40625, "('mean_0', 'policy_mean')_total_reward_mean": 52593.796875, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 232617.359375, "('mm_0', 'policy_mm')_total_reward_mean": 53890.41015625, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 64374.46875, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [92426.79557419014, 674499.9825815937, 34329.02466651925, 85565.13745473578, 160583.01479273525, -82651.76703882078, 27673.070983429425, 128469.20164129959, 329165.051472188, 834844.1646039509, 354463.75354164833, 404150.448051087, 544165.7673794287, 166709.73287122243, 493890.7590585836, 270956.0190841012, 219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [32208.23987011523, 153384.3205571287, 11779.65824765778, 22249.30930256344, 26134.36273791346, -11972.36743036722, -12118.469002560973, 30863.704213607663, 82880.44533326101, 151017.41544193457, 59746.80244833476, 104431.43556788289, 141534.04351970492, 51504.7502327697, 98423.65114163478, 33740.852148597194, 59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326], "policy_policy_mean_reward": [29763.9761486093, 141869.42575994448, -8744.09227670671, 15583.428103294078, 43783.29512326387, -35877.34789973415, 30588.995772046455, 21256.735075558598, 80090.9548687809, 169688.15351931078, 81108.57000223313, 104741.17198114381, 121398.35995607286, 39534.66438649346, 102295.71115992121, 77874.31940135165, 48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835], "policy_policy_mm_reward": [17690.216612277112, 167280.41547104903, 22085.229515720075, 28643.199726032224, 59235.42683484735, -20158.23241894874, 17953.73373890674, 45285.43279145192, 82354.75654087926, 245025.34186810185, 143321.07993694724, 85628.88036765734, 61627.018099551824, 38924.263502407135, 99691.87738452553, 67310.64790241595, 58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015], "policy_policy_rl_reward": [12764.362943188578, 211965.8207934707, 9208.229179847962, 19089.20032284572, 31429.93009671072, -14643.819289770689, -8751.189524962745, 31063.329560681424, 83838.89472926625, 269113.2537746025, 70287.30115413335, 109348.9601344034, 219606.3458040994, 36746.05474955215, 193479.51937250202, 92030.19963173596, 52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356547990286638, "mean_inference_ms": 0.7684948397098869, "mean_action_processing_ms": 0.11938334523173627, "mean_env_wait_ms": 0.17652175662096772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007867217063903809, "StateBufferConnector_ms": 0.0007392168045043945, "ViewRequirementAgentConnector_ms": 0.021371066570281982}, "num_episodes": 16, "episode_return_max": 976628.9481203151, "episode_return_min": -149370.3561424426, "episode_return_mean": 220515.4489366501, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.3208757401026, "num_env_steps_trained_throughput_per_sec": 674.3208757401026, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 6111.523, "restore_workers_time_ms": 0.037, "training_step_time_ms": 6111.418, "sample_time_ms": 5462.178, "learn_time_ms": 644.19, "learn_throughput": 6209.344, "synch_weights_time_ms": 4.198}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "26ec2_00000", "date": "2025-10-15_01-28-56", "timestamp": 1760509736, "time_this_iter_s": 5.937196731567383, "time_total_s": 455.6175844669342, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fe20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 455.6175844669342, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 41.3125, "ram_util_percent": 83.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.329378128051758, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.950150674581527, "policy_loss": -0.019477822106273378, "vf_loss": 9.958684101700783, "vf_explained_var": 8.158385753631591e-08, "kl": 0.01621389785355007, "entropy": 3.5820252008736135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 976628.9481203151, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 213615.56700391945, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 283132.40115985944, "policy_mean": 232617.35920363842, "policy_mm": 250884.4965115219, "policy_rl": 363543.0983874554}, "policy_reward_mean": {"policy_mom": 49926.78889466633, "policy_mean": 51637.78624411444, "policy_mm": 51023.021844554605, "policy_rl": 61027.970020584035}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49926.78515625, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 283132.40625, "('mean_0', 'policy_mean')_total_reward_mean": 51637.78515625, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 232617.359375, "('mm_0', 'policy_mm')_total_reward_mean": 51023.01953125, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 61027.96875, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 363543.09375}, "hist_stats": {"episode_reward": [219417.94995680795, 949576.7732103419, 154482.43136973341, 567702.6687565424, -22203.26856130035, 95108.63274592886, -9014.050638564797, 129694.47662116626, 256307.21658982, 244283.5229115132, 21706.346988301902, 262451.80846359715, 27984.306280733923, 219545.60224997828, 74991.16381191336, 246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [59254.631606860865, 205196.0426332371, 23230.025250639843, 141122.03390257253, -7270.063086140509, 12845.252522087794, 4085.735920442235, 32031.018279125336, 74797.70625771301, 32924.49115605679, 353.28526263200524, 65130.908171927105, 11880.573027943467, 59830.39872590958, 24773.09528696076, 49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366], "policy_policy_mean_reward": [48543.56009712121, 225926.80610733197, 42257.25394099513, 117687.51725243256, -5210.64730080459, 12707.232945954804, -6530.372421594568, 38009.89386375783, 70481.27765922237, 68202.4544994448, 5799.046373989352, 46059.9874588861, 3976.142722298743, 52580.19585898011, 22517.805790639362, 69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126], "policy_policy_mm_reward": [58969.313984015665, 154910.82608231826, 49985.1936411412, 122816.56206671323, -7981.494005085947, 41829.522955371154, -2135.6321345510833, 18490.5792111907, 54795.55306298633, 64008.82071088962, 3986.985656248694, 83426.73127735555, 17563.365930733016, 48463.98985371284, 21275.33160605672, 64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692], "policy_policy_rl_reward": [52650.44426881031, 363543.0983874554, 39009.95853695676, 186076.55553482388, -1741.0641692691788, 27726.62432251516, -4433.782002861398, 41162.98526709242, 56232.679609898245, 79147.75654512191, 11567.029695431847, 67834.18155542843, -5435.775400241439, 58671.01781137566, 6424.931128256504, 63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23579433925356608, "mean_inference_ms": 0.768897866720191, "mean_action_processing_ms": 0.11944047949828264, "mean_env_wait_ms": 0.17663061511830752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007553696632385254, "StateBufferConnector_ms": 0.0007256269454956055, "ViewRequirementAgentConnector_ms": 0.020541131496429443}, "num_episodes": 16, "episode_return_max": 976628.9481203151, "episode_return_min": -149370.3561424426, "episode_return_mean": 213615.56700391945, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 718.0029222175798, "num_env_steps_trained_throughput_per_sec": 718.0029222175798, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 6116.724, "restore_workers_time_ms": 0.037, "training_step_time_ms": 6116.618, "sample_time_ms": 5468.135, "learn_time_ms": 643.477, "learn_throughput": 6216.23, "synch_weights_time_ms": 4.15}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-02", "timestamp": 1760509742, "time_this_iter_s": 5.575780153274536, "time_total_s": 461.19336462020874, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6f20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 461.19336462020874, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 83.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4457173347473145, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.946209970116616, "policy_loss": -0.02650471304077655, "vf_loss": 9.960490494966507, "vf_explained_var": 6.731599569320678e-07, "kl": 0.018109868727424826, "entropy": 3.617658094316721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 1071382.3265210004, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 219650.42042458671, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 232617.35920363842, "policy_mm": 250884.4965115219, "policy_rl": 377232.65786396316}, "policy_reward_mean": {"policy_mom": 52543.20903056723, "policy_mean": 52493.67253624936, "policy_mm": 51551.74616089456, "policy_rl": 63061.79269687552}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52543.21484375, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 52493.671875, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 232617.359375, "('mm_0', 'policy_mm')_total_reward_mean": 51551.74609375, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 250884.5, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63061.7890625, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 377232.65625}, "hist_stats": {"episode_reward": [246018.2206423131, 271596.7297546447, 11501.50556288151, 309070.91635842377, 294052.51809252234, 257870.2928594098, 31457.993697823207, 507880.725275147, 283006.24441931467, 282014.1686322587, 250699.68994417167, 976628.9481203151, -99128.61453419205, 304454.9285132999, 291722.2762169936, 107363.57949802127, 250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [49173.77758693304, 50932.20936147933, 5763.286182358506, 91600.0054934829, 73118.52473158315, 43220.54898391359, 11370.235681635446, 98062.07456757966, 79175.18203156268, 62776.38176199481, 69836.53792414158, 207597.6402136548, -34360.09902912402, 55254.6015043652, 65102.63591871758, 25227.65383959137, 65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288], "policy_policy_mean_reward": [69592.27660252422, 84306.52382075496, 167.21512826247778, 55319.65228126574, 75807.54061554196, 66683.11884366127, -4143.024948172461, 87825.57120835973, 85386.02453351901, 70912.55706947426, 50420.682126591266, 232617.35920363842, -29976.106347841865, 82019.00513165294, 73518.36697009436, 28991.980768890204, 50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886], "policy_policy_mm_reward": [64161.24145617159, 66182.5072732528, -281.2369196952086, 93738.107181877, 73629.25727911721, 71703.49583352589, 12359.971706769993, 123691.42398955334, 39982.655754247724, 68298.40697519184, 51236.00667029758, 250884.4965115219, -11559.430956974129, 73907.64048771777, 79447.98868851968, 35376.82196512767, 51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281], "policy_policy_rl_reward": [63090.92499668418, 70175.48929915774, 5852.241171955832, 68413.15140179846, 71497.19546628006, 76263.12919830892, 11870.811257590236, 198301.65550965423, 78462.38209998523, 80026.82282559763, 79206.46322314104, 285529.45219149895, -23232.978200252124, 93273.68138956417, 73653.28463966199, 17767.122924412004, 83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23582343640980988, "mean_inference_ms": 0.7689163347654369, "mean_action_processing_ms": 0.11944098014305317, "mean_env_wait_ms": 0.17662745480185785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007312893867492676, "StateBufferConnector_ms": 0.0007065534591674805, "ViewRequirementAgentConnector_ms": 0.019900381565093994}, "num_episodes": 15, "episode_return_max": 1071382.3265210004, "episode_return_min": -149370.3561424426, "episode_return_mean": 219650.42042458671, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 719.9405826015297, "num_env_steps_trained_throughput_per_sec": 719.9405826015297, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 6105.583, "restore_workers_time_ms": 0.038, "training_step_time_ms": 6105.477, "sample_time_ms": 5460.686, "learn_time_ms": 640.024, "learn_throughput": 6249.761, "synch_weights_time_ms": 3.96}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-08", "timestamp": 1760509748, "time_this_iter_s": 5.56009316444397, "time_total_s": 466.7534577846527, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db32e0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 466.7534577846527, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 32.775, "ram_util_percent": 83.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6776974201202393, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.955497413873672, "policy_loss": -0.017633124721760395, "vf_loss": 9.96026708483696, "vf_explained_var": 8.773058652877808e-08, "kl": 0.019056918393471817, "entropy": 3.317649193108082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1071382.3265210004, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 235044.3214076556, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -37105.282306952795, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 212846.13609819862, "policy_mm": 241893.530079062, "policy_rl": 377232.65786396316}, "policy_reward_mean": {"policy_mom": 57584.46553851492, "policy_mean": 55346.19761135635, "policy_mm": 53527.14442440805, "policy_rl": 68586.51383337624}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57584.46484375, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 55346.203125, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 212846.140625, "('mm_0', 'policy_mm')_total_reward_mean": 53527.14453125, "('mm_0', 'policy_mm')_total_reward_min": -37105.28125, "('mm_0', 'policy_mm')_total_reward_max": 241893.53125, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68586.5078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 377232.65625}, "hist_stats": {"episode_reward": [250638.8489336661, -47261.932740198616, -18885.540999044017, 111480.6876782958, 99793.50015019663, -45728.53000455036, -143791.5861020944, 714032.0491563134, -9696.021785125367, -4366.7514232528065, 317274.4316247026, 335941.43007785804, 330803.86685290013, 282970.12185630534, 341649.37113068503, 834651.2133374487, 748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [65355.11107343571, -18260.19280625397, -6050.339902236044, 46685.198883822006, 28852.867453516195, -19698.96958119279, -37747.619464925614, 167316.7246570319, 11651.652022042017, 1038.6893241972432, 89647.64453550454, 75804.51897831126, 74446.09458345959, 50363.85721688636, 54000.33898701523, 150868.3824990468, 119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878], "policy_policy_mean_reward": [50371.49981825459, -8361.55475369363, 3889.202756141332, 10885.984950381162, 35337.30985501613, -3513.9430054032623, -36498.92196767727, 136173.80682574396, -633.849433619093, 6010.443367421768, 57485.94909929256, 88775.08701582068, 100343.62105347273, 61794.73279070634, 70610.2286329093, 177891.65171362372, 192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992], "policy_policy_mm_reward": [51749.72735542274, -10828.607085295085, -15888.216103076202, 11557.143154448575, 25571.974881913564, -11444.312332566758, -37105.282306952795, 129069.10662112542, -10238.830750908588, 1061.1545060156159, 75124.69586971894, 88158.7816531407, 81612.49775945232, 85322.47170643267, 124872.01384220281, 241893.530079062, 156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058], "policy_policy_rl_reward": [83162.51068655272, -9811.578094955943, -836.1877498730692, 42352.36068964391, 10031.347959750507, -11071.305085387512, -32439.762362538557, 281472.41105241305, -10474.993622639618, -12477.038620887513, 95016.14212018659, 83203.042430586, 74401.65345651559, 85489.06014227985, 92166.78966855718, 263997.6490457162, 280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23577832604185694, "mean_inference_ms": 0.7686557901601012, "mean_action_processing_ms": 0.1194086151291285, "mean_env_wait_ms": 0.17656265695424322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007018446922302246, "StateBufferConnector_ms": 0.0006886720657348633, "ViewRequirementAgentConnector_ms": 0.018000662326812744}, "num_episodes": 16, "episode_return_max": 1071382.3265210004, "episode_return_min": -149370.3561424426, "episode_return_mean": 235044.3214076556, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.9231304297585, "num_env_steps_trained_throughput_per_sec": 729.9231304297585, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 6087.084, "restore_workers_time_ms": 0.036, "training_step_time_ms": 6086.983, "sample_time_ms": 5443.61, "learn_time_ms": 638.615, "learn_throughput": 6263.559, "synch_weights_time_ms": 3.964}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-13", "timestamp": 1760509753, "time_this_iter_s": 5.484131813049316, "time_total_s": 472.237589597702, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4a40>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 472.237589597702, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.9125, "ram_util_percent": 83.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4907078742980957, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0003, "total_loss": 9.954402443766593, "policy_loss": -0.01844309024600079, "vf_loss": 9.958774456381798, "vf_explained_var": 2.115964889526367e-07, "kl": 0.020846054706908514, "entropy": 3.7164708390831946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -149370.3561424426, "episode_reward_mean": 242431.23385112092, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -41927.290595182785, "policy_mean": -41297.54301360313, "policy_mm": -33544.00721276032, "policy_rl": -47047.484764971035}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 59359.69149706657, "policy_mean": 57741.13994021897, "policy_mm": 54276.73938725763, "policy_rl": 71053.6630265777}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 59359.69140625, "('mom_0', 'policy_mom')_total_reward_min": -41927.2890625, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 57741.140625, "('mean_0', 'policy_mean')_total_reward_min": -41297.54296875, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 54276.734375, "('mm_0', 'policy_mm')_total_reward_min": -33544.0078125, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71053.6640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -47047.484375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [748685.7557936356, -28535.695759940103, -149370.3561424426, 172148.76804920088, 81319.98488841623, 74808.00669126933, 5148.6950821830505, 172345.7220630994, 132055.68815122676, 217878.82937467008, 9942.137783722554, 32159.797885395565, 7946.756494495778, 164123.65355105366, 201467.51753284252, -148451.81573021738, 247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [119483.0319109155, -12295.117553670823, -29833.51821058803, 19472.219447761858, 28725.310520880837, 17711.61819384784, 9673.760457960281, 22062.489596784948, 47113.11496422295, 69535.53314507085, 17926.065937539006, 4282.880532983504, 10684.68678388544, 54842.22353024618, 34299.47639591574, -41927.290595182785, 54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965], "policy_policy_mean_reward": [192087.1756228116, -3336.7381537702595, -38945.34595412309, 51110.23788276554, 10635.743378230381, 21911.30429423887, -624.0332615187797, 51385.390589874085, 37506.25163779257, 47299.68792178793, 2756.74428907019, 10636.664945278078, -14695.169063425476, 37641.30456255384, 78827.67839124068, -41297.54301360313, 64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013], "policy_policy_mm_reward": [156679.49372321722, 15740.280728520847, -33544.00721276032, 44670.03573442189, 26803.261775725787, 23777.97478895544, -4164.342433058081, 61577.44599409643, 13643.68262889321, 43206.929867257495, -3893.3236401208674, 18662.99528060529, 24374.44778980134, 38821.84010008192, 59610.148262436705, -25332.341770265582, 48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133], "policy_policy_rl_reward": [280436.0545366916, -28644.120781019832, -47047.484764971035, 56896.27498425166, 15155.669213579271, 11407.10941422726, 263.31031879924853, 37320.39588234381, 33792.63892031792, 57836.67844055342, -6847.348802765673, -1422.74287347122, -12417.209015765544, 32818.285358171925, 28730.214483249518, -39894.640351165755, 80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2357001738169034, "mean_inference_ms": 0.7683190402689855, "mean_action_processing_ms": 0.11936044796513652, "mean_env_wait_ms": 0.17647016467798352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006954669952392578, "StateBufferConnector_ms": 0.0006895065307617188, "ViewRequirementAgentConnector_ms": 0.017874598503112793}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -149370.3561424426, "episode_return_mean": 242431.23385112092, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.1753287335665, "num_env_steps_trained_throughput_per_sec": 708.1753287335665, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 6046.415, "restore_workers_time_ms": 0.036, "training_step_time_ms": 6046.314, "sample_time_ms": 5414.861, "learn_time_ms": 626.858, "learn_throughput": 6381.032, "synch_weights_time_ms": 3.787}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-19", "timestamp": 1760509759, "time_this_iter_s": 5.652571201324463, "time_total_s": 477.8901607990265, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed76a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 477.8901607990265, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 31.6625, "ram_util_percent": 83.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.201866626739502, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.94993491768837, "policy_loss": -0.01883718641329324, "vf_loss": 9.957955890893937, "vf_explained_var": 1.8440186977386475e-07, "kl": 0.010682664145770618, "entropy": 3.7454843558371067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -102011.16146386431, "episode_reward_mean": 263357.0569919035, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31037.892426698218, "policy_mean": -31609.59849025566, "policy_mm": -22954.73725828355, "policy_rl": -39502.62302548614}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 65134.07991038899, "policy_mean": 62900.59792758933, "policy_mm": 58682.84885438306, "policy_rl": 76639.53029954211}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 65134.078125, "('mom_0', 'policy_mom')_total_reward_min": -31037.892578125, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 62900.6015625, "('mean_0', 'policy_mean')_total_reward_min": -31609.59765625, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 58682.859375, "('mm_0', 'policy_mm')_total_reward_min": -22954.736328125, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76639.53125, "('rl_trader_0', 'policy_rl')_total_reward_min": -39502.62109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [247913.71271654172, 81981.15499245925, 280518.95837920986, 147142.61743687178, 702113.9304856056, 283728.43171015754, 20537.873924653446, 187195.10824876348, -85560.76726609294, 922525.5278120423, 114140.27345708704, 10628.071026383406, 898050.4640928906, 51226.11341646141, 258902.28685442498, 363379.27489400865, 314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [54284.90728505029, 7660.266191711781, 62274.80391954271, 20648.9424148808, 151962.88548366958, 47186.7016402086, 18873.043195404443, 55398.93021257211, -31037.892426698218, 283132.40115985944, 29125.06016129725, -15624.560460817345, 246134.32901855354, 36681.214307817965, 58170.48474391561, 79834.25828760889, 71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073], "policy_policy_mean_reward": [64706.61101612159, 49572.01845634553, 77894.42961588562, 26916.910580288513, 182521.68856140005, 63034.57544892932, 7903.760770125405, 51594.92472859547, -17509.072772728086, 205231.12488200294, 39304.14957518188, -5202.148626132897, 212846.13609819862, 18036.5239910855, 82169.6169205895, 101116.2372326037, 63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505], "policy_policy_mm_reward": [48886.76327443476, 3770.99303510514, 76877.88288228936, 53159.161880511936, 137898.0610123692, 87227.65485413624, -9111.306262285776, 35260.16118568447, -19212.964182663145, 150167.0081306266, 22955.606125442682, 5542.154333887349, 207903.8167445661, -1151.527986756, 58973.611753781915, 90277.0222402938, 90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013], "policy_policy_rl_reward": [80035.43114093487, 20977.877309296888, 63471.8419614923, 46417.60256119055, 229731.29542816634, 86279.49976688337, 2872.3762214095, 44941.092121911315, -17800.837884003413, 283994.99363955355, 22755.457595165044, 25912.625779446447, 231166.18223157237, -2340.0968956860897, 59588.573436137616, 92151.75713350164, 89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23559827977569192, "mean_inference_ms": 0.7679188678171925, "mean_action_processing_ms": 0.1193013302450045, "mean_env_wait_ms": 0.17635917448522295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006898045539855957, "StateBufferConnector_ms": 0.0006823539733886719, "ViewRequirementAgentConnector_ms": 0.01757502555847168}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -102011.16146386431, "episode_return_mean": 263357.0569919035, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 724.5730895542151, "num_env_steps_trained_throughput_per_sec": 724.5730895542151, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 5863.11, "restore_workers_time_ms": 0.034, "training_step_time_ms": 5863.022, "sample_time_ms": 5297.182, "learn_time_ms": 562.178, "learn_throughput": 7115.181, "synch_weights_time_ms": 3.007}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-24", "timestamp": 1760509764, "time_this_iter_s": 5.524620771408081, "time_total_s": 483.41478157043457, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5ee0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 483.41478157043457, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 35.3125, "ram_util_percent": 83.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3271656036376953, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.945268774032593, "policy_loss": -0.024128718589781783, "vf_loss": 9.957294425368309, "vf_explained_var": 2.3875385522842406e-06, "kl": 0.011953647903101747, "entropy": 3.610893319547176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -102011.16146386431, "episode_reward_mean": 247848.65176647954, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -27295.466568468983, "policy_mean": -31609.59849025566, "policy_mm": -24610.15594018467, "policy_rl": -39502.62302548614}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 61558.16775622333, "policy_mean": 58108.14632449702, "policy_mm": 56962.09525193742, "policy_rl": 71220.24243382162}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 61558.17578125, "('mom_0', 'policy_mom')_total_reward_min": -27295.466796875, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 58108.1484375, "('mean_0', 'policy_mean')_total_reward_min": -31609.59765625, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 56962.08984375, "('mm_0', 'policy_mm')_total_reward_min": -24610.15625, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 71220.2421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -39502.62109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [314088.1812177977, -9268.595138739094, 28186.164802398416, 8723.763835786645, 144727.88278582267, 397068.33557458036, 274249.5866454966, 49831.27495247065, 345054.81908479624, 701987.4157461554, 278132.0998188914, 369309.451811385, 70790.2883748841, 98450.2864444105, -8477.273410170528, 86523.7059767771, -40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [71919.68717419359, -17903.07176430148, 11890.67946937101, 1570.361582920536, 17619.07385529326, 103217.72541261287, 61054.94701783651, 24210.247374404684, 86954.58608476703, 175350.0327627665, 40184.46829110787, 122772.24037553716, 13364.003908302497, 12957.426087549959, 5263.630901630693, 34204.05384094537, -24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591], "policy_policy_mean_reward": [63072.30387823426, 1094.0111226222384, 15675.707863598853, -13342.70827340947, 51868.794051150835, 100068.31880034422, 108431.94321624328, -913.6070593349925, 104958.41565969218, 172679.60320742935, 56298.52283379315, 66905.2112140621, 21893.13952369951, 42732.794372055556, -19689.19317731048, 9125.985767696995, 8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948], "policy_policy_mm_reward": [90063.03742421918, 10537.083603907768, 17809.224201710687, 1601.0935779425677, 43420.209964948015, 89384.67145844542, 57721.772025360886, 17272.144704023074, 68724.71766293255, 128088.39613904654, 82945.94890114362, 98288.72402540283, 29751.41291053968, 19439.84404636747, 13193.846797888855, 33632.86631235402, -21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636], "policy_policy_rl_reward": [89033.1527411507, -2996.6181009674947, -17189.446732282046, 18895.01694833301, 31819.80491443045, 104397.61990317688, 47040.924386055834, 9262.489933377814, 84417.09967740445, 225869.38363691242, 98703.15979284658, 81343.27619638295, 5781.732032342407, 23320.22193843755, -7245.557932379645, 9560.800055781167, -2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23547007856702307, "mean_inference_ms": 0.7674276285790157, "mean_action_processing_ms": 0.11923532859537136, "mean_env_wait_ms": 0.1762351483245797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006882548332214355, "StateBufferConnector_ms": 0.0006800293922424316, "ViewRequirementAgentConnector_ms": 0.01755368709564209}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -102011.16146386431, "episode_return_mean": 247848.65176647954, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.7476688961654, "num_env_steps_trained_throughput_per_sec": 730.7476688961654, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 5711.944, "restore_workers_time_ms": 0.022, "training_step_time_ms": 5711.893, "sample_time_ms": 5158.994, "learn_time_ms": 550.038, "learn_throughput": 7272.219, "synch_weights_time_ms": 2.264}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-30", "timestamp": 1760509770, "time_this_iter_s": 5.477971076965332, "time_total_s": 488.8927526473999, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156fa84a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 488.8927526473999, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 33.3625, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.486633777618408, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.952488148212433, "policy_loss": -0.01862962925224565, "vf_loss": 9.95836754143238, "vf_explained_var": 4.308298230171204e-07, "kl": 0.012592822349234322, "entropy": 3.5810306817293167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -129406.6112682434, "episode_reward_mean": 246050.56884598962, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31882.529218858326, "policy_mean": -31609.59849025566, "policy_mm": -33968.04398350888, "policy_rl": -39502.62302548614}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 60491.15073415883, "policy_mean": 57653.342061997384, "policy_mm": 54932.62111212895, "policy_rl": 72973.45493770448}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 60491.1484375, "('mom_0', 'policy_mom')_total_reward_min": -31882.529296875, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 57653.3515625, "('mean_0', 'policy_mean')_total_reward_min": -31609.59765625, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 54932.625, "('mm_0', 'policy_mm')_total_reward_min": -33968.04296875, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72973.453125, "('rl_trader_0', 'policy_rl')_total_reward_min": -39502.62109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [-40703.86649263746, 594552.5441127038, 237792.08015370826, 248965.01371462762, 125726.2009367524, 320424.7914114154, 187162.16409111046, 233091.50943222005, 609882.0126383507, -40072.53156876595, 79029.05704998903, 285960.14934204845, 83587.57346016835, 24175.38647074276, 807327.2235629671, 174755.15633165886, 48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-24590.359947301276, 160775.55801331613, 88932.44821350943, 70185.56103090674, 27973.039456615366, 86318.7591261163, 37585.15820552257, 67269.62423575947, 130198.45635849843, -1898.8534466152644, 21266.46313016016, 70953.45049426645, 22659.049496195646, 9273.39731395676, 157735.08852360782, 37792.981486298064, 15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584], "policy_policy_mean_reward": [8144.053855974484, 118710.78460181346, 51144.5698170513, 61116.449419314464, 17748.536593765126, 103952.64061385859, 71995.81997525475, 69732.2835304517, 117982.81133470101, -25503.727483543145, 19794.61053886302, 91372.41708818743, -4711.253689335519, -7871.618651441122, 169258.8226373129, 51002.11710221269, 19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664], "policy_policy_mm_reward": [-21389.35204916484, 115942.37488588934, 38594.99058194737, 76885.98893819119, 26681.71505767692, 65116.7189944957, 52942.38317665733, 50179.525639499174, 120665.38434992843, -8739.353301411575, 29329.992455631284, 64734.01846754461, 46954.40304169888, 23212.484569796587, 133253.20574197426, 66126.60169363073, 1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746], "policy_policy_rl_reward": [-2868.2083521457716, 199123.82661168426, 59120.0715412, 40777.01432621482, 53322.909828695156, 65036.67267694425, 24638.802733675635, 45910.07602650921, 241035.3605952232, -3930.5973371959817, 8637.990925334565, 58900.263292050186, 18685.374611609415, -438.87676156935777, 347080.1066600724, 19833.456049517394, 12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23532898771841373, "mean_inference_ms": 0.7668972899068772, "mean_action_processing_ms": 0.1191656291024697, "mean_env_wait_ms": 0.17610371581400094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006849169731140137, "StateBufferConnector_ms": 0.0006766319274902344, "ViewRequirementAgentConnector_ms": 0.017458975315093994}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -129406.6112682434, "episode_return_mean": 246050.56884598962, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.4931451050453, "num_env_steps_trained_throughput_per_sec": 729.4931451050453, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 5634.157, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5634.117, "sample_time_ms": 5084.052, "learn_time_ms": 547.126, "learn_throughput": 7310.93, "synch_weights_time_ms": 2.353}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-35", "timestamp": 1760509775, "time_this_iter_s": 5.488154888153076, "time_total_s": 494.380907535553, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed7d80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 494.380907535553, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 28.85, "ram_util_percent": 83.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6907131671905518, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.952358371019363, "policy_loss": -0.01848838319419883, "vf_loss": 9.956634110212326, "vf_explained_var": -8.158385753631591e-08, "kl": 0.014037163627927451, "entropy": 3.889032331854105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -129406.6112682434, "episode_reward_mean": 240658.07979056562, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31882.529218858326, "policy_mean": -31609.59849025566, "policy_mm": -33968.04398350888, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 386465.7416927537, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 57515.69430861828, "policy_mean": 56640.54473925116, "policy_mm": 55577.917084544075, "policy_rl": 70923.92365815207}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 57515.69140625, "('mom_0', 'policy_mom')_total_reward_min": -31882.529296875, "('mom_0', 'policy_mom')_total_reward_max": 386465.75, "('mean_0', 'policy_mean')_total_reward_mean": 56640.5390625, "('mean_0', 'policy_mean')_total_reward_min": -31609.59765625, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 55577.9140625, "('mm_0', 'policy_mm')_total_reward_min": -33968.04296875, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 70923.921875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [48128.83643052825, 1071382.3265210004, -36808.02852636588, -52504.70382382955, 247104.3330179846, 241097.81881497003, 185910.42514062198, 922901.386271091, 844091.1718744866, 112095.01039078798, -22400.74851674765, 199446.67412045962, 277876.8440574754, 271010.1407496364, 274852.3070868697, 706349.4290151354, 190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [15565.311398146796, 386465.7416927537, -18092.471768207135, -21265.007738402288, 68171.80133704307, 62065.11774715007, 38419.842690765974, 257972.64008278272, 142722.3992229636, 39237.151542510925, -2801.516154092953, 47427.035214979194, 85488.82431529339, 64185.64987501484, 66223.24171463813, 140006.400242302, 55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828], "policy_policy_mean_reward": [19084.338384971063, 169358.33276945114, -3649.0123266244, -13201.797762173886, 59915.85202818538, 58024.85764785522, 33775.789539250254, 195161.88943546417, 166864.8413383369, 30393.793917894745, 219.87919367998404, 48935.718659269536, 70146.8778358221, 86571.70721812024, 70726.73816713852, 149058.27685734263, 41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635], "policy_policy_mm_reward": [1289.715877785927, 138325.59419483235, -206.00321949575945, 93.40985052247281, 40410.96924495481, 45834.97550313322, 43687.59788871143, 229984.1009208386, 162048.66842893558, 32231.34020893909, -15944.357372824588, 46031.17256131125, 45655.92241560987, 49947.39182619754, 73804.39044495673, 200136.0810554718, 22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676], "policy_policy_rl_reward": [12189.470769624459, 377232.65786396316, -14860.541212038544, -18131.30817377586, 78605.71040780125, 75172.86791683124, 70027.19502189428, 239782.75583200614, 372455.2628842497, 10232.724721443248, -3874.7541835101138, 57052.74768489963, 76585.21949075007, 70305.39183030438, 64097.93676013621, 217148.67086001878, 70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23518815162454834, "mean_inference_ms": 0.7664105046585604, "mean_action_processing_ms": 0.11909549084547359, "mean_env_wait_ms": 0.17597140527866145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006849765777587891, "StateBufferConnector_ms": 0.0006705522537231445, "ViewRequirementAgentConnector_ms": 0.017518460750579834}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -129406.6112682434, "episode_return_mean": 240658.07979056562, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.5734937511855, "num_env_steps_trained_throughput_per_sec": 709.5734937511855, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 5612.348, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5612.309, "sample_time_ms": 5061.977, "learn_time_ms": 547.765, "learn_throughput": 7302.406, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-41", "timestamp": 1760509781, "time_this_iter_s": 5.641497850418091, "time_total_s": 500.02240538597107, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed71a0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 500.02240538597107, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.4875, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9923731088638306, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.943676850199699, "policy_loss": -0.02151230017625494, "vf_loss": 9.955565613508224, "vf_explained_var": 2.0097941160202027e-07, "kl": 0.009504723437931246, "entropy": 3.758985925465822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 1175200.4781933043, "episode_reward_min": -129406.6112682434, "episode_reward_mean": 211495.6609340262, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31882.529218858326, "policy_mean": -31609.59849025566, "policy_mm": -33968.04398350888, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 245804.51702712878, "policy_mean": 306300.849216757, "policy_mm": 251372.3632519521, "policy_rl": 378095.26303986914}, "policy_reward_mean": {"policy_mom": 49393.056186707814, "policy_mean": 50832.5617978998, "policy_mm": 51460.48767930955, "policy_rl": 59809.55527010903}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 49393.0546875, "('mom_0', 'policy_mom')_total_reward_min": -31882.529296875, "('mom_0', 'policy_mom')_total_reward_max": 245804.515625, "('mean_0', 'policy_mean')_total_reward_mean": 50832.56640625, "('mean_0', 'policy_mean')_total_reward_min": -31609.59765625, "('mean_0', 'policy_mean')_total_reward_max": 306300.84375, "('mm_0', 'policy_mm')_total_reward_mean": 51460.48828125, "('mm_0', 'policy_mm')_total_reward_min": -33968.04296875, "('mm_0', 'policy_mm')_total_reward_max": 251372.359375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 59809.5546875, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 378095.25}, "hist_stats": {"episode_reward": [190106.38823228047, 481503.6254802174, 182328.8225545664, 751326.593070406, 187312.1931826456, 277493.71304847766, 699526.1606145226, -91894.05331098507, 338875.73482215597, -29712.253559174937, 42217.02419823849, -102011.16146386431, 134620.9876679934, 1175200.4781933043, -21561.05706213379, 321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [55359.562796849124, 99044.42565400616, 48649.75423930584, 245804.51702712878, 54406.055734428475, 67401.9044897919, 143050.16651518602, -16418.33846115851, 71215.992805611, -22153.978891660154, 15908.160887150007, -7944.202689839109, 35747.1068337018, 239432.0026847262, 1719.0038627796398, 91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458], "policy_policy_mean_reward": [41874.33827616546, 102447.78272713482, 34574.41211184685, 166008.49556540992, 48114.47778132588, 28713.74809125259, 151184.98384440018, -15387.217944796485, 98757.65353513038, -9246.941318222765, 17276.645575712835, -31609.59849025566, 32371.679450719326, 306300.849216757, -8910.720693213976, 87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222], "policy_policy_mm_reward": [22651.951302197525, 123685.4746733048, 50686.98016951408, 139446.52097632058, 32390.686903002435, 63393.00447396195, 136307.98497243304, -21642.501546566513, 54271.456354022666, 426.85127653451417, 7554.20942791001, -22954.73725828355, 26743.243779843644, 251372.3632519521, -1985.6909445209153, 76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439], "policy_policy_rl_reward": [70220.53585706808, 156325.94242577124, 48417.676033899595, 200067.05950154676, 52400.97276388906, 117985.05599347097, 268983.02528250223, -38445.99535846359, 114630.63212739174, 1261.8153741735728, 1478.0083074654553, -39502.62302548614, 39758.957603728806, 378095.26303986914, -12383.64928717855, 66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2350509064965197, "mean_inference_ms": 0.7659349239517916, "mean_action_processing_ms": 0.11902657103889275, "mean_env_wait_ms": 0.17584124200079745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006805062294006348, "StateBufferConnector_ms": 0.0006682276725769043, "ViewRequirementAgentConnector_ms": 0.01747220754623413}, "num_episodes": 16, "episode_return_max": 1175200.4781933043, "episode_return_min": -129406.6112682434, "episode_return_mean": 211495.6609340262, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.8041050302302, "num_env_steps_trained_throughput_per_sec": 730.8041050302302, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 5577.563, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5577.524, "sample_time_ms": 5032.623, "learn_time_ms": 542.354, "learn_throughput": 7375.263, "synch_weights_time_ms": 1.984}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-46", "timestamp": 1760509786, "time_this_iter_s": 5.477841138839722, "time_total_s": 505.5002465248108, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4cc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 505.5002465248108, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 32.025, "ram_util_percent": 83.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3786654472351074, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.949933063983917, "policy_loss": -0.02379067416623002, "vf_loss": 9.96097314953804, "vf_explained_var": -3.4533441066741944e-07, "kl": 0.012593218548045498, "entropy": 3.93450416252017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 797296.0682975932, "episode_reward_min": -129406.6112682434, "episode_reward_mean": 206257.70569159937, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31882.529218858326, "policy_mean": -31274.784162903612, "policy_mm": -33968.04398350888, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 164962.82049761494, "policy_mean": 207878.9895088051, "policy_mm": 236793.4112635609, "policy_rl": 272098.1618058566}, "policy_reward_mean": {"policy_mom": 48026.26429366357, "policy_mean": 50220.660909127735, "policy_mm": 51172.30617478022, "policy_rl": 56838.474314027844}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 48026.26953125, "('mom_0', 'policy_mom')_total_reward_min": -31882.529296875, "('mom_0', 'policy_mom')_total_reward_max": 164962.828125, "('mean_0', 'policy_mean')_total_reward_mean": 50220.66015625, "('mean_0', 'policy_mean')_total_reward_min": -31274.783203125, "('mean_0', 'policy_mean')_total_reward_max": 207878.984375, "('mm_0', 'policy_mm')_total_reward_mean": 51172.3046875, "('mm_0', 'policy_mm')_total_reward_min": -33968.04296875, "('mm_0', 'policy_mm')_total_reward_max": 236793.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 56838.4765625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 272098.15625}, "hist_stats": {"episode_reward": [321806.60308606067, 675567.5142868201, 126652.69807090664, 89169.0809305611, 264932.73938511073, 199672.1785972943, 106037.73223705294, 285250.5991933412, -9378.588300605905, 84131.3125713522, 280174.3433559661, 274221.4392778006, 275789.20291318063, 291368.1989797463, 180450.38060022113, 657963.6774760461, 200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [91751.76350235418, 114878.81742048633, 35978.28337412736, 24632.670468124958, 62191.145779014965, 54586.49983011815, 18195.488622822137, 60608.015025202774, 1511.4364906882777, 27648.727512060028, 75012.12538059884, 60326.54429081125, 73070.18885503418, 80083.61691298833, 56488.52329688316, 151328.35080799053, 58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088], "policy_policy_mean_reward": [87767.7888161205, 146712.36350714328, 39009.077874279166, 34644.1478479599, 64356.54451034013, 42685.92083288878, 35397.46197514591, 60115.674960048585, -3029.7649287291915, 12867.190354836663, 71531.72691079191, 73486.69149057142, 87820.64923600756, 84277.27461377282, 38342.144215833556, 166018.0556281853, 20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612], "policy_policy_mm_reward": [76032.48491016899, 193824.51357874932, 23867.99860921949, 27198.242028735567, 58647.23531793133, 29753.843379771373, 17483.3994140326, 88266.44512723536, -3959.775793611776, 21531.691459301284, 71020.25515264955, 82954.60099274128, 43967.599889231606, 43812.072618418235, 22664.411280877765, 150804.84162125655, 79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218], "policy_policy_rl_reward": [66254.56585741692, 220151.81978044056, 27797.338213280655, 2694.020585740512, 79737.81377782431, 72645.91455451601, 34961.38222505241, 76260.46408085458, -3900.484068953245, 22083.703245154185, 62610.23591192589, 57453.60250367664, 70930.76493290711, 83195.23483456693, 62955.30180662693, 189812.42941861344, 41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2349220481584399, "mean_inference_ms": 0.7654634496249849, "mean_action_processing_ms": 0.11896224540865565, "mean_env_wait_ms": 0.17571981499863354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000681757926940918, "StateBufferConnector_ms": 0.0006709098815917969, "ViewRequirementAgentConnector_ms": 0.017466425895690918}, "num_episodes": 15, "episode_return_max": 797296.0682975932, "episode_return_min": -129406.6112682434, "episode_return_mean": 206257.70569159937, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.036470427491, "num_env_steps_trained_throughput_per_sec": 709.036470427491, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 5548.517, "restore_workers_time_ms": 0.01, "training_step_time_ms": 5548.482, "sample_time_ms": 5016.372, "learn_time_ms": 529.802, "learn_throughput": 7549.989, "synch_weights_time_ms": 1.753}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-52", "timestamp": 1760509792, "time_this_iter_s": 5.645796060562134, "time_total_s": 511.1460425853729, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed7ba0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 511.1460425853729, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 35.262499999999996, "ram_util_percent": 83.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8678035736083984, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.957733207941056, "policy_loss": -0.01394718017836567, "vf_loss": 9.956957656145097, "vf_explained_var": -5.841255187988282e-07, "kl": 0.014540999507699612, "entropy": 3.533344044536352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -129406.6112682434, "episode_reward_mean": 205412.9250792419, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -31882.529218858326, "policy_mean": -33418.311621749795, "policy_mm": -33968.04398350888, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 176214.3020720639, "policy_mean": 247008.71617337322, "policy_mm": 236793.4112635609, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 47887.9257304116, "policy_mean": 49051.8916145313, "policy_mm": 49645.08274537812, "policy_rl": 58828.024988920835}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 47887.92578125, "('mom_0', 'policy_mom')_total_reward_min": -31882.529296875, "('mom_0', 'policy_mom')_total_reward_max": 176214.296875, "('mean_0', 'policy_mean')_total_reward_mean": 49051.89453125, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 247008.71875, "('mm_0', 'policy_mm')_total_reward_mean": 49645.078125, "('mm_0', 'policy_mm')_total_reward_min": -33968.04296875, "('mm_0', 'policy_mm')_total_reward_max": 236793.40625, "('rl_trader_0', 'policy_rl')_total_reward_mean": 58828.0234375, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [200413.75108298843, 185094.9848375921, 171691.66064768174, 275677.2665976714, 327697.6197195441, 103637.37671881569, 81612.64465711113, 236960.05951610897, 102047.00715843662, -45587.654068348806, 109318.14783217237, 529693.1665517753, 131491.42276672283, 135738.30866684602, 24507.392199763224, 232621.1123915174, 281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [58914.60206156043, 33456.79136029919, 46384.09781777895, 76971.09437754794, 74609.22374843073, 41562.90943828668, 13873.192831980807, 80392.01916455971, 12539.247704108184, -14551.616615429473, 47251.55464919993, 86176.03653299298, 47326.47648351058, 44162.82776201354, 13915.135192586702, 68215.08126457299, 77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636], "policy_policy_mean_reward": [20343.078935659923, 72426.05272617374, 27822.456424066055, 57464.60980294202, 111275.92962804505, 18170.843054200814, 27568.80976240916, 29641.994585732296, 27880.5114907658, -271.7847798735931, 15815.043870562618, 134810.6191355069, 18815.683453944668, 34323.09837052624, 3326.6183174517664, 47879.7180779977, 75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938], "policy_policy_mm_reward": [79681.26954246784, 31321.7781500417, 79047.828269955, 81732.87931708335, 61162.32790890013, 26852.004084764663, 33271.165495174835, 51491.019151120294, 35879.62574110219, -24610.15594018467, 14169.288094219986, 133963.96207217558, 39296.24007774758, 43977.312087255144, 12381.408365502966, 51454.88024554126, 67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334], "policy_policy_rl_reward": [41474.80054330034, 47890.36260107788, 18437.278135881847, 59508.68310009811, 80650.13843416756, 17051.620141563555, 6899.47656754637, 75435.02661469652, 25747.62222246045, -6154.096732861076, 32082.26121818988, 174742.54881109943, 26053.02275151988, 13275.070447051126, -5115.769675778153, 65071.43280340563, 61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23477715586675174, "mean_inference_ms": 0.7649687279874516, "mean_action_processing_ms": 0.11888919992031743, "mean_env_wait_ms": 0.1755822897827489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006771087646484375, "StateBufferConnector_ms": 0.0006682872772216797, "ViewRequirementAgentConnector_ms": 0.017455339431762695}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -129406.6112682434, "episode_return_mean": 205412.9250792419, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.5915838779496, "num_env_steps_trained_throughput_per_sec": 730.5915838779496, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 5538.917, "restore_workers_time_ms": 0.01, "training_step_time_ms": 5538.883, "sample_time_ms": 5007.516, "learn_time_ms": 529.091, "learn_throughput": 7560.135, "synch_weights_time_ms": 1.715}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "26ec2_00000", "date": "2025-10-15_01-29-58", "timestamp": 1760509798, "time_this_iter_s": 5.4791259765625, "time_total_s": 516.6251685619354, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6fc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 516.6251685619354, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 82.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.867032289505005, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.958617863059043, "policy_loss": -0.018041979780537076, "vf_loss": 9.96117277443409, "vf_explained_var": -1.6165897250175476e-06, "kl": 0.015295895972576967, "entropy": 3.754025074094534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -132598.2573114395, "episode_reward_mean": 223530.24332335347, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33723.82060897293, "policy_mean": -33418.311621749795, "policy_mm": -40066.01721546855, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 207640.08173687983, "policy_mean": 283165.3856187032, "policy_mm": 243527.09581328282, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 50632.15094155957, "policy_mean": 53565.31055271969, "policy_mm": 53067.27168819429, "policy_rl": 66265.51014087988}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50632.16015625, "('mom_0', 'policy_mom')_total_reward_min": -33723.8203125, "('mom_0', 'policy_mom')_total_reward_max": 207640.078125, "('mean_0', 'policy_mean')_total_reward_mean": 53565.3046875, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 53067.2734375, "('mm_0', 'policy_mm')_total_reward_min": -40066.015625, "('mm_0', 'policy_mm')_total_reward_max": 243527.09375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 66265.5078125, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [281215.60464278795, 646753.0629663229, -68249.02348306384, 297323.2615233912, 134500.61959869997, -16735.20654530958, -17670.726549286246, 216376.94073300087, -129406.6112682434, 334250.0897039353, 122317.90796327528, 75556.50890992922, -43188.31351341817, 347231.99285793514, 559523.3856355506, -25317.28663396519, 546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [77706.27284644952, 122999.79904073701, -27295.466568468983, 100759.26272569536, 32081.82726521591, 787.0177157287959, 4193.834263079071, 33819.67802472336, -31882.529218858326, 80739.19326109746, 48768.45781450008, 12294.609770635741, -9560.053975762105, 93078.83325237049, 116554.6228917172, 4106.380949112664, 105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037], "policy_policy_mean_reward": [75029.99526836233, 175289.9777147109, -13939.837634322808, 69088.25912449995, 17462.776356786948, -6144.40615160078, -12396.345853123286, 53935.51175415042, -30091.779885173983, 68652.37530144266, 44451.268938544774, 43363.77074351638, -16099.458412642183, 58009.19481914627, 129834.31213739094, -6767.713139102279, 114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381], "policy_policy_mm_reward": [67076.66159361263, 194628.25079848868, -14357.227759828349, 52158.13604120107, 59716.16862896636, -13800.38035220748, 2950.0862369355264, 53023.84515571193, -33968.04398350888, 111791.67109888245, 12958.047707193182, 17532.092927386995, -11728.62352676417, 77388.55289520475, 110728.15276184004, -22614.00624987517, 86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297], "policy_policy_rl_reward": [61402.674934362985, 153835.03541238606, -12656.491520443844, 75317.6036319947, 25239.847347730705, 2422.5622427699154, -12418.301196177485, 75597.90579841519, -33464.25818070226, 73066.85004251273, 16140.133503037203, 2366.035468390227, -5800.177598249732, 118755.41189121323, 202406.29784460162, -41.94819410032709, 239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23463117445960993, "mean_inference_ms": 0.7644753092175628, "mean_action_processing_ms": 0.1188160780750367, "mean_env_wait_ms": 0.17544489487931914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006712675094604492, "StateBufferConnector_ms": 0.0006678104400634766, "ViewRequirementAgentConnector_ms": 0.01741403341293335}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -132598.2573114395, "episode_return_mean": 223530.24332335347, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.5425870842728, "num_env_steps_trained_throughput_per_sec": 736.5425870842728, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 5526.393, "restore_workers_time_ms": 0.01, "training_step_time_ms": 5526.36, "sample_time_ms": 4996.811, "learn_time_ms": 527.364, "learn_throughput": 7584.892, "synch_weights_time_ms": 1.642}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-03", "timestamp": 1760509803, "time_this_iter_s": 5.434640884399414, "time_total_s": 522.0598094463348, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156db7560>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 522.0598094463348, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.987499999999997, "ram_util_percent": 83.48750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.425905227661133, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.950661075115203, "policy_loss": -0.0221884849073831, "vf_loss": 9.961061358451843, "vf_explained_var": -1.0844320058822633e-06, "kl": 0.011642635194676103, "entropy": 3.7343800731003283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -132598.2573114395, "episode_reward_mean": 231870.2830265886, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33723.82060897293, "policy_mean": -33418.311621749795, "policy_mm": -40066.01721546855, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 207640.08173687983, "policy_mean": 283165.3856187032, "policy_mm": 248041.43874557357, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 52402.07721203733, "policy_mean": 54532.90322688939, "policy_mm": 55234.76137127773, "policy_rl": 69700.5412163842}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52402.07421875, "('mom_0', 'policy_mom')_total_reward_min": -33723.8203125, "('mom_0', 'policy_mom')_total_reward_max": 207640.078125, "('mean_0', 'policy_mean')_total_reward_mean": 54532.89453125, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 55234.765625, "('mm_0', 'policy_mm')_total_reward_min": -40066.015625, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 69700.5390625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [546106.4906434392, 630761.3088356346, 263295.001295933, 10179.218307548512, 96288.39609780308, 265609.398955784, -22481.619650695917, -70729.4615770799, 258999.2910163647, 734988.1022052807, 203750.7779518391, 733684.4360134234, 227995.70659164432, -21074.263443192714, 292419.60766797385, 106907.50291394629, -106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [105810.6779629148, 114230.03786646112, 51069.8052914961, 1138.0732789362353, 32779.751020333584, 34334.40114710715, -19734.22710752221, -23076.254685100233, 65743.61480553802, 164962.82049761494, 56198.72491412401, 156488.36809679976, 46782.30551367029, -16493.599294431482, 73666.27478648926, 11793.422415084087, -21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318], "policy_policy_mean_reward": [114620.61978137969, 179822.80182754036, 81086.33922189764, 4419.011807703258, 28683.313859532664, 54815.52795573353, -16677.727385665115, -11472.065877652272, 57150.50249114626, 178856.48882666513, 61506.99450292034, 122625.7619484755, 53295.94899094281, 7138.119436846433, 89650.14420769263, 13209.941376822695, -22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174], "policy_policy_mm_reward": [86497.93997475557, 145609.92373354628, 51476.21798947722, 10593.847402833391, 488.2560039745746, 79578.90369652628, 26862.246402675413, -10805.372486166114, 78804.4638862416, 148952.26728552912, 47397.47304257825, 204293.52861697826, 59890.59071921682, -10366.935719567142, 70782.5567164159, 47524.92330200426, -20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288], "policy_policy_rl_reward": [239177.25292438926, 191098.54540808755, 79662.63879306243, -5971.7141819243125, 34337.07521396235, 96880.56615641702, -12931.911560183991, -25375.768528161483, 57300.70983343879, 242216.52559547202, 38647.58549221673, 250276.77735117017, 68026.86136781442, -1351.8478660405885, 58320.63195737592, 34379.21582003543, -40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2344916878016517, "mean_inference_ms": 0.7640057135811421, "mean_action_processing_ms": 0.11874595512582702, "mean_env_wait_ms": 0.17531404970535305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006728768348693848, "StateBufferConnector_ms": 0.0006723999977111816, "ViewRequirementAgentConnector_ms": 0.017430603504180908}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -132598.2573114395, "episode_return_mean": 231870.2830265886, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 723.0450367176479, "num_env_steps_trained_throughput_per_sec": 723.0450367176479, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 5531.607, "restore_workers_time_ms": 0.01, "training_step_time_ms": 5531.572, "sample_time_ms": 5000.945, "learn_time_ms": 528.191, "learn_throughput": 7573.024, "synch_weights_time_ms": 1.897}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-09", "timestamp": 1760509809, "time_this_iter_s": 5.537487745285034, "time_total_s": 527.5972971916199, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fce0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 527.5972971916199, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.8375, "ram_util_percent": 83.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9526493549346924, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.959803074598312, "policy_loss": -0.016291818491299636, "vf_loss": 9.96101005077362, "vf_explained_var": -6.236135959625244e-07, "kl": 0.014898657301569761, "entropy": 3.7442013800144194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -132598.2573114395, "episode_reward_mean": 230325.55285505074, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33723.82060897293, "policy_mean": -33418.311621749795, "policy_mm": -40066.01721546855, "policy_rl": -40599.02424540118}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 283165.3856187032, "policy_mm": 248041.43874557357, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 53767.4256996588, "policy_mean": 54183.65599319085, "policy_mm": 53555.8069187067, "policy_rl": 68818.66424349438}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 53767.4296875, "('mom_0', 'policy_mom')_total_reward_min": -33723.8203125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 54183.65625, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 53555.8046875, "('mm_0', 'policy_mm')_total_reward_min": -40066.015625, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68818.6640625, "('rl_trader_0', 'policy_rl')_total_reward_min": -40599.0234375, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [-106034.81851805701, 109056.92317757281, 797296.0682975932, -6439.947249430635, -111542.14524831146, 292166.9451321862, 73402.18695211661, 241757.96870400722, 264109.37663769425, 60211.910042378455, -19583.51829798566, 297682.11099482985, 295964.2301889874, 18676.63491643582, 159748.08080460652, 101915.92138883143, 41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-21964.796302010476, 31297.270776161724, 128187.65389853754, 1460.5067174250578, -24762.30704272828, 76034.59204854007, 5609.23323689537, 44499.061047332696, 64728.129576627085, 50598.85029161663, -7787.770507918409, 47098.28715433294, 70721.892592256, 22649.329435140247, 19472.45167275064, 21088.338091967897, 2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282], "policy_policy_mean_reward": [-22814.25290514142, 36764.733597207785, 207878.9895088051, 9042.820037963887, -28382.341702943635, 97081.74304643083, 12874.366842182902, 61254.92838315686, 51878.664334141955, -6668.153045280563, -10278.109094042113, 75071.41580871509, 74079.86189265753, -18142.465613608983, 42170.09600408739, 26602.33105938542, 25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141], "policy_policy_mm_reward": [-20656.745065504078, 18063.089803617906, 236793.4112635609, -4386.919785420972, -27706.80219318676, 58414.9917447686, 34296.752748030165, 66916.5432804338, 75469.82399311324, 9671.55772640968, -619.5930149982532, 87412.5422369646, 85184.05723243354, 2142.8567690183186, 61004.53202608408, 26666.722168032757, 9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631], "policy_policy_rl_reward": [-40599.02424540118, 22931.82900058528, 224436.01362669084, -12556.354219398616, -30690.694309452938, 60635.61829244699, 20621.834125008147, 69087.43599308372, 72032.75873381236, 6609.655069632616, -898.0456810268894, 88099.86579481763, 65978.41847164021, 12026.914325886264, 37101.00110168443, 27558.530069445376, 4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23440027589100143, "mean_inference_ms": 0.7636144778745299, "mean_action_processing_ms": 0.11869121640058988, "mean_env_wait_ms": 0.17521369888402724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006805062294006348, "StateBufferConnector_ms": 0.0006769299507141113, "ViewRequirementAgentConnector_ms": 0.0175057053565979}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -132598.2573114395, "episode_return_mean": 230325.55285505074, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 670.3777714111956, "num_env_steps_trained_throughput_per_sec": 670.3777714111956, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 5563.481, "restore_workers_time_ms": 0.129, "training_step_time_ms": 5563.296, "sample_time_ms": 5032.452, "learn_time_ms": 528.062, "learn_throughput": 7574.871, "synch_weights_time_ms": 2.243}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-15", "timestamp": 1760509815, "time_this_iter_s": 5.972385883331299, "time_total_s": 533.5696830749512, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6fc0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 533.5696830749512, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 37.35555555555556, "ram_util_percent": 84.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5015151500701904, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.948491051793098, "policy_loss": -0.02109733312681783, "vf_loss": 9.95756580233574, "vf_explained_var": -3.986060619354248e-07, "kl": 0.011874116205581745, "entropy": 3.697520138323307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -132598.2573114395, "episode_reward_mean": 238538.13839910307, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33723.82060897293, "policy_mean": -33418.311621749795, "policy_mm": -40066.01721546855, "policy_rl": -30444.540561708152}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 283165.3856187032, "policy_mm": 248041.43874557357, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 55403.161684320476, "policy_mean": 55993.579631539505, "policy_mm": 54141.972786319886, "policy_rl": 72999.42429692319}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55403.16015625, "('mom_0', 'policy_mom')_total_reward_min": -33723.8203125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 55993.57421875, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 54141.96875, "('mm_0', 'policy_mm')_total_reward_min": -40066.015625, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72999.421875, "('rl_trader_0', 'policy_rl')_total_reward_min": -30444.541015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [41386.871557188235, 199864.6534701016, -31741.379104986932, 301899.2595170111, 76830.08406675946, 283251.1736157175, 197589.30638569756, 116065.38515741623, 334457.1672764851, 136032.895170267, 56347.36286921581, 403724.50962622906, 222407.96146239818, 14924.865888614397, 231626.08627671786, 606368.5115338865, 719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [2694.1291570882786, 23354.527026957872, -4884.960831686166, 107099.56607905516, 16552.693153638458, 75163.90082139598, 52538.11732496211, 30919.695143742836, 114907.95455267471, 44070.198807064684, 3186.097812511669, 109270.00231093532, 38129.909566505004, -8406.41873821146, 39010.07405198985, 154367.34578518543, 153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508], "policy_policy_mean_reward": [25259.225190554767, 53144.85727300005, -4820.731569772506, 66317.17369915674, 14764.584558082222, 78636.8682630994, 47129.58344513526, 32475.484779443126, 77810.60124529328, 24225.48689274763, 7594.5299749729675, 109267.40144383855, 52467.47651962907, 6586.150179531583, 69641.51685851354, 127707.35844716098, 163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571], "policy_policy_mm_reward": [9168.85636006629, 76008.74191601793, -6138.200795762825, 68525.45736009956, 27462.38755571439, 62599.79530884247, 55235.815083451766, 33470.92109428177, 67440.22932731165, 32327.42928427172, 38377.589386466774, 67681.12136774838, 61156.71515245653, 8319.323130344901, 39736.24359657433, 138507.00771473255, 131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296], "policy_policy_rl_reward": [4264.660849478845, 47356.527254125875, -15897.485907765536, 59957.06237869921, 18050.418799324438, 66850.60922237938, 42685.79053214847, 19199.2841399484, 74298.38215120522, 35409.78018618278, 7189.145695264408, 117505.98450370626, 70653.86022380758, 8425.811316949334, 83238.25176964022, 185786.7995868077, 272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2343075313893506, "mean_inference_ms": 0.7632539518151493, "mean_action_processing_ms": 0.11863576242243974, "mean_env_wait_ms": 0.17511301000567175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006859302520751953, "StateBufferConnector_ms": 0.0006796121597290039, "ViewRequirementAgentConnector_ms": 0.017471253871917725}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -132598.2573114395, "episode_return_mean": 238538.13839910307, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 721.9844112417081, "num_env_steps_trained_throughput_per_sec": 721.9844112417081, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 5565.461, "restore_workers_time_ms": 0.13, "training_step_time_ms": 5565.275, "sample_time_ms": 5035.25, "learn_time_ms": 527.222, "learn_throughput": 7586.931, "synch_weights_time_ms": 2.257}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-20", "timestamp": 1760509820, "time_this_iter_s": 5.544429063796997, "time_total_s": 539.1141121387482, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156fa8540>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 539.1141121387482, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 42.71428571428571, "ram_util_percent": 83.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5067076683044434, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.949706599116325, "policy_loss": -0.023105942993424833, "vf_loss": 9.959809079766273, "vf_explained_var": 4.779919981956482e-06, "kl": 0.012842907307640945, "entropy": 3.87783822119236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 999107.0031290754, "episode_reward_min": -132598.2573114395, "episode_reward_mean": 245153.24790672745, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -33723.82060897293, "policy_mean": -33418.311621749795, "policy_mm": -40066.01721546855, "policy_rl": -30444.540561708152}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 283165.3856187032, "policy_mm": 248041.43874557357, "policy_rl": 441056.6180162842}, "policy_reward_mean": {"policy_mom": 55965.03824209767, "policy_mean": 58118.29610893233, "policy_mm": 54135.2218462579, "policy_rl": 76934.6917094396}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55965.03515625, "('mom_0', 'policy_mom')_total_reward_min": -33723.8203125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 58118.30078125, "('mean_0', 'policy_mean')_total_reward_min": -33418.3125, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 54135.23046875, "('mm_0', 'policy_mm')_total_reward_min": -40066.015625, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 76934.6875, "('rl_trader_0', 'policy_rl')_total_reward_min": -30444.541015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 441056.625}, "hist_stats": {"episode_reward": [719800.2355633641, 243199.1314231974, 211256.73771616514, -85513.65853940256, 80145.61335340068, 323033.08253166423, 250309.91635183524, -24073.73438529114, -19493.30631556736, 152805.67072616998, 999107.0031290754, 58085.47578408572, -55266.331424576296, 737631.0345766068, 203865.73591810753, 238553.68682758237, 505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [153253.7981939637, 63062.770549608584, 43676.35105209628, -18606.853050842088, 34381.504886780196, 72467.72630514164, 88338.85327531956, 1492.4331756321933, -3368.1925347555966, 63589.31731262449, 176214.3020720639, 31457.941104916434, -13996.527984715116, 140522.1533002398, 42303.53669910931, 74068.40114893384, 114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598], "policy_policy_mean_reward": [163394.91023949147, 65822.94826095735, 69794.96646524806, -31274.784162903612, 11846.968524586793, 102601.63123877524, 55305.35715718195, -8515.650460040579, -3626.5324827173777, 40615.93184684721, 247008.71617337322, 408.00180451268324, -33418.311621749795, 141198.80186614726, 65007.681127729295, 39853.232118344735, 96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122], "policy_policy_mm_reward": [131053.36532405202, 63146.91585668773, 52994.94978095456, -18517.77404948218, 14010.157041207018, 76658.37543119887, 46982.86262628821, -8686.301256114963, -3978.0278144591157, 6680.239718600252, 134827.36686735455, 7037.9254582235635, -4687.2561274998025, 184754.36117145093, 36837.67399762008, 78476.42703894348, 88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756], "policy_policy_rl_reward": [272098.1618058566, 51166.49675594368, 44790.47041786627, -17114.247276174618, 19906.982900826642, 71305.34955654855, 59682.8432930458, -8364.215844767756, -8520.553483635305, 41920.18184809812, 441056.6180162842, 19181.607416433028, -3164.235690611575, 271155.71823876945, 59716.844093648906, 46155.62652136047, 206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23421608267278515, "mean_inference_ms": 0.7628982229387495, "mean_action_processing_ms": 0.11858071453192423, "mean_env_wait_ms": 0.17501387431499285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0006883144378662109, "StateBufferConnector_ms": 0.0006800293922424316, "ViewRequirementAgentConnector_ms": 0.01746189594268799}, "num_episodes": 16, "episode_return_max": 999107.0031290754, "episode_return_min": -132598.2573114395, "episode_return_mean": 245153.24790672745, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.7866823730241, "num_env_steps_trained_throughput_per_sec": 725.7866823730241, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 5569.202, "restore_workers_time_ms": 0.13, "training_step_time_ms": 5569.004, "sample_time_ms": 5034.172, "learn_time_ms": 531.038, "learn_throughput": 7532.417, "synch_weights_time_ms": 3.227}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-26", "timestamp": 1760509826, "time_this_iter_s": 5.521154165267944, "time_total_s": 544.6352663040161, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed7ba0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 544.6352663040161, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.4375, "ram_util_percent": 83.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6108925342559814, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.950565764307976, "policy_loss": -0.021191040638950654, "vf_loss": 9.95809484422207, "vf_explained_var": 4.333071410655976e-06, "kl": 0.013493293216834523, "entropy": 3.7684596233069896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 924176.2990836438, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 237394.7754895116, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -30444.540561708152}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 283165.3856187032, "policy_mm": 248041.43874557357, "policy_rl": 302545.07078738103}, "policy_reward_mean": {"policy_mom": 55595.5023805904, "policy_mean": 56197.21175138059, "policy_mm": 53392.580977401194, "policy_rl": 72209.48038013936}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 55595.51171875, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 56197.21484375, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 283165.375, "('mm_0', 'policy_mm')_total_reward_mean": 53392.578125, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 72209.4765625, "('rl_trader_0', 'policy_rl')_total_reward_min": -30444.541015625, "('rl_trader_0', 'policy_rl')_total_reward_max": 302545.0625}, "hist_stats": {"episode_reward": [505448.09596580936, 295149.20537816995, 258614.6661144678, 15415.236893560068, 876398.8639243757, -132598.2573114395, 196970.7346260729, 122344.05059170492, 160646.58267944926, 315512.0837941228, 826814.9044486693, -53921.052895198, 201010.3792302281, 924176.2990836438, 653611.8478361226, -40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [114074.11452419937, 67016.31441995213, 75022.10535273865, 10874.358185927636, 207640.08173687983, -33723.82060897293, 47858.992010107555, 27971.15151956273, 55711.26858929685, 66187.89593293043, 189573.09169772585, -7784.020948778205, 30957.151015692158, 173599.73880422508, 148098.14536752744, -2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894], "policy_policy_mean_reward": [96916.26424623135, 86829.95301561848, 67967.45395681092, 15126.519873901938, 180937.66870388997, -28363.878925289882, 48080.75727064646, 43076.06535169272, 30187.100547790975, 58308.30707546986, 169216.29042611807, -16704.09422926701, 90539.87303915716, 283165.3856187032, 138870.665342816, -27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586], "policy_policy_mm_reward": [88427.21355699553, 83135.57280914638, 57585.92154345809, -2914.995415916334, 243527.09581328282, -40066.01721546855, 35639.20449927846, 26496.13493057722, 38141.83577331684, 105059.93154419119, 165480.45153744452, -4755.235557553009, 52064.82839557104, 203098.43458976113, 104649.794663665, 858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577], "policy_policy_rl_reward": [206030.50363838312, 58167.365133453226, 58039.18526146025, -7670.645750353209, 244294.01767032244, -30444.540561708152, 65391.78084604015, 24800.698789872466, 36606.37776904473, 85955.9492415315, 302545.07078738103, -24677.70215959988, 27448.52677980762, 264312.7400709539, 261993.24246211446, -10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2341417952776493, "mean_inference_ms": 0.7625737302888396, "mean_action_processing_ms": 0.11853556747241907, "mean_env_wait_ms": 0.17493254796888366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007001161575317383, "StateBufferConnector_ms": 0.0006841421127319336, "ViewRequirementAgentConnector_ms": 0.017559170722961426}, "num_episodes": 16, "episode_return_max": 924176.2990836438, "episode_return_min": -142739.21109275866, "episode_return_mean": 237394.7754895116, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.6956298073144, "num_env_steps_trained_throughput_per_sec": 711.6956298073144, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 5582.915, "restore_workers_time_ms": 0.133, "training_step_time_ms": 5582.714, "sample_time_ms": 5049.802, "learn_time_ms": 529.192, "learn_throughput": 7558.69, "synch_weights_time_ms": 3.149}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-31", "timestamp": 1760509831, "time_this_iter_s": 5.6251630783081055, "time_total_s": 550.2604293823242, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed4720>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 550.2604293823242, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 40.712500000000006, "ram_util_percent": 83.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4631991386413574, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.951117396354675, "policy_loss": -0.02085679862939287, "vf_loss": 9.96071715950966, "vf_explained_var": 2.4551525712013243e-06, "kl": 0.011118049864126556, "entropy": 3.6408705174922944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 844367.0072035881, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 218883.20306891284, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -29828.162928719947}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 207826.4969342251, "policy_mm": 248041.43874557357, "policy_rl": 296340.00655691954}, "policy_reward_mean": {"policy_mom": 51038.54907383367, "policy_mean": 51378.42847145202, "policy_mm": 50145.69228724503, "policy_rl": 66320.53323638215}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51038.546875, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 51378.4296875, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 207826.5, "('mm_0', 'policy_mm')_total_reward_mean": 50145.6953125, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 248041.4375, "('rl_trader_0', 'policy_rl')_total_reward_mean": 66320.53125, "('rl_trader_0', 'policy_rl')_total_reward_min": -29828.162109375, "('rl_trader_0', 'policy_rl')_total_reward_max": 296340.0}, "hist_stats": {"episode_reward": [-40216.54270425356, 21326.14514401421, 4450.022997330529, 281299.02326195914, 256521.00698075278, 121794.81338382434, 269977.7973575364, 190575.9900757154, -73387.15258917723, 844367.0072035881, 604264.727870221, 195685.19202964666, -34222.352226680756, 49408.48661839755, 10204.423782796286, 175700.26836210024, -37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-2801.907650436591, -14271.699755724501, -2677.4613522460363, 57664.83144038662, 61617.75709062037, 27124.597846176006, 76108.44794259584, 51541.49545016294, -14361.727131009911, 163812.08913649825, 148876.2865158336, 39760.00530573015, -6628.578461087509, 7469.840632460254, -2118.7035959827713, 54631.685082942495, -9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151], "policy_policy_mean_reward": [-27830.2792899696, 7887.648255038414, -2917.5192667938, 63419.166213234326, 60762.02054171381, 31341.656161818028, 70001.15434062785, 31713.567825079932, -11953.608142432726, 136173.47276459675, 96136.22599175654, 30024.965141125398, 5526.894063869181, 12517.288447866436, 12382.644931960598, 51653.25945750861, -7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724], "policy_policy_mm_reward": [858.7074323506306, 18366.846776875576, -4891.429468346189, 80259.92975604492, 69361.21347349297, 31000.931462481327, 67840.26977630559, 29197.0274057902, -17243.65438701453, 248041.43874557357, 159062.1194001973, 62862.799538000494, -12951.799218759314, 23400.06284981926, 1166.56954102874, 33802.16452713121, -14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487], "policy_policy_rl_reward": [-10443.063196197983, 9343.349867824665, 14936.433084716511, 79955.09585229374, 64780.01587492579, 32327.627913348966, 56027.925298006514, 78123.89939468208, -29828.162928719947, 296340.00655691954, 200190.0959624343, 63037.42204479064, -20168.868610703114, 6021.294688251694, -1226.0870942103177, 35613.15929451796, -5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23409070155762257, "mean_inference_ms": 0.7623216442785045, "mean_action_processing_ms": 0.11850243285572892, "mean_env_wait_ms": 0.17487372746426877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007050037384033203, "StateBufferConnector_ms": 0.0006896257400512695, "ViewRequirementAgentConnector_ms": 0.01764768362045288}, "num_episodes": 15, "episode_return_max": 844367.0072035881, "episode_return_min": -142739.21109275866, "episode_return_mean": 218883.20306891284, "episodes_this_iter": 15}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.0925896535828, "num_env_steps_trained_throughput_per_sec": 689.0925896535828, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 5599.669, "restore_workers_time_ms": 0.132, "training_step_time_ms": 5599.467, "sample_time_ms": 5059.18, "learn_time_ms": 536.215, "learn_throughput": 7459.69, "synch_weights_time_ms": 3.443}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-37", "timestamp": 1760509837, "time_this_iter_s": 5.809872150421143, "time_total_s": 556.0703015327454, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5b20>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.0703015327454, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.8, "ram_util_percent": 84.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.428037166595459, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.949722355604171, "policy_loss": -0.0207733938616002, "vf_loss": 9.959676349163056, "vf_explained_var": 1.0177493095397949e-06, "kl": 0.010685846312481342, "entropy": 3.831042432785034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 799616.1323124861, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 222859.75105850887, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -28197.426098391177}, "policy_reward_max": {"policy_mom": 221568.66938969152, "policy_mean": 207826.4969342251, "policy_mm": 203178.86844747188, "policy_rl": 265447.1922979359}, "policy_reward_mean": {"policy_mom": 52527.71601954052, "policy_mean": 53350.58943506474, "policy_mm": 48978.58943498943, "policy_rl": 68002.85616891421}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52527.71875, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 221568.671875, "('mean_0', 'policy_mean')_total_reward_mean": 53350.58984375, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 207826.5, "('mm_0', 'policy_mm')_total_reward_mean": 48978.5859375, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 203178.875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 68002.8515625, "('rl_trader_0', 'policy_rl')_total_reward_min": -28197.42578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 265447.1875}, "hist_stats": {"episode_reward": [-37379.67938608881, 234318.71677901378, 223839.41952558886, 340342.4403861234, 432996.07769245567, -48533.087949827124, -53969.01486697654, 63212.09533722321, -59501.719099436894, -44401.377911160125, 459510.42556061875, 146968.79939781717, 799616.1323124861, 90051.28578919219, 57509.32602231583, 104086.58556206827, 709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071, 138718.86875413617, 134206.0101590339, 440097.89913764683, -116738.03058968346, 7913.495349624985, 60021.943507310774, -83715.32867775547, 210265.20838690668, 627532.819770455, 595987.168884708, 310972.3829960293, 337762.3748307411, 140479.2552994365, 380559.0866407838, 102479.29595111735, -11138.793893118134], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [-9029.610587141695, 78209.43530801154, 30829.93382028982, 73541.66163799816, 116377.50820227318, -19615.818825277256, 2462.6861030797577, 3268.491416678217, -13994.532784986035, -20418.257575775166, 101191.85815372472, 29278.953211521533, 221568.66938969152, 32793.600375888615, 15704.310808122616, 24687.381220458577, 163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151, 34645.822395928284, 5357.196118339212, 83980.45709613069, -27432.252086181004, 12354.460001744063, -656.3739704087451, -34237.904326751624, 76027.02057356162, 146933.33523079043, 151059.32450368322, 99929.17258176113, 90878.70073188892, 18325.76349853619, 115630.84957890087, 35842.38503311473, -13974.30389343365], "policy_policy_mean_reward": [-7741.015295435288, 42163.704371527965, 68131.25044140595, 95523.68966094866, 82842.01833733174, -12261.870447077908, -8631.200258617233, 30065.38662115398, -3804.4523891632434, -17075.344880028515, 121409.44638762224, 34017.15968066538, 176653.07738935575, 32713.20585533596, 45318.9766375011, 27502.24602244743, 121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724, 30521.382284987154, 32446.513032972653, 114869.20318769464, -31900.614470625427, -12252.710853674933, 19668.210277179773, -22746.056970881164, 39718.38711744769, 147251.3469808568, 120833.64121429808, 63038.631058579515, 95315.99476057867, 43563.851674828074, 87366.90711329579, 31461.645743654484, 4898.321647081143], "policy_policy_mm_reward": [-14923.17117514007, 51157.48892860076, 60529.6358698828, 62146.4474630571, 95144.0215546288, -1561.1699586645086, -30582.231180915638, 20838.524439364315, -21773.699979436562, -3887.780168762795, 131086.90876005302, 44898.80882571538, 170851.71681037513, -4178.79985752166, 6618.31881463169, 23644.29117231643, 192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487, 32562.835784634608, 28844.50131376346, 110192.72374869391, -29639.29969348798, -5399.309185089587, 24050.111715982395, -8143.201700658648, 51402.224504390404, 102544.21693090083, 113351.07059225565, 60206.88147171824, 55635.52480378732, 33260.315271161286, 83408.23624885417, 12204.050575353425, 8942.030003151542], "policy_policy_rl_reward": [-5685.882328371879, 62788.08817087369, 64348.599394010635, 109130.6416241198, 138632.5295982225, -15094.22871880741, -17218.269530523416, 9039.692860026702, -19929.033945851104, -3019.995286593716, 105822.21225921906, 38773.87767991484, 230542.6687230632, 28723.27941548929, -10132.280237939554, 28252.667146845848, 232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346, 40988.82828858619, 67557.79969395866, 131055.5151051277, -27765.86433938899, 13211.05538664542, 16959.99548455738, -18588.165679464048, 43117.57619150705, 230803.9206279065, 210743.13257447214, 87797.69788397041, 95932.15453448649, 45329.32485491096, 94153.09369973328, 22971.214598994786, -11004.84164991712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23404270282584677, "mean_inference_ms": 0.7621113630383073, "mean_action_processing_ms": 0.11847029325413368, "mean_env_wait_ms": 0.1748161043441951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007146000862121582, "StateBufferConnector_ms": 0.0006962418556213379, "ViewRequirementAgentConnector_ms": 0.01779472827911377}, "num_episodes": 16, "episode_return_max": 799616.1323124861, "episode_return_min": -142739.21109275866, "episode_return_mean": 222859.75105850887, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.6963273113062, "num_env_steps_trained_throughput_per_sec": 707.6963273113062, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 5617.549, "restore_workers_time_ms": 0.177, "training_step_time_ms": 5617.294, "sample_time_ms": 5077.891, "learn_time_ms": 535.324, "learn_throughput": 7472.105, "synch_weights_time_ms": 3.444}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-43", "timestamp": 1760509843, "time_this_iter_s": 5.6565210819244385, "time_total_s": 561.7268226146698, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed6ac0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 561.7268226146698, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 32.0625, "ram_util_percent": 83.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205785036087036, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.947244709730148, "policy_loss": -0.02412983607646311, "vf_loss": 9.961047449707985, "vf_explained_var": 2.1824613213539124e-06, "kl": 0.010199612741167149, "entropy": 3.8060800090432165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 782196.1019899033, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 222109.04195815587, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -28197.426098391177}, "policy_reward_max": {"policy_mom": 165531.2001971822, "policy_mean": 207826.4969342251, "policy_mm": 203178.86844747188, "policy_rl": 265447.1922979359}, "policy_reward_mean": {"policy_mom": 51966.26346256058, "policy_mean": 52649.44192012073, "policy_mm": 50167.605880512594, "policy_rl": 67325.73069496195}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 51966.26953125, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 165531.203125, "('mean_0', 'policy_mean')_total_reward_mean": 52649.4453125, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 207826.5, "('mm_0', 'policy_mm')_total_reward_mean": 50167.6015625, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 203178.875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 67325.7265625, "('rl_trader_0', 'policy_rl')_total_reward_min": -28197.42578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 265447.1875}, "hist_stats": {"episode_reward": [709720.1675504884, 603693.5982671006, 697526.3670233205, 572692.7218968478, 4044.5717797799753, 215966.15235116662, 215276.42230074684, 532870.2045779466, -8027.909344665549, 542475.3437422351, 101652.54856516104, 15146.081430643302, 339063.02235212486, 191617.72622920168, 144817.15172220703, 273909.620825501, 361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071, 138718.86875413617, 134206.0101590339, 440097.89913764683, -116738.03058968346, 7913.495349624985, 60021.943507310774, -83715.32867775547, 210265.20838690668, 627532.819770455, 595987.168884708, 310972.3829960293, 337762.3748307411, 140479.2552994365, 380559.0866407838, 102479.29595111735, -11138.793893118134, 137430.52441565448, 202657.29086505485, 29116.974540739433, 126715.93011732127, -24543.64313974219, 34009.433839225894, -4819.106816800197, 268124.6194860928, 300248.7912369859, 258245.90540382202, 288279.6556713559, 334288.4263091061, -70006.18460330459, -2284.589588639931, 443307.4363563686, 312824.05102287134], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [163296.49421434454, 144944.63983506264, 142710.85775428198, 163278.79790877548, 1070.9140660711282, 21145.990995601343, 76350.15674178705, 99450.56132997091, 2871.020042162941, 45226.15996054404, 36097.832185799125, 22261.692121963093, 94159.11550682844, 48916.850095942864, 47355.625666874905, 42602.647180288084, 78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151, 34645.822395928284, 5357.196118339212, 83980.45709613069, -27432.252086181004, 12354.460001744063, -656.3739704087451, -34237.904326751624, 76027.02057356162, 146933.33523079043, 151059.32450368322, 99929.17258176113, 90878.70073188892, 18325.76349853619, 115630.84957890087, 35842.38503311473, -13974.30389343365, 14100.635311863018, 47989.75922051853, -4422.228513744541, 17878.436311912785, -13003.550544438604, 630.0051142696843, 2832.993644289569, 54814.22709420868, 88155.04541090928, 54179.76111374183, 95509.91822411424, 93711.27391397528, -19576.58936219708, 326.1786391154664, 119567.39456466782, 58017.75403335787], "policy_policy_mean_reward": [121260.33321096729, 147532.70352958248, 157585.32808554574, 120082.51799372338, 11439.486163114141, 39933.656754437536, 63444.90259269272, 97250.92346310761, -3394.6491690848566, 134797.20294636636, 20383.381849465688, 7581.172603902714, 74349.12786305415, 39668.60658935162, 34377.01615891668, 86435.03078145563, 108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724, 30521.382284987154, 32446.513032972653, 114869.20318769464, -31900.614470625427, -12252.710853674933, 19668.210277179773, -22746.056970881164, 39718.38711744769, 147251.3469808568, 120833.64121429808, 63038.631058579515, 95315.99476057867, 43563.851674828074, 87366.90711329579, 31461.645743654484, 4898.321647081143, 31125.43784438069, 55444.678148432744, 10602.886361688737, 38766.550730970346, 10458.80476346733, -4081.2558850151854, -10797.873435004249, 70109.0167715258, 60903.09258334674, 79451.66744183039, 41676.76316518738, 68334.53813208164, -23260.212308432237, 3081.040377344865, 119120.48986232857, 85775.9020864386], "policy_policy_mm_reward": [192640.8487149123, 123933.82430938148, 131782.9888855571, 95785.73172146577, -10412.895998553631, 94127.70836957806, 37112.92828527208, 145089.5301066023, -16559.36112815132, 148633.530685639, 18366.01458643071, -8390.422175708405, 53445.15115322242, 37305.21355684072, 36264.43010106587, 72269.15601131407, 53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487, 32562.835784634608, 28844.50131376346, 110192.72374869391, -29639.29969348798, -5399.309185089587, 24050.111715982395, -8143.201700658648, 51402.224504390404, 102544.21693090083, 113351.07059225565, 60206.88147171824, 55635.52480378732, 33260.315271161286, 83408.23624885417, 12204.050575353425, 8942.030003151542, 52270.090891030886, 32852.1856661813, 10831.95598443583, 47360.91926761747, -1391.059523577921, 18474.62215290621, -10347.664817368151, 74340.95639755046, 55473.520493799646, 63898.09576721855, 74339.26958865134, 125626.53491365745, -13966.788499881794, -7322.916833552514, 91767.12248652741, 94704.11093530503], "policy_policy_rl_reward": [232522.49141026437, 187282.4305930735, 265447.1922979359, 193545.6742728831, 1947.0675491483087, 60758.796231549626, 38368.43468099497, 191079.18967826533, 9055.080910407873, 213818.45014968555, 26805.31994346543, -6306.361119514104, 117109.62782901964, 65727.05598706653, 26820.079795349844, 72602.78685244246, 121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346, 40988.82828858619, 67557.79969395866, 131055.5151051277, -27765.86433938899, 13211.05538664542, 16959.99548455738, -18588.165679464048, 43117.57619150705, 230803.9206279065, 210743.13257447214, 87797.69788397041, 95932.15453448649, 45329.32485491096, 94153.09369973328, 22971.214598994786, -11004.84164991712, 39934.360368379894, 66370.66782992217, 12104.360708359398, 22710.023806820747, -20607.837835192993, 18986.062457065327, 13493.437791282562, 68860.41922280808, 95717.13274893013, 60716.38108103127, 76753.70469340304, 46616.079349391475, -13202.594432793545, 1631.1082284520696, 112852.42944284428, 74326.28396776949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23395927091526342, "mean_inference_ms": 0.7618264155500767, "mean_action_processing_ms": 0.11842665670188865, "mean_env_wait_ms": 0.17473744751046616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007162094116210938, "StateBufferConnector_ms": 0.0006908178329467773, "ViewRequirementAgentConnector_ms": 0.01769810914993286}, "num_episodes": 16, "episode_return_max": 782196.1019899033, "episode_return_min": -142739.21109275866, "episode_return_mean": 222109.04195815587, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.8278964648505, "num_env_steps_trained_throughput_per_sec": 731.8278964648505, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 5599.98, "restore_workers_time_ms": 0.177, "training_step_time_ms": 5599.724, "sample_time_ms": 5056.764, "learn_time_ms": 538.869, "learn_throughput": 7422.955, "synch_weights_time_ms": 3.445}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-48", "timestamp": 1760509848, "time_this_iter_s": 5.470340013504028, "time_total_s": 567.1971626281738, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4e0c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 567.1971626281738, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 35.7, "ram_util_percent": 83.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.534092426300049, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.952468320727348, "policy_loss": -0.02065072363911895, "vf_loss": 9.959518533945083, "vf_explained_var": 8.031725883483887e-07, "kl": 0.013432661693014445, "entropy": 3.99441040456295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 782196.1019899033, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 212714.76147800297, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -28197.426098391177}, "policy_reward_max": {"policy_mom": 186609.43006465555, "policy_mean": 207826.4969342251, "policy_mm": 203178.86844747188, "policy_rl": 269521.64198379393}, "policy_reward_mean": {"policy_mom": 50736.88933873493, "policy_mean": 50151.02362704942, "policy_mm": 47876.51568918796, "policy_rl": 63950.33282303069}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50736.88671875, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 186609.4375, "('mean_0', 'policy_mean')_total_reward_mean": 50151.0234375, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 207826.5, "('mm_0', 'policy_mm')_total_reward_mean": 47876.51953125, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 203178.875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 63950.328125, "('rl_trader_0', 'policy_rl')_total_reward_min": -28197.42578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 269521.65625}, "hist_stats": {"episode_reward": [361477.7893165748, 297500.3234765, 16496.219415352058, -65445.65596689977, 114851.44133489199, 535023.5883780497, 342599.66793082113, 166778.04469537345, 91886.63502834586, -99822.36660201036, 620499.1842843468, 576422.2792228236, 252968.89748730525, 444484.5997594425, 146926.17158606884, 251543.6032742397, 200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071, 138718.86875413617, 134206.0101590339, 440097.89913764683, -116738.03058968346, 7913.495349624985, 60021.943507310774, -83715.32867775547, 210265.20838690668, 627532.819770455, 595987.168884708, 310972.3829960293, 337762.3748307411, 140479.2552994365, 380559.0866407838, 102479.29595111735, -11138.793893118134, 137430.52441565448, 202657.29086505485, 29116.974540739433, 126715.93011732127, -24543.64313974219, 34009.433839225894, -4819.106816800197, 268124.6194860928, 300248.7912369859, 258245.90540382202, 288279.6556713559, 334288.4263091061, -70006.18460330459, -2284.589588639931, 443307.4363563686, 312824.05102287134, 233566.25817866586, 690357.9648250034, 396037.4073951477, 660465.5633941409, 233457.8908720649, 95450.20202403376, 105325.90416414071, 671163.8366603395, -7598.912982872555, -40116.88896615185, -803.4343641663241, 200535.00503796464, 324064.5330105136, 131093.3072993848, 231720.2583916096, 288296.84831470274], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [78093.82902605199, 61668.84646870586, 14133.807598673662, -27839.321559778167, 30009.507791677508, 107351.91279243707, 107704.31046924267, 25034.74704900347, 26167.595420001704, -23280.86772656157, 117918.21847524014, 101483.3291902621, 67194.25552480298, 144315.6166583738, 23185.294179335335, 59770.62576562726, 53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151, 34645.822395928284, 5357.196118339212, 83980.45709613069, -27432.252086181004, 12354.460001744063, -656.3739704087451, -34237.904326751624, 76027.02057356162, 146933.33523079043, 151059.32450368322, 99929.17258176113, 90878.70073188892, 18325.76349853619, 115630.84957890087, 35842.38503311473, -13974.30389343365, 14100.635311863018, 47989.75922051853, -4422.228513744541, 17878.436311912785, -13003.550544438604, 630.0051142696843, 2832.993644289569, 54814.22709420868, 88155.04541090928, 54179.76111374183, 95509.91822411424, 93711.27391397528, -19576.58936219708, 326.1786391154664, 119567.39456466782, 58017.75403335787, 76980.23397097025, 186609.43006465555, 119167.95087000854, 162840.15237792733, 51911.85368005717, 38248.60164711299, 19419.59675318034, 119793.95401208673, 6438.384298392215, -14879.252150993068, -7701.529103921437, 62900.85382579243, 57310.23133824776, 31948.05105443333, 55436.00241495568, 62377.428170829015], "policy_policy_mean_reward": [108050.73815294156, 54855.481497432724, 2209.098521026534, -14127.301354290279, 43592.60273780571, 118981.21201162314, 78878.90203455908, 24629.56524323552, 23468.08536892701, -28003.03425005108, 124323.51374011901, 207826.4969342251, 79475.78025492921, 117951.1189420161, 31270.867563554315, 62530.48156178141, 22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724, 30521.382284987154, 32446.513032972653, 114869.20318769464, -31900.614470625427, -12252.710853674933, 19668.210277179773, -22746.056970881164, 39718.38711744769, 147251.3469808568, 120833.64121429808, 63038.631058579515, 95315.99476057867, 43563.851674828074, 87366.90711329579, 31461.645743654484, 4898.321647081143, 31125.43784438069, 55444.678148432744, 10602.886361688737, 38766.550730970346, 10458.80476346733, -4081.2558850151854, -10797.873435004249, 70109.0167715258, 60903.09258334674, 79451.66744183039, 41676.76316518738, 68334.53813208164, -23260.212308432237, 3081.040377344865, 119120.48986232857, 85775.9020864386, 64696.94139917598, 102927.10021309946, 118213.05332657308, 124457.8159347845, 43467.13305335697, 29738.2050593739, 44648.40344825614, 134487.9690494363, -1604.1752408332336, -7698.700925813241, 7857.686990644859, 59101.979895482255, 85010.64985784046, -6156.909295287463, 41382.388127428385, 62355.37121594993], "policy_policy_mm_reward": [53732.612317973086, 95055.22584716484, -9915.907670798548, -15841.993245294241, 26589.590893525296, 79779.12589109564, 73482.64527316662, 45845.465021023534, 22214.8041968711, -23218.079302557515, 136433.06447738165, 101379.8454522859, 71872.4593339394, 70879.30803384386, 41298.702287373104, 67897.15831145646, 45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487, 32562.835784634608, 28844.50131376346, 110192.72374869391, -29639.29969348798, -5399.309185089587, 24050.111715982395, -8143.201700658648, 51402.224504390404, 102544.21693090083, 113351.07059225565, 60206.88147171824, 55635.52480378732, 33260.315271161286, 83408.23624885417, 12204.050575353425, 8942.030003151542, 52270.090891030886, 32852.1856661813, 10831.95598443583, 47360.91926761747, -1391.059523577921, 18474.62215290621, -10347.664817368151, 74340.95639755046, 55473.520493799646, 63898.09576721855, 74339.26958865134, 125626.53491365745, -13966.788499881794, -7322.916833552514, 91767.12248652741, 94704.11093530503, 38384.545554088, 148814.52863952267, 51909.29666975467, 160812.74989591126, 63891.043139549256, -773.2921629249954, 15243.681588911499, 147360.2716150231, 1422.3173222108321, -5143.444586429879, 1398.804286507277, 51424.30029696011, 73043.89929849964, 44837.51821175862, 53072.28457367621, 76586.85370938764], "policy_policy_rl_reward": [121600.6098196081, 85920.76966319681, 10069.220966450548, -7637.039807537114, 14659.73991188354, 228911.33768289414, 82533.81015385277, 71268.267382111, 20036.15004254612, -25320.385322840277, 241824.38759160662, 165732.60764604996, 34426.402373633675, 111338.55612520895, 51171.30755580595, 61345.33763537472, 79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346, 40988.82828858619, 67557.79969395866, 131055.5151051277, -27765.86433938899, 13211.05538664542, 16959.99548455738, -18588.165679464048, 43117.57619150705, 230803.9206279065, 210743.13257447214, 87797.69788397041, 95932.15453448649, 45329.32485491096, 94153.09369973328, 22971.214598994786, -11004.84164991712, 39934.360368379894, 66370.66782992217, 12104.360708359398, 22710.023806820747, -20607.837835192993, 18986.062457065327, 13493.437791282562, 68860.41922280808, 95717.13274893013, 60716.38108103127, 76753.70469340304, 46616.079349391475, -13202.594432793545, 1631.1082284520696, 112852.42944284428, 74326.28396776949, 53504.53725443159, 252006.90590772525, 106747.10652881135, 212354.84518551678, 74187.86099910182, 28236.687480472094, 26014.222373792738, 269521.64198379393, -13855.4393626424, -12395.49130291579, -2358.3965373969127, 27107.871019730377, 108699.75251592552, 60464.64732848019, 81829.58327554922, 86977.19521853566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.233863212402471, "mean_inference_ms": 0.7614906775944787, "mean_action_processing_ms": 0.11838026725774946, "mean_env_wait_ms": 0.17465241714793997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007100701332092285, "StateBufferConnector_ms": 0.0006881952285766602, "ViewRequirementAgentConnector_ms": 0.017668604850769043}, "num_episodes": 16, "episode_return_max": 782196.1019899033, "episode_return_min": -142739.21109275866, "episode_return_mean": 212714.76147800297, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.5861083253712, "num_env_steps_trained_throughput_per_sec": 732.5861083253712, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 5598.499, "restore_workers_time_ms": 0.189, "training_step_time_ms": 5598.221, "sample_time_ms": 5054.986, "learn_time_ms": 539.133, "learn_throughput": 7419.32, "synch_weights_time_ms": 3.458}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-54", "timestamp": 1760509854, "time_this_iter_s": 5.464405059814453, "time_total_s": 572.6615676879883, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed5f80>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 572.6615676879883, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 41.285714285714285, "ram_util_percent": 83.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.700272798538208, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.956604254245757, "policy_loss": -0.014115101093193517, "vf_loss": 9.957125428318978, "vf_explained_var": 7.877126336097717e-07, "kl": 0.013426087019980137, "entropy": 3.8527972802519797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 950833.0076965167, "episode_reward_min": -142739.21109275866, "episode_reward_mean": 206233.73695072983, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -40871.19681818373, "policy_mean": -32960.890062940816, "policy_mm": -41069.46974140177, "policy_rl": -28197.426098391177}, "policy_reward_max": {"policy_mom": 272424.13550815155, "policy_mean": 192479.61819604502, "policy_mm": 238185.67979101065, "policy_rl": 278851.7454955503}, "policy_reward_mean": {"policy_mom": 50040.303227990255, "policy_mean": 47786.27485087723, "policy_mm": 47286.96860102468, "policy_rl": 61120.19027083772}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 50040.30078125, "('mom_0', 'policy_mom')_total_reward_min": -40871.1953125, "('mom_0', 'policy_mom')_total_reward_max": 272424.125, "('mean_0', 'policy_mean')_total_reward_mean": 47786.2734375, "('mean_0', 'policy_mean')_total_reward_min": -32960.890625, "('mean_0', 'policy_mean')_total_reward_max": 192479.625, "('mm_0', 'policy_mm')_total_reward_mean": 47286.9609375, "('mm_0', 'policy_mm')_total_reward_min": -41069.46875, "('mm_0', 'policy_mm')_total_reward_max": 238185.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 61120.19140625, "('rl_trader_0', 'policy_rl')_total_reward_min": -28197.42578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 278851.75}, "hist_stats": {"episode_reward": [200820.71574599942, 206325.22361676826, -2041.337712857377, -36741.56267403539, 154872.32151047842, -142739.21109275866, 469576.88135801523, -88100.46295147699, -23596.09688788443, 133620.12541414498, 597147.2597527327, 521487.27622984373, 294203.1819467105, 411897.1751885417, 62151.50989427389, 117015.11444881385, 245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071, 138718.86875413617, 134206.0101590339, 440097.89913764683, -116738.03058968346, 7913.495349624985, 60021.943507310774, -83715.32867775547, 210265.20838690668, 627532.819770455, 595987.168884708, 310972.3829960293, 337762.3748307411, 140479.2552994365, 380559.0866407838, 102479.29595111735, -11138.793893118134, 137430.52441565448, 202657.29086505485, 29116.974540739433, 126715.93011732127, -24543.64313974219, 34009.433839225894, -4819.106816800197, 268124.6194860928, 300248.7912369859, 258245.90540382202, 288279.6556713559, 334288.4263091061, -70006.18460330459, -2284.589588639931, 443307.4363563686, 312824.05102287134, 233566.25817866586, 690357.9648250034, 396037.4073951477, 660465.5633941409, 233457.8908720649, 95450.20202403376, 105325.90416414071, 671163.8366603395, -7598.912982872555, -40116.88896615185, -803.4343641663241, 200535.00503796464, 324064.5330105136, 131093.3072993848, 231720.2583916096, 288296.84831470274, 27006.011917266867, 239989.16759417843, 105202.06835356087, 135989.36473078906, 218749.51182955035, 495151.2786502324, -80414.25479986054, 241953.8108884834, 286916.572289833, 15344.878572401356, 141742.85786993196, 201514.8831901577, 950833.0076965167, 32377.99825248176, 132697.9534351489, 261032.85942324004], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [53858.09729479551, 52536.64890231689, -16818.478699447725, -6610.518158614879, 14349.700664712598, -40871.19681818373, 126794.11757080605, -35030.29578734312, -879.8590125625699, 55271.88366438889, 165531.2001971822, 134499.4654575824, 78330.13590086042, 118640.34327293959, 18069.05449752679, 37901.823622534954, 84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151, 34645.822395928284, 5357.196118339212, 83980.45709613069, -27432.252086181004, 12354.460001744063, -656.3739704087451, -34237.904326751624, 76027.02057356162, 146933.33523079043, 151059.32450368322, 99929.17258176113, 90878.70073188892, 18325.76349853619, 115630.84957890087, 35842.38503311473, -13974.30389343365, 14100.635311863018, 47989.75922051853, -4422.228513744541, 17878.436311912785, -13003.550544438604, 630.0051142696843, 2832.993644289569, 54814.22709420868, 88155.04541090928, 54179.76111374183, 95509.91822411424, 93711.27391397528, -19576.58936219708, 326.1786391154664, 119567.39456466782, 58017.75403335787, 76980.23397097025, 186609.43006465555, 119167.95087000854, 162840.15237792733, 51911.85368005717, 38248.60164711299, 19419.59675318034, 119793.95401208673, 6438.384298392215, -14879.252150993068, -7701.529103921437, 62900.85382579243, 57310.23133824776, 31948.05105443333, 55436.00241495568, 62377.428170829015, 5506.06043254467, 57536.89591640145, 41808.33584745539, 29303.656678380714, 59573.75336063014, 99535.8155330692, -22067.02954203484, 68602.28374102752, 80524.64904538532, -16379.44143622124, 20161.542401090956, 60178.99239668943, 272424.13550815155, 6667.214999938581, 18018.99007363676, 61857.24109248123], "policy_policy_mean_reward": [22015.529119362633, 81915.92403792567, 9778.2693444648, -3256.682330853247, 48893.18536385122, -32960.890062940816, 75516.12414977502, -15715.74996748999, -6674.047869989279, 13775.816176405391, 119050.34984293595, 132213.88977476305, 97989.36667334291, 92205.90692479989, 26657.20534686451, 36787.69114067377, 70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724, 30521.382284987154, 32446.513032972653, 114869.20318769464, -31900.614470625427, -12252.710853674933, 19668.210277179773, -22746.056970881164, 39718.38711744769, 147251.3469808568, 120833.64121429808, 63038.631058579515, 95315.99476057867, 43563.851674828074, 87366.90711329579, 31461.645743654484, 4898.321647081143, 31125.43784438069, 55444.678148432744, 10602.886361688737, 38766.550730970346, 10458.80476346733, -4081.2558850151854, -10797.873435004249, 70109.0167715258, 60903.09258334674, 79451.66744183039, 41676.76316518738, 68334.53813208164, -23260.212308432237, 3081.040377344865, 119120.48986232857, 85775.9020864386, 64696.94139917598, 102927.10021309946, 118213.05332657308, 124457.8159347845, 43467.13305335697, 29738.2050593739, 44648.40344825614, 134487.9690494363, -1604.1752408332336, -7698.700925813241, 7857.686990644859, 59101.979895482255, 85010.64985784046, -6156.909295287463, 41382.388127428385, 62355.37121594993, 9499.46389272974, 49699.381183678684, 14704.108614934268, 42224.19966551698, 39053.17692228359, 130412.3761847039, -23937.861436164334, 60680.66419098962, 64566.965284205944, 30723.602453909214, 53314.90863007719, 42046.990228851035, 161371.44690180413, 6647.385860252991, 38081.69661532264, 80350.22614952082], "policy_policy_mm_reward": [45864.24027688776, 29539.88201293676, -2138.5456877640704, -15831.500228881145, 33905.763487359756, -41069.46974140177, 99784.58629537166, -17548.863069179788, -5175.813604906479, 17697.809687829784, 163403.40489984947, 122363.96011660347, 51355.61738401056, 63840.04747912652, -4712.682401085826, 28230.814739000478, 33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487, 32562.835784634608, 28844.50131376346, 110192.72374869391, -29639.29969348798, -5399.309185089587, 24050.111715982395, -8143.201700658648, 51402.224504390404, 102544.21693090083, 113351.07059225565, 60206.88147171824, 55635.52480378732, 33260.315271161286, 83408.23624885417, 12204.050575353425, 8942.030003151542, 52270.090891030886, 32852.1856661813, 10831.95598443583, 47360.91926761747, -1391.059523577921, 18474.62215290621, -10347.664817368151, 74340.95639755046, 55473.520493799646, 63898.09576721855, 74339.26958865134, 125626.53491365745, -13966.788499881794, -7322.916833552514, 91767.12248652741, 94704.11093530503, 38384.545554088, 148814.52863952267, 51909.29666975467, 160812.74989591126, 63891.043139549256, -773.2921629249954, 15243.681588911499, 147360.2716150231, 1422.3173222108321, -5143.444586429879, 1398.804286507277, 51424.30029696011, 73043.89929849964, 44837.51821175862, 53072.28457367621, 76586.85370938764, -1843.4494460522167, 62439.10207384067, 16916.680066707817, 31579.501602558452, 51620.311389541486, 103086.11983897559, -18457.16879521822, 46792.9533994328, 80101.08460226521, 4795.436415027937, 25736.96779273363, 30198.144615478363, 238185.67979101065, 13448.115944133726, 51811.10480041039, 42118.734211273775], "policy_policy_rl_reward": [79082.84905495342, 42332.76866358907, 7137.417329889679, -11042.861955686056, 57723.671994554796, -27837.65447023212, 167482.05334206295, -19805.554127464155, -10866.376400426088, 46874.615885520856, 149162.30481276516, 132409.96088089468, 66528.06198849679, 137210.87751167617, 22137.932450968394, 14094.784946604734, 58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346, 40988.82828858619, 67557.79969395866, 131055.5151051277, -27765.86433938899, 13211.05538664542, 16959.99548455738, -18588.165679464048, 43117.57619150705, 230803.9206279065, 210743.13257447214, 87797.69788397041, 95932.15453448649, 45329.32485491096, 94153.09369973328, 22971.214598994786, -11004.84164991712, 39934.360368379894, 66370.66782992217, 12104.360708359398, 22710.023806820747, -20607.837835192993, 18986.062457065327, 13493.437791282562, 68860.41922280808, 95717.13274893013, 60716.38108103127, 76753.70469340304, 46616.079349391475, -13202.594432793545, 1631.1082284520696, 112852.42944284428, 74326.28396776949, 53504.53725443159, 252006.90590772525, 106747.10652881135, 212354.84518551678, 74187.86099910182, 28236.687480472094, 26014.222373792738, 269521.64198379393, -13855.4393626424, -12395.49130291579, -2358.3965373969127, 27107.871019730377, 108699.75251592552, 60464.64732848019, 81829.58327554922, 86977.19521853566, 13843.937038044636, 70313.78842025778, 31772.943824463393, 32882.006784333214, 68502.27015709491, 162116.96709348308, -15952.195026443103, 65877.90955703352, 61723.873357976205, -3794.7188603146487, 42529.43904603011, 69090.75594913878, 278851.7454955503, 5615.28144815649, 24786.16194577931, 76706.65796996445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23376907339862094, "mean_inference_ms": 0.7611912545199371, "mean_action_processing_ms": 0.11833553226321186, "mean_env_wait_ms": 0.17456921334678996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0007063150405883789, "StateBufferConnector_ms": 0.0006878376007080078, "ViewRequirementAgentConnector_ms": 0.017682135105133057}, "num_episodes": 16, "episode_return_max": 950833.0076965167, "episode_return_min": -142739.21109275866, "episode_return_mean": 206233.73695072983, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.1025032993722, "num_env_steps_trained_throughput_per_sec": 720.1025032993722, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 5610.897, "restore_workers_time_ms": 0.189, "training_step_time_ms": 5610.619, "sample_time_ms": 5066.918, "learn_time_ms": 539.512, "learn_throughput": 7414.102, "synch_weights_time_ms": 3.535}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "26ec2_00000", "date": "2025-10-15_01-30-59", "timestamp": 1760509859, "time_this_iter_s": 5.559240102767944, "time_total_s": 578.2208077907562, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156ed60c0>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 578.2208077907562, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 29.1625, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_rl": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.391303539276123, "cur_kl_coeff": 1.0125, "cur_lr": 0.0003, "total_loss": 9.950028094649316, "policy_loss": -0.021686566760763526, "vf_loss": 9.960704743862152, "vf_explained_var": 3.6247074604034423e-07, "kl": 0.010873943270849428, "entropy": 3.6505605250597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 950833.0076965167, "episode_reward_min": -116738.03058968346, "episode_reward_mean": 224863.96669085734, "episode_len_mean": 252.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"policy_mom": -34237.904326751624, "policy_mean": -31900.614470625427, "policy_mm": -29639.29969348798, "policy_rl": -28197.426098391177}, "policy_reward_max": {"policy_mom": 272424.13550815155, "policy_mean": 192479.61819604502, "policy_mm": 238185.67979101065, "policy_rl": 278851.7454955503}, "policy_reward_mean": {"policy_mom": 52852.449702967264, "policy_mean": 53629.51208799302, "policy_mm": 51924.20988573453, "policy_rl": 66457.79501416246}, "custom_metrics": {"('mom_0', 'policy_mom')_total_reward_mean": 52852.4453125, "('mom_0', 'policy_mom')_total_reward_min": -34237.90625, "('mom_0', 'policy_mom')_total_reward_max": 272424.125, "('mean_0', 'policy_mean')_total_reward_mean": 53629.51171875, "('mean_0', 'policy_mean')_total_reward_min": -31900.615234375, "('mean_0', 'policy_mean')_total_reward_max": 192479.625, "('mm_0', 'policy_mm')_total_reward_mean": 51924.2109375, "('mm_0', 'policy_mm')_total_reward_min": -29639.298828125, "('mm_0', 'policy_mm')_total_reward_max": 238185.6875, "('rl_trader_0', 'policy_rl')_total_reward_mean": 66457.796875, "('rl_trader_0', 'policy_rl')_total_reward_min": -28197.42578125, "('rl_trader_0', 'policy_rl')_total_reward_max": 278851.75}, "hist_stats": {"episode_reward": [245991.6405645067, 158781.0529711604, 174950.86871271653, 376859.3619342804, -51646.62596879531, 782196.1019899033, 236592.14986562455, 249207.37859509134, 203694.42521879476, -49585.972690309856, 251813.591194234, 179488.94497724317, 232898.21987691807, -62384.88662508974, 135058.07183206236, 282282.74392003164, 17310.503810051374, 341303.8441239379, 243206.39679858944, 271354.8854128071, 138718.86875413617, 134206.0101590339, 440097.89913764683, -116738.03058968346, 7913.495349624985, 60021.943507310774, -83715.32867775547, 210265.20838690668, 627532.819770455, 595987.168884708, 310972.3829960293, 337762.3748307411, 140479.2552994365, 380559.0866407838, 102479.29595111735, -11138.793893118134, 137430.52441565448, 202657.29086505485, 29116.974540739433, 126715.93011732127, -24543.64313974219, 34009.433839225894, -4819.106816800197, 268124.6194860928, 300248.7912369859, 258245.90540382202, 288279.6556713559, 334288.4263091061, -70006.18460330459, -2284.589588639931, 443307.4363563686, 312824.05102287134, 233566.25817866586, 690357.9648250034, 396037.4073951477, 660465.5633941409, 233457.8908720649, 95450.20202403376, 105325.90416414071, 671163.8366603395, -7598.912982872555, -40116.88896615185, -803.4343641663241, 200535.00503796464, 324064.5330105136, 131093.3072993848, 231720.2583916096, 288296.84831470274, 27006.011917266867, 239989.16759417843, 105202.06835356087, 135989.36473078906, 218749.51182955035, 495151.2786502324, -80414.25479986054, 241953.8108884834, 286916.572289833, 15344.878572401356, 141742.85786993196, 201514.8831901577, 950833.0076965167, 32377.99825248176, 132697.9534351489, 261032.85942324004, 631243.0955708593, 175188.93946002983, 327251.29848090286, 176723.7477361046, 127825.39631158435, 303947.48049910995, 667500.6521090531, 163014.380512331, 68774.45032011386, 264317.7724928419, 347705.2014942748, 104325.30910936325, 321558.12957078265, 373356.3899625782, 311801.9730553116, 374386.8711148118], "episode_lengths": [252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252], "policy_policy_mom_reward": [84061.74847496742, 36830.93748407362, 50077.809734516835, 90498.00461303264, -7821.243516930894, 125372.77969293551, 56007.936985023676, 60724.574557459026, 53081.31949116212, -17033.546764683637, 41333.10676233401, 33609.345809680504, 56111.84648210642, -13871.66531132369, 27963.403894111158, 96326.36622766685, -2289.8952723617213, 57423.19157929394, 78309.5105745751, 64312.96221536151, 34645.822395928284, 5357.196118339212, 83980.45709613069, -27432.252086181004, 12354.460001744063, -656.3739704087451, -34237.904326751624, 76027.02057356162, 146933.33523079043, 151059.32450368322, 99929.17258176113, 90878.70073188892, 18325.76349853619, 115630.84957890087, 35842.38503311473, -13974.30389343365, 14100.635311863018, 47989.75922051853, -4422.228513744541, 17878.436311912785, -13003.550544438604, 630.0051142696843, 2832.993644289569, 54814.22709420868, 88155.04541090928, 54179.76111374183, 95509.91822411424, 93711.27391397528, -19576.58936219708, 326.1786391154664, 119567.39456466782, 58017.75403335787, 76980.23397097025, 186609.43006465555, 119167.95087000854, 162840.15237792733, 51911.85368005717, 38248.60164711299, 19419.59675318034, 119793.95401208673, 6438.384298392215, -14879.252150993068, -7701.529103921437, 62900.85382579243, 57310.23133824776, 31948.05105443333, 55436.00241495568, 62377.428170829015, 5506.06043254467, 57536.89591640145, 41808.33584745539, 29303.656678380714, 59573.75336063014, 99535.8155330692, -22067.02954203484, 68602.28374102752, 80524.64904538532, -16379.44143622124, 20161.542401090956, 60178.99239668943, 272424.13550815155, 6667.214999938581, 18018.99007363676, 61857.24109248123, 108820.23146610355, 40590.005362294345, 95939.13777610492, 26573.25874818755, 40973.0912493763, 64744.786768394726, 134157.11793068858, 38784.626581839366, 19809.9201268376, 62392.11362351895, 77864.03328267435, 21588.168485666843, 73397.71225203454, 58385.17801801269, 72759.06400813175, 100008.32438732966], "policy_policy_mean_reward": [70094.53270202628, 48549.578171281166, 18094.789148129443, 65019.973101455245, -6689.102911421586, 192479.61819604502, 60605.38290130623, 48375.21050392389, 24918.46785167505, 4751.557033242831, 44365.32137472974, 45012.97836215551, 57776.47869726914, -11772.791838440658, 40586.37711450765, 58699.952316665214, -558.0746973113789, 79660.88133219365, 76588.43831009232, 60786.20586337724, 30521.382284987154, 32446.513032972653, 114869.20318769464, -31900.614470625427, -12252.710853674933, 19668.210277179773, -22746.056970881164, 39718.38711744769, 147251.3469808568, 120833.64121429808, 63038.631058579515, 95315.99476057867, 43563.851674828074, 87366.90711329579, 31461.645743654484, 4898.321647081143, 31125.43784438069, 55444.678148432744, 10602.886361688737, 38766.550730970346, 10458.80476346733, -4081.2558850151854, -10797.873435004249, 70109.0167715258, 60903.09258334674, 79451.66744183039, 41676.76316518738, 68334.53813208164, -23260.212308432237, 3081.040377344865, 119120.48986232857, 85775.9020864386, 64696.94139917598, 102927.10021309946, 118213.05332657308, 124457.8159347845, 43467.13305335697, 29738.2050593739, 44648.40344825614, 134487.9690494363, -1604.1752408332336, -7698.700925813241, 7857.686990644859, 59101.979895482255, 85010.64985784046, -6156.909295287463, 41382.388127428385, 62355.37121594993, 9499.46389272974, 49699.381183678684, 14704.108614934268, 42224.19966551698, 39053.17692228359, 130412.3761847039, -23937.861436164334, 60680.66419098962, 64566.965284205944, 30723.602453909214, 53314.90863007719, 42046.990228851035, 161371.44690180413, 6647.385860252991, 38081.69661532264, 80350.22614952082, 176962.5260566861, 65179.15539121718, 69982.30438976912, 51510.85740791816, 37114.22155628951, 63235.347526480786, 139999.3294763408, 54493.503763258595, 36621.65778271867, 81760.08369952807, 89015.4239339863, 32359.414063784698, 102914.52937958625, 99912.4291431137, 94332.14291257621, 87122.68489221616], "policy_policy_mm_reward": [33481.10034649815, 34299.80053123868, 51106.48581896198, 135209.229139491, -8938.853442051577, 203178.86844747188, 58133.71781696863, 74002.80499298101, 58308.47645166322, -18130.976809723754, 94558.63768406611, 36217.89797425694, 56261.82216592165, -22152.072108759952, 44782.26380892284, 61717.538430562985, 20686.31795611007, 75664.15686885473, 32330.37175671204, 55321.47701612487, 32562.835784634608, 28844.50131376346, 110192.72374869391, -29639.29969348798, -5399.309185089587, 24050.111715982395, -8143.201700658648, 51402.224504390404, 102544.21693090083, 113351.07059225565, 60206.88147171824, 55635.52480378732, 33260.315271161286, 83408.23624885417, 12204.050575353425, 8942.030003151542, 52270.090891030886, 32852.1856661813, 10831.95598443583, 47360.91926761747, -1391.059523577921, 18474.62215290621, -10347.664817368151, 74340.95639755046, 55473.520493799646, 63898.09576721855, 74339.26958865134, 125626.53491365745, -13966.788499881794, -7322.916833552514, 91767.12248652741, 94704.11093530503, 38384.545554088, 148814.52863952267, 51909.29666975467, 160812.74989591126, 63891.043139549256, -773.2921629249954, 15243.681588911499, 147360.2716150231, 1422.3173222108321, -5143.444586429879, 1398.804286507277, 51424.30029696011, 73043.89929849964, 44837.51821175862, 53072.28457367621, 76586.85370938764, -1843.4494460522167, 62439.10207384067, 16916.680066707817, 31579.501602558452, 51620.311389541486, 103086.11983897559, -18457.16879521822, 46792.9533994328, 80101.08460226521, 4795.436415027937, 25736.96779273363, 30198.144615478363, 238185.67979101065, 13448.115944133726, 51811.10480041039, 42118.734211273775, 129915.86543625031, 26552.89080255828, 91379.71662369202, 49594.65997685549, 18009.70039965949, 58127.73008594525, 153467.00330782763, 35055.06021217359, 5675.893373117267, 62557.706518937855, 67120.4033686492, 23257.96834347879, 68280.73237932532, 87868.45543106554, 67123.06087897747, 89246.53297822991], "policy_policy_rl_reward": [58354.25904101465, 39100.73678456686, 55671.784011108415, 86132.15508030096, -28197.426098391177, 261164.83565345037, 61845.1121623259, 66104.78854072747, 67386.1614242942, -19173.00614914539, 71556.52537310406, 64648.722831150364, 62748.072531620826, -14588.357366565519, 21726.02701452085, 65538.88694513658, -527.8441763855966, 128555.61434359552, 55978.07615721004, 90934.24031794346, 40988.82828858619, 67557.79969395866, 131055.5151051277, -27765.86433938899, 13211.05538664542, 16959.99548455738, -18588.165679464048, 43117.57619150705, 230803.9206279065, 210743.13257447214, 87797.69788397041, 95932.15453448649, 45329.32485491096, 94153.09369973328, 22971.214598994786, -11004.84164991712, 39934.360368379894, 66370.66782992217, 12104.360708359398, 22710.023806820747, -20607.837835192993, 18986.062457065327, 13493.437791282562, 68860.41922280808, 95717.13274893013, 60716.38108103127, 76753.70469340304, 46616.079349391475, -13202.594432793545, 1631.1082284520696, 112852.42944284428, 74326.28396776949, 53504.53725443159, 252006.90590772525, 106747.10652881135, 212354.84518551678, 74187.86099910182, 28236.687480472094, 26014.222373792738, 269521.64198379393, -13855.4393626424, -12395.49130291579, -2358.3965373969127, 27107.871019730377, 108699.75251592552, 60464.64732848019, 81829.58327554922, 86977.19521853566, 13843.937038044636, 70313.78842025778, 31772.943824463393, 32882.006784333214, 68502.27015709491, 162116.96709348308, -15952.195026443103, 65877.90955703352, 61723.873357976205, -3794.7188603146487, 42529.43904603011, 69090.75594913878, 278851.7454955503, 5615.28144815649, 24786.16194577931, 76706.65796996445, 215544.47261181887, 42866.88790396013, 69950.13969133698, 49044.9716031434, 31728.383106258938, 117839.61611828931, 239877.20139419587, 34681.18995505963, 6666.979037440309, 57607.86865085684, 113705.34090896467, 27119.75821643284, 76965.15555983652, 127190.32737038656, 77587.70525562603, 98009.32885703664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2336696905719468, "mean_inference_ms": 0.7608723419888697, "mean_action_processing_ms": 0.1182875789635634, "mean_env_wait_ms": 0.17447993585303087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.000693976879119873, "StateBufferConnector_ms": 0.0006783604621887207, "ViewRequirementAgentConnector_ms": 0.017503738403320312}, "num_episodes": 16, "episode_return_max": 950833.0076965167, "episode_return_min": -116738.03058968346, "episode_return_mean": 224863.96669085734, "episodes_this_iter": 16}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.549845222269, "num_env_steps_trained_throughput_per_sec": 730.549845222269, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 5605.214, "restore_workers_time_ms": 0.189, "training_step_time_ms": 5604.937, "sample_time_ms": 5060.076, "learn_time_ms": 540.929, "learn_throughput": 7394.685, "synch_weights_time_ms": 3.264}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "26ec2_00000", "date": "2025-10-15_01-31-05", "timestamp": 1760509865, "time_this_iter_s": 5.479470729827881, "time_total_s": 583.7002785205841, "pid": 95489, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "multi_asset_market_env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x156e4fa60>", "policies_to_train": ["policy_rl"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_mom": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mean": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_mm": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}], "policy_rl": [null, "Box(-inf, inf, (81,), float32)", "Box(0.0, 1.0, (4,), float32)", {}]}, "callbacks": "<class '__main__.CustomMetrics'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 583.7002785205841, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.9625, "ram_util_percent": 82.7}}
